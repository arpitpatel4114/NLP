This page intentionally left blank COMPUTER NETWORKS FIFTH EDITION This page intentionally left blank COMPUTER NETWORKS FIFTH EDITION ANDREW S TANENBAUM Vrije Universiteit Amsterdam The Netherlands DAVID J WETHERALL University Washington Seattle WA PRENTICE HALL Boston Columbus Indianapolis New York San Francisco Upper Saddle River Amsterdam Cape Town Dubai London Madrid Milan Paris Montreal Toronto Delhi Mexico City Sao Paulo Sydney Hong Kong Seoul Singapore Tapei Tokyo Editorial Director Marcia Horton Editor Chief Michael Hirsch Executive Editor Tracy Dunkelberger Assistant Editor Melinda Haggerty Editorial Assistant Allison Michael Vice President Marketing Patrice Jones Marketing Manager Yezan Alayan Marketing Coordinator Kathryn Ferranti Vice President Production Vince O Brien Managing Editor Jeff Holcomb Senior Operations Supervisor Alan Fischer Manufacturing Buyer Lisa McDowell Cover Direction Andrew S Tanenbaum David J Wetherall Tracy Dunkelberger Art Director Linda Knowles Cover Designer Susan Paradise Cover Illustration Jason Consalvo Interior Design Andrew S Tanenbaum AV Production Project Manager Gregory L Dulles Interior Illustrations Laserwords Inc Media Editor Daniel Sandin Composition Andrew S Tanenbaum Copyeditor Rachel Head Proofreader Joe Ruddick Printer Binder Courier Westford Cover Printer Lehigh Phoenix Color Hagerstown Credits acknowledgments borrowed sources reproduced permission textbook appear appropriate page within text Many designations manufacturers sellers distinguish products claimed trademarks Where designations appear book publisher aware trademark claim designations printed initial caps caps Copyright 2011 2003 1996 1989 1981 Pearson Education Inc publishing Prentice Hall All rights reserved Manufactured United States America This publication protected Copyright permission obtained publisher prior prohibited reproduction storage retrieval system transmission form means electronic mechanical photocopying recording likewise To obtain permission use material work please submit written request Pearson Education Inc Permissions Department 501 Boylston Street Suite 900 Boston Massachusetts 02116 Library Congress Cataloging Publication Data Tanenbaum Andrew S 1944Computer networks Andrew S Tanenbaum David J Wetherall 5th ed p cm Includes bibliographical references index ISBN 13 978 0 13 212695 3 alk paper ISBN 10 0 13 212695 8 alk paper 1 Computer networks I Wetherall D David II Title TK5105 5 T36 2011 004 6 dc2210 9 8 7 6 5 4 3 2 1 CRW 14 13 12 11 10 To Suzanne Barbara Daniel Aron Marvin Matilde memory Bram Sweetie AST To Katrin Lucy Pepper DJW This page intentionally left blank CONTENTS xix PREFACE INTRODUCTION 1 1 USES OF COMPUTER NETWORKS 3 1 1 1 Business Applications 3 1 1 2 Home Applications 6 1 1 3 Mobile Users 10 1 1 4 Social Issues 14 1 2 NETWORK HARDWARE 17 1 2 1 Personal Area Networks 18 1 2 2 Local Area Networks 19 1 2 3 Metropolitan Area Networks 23 1 2 4 Wide Area Networks 23 1 2 5 Internetworks 28 1 3 NETWORK SOFTWARE 29 1 3 1 Protocol Hierarchies 29 1 3 2 Design Issues Layers 33 1 3 3 Connection Oriented Versus Connectionless Service 35 1 3 4 Service Primitives 38 1 3 5 The Relationship Services Protocols 40 1 4 REFERENCE MODELS 41 1 4 1 The OSI Reference Model 41 1 4 2 The TCP IP Reference Model 45 1 4 3 The Model Used This Book 48 vii viii CONTENTS 1 4 4 A Comparison OSI TCP IP Reference Models 49 1 4 5 A Critique OSI Model Protocols 51 1 4 6 A Critique TCP IP Reference Model 53 1 5 EXAMPLE NETWORKS 54 1 5 1 The Internet 54 1 5 2 Third Generation Mobile Phone Networks 65 1 5 3 Wireless LANs 802 11 70 1 5 4 RFID Sensor Networks 73 1 6 NETWORK STANDARDIZATION 75 1 6 1 Who Who Telecommunications World 77 1 6 2 Who Who International Standards World 78 1 6 3 Who Who Internet Standards World 80 1 7 METRIC UNITS 82 1 8 OUTLINE OF THE REST OF THE BOOK 83 1 9 SUMMARY 84 THE PHYSICAL LAYER 2 1 THE THEORETICAL BASIS FOR DATA COMMUNICATION 90 2 1 1 Fourier Analysis 90 2 1 2 Bandwidth Limited Signals 90 2 1 3 The Maximum Data Rate Channel 94 2 2 GUIDED TRANSMISSION MEDIA 95 2 2 1 Magnetic Media 95 2 2 2 Twisted Pairs 96 2 2 3 Coaxial Cable 97 2 2 4 Power Lines 98 2 2 5 Fiber Optics 99 2 3 WIRELESS TRANSMISSION 105 2 3 1 The Electromagnetic Spectrum 105 2 3 2 Radio Transmission 109 2 3 3 Microwave Transmission 110 2 3 4 Infrared Transmission 114 2 3 5 Light Transmission 114 CONTENTS ix 2 4 COMMUNICATION SATELLITES 116 2 4 1 Geostationary Satellites 117 2 4 2 Medium Earth Orbit Satellites 121 2 4 3 Low Earth Orbit Satellites 121 2 4 4 Satellites Versus Fiber 123 2 5 DIGITAL MODULATION AND MULTIPLEXING 125 2 5 1 Baseband Transmission 125 2 5 2 Passband Transmission 130 2 5 3 Frequency Division Multiplexing 132 2 5 4 Time Division Multiplexing 135 2 5 5 Code Division Multiplexing 135 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK 138 2 6 1 Structure Telephone System 139 2 6 2 The Politics Telephones 142 2 6 3 The Local Loop Modems ADSL Fiber 144 2 6 4 Trunks Multiplexing 152 2 6 5 Switching 161 2 7 THE MOBILE TELEPHONE SYSTEM 164 2 7 1 First Generation coco1G Mobile Phones Analog Voice 166 2 7 2 Second Generation 2G Mobile Phones Digital Voice 170 2 7 3 Third Generation 3G Mobile Phones Digital Voice Data 174 2 8 CABLE TELEVISION 179 2 8 1 Community Antenna Television 179 2 8 2 Internet Cable 180 2 8 3 Spectrum Allocation 182 2 8 4 Cable Modems 183 2 8 5 ADSL Versus Cable 185 2 9 SUMMARY 186 THE DATA LINK LAYER 3 1 DATA LINK LAYER DESIGN ISSUES 194 3 1 1 Services Provided Network Layer 194 3 1 2 Framing 197 3 1 3 Error Control 200 3 1 4 Flow Control 201 x CONTENTS 3 2 ERROR DETECTION AND CORRECTION 202 3 2 1 Error Correcting Codes 204 3 2 2 Error Detecting Codes 209 3 3 ELEMENTARY DATA LINK PROTOCOLS 215 3 3 1 A Utopian Simplex Protocol 220 3 3 2 A Simplex Stop Wait Protocol Error Free Channel 221 3 3 3 A Simplex Stop Wait Protocol Noisy Channel 222 3 4 SLIDING WINDOW PROTOCOLS 226 3 4 1 A One Bit Sliding Window Protocol 229 3 4 2 A Protocol Using Go Back N 232 3 4 3 A Protocol Using Selective Repeat 239 3 5 EXAMPLE DATA LINK PROTOCOLS 244 3 5 1 Packet SONET 245 3 5 2 ADSL Asymmetric Digital Subscriber Loop 248 3 6 SUMMARY 251 THE MEDIUM ACCESS CONTROL SUBLAYER 257 4 1 THE CHANNEL ALLOCATION PROBLEM 258 4 1 1 Static Channel Allocation 258 4 1 2 Assumptions Dynamic Channel Allocation 260 4 2 MULTIPLE ACCESS PROTOCOLS 261 4 2 1 ALOHA 262 4 2 2 Carrier Sense Multiple Access Protocols 266 4 2 3 Collision Free Protocols 269 4 2 4 Limited Contention Protocols 274 4 2 5 Wireless LAN Protocols 277 4 3 ETHERNET 280 4 3 1 Classic Ethernet Physical Layer 281 4 3 2 Classic Ethernet MAC Sublayer Protocol 282 4 3 3 Ethernet Performance 286 4 3 4 Switched Ethernet 288 CONTENTS xi 4 3 5 Fast Ethernet 290 4 3 6 Gigabit Ethernet 293 4 3 7 10 Gigabit Ethernet 296 4 3 8 Retrospective Ethernet 298 4 4 WIRELESS LANS 299 4 4 1 The 802 11 Architecture Protocol Stack 299 4 4 2 The 802 11 Physical Layer 301 4 4 3 The 802 11 MAC Sublayer Protocol 303 4 4 4 The 802 11 Frame Structure 309 4 4 5 Services 311 4 5 BROADBAND WIRELESS 312 4 5 1 Comparison 802 16 802 11 3G 313 4 5 2 The 802 16 Architecture Protocol Stack 314 4 5 3 The 802 16 Physical Layer 316 4 5 4 The 802 16 MAC Sublayer Protocol 317 4 5 5 The 802 16 Frame Structure 319 4 6 BLUETOOTH 320 4 6 1 Bluetooth Architecture 320 4 6 2 Bluetooth Applications 321 4 6 3 The Bluetooth Protocol Stack 322 4 6 4 The Bluetooth Radio Layer 324 4 6 5 The Bluetooth Link Layers 324 4 6 6 The Bluetooth Frame Structure 325 4 7 RFID 327 4 7 1 EPC Gen 2 Architecture 327 4 7 2 EPC Gen 2 Physical Layer 328 4 7 3 EPC Gen 2 Tag Identi cation Layer 329 4 7 4 Tag Identi cation Message Formats 331 4 8 DATA LINK LAYER SWITCHING 332 4 8 1 Uses Bridges 332 4 8 2 Learning Bridges 334 4 8 3 Spanning Tree Bridges 337 4 8 4 Repeaters Hubs Bridges Switches Routers Gateways 340 4 8 5 Virtual LANs 342 4 9 SUMMARY 349 xii CONTENTS THE NETWORK LAYER 5 1 NETWORK LAYER DESIGN ISSUES 355 5 1 1 Store Forward Packet Switching 356 5 1 2 Services Provided Transport Layer 356 5 1 3 Implementation Connectionless Service 358 5 1 4 Implementation Connection Oriented Service 359 5 1 5 Comparison Virtual Circuit Datagram Networks 361 5 2 ROUTING ALGORITHMS 362 5 2 1 The Optimality Principle 364 5 2 2 Shortest Path Algorithm 366 5 2 3 Flooding 368 5 2 4 Distance Vector Routing 370 5 2 5 Link State Routing 373 5 2 6 Hierarchical Routing 378 5 2 7 Broadcast Routing 380 5 2 8 Multicast Routing 382 5 2 9 Anycast Routing 385 5 2 10 Routing Mobile Hosts 386 5 2 11 Routing Ad Hoc Networks 389 5 3 CONGESTION CONTROL ALGORITHMS 392 5 3 1 Approaches Congestion Control 394 5 3 2 Traf c Aware Routing 395 5 3 3 Admission Control 397 5 3 4 Traf c Throttling 398 5 3 5 Load Shedding 401 5 4 QUALITY OF SERVICE 404 5 4 1 Application Requirements 405 5 4 2 Traf c Shaping 407 5 4 3 Packet Scheduling 411 5 4 4 Admission Control 415 5 4 5 Integrated Services 418 5 4 6 Differentiated Services 421 5 5 INTERNETWORKING 424 5 5 1 How Networks Differ 425 5 5 2 How Networks Can Be Connected 426 5 5 3 Tunneling 429 CONTENTS xiii 5 5 4 Internetwork Routing 431 5 5 5 Packet Fragmentation 432 5 6 THE NETWORK LAYER IN THE INTERNET 436 5 6 1 The IP Version 4 Protocol 439 5 6 2 IP Addresses 442 5 6 3 IP Version 6 455 5 6 4 Internet Control Protocols 465 5 6 5 Label Switching MPLS 470 5 6 6 OSPF An Interior Gateway Routing Protocol 474 5 6 7 BGP The Exterior Gateway Routing Protocol 479 5 6 8 Internet Multicasting 484 5 6 9 Mobile IP 485 5 7 SUMMARY 488 THE TRANSPORT LAYER 6 1 THE TRANSPORT SERVICE 495 6 1 1 Services Provided Upper Layers 496 6 1 2 Transport Service Primitives 498 6 1 3 Berkeley Sockets 500 6 1 4 An Example Socket Programming An Internet File Server 503 6 2 ELEMENTS OF TRANSPORT PROTOCOLS 507 6 2 1 Addressing 509 6 2 2 Connection Establishment 512 6 2 3 Connection Release 517 6 2 4 Error Control Flow Control 522 6 2 5 Multiplexing 527 6 2 6 Crash Recovery 527 6 3 CONGESTION CONTROL 530 6 3 1 Desirable Bandwidth Allocation 531 6 3 2 Regulating Sending Rate 535 6 3 3 Wireless Issues 539 6 4 THE INTERNET TRANSPORT PROTOCOLS UDP 541 6 4 1 Introduction UDP 541 6 4 2 Remote Procedure Call 543 6 4 3 Real Time Transport Protocols 546 xiv CONTENTS 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP 552 6 5 1 Introduction TCP 552 6 5 2 The TCP Service Model 553 6 5 3 The TCP Protocol 556 6 5 4 The TCP Segment Header 557 6 5 5 TCP Connection Establishment 560 6 5 6 TCP Connection Release 562 6 5 7 TCP Connection Management Modeling 562 6 5 8 TCP Sliding Window 565 6 5 9 TCP Timer Management 568 6 5 10 TCP Congestion Control 571 6 5 11 The Future TCP 581 6 6 PERFORMANCE ISSUES 582 6 6 1 Performance Problems Computer Networks 583 6 6 2 Network Performance Measurement 584 6 6 3 Host Design Fast Networks 586 6 6 4 Fast Segment Processing 590 6 6 5 Header Compression 593 6 6 6 Protocols Long Fat Networks 595 6 7 DELAY TOLERANT NETWORKING 599 6 7 1 DTN Architecture 600 6 7 2 The Bundle Protocol 603 6 8 SUMMARY 605 THE APPLICATION LAYER 7 1 DNS THE DOMAIN NAME SYSTEM 611 7 1 1 The DNS Name Space 612 7 1 2 Domain Resource Records 616 7 1 3 Name Servers 619 7 2 ELECTRONIC MAIL 623 7 2 1 Architecture Services 624 7 2 2 The User Agent 626 7 2 3 Message Formats 630 7 2 4 Message Transfer 637 7 2 5 Final Delivery 643 CONTENTS xv 7 3 THE WORLD WIDE WEB 646 7 3 1 Architectural Overview 647 7 3 2 Static Web Pages 662 7 3 3 Dynamic Web Pages Web Applications 672 7 3 4 HTTP The HyperText Transfer Protocol 683 7 3 5 The Mobile Web 693 7 3 6 Web Search 695 7 4 STREAMING AUDIO AND VIDEO 697 7 4 1 Digital Audio 699 7 4 2 Digital Video 704 7 4 3 Streaming Stored Media 713 7 4 4 Streaming Live Media 721 7 4 5 Real Time Conferencing 724 7 5 CONTENT DELIVERY 734 7 5 1 Content Internet Traf c 736 7 5 2 Server Farms Web Proxies 738 7 5 3 Content Delivery Networks 743 7 5 4 Peer Peer Networks 748 7 6 SUMMARY 757 NETWORK SECURITY 8 1 CRYPTOGRAPHY 766 8 1 1 Introduction Cryptography 767 8 1 2 Substitution Ciphers 769 8 1 3 Transposition Ciphers 771 8 1 4 One Time Pads 772 8 1 5 Two Fundamental Cryptographic Principles 776 8 2 SYMMETRIC KEY ALGORITHMS 778 8 2 1 DES The Data Encryption Standard 780 8 2 2 AES The Advanced Encryption Standard 783 8 2 3 Cipher Modes 787 8 2 4 Other Ciphers 792 8 2 5 Cryptanalysis 792 xvi CONTENTS 8 3 PUBLIC KEY ALGORITHMS 793 8 3 1 RSA 794 8 3 2 Other Public Key Algorithms 796 8 4 DIGITAL SIGNATURES 797 8 4 1 Symmetric Key Signatures 798 8 4 2 Public Key Signatures 799 8 4 3 Message Digests 800 8 4 4 The Birthday Attack 804 8 5 MANAGEMENT OF PUBLIC KEYS 806 8 5 1 Certi cates 807 8 5 2 X 509 809 8 5 3 Public Key Infrastructures 810 8 6 COMMUNICATION SECURITY 813 8 6 1 IPsec 814 8 6 2 Firewalls 818 8 6 3 Virtual Private Networks 821 8 6 4 Wireless Security 822 8 7 AUTHENTICATION PROTOCOLS 827 8 7 1 Authentication Based Shared Secret Key 828 8 7 2 Establishing Shared Key The Dif e Hellman Key Exchange 833 8 7 3 Authentication Using Key Distribution Center 835 8 7 4 Authentication Using Kerberos 838 8 7 5 Authentication Using Public Key Cryptography 840 8 8 EMAIL SECURITY 841 8 8 1 PGP Pretty Good Privacy 842 8 8 2 S MIME 846 8 9 WEB SECURITY 846 8 9 1 Threats 847 8 9 2 Secure Naming 848 8 9 3 SSL The Secure Sockets Layer 853 8 9 4 Mobile Code Security 857 8 10 SOCIAL ISSUES 860 8 10 1 Privacy 860 8 10 2 Freedom Speech 863 8 10 3 Copyright 867 8 11 SUMMARY 869 CONTENTS READING LIST AND BIBLIOGRAPHY xvii 9 1 SUGGESTIONS FOR FURTHER READING 877 9 1 1 Introduction General Works 878 9 1 2 The Physical Layer 879 9 1 3 The Data Link Layer 880 9 1 4 The Medium Access Control Sublayer 880 9 1 5 The Network Layer 881 9 1 6 The Transport Layer 882 9 1 7 The Application Layer 882 9 1 8 Network Security 883 9 2 ALPHABETICAL BIBLIOGRAPHY 884 INDEX This page intentionally left blank PREFACE This book fth edition Each edition corresponded different phase way computer networks used When rst edition appeared 1980 networks academic curiosity When second edition appeared 1988 networks used universities large businesses When third edition appeared 1996 computer networks especially Internet become daily reality millions people By fourth edition 2003 wireless networks mobile computers become commonplace accessing Web Internet Now fth edition networks content distribution especially videos using CDNs peer peer networks mobile phones small computers Internet New Fifth Edition Among many changes book important one addition Prof David J Wetherall co author David brings rich background networking cut teeth designing metropolitan area networks 20 years ago He worked Internet wireless networks ever since professor University Washington teaching research computer networks related topics past decade Of course book also many changes keep ever changing world computer networks Among revised new material Wireless networks 802 12 802 16 The 3G networks used smart phones RFID sensor networks Content distribution using CDNs Peer peer networks Real time media stored streaming live sources Internet telephony voice IP Delay tolerant networks A detailed chapter chapter list follows xix xx PREFACE Chapter 1 introductory function fourth edition contents revised brought date The Internet mobile phone networks 802 11 RFID sensor networks discussed examples computer networks Material original Ethernet vampire taps removed along material ATM Chapter 2 covers physical layer expanded coverage digital modulation including OFDM widely used wireless networks 3G networks based CDMA New technologies discussed including Fiber Home power line networking Chapter 3 point point links improved two ways The material codes error detection correction updated also includes brief description modern codes important practice e g convolutional LDPC codes The examples protocols use Packet SONET ADSL Sadly material protocol veri cation removed little used In Chapter 4 MAC sublayer principles timeless technologies changed Sections example networks redone accordingly including gigabit Ethernet 802 11 802 16 Bluetooth RFID Also updated coverage LAN switching including VLANs Chapter 5 network layer covers ground fourth edition The revisions update material add depth particularly quality service relevant real time media internetworking The sections BGP OSPF CIDR expanded treatment multicast routing Anycast routing included Chapter 6 transport layer material added revised removed New material describes delay tolerant networking congestion control general The revised material updates expands coverage TCP congestion control The material removed described connection oriented network layers something rarely seen Chapter 7 applications also updated enlarged While material DNS email similar fourth edition past years many developments use Web streaming media content delivery Accordingly sections Web streaming media brought date A new section covers content distribution including CDNs peer peer networks Chapter 8 security still covers symmetric public key cryptography con dentiality authenticity Material techniques used practice including rewalls VPNs updated new material 802 11 security Kerberos V5 added Chapter 9 contains renewed list suggested readings comprehensive bibliography 300 citations current literature More half papers books written 2000 later rest citations classic papers PREFACE xxi List Acronyms Computer books full acronyms This one exception By time nished reading one following ring bell ADSL AES AJAX AODV AP ARP ARQ AS BGP BOC CDMA CDN CGI CIDR CRL CSMA CSS DCT DES DHCP DHT DIFS DMCA DMT DMZ DNS DOCSIS DOM DSLAM DTN FCFS FDD FDDI FDM FEC FIFO FSK FTP GPRS GSM HDTV HFC HMAC HTTP IAB ICANN ICMP IDEA IETF IMAP IMP IP IPTV IRTF ISO ISP ITU JPEG JSP JVM LAN LATA LEC LEO LLC LSR LTE MAN MFJ MIME MPEG MPLS MSC MTSO MTU NAP NAT NRZ NSAP OFDM OSI OSPF PAWS PCM PGP PIM PKI POP POTS PPP PSTN QAM QPSK RED RFC RFID RPC RSA RTSP SHA SIP SMTP SNR SOAP SONET SPE SSL TCP TDD TDM TSAP UDP UMTS URL VLAN VSAT WAN WDM XML But worry Each appear boldface type carefully de ned used As fun test see many identify reading book write number margin try reading book How Use Book To help instructors use book text courses ranging length quarters semesters structured chapters core optional material The sections marked table contents optional ones If major section e g 2 7 marked subsections optional They provide material network technologies useful omitted short course without loss continuity Of course students encouraged read sections well extent time material date value Instructors Resource Materials The following protected instructors resource materials available publisher Web site www pearsonhighered com tanenbaum For username password please contact local Pearson representative Solutions manual PowerPoint lecture slides Students Resource Materials Resources students available open access Companion Web site link www pearsonhighered com tanenbaum including Web resources links tutorials organizations FAQs Figures tables programs book Steganography demo Protocol simulators xxii PREFACE Acknowledgements Many people helped us course fth edition We would especially like thank Emmanuel Agu Worcester Polytechnic Institute Yoris Au University Texas Antonio Nikhil Bhargava Aircom International Inc Michael Buettner University Washington John Day Boston University Kevin Fall Intel Labs Ronald Fulle Rochester Institute Technology Ben Greenstein Intel Labs Daniel Halperin University Washington Bob Kinicki Worcester Polytechnic Institute Tadayoshi Kohno University Washington Sarvish Kulkarni Villanova University Hank Levy University Washington Ratul Mahajan Microsoft Research Craig Partridge BBN Michael Piatek University Washington Joshua Smith Intel Labs Neil Spring University Maryland David Teneyuca University Texas Antonio Tammy VanDegrift University Portland Bo Yuan Rochester Institute Technology providing ideas feedback Melody Kadenko Julie Svendsen provided administrative support David Shivakant Mishra University Colorado Boulder Paul Nagin Chimborazo Publishing Inc thought many new challenging end chapter problems Our editor Pearson Tracy Dunkelberger usual helpful self many ways large small Melinda Haggerty Jeff Holcomb good job keeping things running smoothly Steve Armstrong LeTourneau University prepared PowerPoint slides Stephen Turner University Michigan Flint artfully revised Web resources simulators accompany text Our copyeditor Rachel Head odd hybrid eye eagle memory elephant After reading corrections us wondered ever made past third grade Finally come important people Suzanne 19 times still endless patience love Barbara Marvin know difference good textbooks bad ones always inspiration produce good ones Daniel Matilde welcome additions family Aron unlikely read book soon likes nice pictures page 866 AST Katrin Lucy provided endless support always managed keep smile face Thank DJW ANDREW S TANENBAUM DAVID J WETHERALL 1 INTRODUCTION Each past three centuries dominated single new technology The 18th century era great mechanical systems accompanying Industrial Revolution The 19th century age steam engine During 20th century key technology information gathering processing distribution Among developments saw installation worldwide telephone networks invention radio television birth unprecedented growth computer industry launching communication satellites course Internet As result rapid technological progress areas rapidly converging 21st century differences collecting transporting storing processing information quickly disappearing Organizations hundreds offices spread wide geographical area routinely expect able examine current status even remote outpost push button As ability gather process distribute information grows demand ever sophisticated information processing grows even faster Although computer industry still young compared industries e g automobiles air transportation computers made spectacular progress short time During first two decades existence computer systems highly centralized usually within single large room Not infrequently room glass walls visitors could gawk great electronic wonder inside A medium sized company university might 2 INTRODUCTION one two computers large institutions dozen The idea within forty years vastly powerful computers smaller postage stamps would mass produced billions pure science fiction The merging computers communications profound influence way computer systems organized The dominant concept computer center room large computer users bring work processing totally obsolete although data centers holding thousands Internet servers becoming common The old model single computer serving organization computational needs replaced one large number separate interconnected computers job These systems called computer networks The design organization networks subjects book Throughout book use term computer network mean collection autonomous computers interconnected single technology Two computers said interconnected able exchange information The connection need via copper wire fiber optics microwaves infrared communication satellites also used Networks come many sizes shapes forms see later They usually connected together make larger networks Internet well known example network networks There considerable confusion literature computer network distributed system The key distinction distributed system collection independent computers appears users single coherent system Usually single model paradigm presents users Often layer software top operating system called middleware responsible implementing model A well known example distributed system World Wide Web It runs top Internet presents model everything looks like document Web page In computer network coherence model software absent Users exposed actual machines without attempt system make machines look act coherent way If machines different hardware different operating systems fully visible users If user wants run program remote machine log onto machine run In effect distributed system software system built top network The software gives high degree cohesiveness transparency Thus distinction network distributed system lies software especially operating system rather hardware Nevertheless considerable overlap two subjects For example distributed systems computer networks need move files around The difference lies invokes movement system user He read throughout book SEC 1 1 USES OF COMPUTER NETWORKS Although book primarily focuses networks many topics also important distributed systems For information distributed systems see Tanenbaum Van Steen 2007 1 1 USES OF COMPUTER NETWORKS Before start examine technical issues detail worth devoting time pointing people interested computer networks used After nobody interested computer networks would built We start traditional uses companies move home networking recent developments regarding mobile users finish social issues 1 1 1 Business Applications Most companies substantial number computers For example company may computer worker use design products write brochures payroll Initially computers may worked isolation others point management may decided connect able distribute information throughout company Put slightly general form issue resource sharing The goal make programs equipment especially data available anyone network without regard physical location resource user An obvious widespread example group office workers share common printer None individuals really needs private printer high volume networked printer often cheaper faster easier maintain large collection individual printers However probably even important sharing physical resources printers tape backup systems sharing information Companies small large vitally dependent computerized information Most companies customer records product information inventories financial statements tax information much online If computers suddenly went bank could last five minutes A modern manufacturing plant computer controlled assembly line would last even 5 seconds Even small travel agency three person law firm highly dependent computer networks allowing employees access relevant information documents instantly For smaller companies computers likely single office perhaps single building larger ones computers employees may scattered dozens offices plants many countries Nevertheless sales person New York might sometimes need access product inventory 4 INTRODUCTION database Singapore Networks called VPNs Virtual Private Networks may used join individual networks different sites one extended network In words mere fact user happens 15 000 km away data prevent using data though local This goal may summarized saying attempt end tyranny geography In simplest terms one imagine company information system consisting one databases company information number employees need access remotely In model data stored powerful computers called servers Often centrally housed maintained system administrator In contrast employees simpler machines called clients desks access remote data example include spreadsheets constructing Sometimes refer human user client machine client clear context whether mean computer user The client server machines connected network illustrated Note shown network simple oval without detail We use form mean network abstract sense When detail required provided Client Server Network A network two clients one server This whole arrangement called client server model It widely used forms basis much network usage The popular realization Web application server generates Web pages based database response client requests may update database The client server model applicable client server building belong company also far apart For example person home accesses page World Wide Web model employed remote Web server server user personal SEC 1 1 USES OF COMPUTER NETWORKS computer client Under conditions one server handle large number hundreds thousands clients simultaneously If look client server model detail see two processes e running programs involved one client machine one server machine Communication takes form client process sending message network server process The client process waits reply message When server process gets request performs requested work looks requested data sends back reply These messages shown Client machine Server machine Request Network Reply Client process Server process The client server model involves requests replies A second goal setting computer network people rather information even computers A computer network provide powerful communication medium among employees Virtually every company two computers email electronic mail employees generally use great deal daily communication In fact common gripe around water cooler much email everyone deal much quite meaningless bosses discovered send often content free message subordinates push button Telephone calls employees may carried computer network instead phone company This technology called IP telephony Voice IP VoIP Internet technology used The microphone speaker end may belong VoIP enabled phone employee computer Companies find wonderful way save telephone bills Other richer forms communication made possible computer networks Video added audio employees distant locations see hear hold meeting This technique powerful tool eliminating cost time previously devoted travel Desktop sharing lets remote workers see interact graphical computer screen This makes easy two people work far apart read write shared blackboard write report together When one worker makes change online document others see change immediately instead waiting several days letter Such speedup makes cooperation among far flung groups people easy previously impossible More ambitious forms remote coordination telemedicine starting used e g 6 INTRODUCTION remote patient monitoring may become much important It sometimes said communication transportation race whichever wins make obsolete A third goal many companies business electronically especially customers suppliers This new model called e commerce electronic commerce grown rapidly recent years Airlines bookstores retailers discovered many customers like convenience shopping home Consequently many companies provide catalogs goods services online take orders online Manufacturers automobiles aircraft computers among others buy subsystems variety suppliers assemble parts Using computer networks manufacturers place orders electronically needed This reduces need large inventories enhances efficiency 1 1 2 Home Applications In 1977 Ken Olsen president Digital Equipment Corporation number two computer vendor world IBM When asked Digital going personal computer market big way said There reason individual computer home History showed otherwise Digital longer exists People initially bought computers word processing games Recently biggest reason buy home computer probably Internet access Now many consumer electronic devices set top boxes game consoles clock radios come embedded computers computer networks especially wireless networks home networks broadly used entertainment including listening looking creating music photos videos Internet access provides home users connectivity remote computers As companies home users access information communicate people buy products services e commerce The main benefit comes connecting outside home Bob Metcalfe inventor Ethernet hypothesized value network proportional square number users roughly number different connections may made Gilder 1993 This hypothesis known Metcalfe law It helps explain tremendous popularity Internet comes size Access remote information comes many forms It surfing World Wide Web information fun Information available includes arts business cooking government health history hobbies recreation science sports travel many others Fun comes many ways mention plus ways better left unmentioned Many newspapers gone online personalized For example sometimes possible tell newspaper want everything corrupt SEC 1 1 USES OF COMPUTER NETWORKS politicians big fires scandals involving celebrities epidemics football thank Sometimes possible selected articles downloaded computer sleep As trend continues cause massive unemployment among 12 year old paperboys newspapers like distribution always weakest link whole production chain Of course make model work first figure make money new world something entirely obvious since Internet users expect everything free The next step beyond newspapers plus magazines scientific journals online digital library Many professional organizations ACM www acm org IEEE Computer Society www computer org already journals conference proceedings online Electronic book readers online libraries may make printed books obsolete Skeptics take note effect printing press medieval illuminated manuscript Much information accessed using client server model different popular model accessing information goes name peer peer communication Parameswaran et al 2001 In form individuals form loose group communicate others group shown Every person principle communicate one people fixed division clients servers In peer peer system fixed clients servers Many peer peer systems BitTorrent Cohen 2003 central database content Instead user maintains database locally provides list nearby people members system A new user go existing member see get names members inspect content names This lookup process repeated indefinitely build large local database It activity would get tedious people computers excel 8 INTRODUCTION Peer peer communication often used share music videos It really hit big time around 2000 music sharing service called Napster shut probably biggest copyright infringement case recorded history Lam Tan 2001 Macedonia 2000 Legal applications peer peer communication also exist These include fans sharing public domain music families sharing photos movies users downloading public software packages In fact one popular Internet applications email inherently peer peer This form communication likely grow considerably future All applications involve interactions person remote database full information The second broad category network use person person communication basically 21st century answer 19th century telephone E mail already used daily basis millions people world use growing rapidly It already routinely contains audio video well text pictures Smell may take Any teenager worth salt addicted instant messaging This facility derived UNIX talk program use since around 1970 allows two people type messages real time There multi person messaging services Twitter service lets people send short text messages called tweets circle friends willing audiences The Internet used applications carry audio e g Internet radio stations video e g YouTube Besides cheap way call distant friends applications provide rich experiences telelearning meaning attending 8 A M classes without inconvenience get bed first In long run use networks enhance human human communication may prove important others It may become hugely important people geographically challenged giving access services people living middle big city Between person person communications accessing information social network applications Here flow information driven relationships people declare One popular social networking sites Facebook It lets people update personal profiles shares updates people declared friends Other social networking applications make introductions via friends friends send news messages friends Twitter much Even loosely groups people work together create content A wiki example collaborative Web site members community edit The famous wiki Wikipedia encyclopedia anyone edit thousands wikis Our third category electronic commerce broadest sense term Home shopping already popular enables users inspect online catalogs thousands companies Some catalogs interactive showing products different viewpoints configurations personalized SEC 1 1 USES OF COMPUTER NETWORKS After customer buys product electronically figure use online technical support may consulted Another area e commerce widely used access financial institutions Many people already pay bills manage bank accounts handle investments electronically This trend surely continue networks become secure One area virtually nobody foresaw electronic flea markets e flea Online auctions second hand goods become massive industry Unlike traditional e commerce follows client server model online auctions peer peer sense consumers act buyers sellers Some forms e commerce acquired cute little tags based fact 2 pronounced The popular ones listed Tag Full name Example B2C Business consumer Ordering books online B2B Business business Car manufacturer ordering tires supplier G2C Government consumer Government distributing tax forms electronically C2C Consumer consumer Auctioning second hand products online P2P Peer peer Music sharing Some forms e commerce Our fourth category entertainment This made huge strides home recent years distribution music radio television programs movies Internet beginning rival traditional mechanisms Users find buy download MP3 songs DVD quality movies add personal collection TV shows reach many homes via IPTV IP TeleVision systems based IP technology instead cable TV radio transmissions Media streaming applications let users tune Internet radio stations watch recent episodes favorite TV shows Naturally content moved around house different devices displays speakers usually wireless network Soon may possible search movie television program ever made country displayed screen instantly New films may become interactive user occasionally prompted story direction Macbeth murder Duncan bide time alternative scenarios provided cases Live television may also become interactive audience participating quiz shows choosing among contestants Another form entertainment game playing Already multiperson real time simulation games like hide seek virtual dungeon flight 10 INTRODUCTION simulators players one team trying shoot players opposing team Virtual worlds provide persistent setting thousands users experience shared reality three dimensional graphics Our last category ubiquitous computing computing embedded everyday life vision Mark Weiser 1991 Many homes already wired security systems include door window sensors many sensors folded smart home monitor energy consumption Your electricity gas water meters could also report usage network This would save money would need send meter readers And smoke detectors could call fire department instead making big noise little value one home As cost sensing communication drops measurement reporting done networks Increasingly consumer electronic devices networked For example high end cameras already wireless network capability use send photos nearby display viewing Professional sports photographers also send photos editors real time first wirelessly access point Internet Devices televisions plug wall use power line networks send information throughout house wires carry electricity It may surprising objects network objects think computers may sense communicate information For example shower may record water usage give visual feedback lather report home environmental monitoring application done help save water bill A technology called RFID Radio Frequency IDentification push idea even future RFID tags passive e battery chips size stamps already affixed books passports pets credit cards items home This lets RFID readers locate communicate items distance several meters depending kind RFID Originally RFID commercialized replace barcodes It succeeded yet barcodes free RFID tags cost cents Of course RFID tags offer much price rapidly declining They may turn real world Internet things ITU 2005 1 1 3 Mobile Users Mobile computers laptop handheld computers one fastest growing segments computer industry Their sales already overtaken desktop computers Why would anyone want one People go often want use mobile devices read send email tweet watch movies download music play games simply surf Web information They want things home office Naturally want anywhere land sea air SEC 1 1 USES OF COMPUTER NETWORKS Connectivity Internet enables many mobile uses Since wired connection impossible cars boats airplanes lot interest wireless networks Cellular networks operated telephone companies one familiar kind wireless network blankets us coverage mobile phones Wireless hotspots based 802 11 standard another kind wireless network mobile computers They sprung everywhere people go resulting patchwork coverage cafes hotels airports schools trains planes Anyone laptop computer wireless modem turn computer connected Internet hotspot though computer plugged wired network Wireless networks great value fleets trucks taxis delivery vehicles repairpersons keeping contact home base For example many cities taxi drivers independent businessmen rather employees taxi company In cities taxis display driver see When customer calls central dispatcher types pickup destination points This information displayed drivers displays beep sounds The first driver hit button display gets call Wireless networks also important military If able fight war anywhere Earth short notice counting using local networking infrastructure probably good idea It better bring Although wireless networking mobile computing often related identical shows Here see distinction fixed wireless mobile wireless networks Even notebook computers sometimes wired For example traveler plugs notebook computer wired network jack hotel room mobility without wireless network Wireless Mobile No No Desktop computers offices Typical applications No Yes A notebook computer used hotel room Yes No Networks unwired buildings Yes Yes Store inventory handheld computer Combinations wireless networks mobile computing Conversely wireless computers mobile In home offices hotels lack suitable cabling convenient connect desktop computers media players wirelessly install wires Installing wireless network may require little buying small box electronics unpacking plugging This solution may far cheaper workmen put cable ducts wire building Finally also true mobile wireless applications people walking around stores handheld computers recording inventory At many busy 12 INTRODUCTION airports car rental return clerks work parking lot wireless mobile computers They scan barcodes RFID chips returning cars mobile device built printer calls main computer gets rental information prints bill spot Perhaps key driver mobile wireless applications mobile phone Text messaging texting tremendously popular It lets mobile phone user type short message delivered cellular network another mobile subscriber Few people would predicted ten years ago teenagers tediously typing short text messages mobile phones would immense money maker telephone companies But texting Short Message Service known outside U S profitable since costs carrier tiny fraction one cent relay text message service charge far The long awaited convergence telephones Internet finally arrived accelerate growth mobile applications Smart phones popular iPhone combine aspects mobile phones mobile computers The 3G 4G cellular networks connect provide fast data services using Internet well handling phone calls Many advanced phones connect wireless hotspots automatically switch networks choose best option user Other consumer electronics devices also use cellular hotspot networks stay connected remote computers Electronic book readers download newly purchased book next edition magazine today newspaper wherever roam Electronic picture frames update displays cue fresh images Since mobile phones know locations often equipped GPS Global Positioning System receivers services intentionally location dependent Mobile maps directions obvious candidate GPS enabled phone car probably better idea So searches nearby bookstore Chinese restaurant local weather forecast Other services may record location annotating photos videos place made This annotation known geo tagging An area mobile phones starting used commerce mobile commerce Senn 2000 Short text messages mobile used authorize payments food vending machines movie tickets small items instead cash credit cards The charge appears mobile phone bill When equipped NFC Near Field Communication technology mobile act RFID smartcard interact nearby reader payment The driving forces behind phenomenon mobile device makers network operators trying hard figure get piece e commerce pie From store point view scheme may save credit card company fee several percent SEC 1 1 USES OF COMPUTER NETWORKS Of course plan may backfire since customers store might use RFID barcode readers mobile devices check competitors prices buying use get detailed report else item purchased nearby price One huge thing commerce going mobile phone users accustomed paying everything contrast Internet users expect everything free If Internet Web site charged fee allow customers pay credit card would immense howling noise users If however mobile phone operator customers pay items store waving phone cash register tacked fee convenience would probably accepted normal Time tell No doubt uses mobile wireless computers grow rapidly future size computers shrinks probably ways one foresee Let us take quick look possibilities Sensor networks made nodes gather wirelessly relay information sense state physical world The nodes may part familiar items cars phones may small separate devices For example car might gather data location speed vibration fuel efficiency board diagnostic system upload information database Hull et al 2006 Those data help find potholes plan trips around congested roads tell gas guzzler compared drivers stretch road Sensor networks revolutionizing science providing wealth data behavior could previously observed One example tracking migration individual zebras placing small sensor animal Juang et al 2002 Researchers packed wireless computer cube 1 mm edge Warneke et al 2001 With mobile computers small even small birds rodents insects tracked Even mundane uses parking meters significant make use data previously available Wireless parking meters accept credit debit card payments instant verification wireless link They also report use wireless network This would let drivers download recent parking map car find available spot easily Of course meter expires might also check presence car bouncing signal report expiration parking enforcement It estimated city governments U S alone could collect additional 10 billion way Harte et al 2000 Wearable computers another promising application Smart watches radios part mental space since appearance Dick Tracy comic strip 1946 buy Other devices may implanted pacemakers insulin pumps Some controlled wireless network This lets doctors test reconfigure easily It could also lead nasty problems devices insecure average PC hacked easily Halperin et al 2008 14 INTRODUCTION 1 1 4 Social Issues Computer networks like printing press 500 years ago allow ordinary citizens distribute view content ways previously possible But along good comes bad new found freedom brings many unsolved social political ethical issues Let us briefly mention thorough study would require full book least Social networks message boards content sharing sites host applications allow people share views like minded individuals As long subjects restricted technical topics hobbies like gardening many problems arise The trouble comes topics people actually care like politics religion sex Views publicly posted may deeply offensive people Worse yet may politically correct Furthermore opinions need limited text high resolution color photographs video clips easily shared computer networks Some people take live let live view others feel posting certain material e g verbal attacks particular countries religions pornography etc simply unacceptable content must censored Different countries different conflicting laws area Thus debate rages In past people sued network operators claiming responsible contents carry newspapers magazines The inevitable response network like telephone company post office expected police users say It come slight surprise learn network operators block content reasons Some users peer peer applications network service cut network operators find profitable carry large amounts traffic sent applications Those operators would probably like treat different companies differently If big company pay well get good service small time player get poor service Opponents practice argue peer peer content treated way bits network This argument communications differentiated content source providing content known network neutrality Wu 2003 It probably safe say debate go Many parties involved tussle content For instance pirated music movies fueled massive growth peer peer networks please copyright holders threatened sometimes taken legal action There automated systems search peer peer networks fire warnings network operators users suspected infringing copyright In United States warnings known DMCA takedown notices Digital Millennium Copyright Act This SEC 1 1 USES OF COMPUTER NETWORKS search arms race hard reliably catch copyright infringement Even printer might mistaken culprit Piatek et al 2008 Computer networks make easy communicate They also make easy people run network snoop traffic This sets conflicts issues employee rights versus employer rights Many people read write email work Many employers claimed right read possibly censor employee messages including messages sent home computer outside working hours Not employees agree especially latter part Another conflict centered around government versus citizen rights The FBI installed systems many Internet service providers snoop incoming outgoing email nuggets interest One early system originally called Carnivore bad publicity caused renamed innocent sounding DCS1000 Blaze Bellovin 2000 Sobel 2001 Zacks 2001 The goal systems spy millions people hope perhaps finding information illegal activities Unfortunately spies Fourth Amendment U S Constitution prohibits government searches without search warrant government often ignores Of course government monopoly threatening people privacy The private sector bit profiling users For example small files called cookies Web browsers store users computers allow companies track users activities cyberspace may also allow credit card numbers social security numbers confidential information leak Internet Berghel 2001 Companies provide Web based services may maintain large amounts personal information users allows study user activities directly For example Google read email show advertisements based interests use email service Gmail A new twist mobile devices location privacy Beresford Stajano 2003 As part process providing service mobile device network operators learn different times day This allows track movements They may know nightclub frequent medical center visit Computer networks also offer potential increase privacy sending anonymous messages In situations capability may desirable Beyond preventing companies learning habits provides example way students soldiers employees citizens blow whistle illegal behavior part professors officers superiors politicians without fear reprisals On hand United States democracies law specifically permits accused person right confront challenge accuser court anonymous accusations used evidence The Internet makes possible find information quickly great deal ill considered misleading downright wrong That medical advice 16 INTRODUCTION plucked Internet pain chest may come Nobel Prize winner high school dropout Other information frequently unwanted Electronic junk mail spam become part life spammers collected millions email addresses would marketers cheaply send computer generated messages The resulting flood spam rivals flow messages real people Fortunately filtering software able read discard spam generated computers lesser greater degrees success Still content intended criminal behavior Web pages email messages containing active content basically programs macros execute receiver machine contain viruses take computer They might used steal bank account passwords computer send spam part botnet pool compromised machines Phishing messages masquerade originating trustworthy party example bank try trick revealing sensitive information example credit card numbers Identity theft becoming serious problem thieves collect enough information victim obtain credit cards documents victim name It difficult prevent computers impersonating people Internet This problem led development CAPTCHAs computer asks person solve short recognition task example typing letters shown distorted image show human von Ahn 2001 This process variation famous Turing test person asks questions network judge whether entity responding human A lot problems could solved computer industry took computer security seriously If messages encrypted authenticated would harder commit mischief Such technology well established study detail Chap 8 The problem hardware software vendors know putting security features costs money customers demanding features In addition substantial number problems caused buggy software occurs vendors keep adding features programs inevitably means code thus bugs A tax new features might help might tough sell quarters A refund defective software might nice except would bankrupt entire software industry first year Computer networks raise new legal problems interact old laws Electronic gambling provides example Computers simulating things decades simulate slot machines roulette wheels blackjack dealers gambling equipment Well illegal lot places The trouble gambling legal lot places England example casino owners grasped potential Internet gambling What happens gambler casino server different countries conflicting laws Good question SEC 1 2 NETWORK HARDWARE 1 2 NETWORK HARDWARE It time turn attention applications social aspects networking dessert technical issues involved network design spinach There generally accepted taxonomy computer networks fit two dimensions stand important transmission technology scale We examine turn Broadly speaking two types transmission technology widespread use broadcast links point point links Point point links connect individual pairs machines To go source destination network made point point links short messages called packets certain contexts may first visit one intermediate machines Often multiple routes different lengths possible finding good ones important point point networks Point point transmission exactly one sender exactly one receiver sometimes called unicasting In contrast broadcast network communication channel shared machines network packets sent machine received others An address field within packet specifies intended recipient Upon receiving packet machine checks address field If packet intended receiving machine machine processes packet packet intended machine ignored A wireless network common example broadcast link communication shared coverage region depends wireless channel transmitting machine As analogy consider someone standing meeting room shouting Watson come I want Although packet may actually received heard many people Watson respond others ignore Broadcast systems usually also allow possibility addressing packet destinations using special code address field When packet code transmitted received processed every machine network This mode operation called broadcasting Some broadcast systems also support transmission subset machines known multicasting An alternative criterion classifying networks scale Distance important classification metric different technologies used different scales In classify multiple processor systems rough physical size At top personal area networks networks meant one person Beyond come longer range networks These divided local metropolitan wide area networks increasing scale Finally connection two networks called internetwork The worldwide Internet certainly best known example internetwork 18 INTRODUCTION Soon even larger internetworks Interplanetary Internet connects networks across space Burleigh et al 2003 Interprocessor distance Processors located 1m Square meter 10 Room 100 Building 1 km Campus 10 km City 100 km Country 1000 km Continent 10 000 km Example Personal area network Local area network Metropolitan area network Wide area network Planet The Internet Classification interconnected processors scale In book concerned networks scales In following sections give brief introduction network hardware scale 1 2 1 Personal Area Networks PANs Personal Area Networks let devices communicate range person A common example wireless network connects computer peripherals Almost every computer attached monitor keyboard mouse printer Without using wireless connection must done cables So many new users hard time finding right cables plugging right little holes even though usually color coded computer vendors offer option sending technician user home To help users companies got together design short range wireless network called Bluetooth connect components without wires The idea devices Bluetooth need cables You put turn work together For many people ease operation big plus In simplest form Bluetooth networks use master slave paradigm The system unit PC normally master talking mouse keyboard etc slaves The master tells slaves addresses use broadcast long transmit frequencies use Bluetooth used settings It often used connect headset mobile phone without cords allow digital music player SEC 1 2 NETWORK HARDWARE Bluetooth PAN configuration connect car merely brought within range A completely different kind PAN formed embedded medical device pacemaker insulin pump hearing aid talks user operated remote control We discuss Bluetooth detail Chap 4 PANs also built technologies communicate short ranges RFID smartcards library books We study RFID Chap 4 1 2 2 Local Area Networks The next step LAN Local Area Network A LAN privately owned network operates within nearby single building like home office factory LANs widely used connect personal computers consumer electronics let share resources e g printers exchange information When LANs used companies called enterprise networks Wireless LANs popular days especially homes older office buildings cafeterias places much trouble install cables In systems every computer radio modem antenna uses communicate computers In cases computer talks device ceiling shown This device called AP Access Point wireless router base station relays packets wireless computers also Internet Being AP like popular kid school everyone wants talk However computers close enough communicate directly one another peer peer configuration There standard wireless LANs called IEEE 802 11 popularly known WiFi become widespread It runs speeds anywhere 11 20 INTRODUCTION Access point To wired network Ports Ethernet switch To rest network Wireless wired LANs 802 11 b Switched Ethernet hundreds Mbps In book adhere tradition measure line speeds megabits sec 1 Mbps 1 000 000 bits sec gigabits sec 1 Gbps 1 000 000 000 bits sec We discuss 802 11 Chap 4 Wired LANs use range different transmission technologies Most use copper wires use optical fiber LANs restricted size means worst case transmission time bounded known advance Knowing bounds helps task designing network protocols Typically wired LANs run speeds 100 Mbps 1 Gbps low delay microseconds nanoseconds make errors Newer LANs operate 10 Gbps Compared wireless networks wired LANs exceed dimensions performance It easier send signals wire fiber air The topology many wired LANs built point point links IEEE 802 3 popularly called Ethernet far common type wired LAN b shows sample topology switched Ethernet Each computer speaks Ethernet protocol connects box called switch point point link Hence name A switch multiple ports connect one computer The job switch relay packets computers attached using address packet determine computer send To build larger LANs switches plugged using ports What happens plug together loop Will network still work Luckily designers thought case It job protocol sort paths packets travel safely reach intended computer We see works Chap 4 It also possible divide one large physical LAN two smaller logical LANs You might wonder would useful Sometimes layout network equipment match organization structure For example SEC 1 2 NETWORK HARDWARE engineering finance departments company might computers physical LAN wing building might easier manage system engineering finance logically network Virtual LAN VLAN In design port tagged color say green engineering red finance The switch forwards packets computers attached green ports separated computers attached red ports Broadcast packets sent red port example received green port though two different LANs We cover VLANs end Chap 4 There wired LAN topologies In fact switched Ethernet modern version original Ethernet design broadcast packets single linear cable At one machine could successfully transmit time distributed arbitration mechanism used resolve conflicts It used simple algorithm computers could transmit whenever cable idle If two packets collided computer waited random time tried later We call version classic Ethernet clarity suspected learn Chap 4 Both wireless wired broadcast networks divided static dynamic designs depending channel allocated A typical static allocation would divide time discrete intervals use round robin algorithm allowing machine broadcast time slot comes Static allocation wastes channel capacity machine nothing say allocated slot systems attempt allocate channel dynamically e demand Dynamic allocation methods common channel either centralized decentralized In centralized channel allocation method single entity example base station cellular networks determines goes next It might accepting multiple packets prioritizing according internal algorithm In decentralized channel allocation method central entity machine must decide whether transmit You might think approach would lead chaos Later study many algorithms designed bring order potential chaos It worth spending little time discussing LANs home In future likely every appliance home capable communicating every appliance accessible Internet This development likely one visionary concepts nobody asked like TV remote controls mobile phones arrived nobody imagine lived without Many devices already capable networked These include computers entertainment devices TVs DVDs phones consumer electronics cameras appliances like clock radios infrastructure like utility meters thermostats This trend continue For instance average home probably dozen clocks e g appliances could 22 INTRODUCTION adjust daylight savings time automatically clocks Internet Remote monitoring home likely winner many grown children would willing spend money help aging parents live safely homes While could think home network another LAN likely different properties networks First networked devices easy install Wireless routers returned consumer electronic item People buy one want wireless network home find work box return rather listen elevator music hold technical helpline Second network devices foolproof operation Air conditioners used one knob four settings OFF LOW MEDIUM HIGH Now 30 page manuals Once networked expect chapter security alone 30 pages This problem computer users accustomed putting products work car television refrigerator buying public far less tolerant They expect products work 100 without need hire geek Third low price essential success People pay 50 premium Internet thermostat people regard monitoring home temperature work important For 5 extra though might sell Fourth must possible start one two devices expand reach network gradually This means format wars Telling consumers buy peripherals IEEE 1394 FireWire interfaces years later retracting saying USB 2 0 interface month switching 802 11g oops make 802 11n I mean 802 16 different wireless networks going make consumers skittish The network interface remain stable decades like television broadcasting standards Fifth security reliability important Losing files email virus one thing burglar disarm security system mobile computer plunder house something quite different An interesting question whether home networks wired wireless Convenience cost favors wireless networking wires fit worse retrofit Security favors wired networking radio waves wireless networks use quite good going walls Not everyone overjoyed thought neighbors piggybacking Internet connection reading email In Chap 8 study encryption used provide security easier said done inexperienced users A third option may appealing reuse networks already home The obvious candidate electric wires installed throughout house Power line networks let devices plug outlets broadcast information throughout house You plug TV anyway way get Internet connectivity time The difficulty SEC 1 2 NETWORK HARDWARE carry power data signals time Part answer use different frequency bands In short home LANs offer many opportunities challenges Most latter relate need networks easy manage dependable secure especially hands nontechnical users well low cost 1 2 3 Metropolitan Area Networks A MAN Metropolitan Area Network covers city The best known examples MANs cable television networks available many cities These systems grew earlier community antenna systems used areas poor air television reception In early systems large antenna placed top nearby hill signal piped subscribers houses At first locally designed ad hoc systems Then companies began jumping business getting contracts local governments wire entire cities The next step television programming even entire channels designed cable Often channels highly specialized news sports cooking gardening But inception late 1990s intended television reception When Internet began attracting mass audience cable TV network operators began realize changes system could provide two way Internet service unused parts spectrum At point cable TV system began morph simply way distribute television metropolitan area network To first approximation MAN might look something like system shown In figure see television signals Internet fed centralized cable headend subsequent distribution people homes We come back subject detail Chap 2 Cable television MAN though Recent developments highspeed wireless Internet access resulted another MAN standardized IEEE 802 16 popularly known WiMAX We look Chap 4 1 2 4 Wide Area Networks A WAN Wide Area Network spans large geographical area often country continent We begin discussion wired WANs using example company branch offices different cities The WAN network connects offices Perth Melbourne Brisbane Each offices contains computers intended running user e application programs We follow traditional usage call machines hosts The rest network connects hosts called 24 INTRODUCTION Junction box Antenna Head end Internet A metropolitan area network based cable TV communication subnet subnet short The job subnet carry messages host host telephone system carries words really sounds speaker listener In WANs subnet consists two distinct components transmission lines switching elements Transmission lines move bits machines They made copper wire optical fiber even radio links Most companies transmission lines lying instead lease lines telecommunications company Switching elements switches specialized computers connect two transmission lines When data arrive incoming line switching element must choose outgoing line forward These switching computers called various names past name router commonly used Unfortunately people pronounce rooter others rhyme doubter Determining correct pronunciation left exercise reader Note perceived correct answer may depend live A short comment term subnet order Originally meaning collection routers communication lines moved packets source host destination host Readers aware acquired second recent meaning conjunction network addressing We discuss meaning Chap 5 stick original meaning collection lines routers The WAN described looks similar large wired LAN important differences go beyond long wires Usually WAN hosts subnet owned operated different people In SEC 1 2 NETWORK HARDWARE Subnet Transmission line Brisbane Router Perth Melbourne WAN connects three branch offices Australia example employees might responsible computers company IT department charge rest network We see clearer boundaries coming examples network provider telephone company operates subnet Separation pure communication aspects network subnet application aspects hosts greatly simplifies overall network design A second difference routers usually connect different kinds networking technology The networks inside offices may switched Ethernet example long distance transmission lines may SONET links cover Chap 2 Some device needs join The astute reader notice goes beyond definition network This means many WANs fact internetworks composite networks made one network We say internetworks next section A final difference connected subnet This could individual computers case connecting LANs could entire LANs This larger networks built smaller ones As far subnet concerned job We position look two varieties WANs First rather lease dedicated transmission lines company might connect offices Internet This allows connections made offices virtual links 26 INTRODUCTION use underlying capacity Internet This arrangement shown called VPN Virtual Private Network Compared dedicated arrangement VPN usual advantage virtualization provides flexible reuse resource Internet connectivity Consider easy add fourth office see A VPN also usual disadvantage virtualization lack control underlying resources With dedicated line capacity clear With VPN mileage may vary Internet service Internet Link via internet Brisbane Perth Melbourne WAN using virtual private network The second variation subnet may run different company The subnet operator known network service provider offices customers This structure shown The subnet operator connect customers long pay provide service Since would disappointing network service customers could send packets subnet operator also connect networks part Internet Such subnet operator called ISP Internet Service Provider subnet ISP network Its customers connect ISP receive Internet service We use ISP network preview key issues study later chapters In WANs network contains many transmission lines connecting pair routers If two routers share transmission line wish communicate must indirectly via routers There SEC 1 2 NETWORK HARDWARE ISP network Transmission line Brisbane Customer network Perth Melbourne WAN using ISP network may many paths network connect two routers How network makes decision path use called routing algorithm Many algorithms exist How router makes decision send packet next called forwarding algorithm Many exist We study types detail Chap 5 Other kinds WANs make heavy use wireless technologies In satellite systems computer ground antenna send data receive data satellite orbit All computers hear output satellite cases also hear upward transmissions fellow computers satellite well Satellite networks inherently broadcast useful broadcast property important The cellular telephone network another example WAN uses wireless technology This system already gone three generations fourth one horizon The first generation analog voice The second generation digital voice The third generation digital voice data Each cellular base station covers distance much larger wireless LAN range measured kilometers rather tens meters The base stations connected backbone network usually wired The data rates cellular networks often order 1 Mbps much smaller wireless LAN range order 100 Mbps We lot say networks Chap 2 28 INTRODUCTION 1 2 5 Internetworks Many networks exist world often different hardware software People connected one network often want communicate people attached different one The fulfillment desire requires different frequently incompatible networks connected A collection interconnected networks called internetwork internet These terms used generic sense contrast worldwide Internet one specific internet always capitalize The Internet uses ISP networks connect enterprise networks home networks many networks We look Internet great detail later book Subnets networks internetworks often confused The term subnet makes sense context wide area network refers collection routers communication lines owned network operator As analogy telephone system consists telephone switching offices connected one another high speed lines houses businesses low speed lines These lines equipment owned managed telephone company form subnet telephone system The telephones hosts analogy part subnet A network formed combination subnet hosts However word network often used loose sense well A subnet might described network case ISP network An internetwork might also described network case WAN We follow similar practice distinguishing network arrangements stick original definition collection computers interconnected single technology Let us say constitutes internetwork We know internet formed distinct networks interconnected In view connecting LAN WAN connecting two LANs usual way form internetwork little agreement industry terminology area There two rules thumb useful First different organizations paid construct different parts network maintains part internetwork rather single network Second underlying technology different different parts e g broadcast versus point point wired versus wireless probably internetwork To go deeper need talk two different networks connected The general name machine makes connection two networks provides necessary translation terms hardware software gateway Gateways distinguished layer operate protocol hierarchy We much say layers protocol hierarchies starting next section imagine higher layers tied applications Web lower layers tied transmission links Ethernet SEC 1 2 NETWORK HARDWARE Since benefit forming internet connect computers across networks want use low level gateway unable make connections different kinds networks We want use high level gateway either connection work particular applications The level middle right often called network layer router gateway switches packets network layer We spot internet finding network routers 1 3 NETWORK SOFTWARE The first computer networks designed hardware main concern software afterthought This strategy longer works Network software highly structured In following sections examine software structuring technique detail The approach described forms keystone entire book occur repeatedly later 1 3 1 Protocol Hierarchies To reduce design complexity networks organized stack layers levels one built upon one The number layers name layer contents layer function layer differ network network The purpose layer offer certain services higher layers shielding layers details offered services actually implemented In sense layer kind virtual machine offering certain services layer This concept actually familiar one used throughout computer science variously known information hiding abstract data types data encapsulation object oriented programming The fundamental idea particular piece software hardware provides service users keeps details internal state algorithms hidden When layer n one machine carries conversation layer n another machine rules conventions used conversation collectively known layer n protocol Basically protocol agreement communicating parties communication proceed As analogy woman introduced man may choose stick hand He turn may decide either shake kiss depending example whether American lawyer business meeting European princess formal ball Violating protocol make communication difficult completely impossible A five layer network illustrated The entities comprising corresponding layers different machines called peers The peers may 30 INTRODUCTION software processes hardware devices even human beings In words peers communicate using protocol talk Host 1 Host 2 Layer 5 protocol Layer 5 Layer 5 Layer 4 5 interface Layer 4 Layer 4 protocol Layer 4 Layer 3 4 interface Layer 3 Layer 3 protocol Layer 3 Layer 2 3 interface Layer 2 Layer 2 protocol Layer 2 Layer 1 2 interface Layer 1 Layer 1 protocol Layer 1 Physical medium Layers protocols interfaces In reality data directly transferred layer n one machine layer n another machine Instead layer passes data control information layer immediately lowest layer reached Below layer 1 physical medium actual communication occurs In virtual communication shown dotted lines physical communication solid lines Between pair adjacent layers interface The interface defines primitive operations services lower layer makes available upper one When network designers decide many layers include network one one important considerations defining clean interfaces layers Doing turn requires layer perform specific collection well understood functions In addition minimizing amount information must passed layers clearcut interfaces also make simpler replace one layer completely different protocol implementation e g replacing telephone lines satellite channels required new protocol implementation offer exactly set services upstairs neighbor old one It common different hosts use different implementations protocol often written different companies In fact protocol change layer without layers even noticing SEC 1 3 NETWORK SOFTWARE A set layers protocols called network architecture The specification architecture must contain enough information allow implementer write program build hardware layer correctly obey appropriate protocol Neither details implementation specification interfaces part architecture hidden away inside machines visible outside It even necessary interfaces machines network provided machine correctly use protocols A list protocols used certain system one protocol per layer called protocol stack Network architectures protocol stacks protocols principal subjects book An analogy may help explain idea multilayer communication Imagine two philosophers peer processes layer 3 one speaks Urdu English one speaks Chinese French Since common language engage translator peer processes layer 2 turn contacts secretary peer processes layer 1 Philosopher 1 wishes convey affection oryctolagus cuniculus peer To passes message English across 2 3 interface translator saying I like rabbits illustrated The translators agreed neutral language known Dutch message converted Ik vind konijnen leuk The choice language layer 2 protocol layer 2 peer processes The translator gives message secretary transmission example email layer 1 protocol When message arrives secretary passed local translator translates French passes across 2 3 interface second philosopher Note protocol completely independent ones long interfaces changed The translators switch Dutch say Finnish provided agree neither changes interface either layer 1 layer 3 Similarly secretaries switch email telephone without disturbing even informing layers Each process may add information intended peer This information passed layer Now consider technical example provide communication top layer five layer network A message M produced application process running layer 5 given layer 4 transmission Layer 4 puts header front message identify message passes result layer 3 The header includes control information addresses allow layer 4 destination machine deliver message Other examples control information used layers sequence numbers case lower layer preserve message order sizes times In many networks limit placed size messages transmitted layer 4 protocol nearly always limit imposed layer 3 protocol Consequently layer 3 must break incoming messages smaller 32 INTRODUCTION Location A I like rabbits Location B Message Philosopher J aime bien les lapins L Dutch Ik vind konijnen leuk Fax L Dutch Ik vind konijnen leuk Information remote translator Information remote secretary Translator Secretary L Dutch Ik vind konijnen leuk Fax L Dutch Ik vind konijnen leuk The philosopher translator secretary architecture units packets prepending layer 3 header packet In example M split two parts M 1 M 2 transmitted separately Layer 3 decides outgoing lines use passes packets layer 2 Layer 2 adds piece header also trailer gives resulting unit layer 1 physical transmission At receiving machine message moves upward layer layer headers stripped progresses None headers layers n passed layer n The important thing understand relation virtual actual communication difference protocols interfaces The peer processes layer 4 example conceptually think communication horizontal using layer 4 protocol Each one likely procedures called something like SendToOtherSide GetFromOtherSide even though procedures actually communicate lower layers across 3 4 interface side SEC 1 3 NETWORK SOFTWARE Layer Layer 5 protocol M H4 Layer 4 protocol M M H4 M Layer 3 protocol H3 H4 M1 H3 M2 H3 H4 M1 H3 M 2 H2 H3 H4 M1 T2 H2 H3 M2 T2 Layer 2 protocol 2 H2 H3 H4 M 1 T 2 H2 H3 M2 T2 Source machine Destination machine Example information flow supporting virtual communication layer 5 The peer process abstraction crucial network design Using unmanageable task designing complete network broken several smaller manageable design problems namely design individual layers Although Sec 1 3 called Network Software worth pointing lower layers protocol hierarchy frequently implemented hardware firmware Nevertheless complex protocol algorithms involved even embedded whole part hardware 1 3 2 Design Issues Layers Some key design issues occur computer networks come layer layer Below briefly mention important ones Reliability design issue making network operates correctly even though made collection components unreliable Think bits packet traveling network There chance bits received damaged inverted due fluke electrical noise random wireless signals hardware flaws software bugs How possible find fix errors One mechanism finding errors received information uses codes error detection Information incorrectly received retransmitted 34 INTRODUCTION received correctly More powerful codes allow error correction correct message recovered possibly incorrect bits originally received Both mechanisms work adding redundant information They used low layers protect packets sent individual links high layers check right contents received Another reliability issue finding working path network Often multiple paths source destination large network may links routers broken Suppose network Germany Packets sent London Rome via Germany get could instead send packets London Rome via Paris The network automatically make decision This topic called routing A second design issue concerns evolution network Over time networks grow larger new designs emerge need connected existing network We recently seen key structuring mechanism used support change dividing overall problem hiding implementation details protocol layering There many strategies well Since many computers network every layer needs mechanism identifying senders receivers involved particular message This mechanism called addressing naming low high layers respectively An aspect growth different network technologies often different limitations For example communication channels preserve order messages sent leading solutions number messages Another example differences maximum size message networks transmit This leads mechanisms disassembling transmitting reassembling messages This overall topic called internetworking When networks get large new problems arise Cities traffic jams shortage telephone numbers easy get lost Not many people problems neighborhood citywide may big issue Designs continue work well network gets large said scalable A third design issue resource allocation Networks provide service hosts underlying resources capacity transmission lines To well need mechanisms divide resources one host interfere another much Many designs share network bandwidth dynamically according shortterm needs hosts rather giving host fixed fraction bandwidth may may use This design called statistical multiplexing meaning sharing based statistics demand It applied low layers single link high layers network even applications use network An allocation problem occurs every level keep fast sender swamping slow receiver data Feedback receiver SEC 1 3 NETWORK SOFTWARE sender often used This subject called flow control Sometimes problem network oversubscribed many computers want send much traffic network deliver This overloading network called congestion One strategy computer reduce demand experiences congestion It used layers It interesting observe network resources offer simply bandwidth For uses carrying live video timeliness delivery matters great deal Most networks must provide service applications want real time delivery time provide service applications want high throughput Quality service name given mechanisms reconcile competing demands The last major design issue secure network defending different kinds threats One threats mentioned previously eavesdropping communications Mechanisms provide confidentiality defend threat used multiple layers Mechanisms authentication prevent someone impersonating someone else They might used tell fake banking Web sites real one let cellular network check call really coming phone pay bill Other mechanisms integrity prevent surreptitious changes messages altering debit account 10 debit account 1000 All designs based cryptography shall study Chap 8 1 3 3 Connection Oriented Versus Connectionless Service Layers offer two different types service layers connection oriented connectionless In section look two types examine differences Connection oriented service modeled telephone system To talk someone pick phone dial number talk hang Similarly use connection oriented network service service user first establishes connection uses connection releases connection The essential aspect connection acts like tube sender pushes objects bits one end receiver takes end In cases order preserved bits arrive order sent In cases connection established sender receiver subnet conduct negotiation parameters used maximum message size quality service required issues Typically one side makes proposal side accept reject make counterproposal A circuit another name connection associated resources fixed bandwidth This dates telephone network circuit path copper wire carried phone conversation In contrast connection oriented service connectionless service modeled postal system Each message letter carries full destination address 36 INTRODUCTION one routed intermediate nodes inside system independent subsequent messages There different names messages different contexts packet message network layer When intermediate nodes receive message full sending next node called store forward switching The alternative onward transmission message node starts completely received node called cut switching Normally two messages sent destination first one sent first one arrive However possible first one sent delayed second one arrives first Each kind service characterized reliability Some services reliable sense never lose data Usually reliable service implemented receiver acknowledge receipt message sender sure arrived The acknowledgement process introduces overhead delays often worth sometimes undesirable A typical situation reliable connection oriented service appropriate file transfer The owner file wants sure bits arrive correctly order sent Very file transfer customers would prefer service occasionally scrambles loses bits even much faster Reliable connection oriented service two minor variations message sequences byte streams In former variant message boundaries preserved When two 1024 byte messages sent arrive two distinct 1024byte messages never one 2048 byte message In latter connection simply stream bytes message boundaries When 2048 bytes arrive receiver way tell sent one 2048 byte message two 1024 byte messages 2048 1 byte messages If pages book sent network phototypesetter separate messages might important preserve message boundaries On hand download DVD movie byte stream server user computer needed Message boundaries within movie relevant For applications transit delays introduced acknowledgements unacceptable One application digitized voice traffic voice IP It less disruptive telephone users hear bit noise line time time experience delay waiting acknowledgements Similarly transmitting video conference pixels wrong problem image jerk along flow stops starts correct errors irritating Not applications require connections For example spammers send electronic junk mail many recipients The spammer probably want go trouble setting later tearing connection recipient send one item Nor 100 percent reliable delivery essential especially costs All needed way send single message high SEC 1 3 NETWORK SOFTWARE probability arrival guarantee Unreliable meaning acknowledged connectionless service often called datagram service analogy telegram service also return acknowledgement sender Despite unreliable dominant form networks reasons become clear later In situations convenience establish connection send one message desired reliability essential The acknowledged datagram service provided applications It like sending registered letter requesting return receipt When receipt comes back sender absolutely sure letter delivered intended party lost along way Text messaging mobile phones example Still another service request reply service In service sender transmits single datagram containing request reply contains answer Request reply commonly used implement communication client server model client issues request server responds For example mobile phone client might send query map server retrieve map data current location summarizes types services discussed Connectionoriented Connectionless Service Example Reliable message stream Sequence pages Reliable byte stream Movie download Unreliable connection Voice IP Unreliable datagram Electronic junk mail Acknowledged datagram Text messaging Request reply Database query Six different types service The concept using unreliable communication may confusing first After would anyone actually prefer unreliable communication reliable communication First reliable communication sense acknowledged may available given layer For example Ethernet provide reliable communication Packets occasionally damaged transit It higher protocol levels recover problem In particular many reliable services built top unreliable datagram service Second delays inherent providing reliable service may unacceptable especially real time applications multimedia For reasons reliable unreliable communication coexist 38 INTRODUCTION 1 3 4 Service Primitives A service formally specified set primitives operations available user processes access service These primitives tell service perform action report action taken peer entity If protocol stack located operating system often primitives normally system calls These calls cause trap kernel mode turns control machine operating system send necessary packets The set primitives available depends nature service provided The primitives connection oriented service different connectionless service As minimal example service primitives might provide reliable byte stream consider primitives listed They familiar fans Berkeley socket interface primitives simplified version interface Primitive Meaning LISTEN Block waiting incoming connection CONNECT Establish connection waiting peer ACCEPT Accept incoming connection peer RECEIVE Block waiting incoming message SEND Send message peer DISCONNECT Terminate connection Six service primitives provide simple connection oriented service These primitives might used request reply interaction client server environment To illustrate We sketch simple protocol implements service using acknowledged datagrams First server executes LISTEN indicate prepared accept incoming connections A common way implement LISTEN make blocking system call After executing primitive server process blocked request connection appears Next client process executes CONNECT establish connection server The CONNECT call needs specify connect might parameter giving server address The operating system typically sends packet peer asking connect shown 1 The client process suspended response When packet arrives server operating system sees packet requesting connection It checks see listener unblocks listener The server process establish connection ACCEPT call This sends response 2 back client process accept SEC 1 3 NETWORK SOFTWARE Client machine 1 Connect request Server machine 2 Accept response Client process System process 3 Request data System calls Operating system Kernel Protocol Drivers stack 4 Reply 5 Disconnect 6 Disconnect Kernel Protocol Drivers stack A simple client server interaction using acknowledged datagrams connection The arrival response releases client At point client server running connection established The obvious analogy protocol real life customer client calling company customer service manager At start day service manager sits next telephone case rings Later client places call When manager picks phone connection established The next step server execute RECEIVE prepare accept first request Normally server immediately upon released LISTEN acknowledgement get back client The RECEIVE call blocks server Then client executes SEND transmit request 3 followed execution RECEIVE get reply The arrival request packet server machine unblocks server handle request After done work server uses SEND return answer client 4 The arrival packet unblocks client inspect answer If client additional requests make When client done executes DISCONNECT terminate connection 5 Usually initial DISCONNECT blocking call suspending client sending packet server saying connection longer needed When server gets packet also issues DISCONNECT acknowledging client releasing connection 6 When server packet gets back client machine client process released connection broken In nutshell connection oriented communication works Of course life simple Many things go wrong The timing wrong e g CONNECT done LISTEN packets get lost much We look issues great detail later moment briefly summarizes client server communication might work acknowledged datagrams ignore lost packets Given six packets required complete protocol one might wonder connectionless protocol used instead The answer perfect world could case two packets would needed one 40 INTRODUCTION request one reply However face large messages either direction e g megabyte file transmission errors lost packets situation changes If reply consisted hundreds packets could lost transmission would client know pieces missing How would client know whether last packet actually received really last packet sent Suppose client wanted second file How could tell packet 1 second file lost packet 1 first file suddenly found way client In short real world simple request reply protocol unreliable network often inadequate In Chap 3 study variety protocols detail overcome problems For moment suffice say reliable ordered byte stream processes sometimes convenient 1 3 5 The Relationship Services Protocols Services protocols distinct concepts This distinction important emphasize A service set primitives operations layer provides layer The service defines operations layer prepared perform behalf users says nothing operations implemented A service relates interface two layers lower layer service provider upper layer service user A protocol contrast set rules governing format meaning packets messages exchanged peer entities within layer Entities use protocols implement service definitions They free change protocols provided change service visible users In way service protocol completely decoupled This key concept network designer understand well To repeat crucial point services relate interfaces layers illustrated In contrast protocols relate packets sent peer entities different machines It important confuse two concepts An analogy programming languages worth making A service like abstract data type object object oriented language It defines operations performed object specify operations implemented In contrast protocol relates implementation service visible user service Many older protocols distinguish service protocol In effect typical layer might service primitive SEND PACKET user providing pointer fully assembled packet This arrangement meant changes protocol immediately visible users Most network designers regard design serious blunder SEC 1 4 REFERENCE MODELS Layer k 1 Layer k 1 Service provided layer k Layer k Layer k 1 Protocol Layer k Layer k 1 The relationship service protocol 1 4 REFERENCE MODELS Now discussed layered networks abstract time look examples We discuss two important network architectures OSI reference model TCP IP reference model Although protocols associated OSI model used model actually quite general still valid features discussed layer still important The TCP IP model opposite properties model much use protocols widely used For reason look detail Also sometimes learn failures successes 1 4 1 The OSI Reference Model The OSI model minus physical medium shown This model based proposal developed International Standards Organization ISO first step toward international standardization protocols used various layers Day Zimmermann 1983 It revised 1995 Day 1995 The model called ISO OSI Open Systems Interconnection Reference Model deals connecting open systems systems open communication systems We call OSI model short The OSI model seven layers The principles applied arrive seven layers briefly summarized follows 1 A layer created different abstraction needed 2 Each layer perform well defined function 3 The function layer chosen eye toward defining internationally standardized protocols 42 INTRODUCTION Layer Name unit exchanged Application Application protocol Application APDU Presentation PPDU Session SPDU Transport TPDU Interface Presentation Session Transport Presentation protocol Session protocol Transport protocol Communication subnet boundary Internal subnet protocol Network Network Network Network Packet Data link Data link Data link Data link Frame Physical Physical Physical Physical Bit Host A Router Router Host B Network layer host router protocol Data link layer host router protocol Physical layer host router protocol The OSI reference model 4 The layer boundaries chosen minimize information flow across interfaces 5 The number layers large enough distinct functions need thrown together layer necessity small enough architecture become unwieldy Below discuss layer model turn starting bottom layer Note OSI model network architecture specify exact services protocols used layer It tells layer However ISO also produced standards layers although part reference model Each one published separate international standard The model part widely used although associated protocols long forgotten SEC 1 4 REFERENCE MODELS The Physical Layer The physical layer concerned transmitting raw bits communication channel The design issues making sure one side sends 1 bit received side 1 bit 0 bit Typical questions electrical signals used represent 1 0 many nanoseconds bit lasts whether transmission may proceed simultaneously directions initial connection established torn sides finished many pins network connector pin used These design issues largely deal mechanical electrical timing interfaces well physical transmission medium lies physical layer The Data Link Layer The main task data link layer transform raw transmission facility line appears free undetected transmission errors It masking real errors network layer see It accomplishes task sender break input data data frames typically hundred thousand bytes transmit frames sequentially If service reliable receiver confirms correct receipt frame sending back acknowledgement frame Another issue arises data link layer higher layers well keep fast transmitter drowning slow receiver data Some traffic regulation mechanism may needed let transmitter know receiver accept data Broadcast networks additional issue data link layer control access shared channel A special sublayer data link layer medium access control sublayer deals problem The Network Layer The network layer controls operation subnet A key design issue determining packets routed source destination Routes based static tables wired network rarely changed often updated automatically avoid failed components They also determined start conversation example terminal session login remote machine Finally highly dynamic determined anew packet reflect current network load If many packets present subnet time get one another way forming bottlenecks Handling congestion also responsibility network layer conjunction higher layers adapt load 44 INTRODUCTION place network More generally quality service provided delay transit time jitter etc also network layer issue When packet travel one network another get destination many problems arise The addressing used second network may different used first one The second one may accept packet large The protocols may differ It network layer overcome problems allow heterogeneous networks interconnected In broadcast networks routing problem simple network layer often thin even nonexistent The Transport Layer The basic function transport layer accept data split smaller units need pass network layer ensure pieces arrive correctly end Furthermore must done efficiently way isolates upper layers inevitable changes hardware technology course time The transport layer also determines type service provide session layer ultimately users network The popular type transport connection error free point point channel delivers messages bytes order sent However possible kinds transport service exist transporting isolated messages guarantee order delivery broadcasting messages multiple destinations The type service determined connection established As aside error free channel completely impossible achieve people really mean term error rate low enough ignore practice The transport layer true end end layer carries data way source destination In words program source machine carries conversation similar program destination machine using message headers control messages In lower layers protocols machine immediate neighbors ultimate source destination machines may separated many routers The difference layers 1 3 chained layers 4 7 end end illustrated The Session Layer The session layer allows users different machines establish sessions Sessions offer various services including dialog control keeping track whose turn transmit token management preventing two parties attempting critical operation simultaneously synchronization SEC 1 4 REFERENCE MODELS checkpointing long transmissions allow pick left event crash subsequent recovery The Presentation Layer Unlike lower layers mostly concerned moving bits around presentation layer concerned syntax semantics information transmitted In order make possible computers different internal data representations communicate data structures exchanged defined abstract way along standard encoding used wire The presentation layer manages abstract data structures allows higher level data structures e g banking records defined exchanged The Application Layer The application layer contains variety protocols commonly needed users One widely used application protocol HTTP HyperText Transfer Protocol basis World Wide Web When browser wants Web page sends name page wants server hosting page using HTTP The server sends page back Other application protocols used file transfer electronic mail network news 1 4 2 The TCP IP Reference Model Let us turn OSI reference model reference model used grandparent wide area computer networks ARPANET successor worldwide Internet Although give brief history ARPANET later useful mention key aspects The ARPANET research network sponsored DoD U S Department Defense It eventually connected hundreds universities government installations using leased telephone lines When satellite radio networks added later existing protocols trouble interworking new reference architecture needed Thus nearly beginning ability connect multiple networks seamless way one major design goals This architecture later became known TCP IP Reference Model two primary protocols It first described Cerf Kahn 1974 later refined defined standard Internet community Braden 1989 The design philosophy behind model discussed Clark 1988 Given DoD worry precious hosts routers internetwork gateways might get blown pieces moment notice attack Soviet Union another major goal network able survive loss subnet hardware without existing conversations broken In 46 INTRODUCTION words DoD wanted connections remain intact long source destination machines functioning even machines transmission lines suddenly put operation Furthermore since applications divergent requirements envisioned ranging transferring files real time speech transmission flexible architecture needed The Link Layer All requirements led choice packet switching network based connectionless layer runs across different networks The lowest layer model link layer describes links serial lines classic Ethernet must meet needs connectionless internet layer It really layer normal sense term rather interface hosts transmission links Early material TCP IP model little say The Internet Layer The internet layer linchpin holds whole architecture together It shown corresponding roughly OSI network layer Its job permit hosts inject packets network travel independently destination potentially different network They may even arrive completely different order sent case job higher layers rearrange order delivery desired Note internet used generic sense even though layer present Internet OSI TCP IP Application Application Presentation Session Transport Transport Network Internet Data link Link Physical Not present model The TCP IP reference model The analogy snail mail system A person drop sequence international letters mailbox one country little luck SEC 1 4 REFERENCE MODELS delivered correct address destination country The letters probably travel one international mail gateways along way transparent users Furthermore country e network stamps preferred envelope sizes delivery rules hidden users The internet layer defines official packet format protocol called IP Internet Protocol plus companion protocol called ICMP Internet Control Message Protocol helps function The job internet layer deliver IP packets supposed go Packet routing clearly major issue congestion though IP proven effective avoiding congestion The Transport Layer The layer internet layer TCP IP model usually called transport layer It designed allow peer entities source destination hosts carry conversation OSI transport layer Two end end transport protocols defined The first one TCP Transmission Control Protocol reliable connection oriented protocol allows byte stream originating one machine delivered without error machine internet It segments incoming byte stream discrete messages passes one internet layer At destination receiving TCP process reassembles received messages output stream TCP also handles flow control make sure fast sender swamp slow receiver messages handle The second protocol layer UDP User Datagram Protocol unreliable connectionless protocol applications want TCP sequencing flow control wish provide It also widely used one shot client server type request reply queries applications prompt delivery important accurate delivery transmitting speech video The relation IP TCP UDP shown Since model developed IP implemented many networks The Application Layer The TCP IP model session presentation layers No need perceived Instead applications simply include session presentation functions require Experience OSI model proven view correct layers little use applications On top transport layer application layer It contains higher level protocols The early ones included virtual terminal TELNET file transfer FTP electronic mail SMTP Many protocols added years Some important ones study shown 48 INTRODUCTION Application HTTP Transport SMTP TCP RTP DNS UDP Protocols Layers Internet Link DSL IP ICMP SONET 802 11 Ethernet The TCP IP model protocols study include Domain Name System DNS mapping host names onto network addresses HTTP protocol fetching pages World Wide Web RTP protocol delivering real time media voice movies 1 4 3 The Model Used This Book As mentioned earlier strength OSI reference model model minus presentation session layers proven exceptionally useful discussing computer networks In contrast strength TCP IP reference model protocols widely used many years Since computer scientists like cake eat use hybrid model framework book Application Transport Network Link Physical The reference model used book This model five layers running physical layer link network transport layers application layer The physical layer specifies transmit bits across different kinds media electrical analog signals The link layer concerned send finite length messages directly connected computers specified levels reliability Ethernet 802 11 examples link layer protocols SEC 1 4 REFERENCE MODELS The network layer deals combine multiple links networks networks networks internetworks send packets distant computers This includes task finding path along send packets IP main example protocol study layer The transport layer strengthens delivery guarantees Network layer usually increased reliability provide delivery abstractions reliable byte stream match needs different applications TCP important example transport layer protocol Finally application layer contains programs make use network Many networked applications user interfaces Web browser Our concern however portion program uses network This HTTP protocol case Web browser There also important support programs application layer DNS used many applications Our chapter sequence based model In way retain value OSI model understanding network architectures concentrate primarily protocols important practice TCP IP related protocols newer ones 802 11 SONET Bluetooth 1 4 4 A Comparison OSI TCP IP Reference Models The OSI TCP IP reference models much common Both based concept stack independent protocols Also functionality layers roughly similar For example models layers including transport layer provide end end network independent transport service processes wishing communicate These layers form transport provider Again models layers transport application oriented users transport service Despite fundamental similarities two models also many differences In section focus key differences two reference models It important note comparing reference models corresponding protocol stacks The protocols discussed later For entire book comparing contrasting TCP IP OSI see Piscitello Chapin 1993 Three concepts central OSI model 1 Services 2 Interfaces 3 Protocols Probably biggest contribution OSI model makes distinction three concepts explicit Each layer performs services 50 INTRODUCTION layer The service definition tells layer entities access layer works It defines layer semantics A layer interface tells processes access It specifies parameters results expect It says nothing layer works inside Finally peer protocols used layer layer business It use protocols wants long gets job done e provides offered services It also change without affecting software higher layers These ideas fit nicely modern ideas object oriented programming An object like layer set methods operations processes outside object invoke The semantics methods define set services object offers The methods parameters results form object interface The code internal object protocol visible concern outside object The TCP IP model originally clearly distinguish services interfaces protocols although people tried retrofit fact make OSI like For example real services offered internet layer SEND IP PACKET RECEIVE IP PACKET As consequence protocols OSI model better hidden TCP IP model replaced relatively easily technology changes Being able make changes transparently one main purposes layered protocols first place The OSI reference model devised corresponding protocols invented This ordering meant model biased toward one particular set protocols fact made quite general The downside ordering designers much experience subject good idea functionality put layer For example data link layer originally dealt point point networks When broadcast networks came around new sublayer hacked model Furthermore people started build real networks using OSI model existing protocols discovered networks match required service specifications wonder wonders convergence sublayers grafted onto model provide place papering differences Finally committee originally expected country would one network run government using OSI protocols thought given internetworking To make long story short things turn way With TCP IP reverse true protocols came first model really description existing protocols There problem protocols fitting model They fit perfectly The trouble model fit protocol stacks Consequently especially useful describing non TCP IP networks SEC 1 4 REFERENCE MODELS Turning philosophical matters specific ones obvious difference two models number layers OSI model seven layers TCP IP model four Both inter network transport application layers layers different Another difference area connectionless versus connection oriented communication The OSI model supports connectionless connectionoriented communication network layer connection oriented communication transport layer counts transport service visible users The TCP IP model supports one mode network layer connectionless transport layer giving users choice This choice especially important simple request response protocols 1 4 5 A Critique OSI Model Protocols Neither OSI model protocols TCP IP model protocols perfect Quite bit criticism directed In section next one look criticisms We begin OSI examine TCP IP afterward At time second edition book published 1989 appeared many experts field OSI model protocols going take world push everything else way This happen Why A look back reasons may useful They summarized 1 Bad timing 2 Bad technology 3 Bad implementations 4 Bad politics Bad Timing First let us look reason one bad timing The time standard established absolutely critical success David Clark M I T theory standards calls apocalypse two elephants illustrated This figure shows amount activity surrounding new subject When subject first discovered burst research activity form discussions papers meetings After activity subsides corporations discover subject billion dollar wave investment hits It essential standards written trough two elephants If written early research results well 52 INTRODUCTION Billion dollar investment Research Activity Standards Time The apocalypse two elephants established subject may still poorly understood result bad standard If written late many companies may already made major investments different ways things standards effectively ignored If interval two elephants short everyone hurry get started people developing standards may get crushed It appears standard OSI protocols got crushed The competing TCP IP protocols already widespread use research universities time OSI protocols appeared While billion dollar wave investment yet hit academic market large enough many vendors begun cautiously offering TCP IP products When OSI came around want support second protocol stack forced initial offerings With every company waiting every company go first company went first OSI never happened Bad Technology The second reason OSI never caught model protocols flawed The choice seven layers political technical two layers session presentation nearly empty whereas two ones data link network overfull The OSI model along associated service definitions protocols extraordinarily complex When piled printed standards occupy significant fraction meter paper They also difficult implement inefficient operation In context riddle posed Paul Mockapetris cited Rose 1993 comes mind Q What get cross mobster international standard A Someone makes offer understand SEC 1 4 REFERENCE MODELS In addition incomprehensible another problem OSI functions addressing flow control error control reappear layer Saltzer et al 1984 example pointed effective error control must done highest layer repeating lower layers often unnecessary inefficient Bad Implementations Given enormous complexity model protocols come surprise initial implementations huge unwieldy slow Everyone tried got burned It take long people associate OSI poor quality Although products improved course time image stuck In contrast one first implementations TCP IP part Berkeley UNIX quite good mention free People began using quickly led large user community led improvements led even larger community Here spiral upward instead downward Bad Politics On account initial implementation many people especially academia thought TCP IP part UNIX UNIX 1980s academia unlike parenthood incorrectly called motherhood apple pie OSI hand widely thought creature European telecommunication ministries European Community later U S Government This belief partly true idea bunch government bureaucrats trying shove technically inferior standard throats poor researchers programmers trenches actually developing computer networks aid OSI cause Some people viewed development light IBM announcing 1960s PL I language future DoD correcting later announcing actually Ada 1 4 6 A Critique TCP IP Reference Model The TCP IP model protocols problems First model clearly distinguish concepts services interfaces protocols Good software engineering practice requires differentiating specification implementation something OSI carefully TCP IP Consequently TCP IP model much guide designing new networks using new technologies Second TCP IP model general poorly suited describing protocol stack TCP IP Trying use TCP IP model describe Bluetooth example completely impossible 54 INTRODUCTION Third link layer really layer normal sense term used context layered protocols It interface network data link layers The distinction interface layer crucial one sloppy Fourth TCP IP model distinguish physical data link layers These completely different The physical layer transmission characteristics copper wire fiber optics wireless communication The data link layer job delimit start end frames get one side desired degree reliability A proper model include separate layers The TCP IP model Finally although IP TCP protocols carefully thought well implemented many protocols ad hoc generally produced couple graduate students hacking away got tired The protocol implementations distributed free resulted becoming widely used deeply entrenched thus hard replace Some bit embarrassment The virtual terminal protocol TELNET example designed ten character per second mechanical Teletype terminal It knows nothing graphical user interfaces mice Nevertheless still use 30 years later 1 5 EXAMPLE NETWORKS The subject computer networking covers many different kinds networks large small well known less well known They different goals scales technologies In following sections look examples get idea variety one finds area computer networking We start Internet probably best known network look history evolution technology Then consider mobile phone network Technically quite different Internet contrasting nicely Next introduce IEEE 802 11 dominant standard wireless LANs Finally look RFID sensor networks technologies extend reach network include physical world everyday objects 1 5 1 The Internet The Internet really network vast collection different networks use certain common protocols provide certain common services It unusual system planned anyone controlled anyone To better understand let us start beginning see developed For wonderful history Internet John Naughton 2000 book highly recommended It one rare books fun read also 20 pages ibid op cit serious historian Some material section based book SEC 1 5 EXAMPLE NETWORKS Of course countless technical books written Internet protocols well For information see example Maufer 1999 The ARPANET The story begins late 1950s At height Cold War U S DoD wanted command control network could survive nuclear war At time military communications used public telephone network considered vulnerable The reason belief gleaned Here black dots represent telephone switching offices connected thousands telephones These switching offices turn connected higher level switching offices toll offices form national hierarchy small amount redundancy The vulnerability system destruction key toll offices could fragment many isolated islands Switching office Toll office b Structure telephone system b Baran proposed distributed switching system Around 1960 DoD awarded contract RAND Corporation find solution One employees Paul Baran came highly distributed fault tolerant design b Since paths two switching offices much longer analog signals could travel without distortion Baran proposed using digital packet switching technology Baran wrote several reports DoD describing ideas detail Baran 1964 Officials Pentagon liked concept asked AT T U S national telephone monopoly build prototype AT T dismissed Baran ideas hand The biggest richest corporation world allow 56 INTRODUCTION young whippersnapper tell build telephone system They said Baran network could built idea killed Several years went still DoD better command andcontrol system To understand happened next go back way October 1957 Soviet Union beat U S space launch first artificial satellite Sputnik When President Eisenhower tried find asleep switch appalled find Army Navy Air Force squabbling Pentagon research budget His immediate response create single defense research organization ARPA Advanced Research Projects Agency ARPA scientists laboratories fact nothing office small Pentagon standards budget It work issuing grants contracts universities companies whose ideas looked promising For first years ARPA tried figure mission In 1967 attention Larry Roberts program manager ARPA trying figure provide remote access computers turned networking He contacted various experts decide One Wesley Clark suggested building packet switched subnet connecting host router After initial skepticism Roberts bought idea presented somewhat vague paper ACM SIGOPS Symposium Operating System Principles held Gatlinburg Tennessee late 1967 Roberts 1967 Much Roberts surprise another paper conference described similar system designed actually fully implemented direction Donald Davies National Physical Laboratory England The NPL system national system connected several computers NPL campus demonstrated packet switching could made work Furthermore cited Baran discarded earlier work Roberts came away Gatlinburg determined build later became known ARPANET The subnet would consist minicomputers called IMPs Interface Message Processors connected 56 kbps transmission lines For high reliability IMP would connected least two IMPs The subnet datagram subnet lines IMPs destroyed messages could automatically rerouted along alternative paths Each node network consist IMP host room connected short wire A host could send messages 8063 bits IMP would break packets 1008 bits forward independently toward destination Each packet received entirety forwarded subnet first electronic storeand forward packet switching network ARPA put tender building subnet Twelve companies bid After evaluating proposals ARPA selected BBN consulting firm based Cambridge Massachusetts December 1968 awarded contract SEC 1 5 EXAMPLE NETWORKS build subnet write subnet software BBN chose use specially modified Honeywell DDP 316 minicomputers 12K 16 bit words core memory IMPs The IMPs disks since moving parts considered unreliable The IMPs interconnected 56 kbps lines leased telephone companies Although 56 kbps choice teenagers afford DSL cable best money could buy The software split two parts subnet host The subnet software consisted IMP end host IMP connection IMP IMP protocol source IMP destination IMP protocol designed improve reliability The original ARPANET design shown Host host protocol Host Host IMP protocol Source IMP IMP IMP protocol ol n IMP protoc destinatio IMP IMP col prot Subnet IMP The original ARPANET design Outside subnet software also needed namely host end host IMP connection host host protocol application software It soon became clear BBN opinion accepted message host IMP wire placed host IMP wire destination job done Roberts problem though hosts needed software To deal convened meeting network researchers mostly graduate students Snowbird Utah summer 1969 The graduate students expected network expert explain grand design network software assign job writing part They astounded network expert grand design They figure Nevertheless somehow experimental network went online December 1969 four nodes UCLA UCSB SRI University Utah These four chosen large number ARPA contracts different completely incompatible host computers make fun The first host host message sent two months earlier UCLA 58 INTRODUCTION node team led Len Kleinrock pioneer theory packet switching SRI node The network grew quickly IMPs delivered installed soon spanned United States shows rapidly ARPANET grew first 3 years SRI SRI UTAH UTAH UCSB UCSB MIT SRI SDC UTAH ILLINOIS MIT UCSB LINCOLN CASE CARN SDC STAN UCLA UCLA RAND UCLA BBN MCCLELLAN UTAH GWC LINCOLN CASE STAN USC MIT SDC CARN LINC MITRE RAND STANFORD FNWC RAND TINKER ETAC TINKER BBN HARVARD UCSD NBS UCLA SDC ILLINOIS MIT CCA BBN HARVARD LINC ABERDEEN NBS ETAC AMES IMP UCSB UCLA UTAH X PARC RADC ILLINOIS AMES UCSB LBL MCCLELLAN AMES TIP NCAR HARVARD BURROUGHS c SRI SRI BBN RAND b USC ARPA MITRE RADC SAAC BELVOIR CMU NOAA GWC CASE e Growth ARPANET December 1969 b July 1970 c March 1971 April 1972 e September 1972 In addition helping fledgling ARPANET grow ARPA also funded research use satellite networks mobile packet radio networks In one famous demonstration truck driving around California used packet radio network send messages SRI forwarded ARPANET East Coast shipped University College London satellite network This allowed researcher truck use computer London driving around California This experiment also demonstrated existing ARPANET protocols suitable running different networks This observation led research protocols culminating invention TCP IP model protocols Cerf Kahn 1974 TCP IP specifically designed handle communication internetworks something becoming increasingly important networks hooked ARPANET SEC 1 5 EXAMPLE NETWORKS To encourage adoption new protocols ARPA awarded several contracts implement TCP IP different computer platforms including IBM DEC HP systems well Berkeley UNIX Researchers University California Berkeley rewrote TCP IP new programming interface called sockets upcoming 4 2BSD release Berkeley UNIX They also wrote many application utility management programs show convenient use network sockets The timing perfect Many universities acquired second third VAX computer LAN connect networking software When 4 2BSD came along TCP IP sockets many network utilities complete package adopted immediately Furthermore TCP IP easy LANs connect ARPANET many During 1980s additional networks especially LANs connected ARPANET As scale increased finding hosts became increasingly expensive DNS Domain Name System created organize machines domains map host names onto IP addresses Since DNS become generalized distributed database system storing variety information related naming We study detail Chap 7 NSFNET By late 1970s NSF U S National Science Foundation saw enormous impact ARPANET university research allowing scientists across country share data collaborate research projects However get ARPANET university research contract DoD Many contract NSF initial response fund Computer Science Network CSNET 1981 It connected computer science departments industrial research labs ARPANET via dial leased lines In late 1980s NSF went decided design successor ARPANET would open university research groups To something concrete start NSF decided build backbone network connect six supercomputer centers San Diego Boulder Champaign Pittsburgh Ithaca Princeton Each supercomputer given little brother consisting LSI 11 microcomputer called fuzzball The fuzzballs connected 56 kbps leased lines formed subnet hardware technology ARPANET used The software technology different however fuzzballs spoke TCP IP right start making first TCP IP WAN NSF also funded eventually 20 regional networks connected backbone allow users thousands universities research labs libraries museums access supercomputers communicate one another The complete network including backbone regional networks called NSFNET It connected ARPANET link 60 INTRODUCTION IMP fuzzball Carnegie Mellon machine room The first NSFNET backbone illustrated superimposed map U S NSF Supercomputer center NSF Midlevel network Both The NSFNET backbone 1988 NSFNET instantaneous success overloaded word go NSF immediately began planning successor awarded contract Michigan based MERIT consortium run Fiber optic channels 448 kbps leased MCI since merged WorldCom provide version 2 backbone IBM PC RTs used routers This soon overwhelmed 1990 second backbone upgraded 1 5 Mbps As growth continued NSF realized government could continue financing networking forever Furthermore commercial organizations wanted join forbidden NSF charter using networks NSF paid Consequently NSF encouraged MERIT MCI IBM form nonprofit corporation ANS Advanced Networks Services first step along road commercialization In 1990 ANS took NSFNET upgraded 1 5 Mbps links 45 Mbps form ANSNET This network operated 5 years sold America Online But various companies offering commercial IP service clear government get networking business To ease transition make sure every regional network could communicate every regional network NSF awarded contracts four different network operators establish NAP Network Access Point These operators PacBell San Francisco Ameritech Chicago MFS Washington D C Sprint New York City NAP purposes Pennsauken New Jersey counts New York City Every network operator wanted provide backbone service NSF regional networks connect NAPs SEC 1 5 EXAMPLE NETWORKS This arrangement meant packet originating regional network choice backbone carriers get NAP destination NAP Consequently backbone carriers forced compete regional networks business basis service price idea course As result concept single default backbone replaced commercially driven competitive infrastructure Many people like criticize Federal Government innovative area networking DoD NSF created infrastructure formed basis Internet handed industry operate During 1990s many countries regions also built national research networks often patterned ARPANET NSFNET These included EuropaNET EBONE Europe started 2 Mbps lines upgraded 34 Mbps lines Eventually network infrastructure Europe handed industry well The Internet changed great deal since early days It exploded size emergence World Wide Web WWW early 1990s Recent data Internet Systems Consortium puts number visible Internet hosts 600 million This guess low ball estimate far exceeds million hosts around first conference WWW held CERN 1994 The way use Internet also changed radically Initially applications email academics newsgroups remote login file transfer dominated Later switched email everyman Web peer peer content distribution shuttered Napster Now real time media distribution social networks e g Facebook microblogging e g Twitter taking These switches brought richer kinds media Internet hence much traffic In fact dominant traffic Internet seems change regularity example new better ways work music movies become popular quickly Architecture Internet The architecture Internet also changed great deal grown explosively In section attempt give brief overview looks like today The picture complicated continuous upheavals businesses telephone companies telcos cable companies ISPs often make hard tell One driver upheavals telecommunications convergence one network used previously different uses For example triple play one company sells telephony TV Internet service network connection assumption save money Consequently description given necessity somewhat simpler reality And true today may true tomorrow 62 INTRODUCTION The big picture shown Let us examine figure piece piece starting computer home edges figure To join Internet computer connected Internet Service Provider simply ISP user purchases Internet access connectivity This lets computer exchange packets accessible hosts Internet The user might send packets surf Web thousand uses matter There many kinds Internet access usually distinguished much bandwidth provide much cost important attribute connectivity Data center Tier 1 ISP Backbone Router Fiber FTTH Peering IXP 3G mobile phone Dialup Cable DSL Other ISPs DSLAM DSL modem POP Data path Cable modem CMTS Overview Internet architecture A common way connect ISP use phone line house case phone company ISP DSL short Digital Subscriber Line reuses telephone line connects house digital data transmission The computer connected device called DSL modem converts digital packets analog signals pass unhindered telephone line At end device called DSLAM Digital Subscriber Line Access Multiplexer converts signals packets Several popular ways connect ISP shown DSL higher bandwidth way use local telephone line send bits traditional telephone call instead voice conversation That called dial done different kind modem ends The word modem short modulator demodulator refers device converts digital bits analog signals Another method send signals cable TV system Like DSL way reuse existing infrastructure case otherwise unused cable TV SEC 1 5 EXAMPLE NETWORKS channels The device home end called cable modem device cable headend called CMTS Cable Modem Termination System DSL cable provide Internet access rates small fraction megabit sec multiple megabit sec depending system These rates much greater dial rates limited 56 kbps narrow bandwidth used voice calls Internet access much greater dial speeds called broadband The name refers broader bandwidth used faster networks rather particular speed The access methods mentioned far limited bandwidth last mile last leg transmission By running optical fiber residences faster Internet access provided rates order 10 100 Mbps This design called FTTH Fiber Home For businesses commercial areas may make sense lease high speed transmission line offices nearest ISP For example North America T3 line runs roughly 45 Mbps Wireless used Internet access An example explore shortly 3G mobile phone networks They provide data delivery rates 1 Mbps higher mobile phones fixed subscribers coverage area We move packets home ISP We call location customer packets enter ISP network service ISP POP Point Presence We next explain packets moved POPs different ISPs From point system fully digital packet switched ISP networks may regional national international scope We already seen architecture made long distance transmission lines interconnect routers POPs different cities ISPs serve This equipment called backbone ISP If packet destined host served directly ISP packet routed backbone delivered host Otherwise must handed another ISP ISPs connect networks exchange traffic IXPs Internet eXchange Points The connected ISPs said peer There many IXPs cities around world They drawn vertically ISP networks overlap geographically Basically IXP room full routers least one per ISP A LAN room connects routers packets forwarded ISP backbone ISP backbone IXPs large independently owned facilities One largest Amsterdam Internet Exchange hundreds ISPs connect exchange hundreds gigabits sec traffic The peering happens IXPs depends business relationships ISPs There many possible relationships For example small ISP might pay larger ISP Internet connectivity reach distant hosts much customer purchases service Internet provider In case small ISP said pay transit Alternatively two large ISPs might decide exchange 64 INTRODUCTION traffic ISP deliver traffic ISP without pay transit One many paradoxes Internet ISPs publicly compete one another customers often privately cooperate peering Metz 2001 The path packet takes Internet depends peering choices ISPs If ISP delivering packet peers destination ISP might deliver packet directly peer Otherwise might route packet nearest place connects paid transit provider provider deliver packet Two example paths across ISPs drawn Often path packet takes shortest path Internet At top food chain small handful companies like AT T Sprint operate large international backbone networks thousands routers connected high bandwidth fiber optic links These ISPs pay transit They usually called tier 1 ISPs said form backbone Internet since everyone else must connect able reach entire Internet Companies provide lots content Google Yahoo locate computers data centers well connected rest Internet These data centers designed computers humans may filled rack upon rack machines called server farm Colocation hosting data centers let customers put equipment servers ISP POPs short fast connections made servers ISP backbones The Internet hosting industry become increasingly virtualized common rent virtual machine run server farm instead installing physical computer These data centers large tens hundreds thousands machines electricity major cost data centers sometimes built areas electricity cheap This ends quick tour Internet We great deal say individual components design algorithms protocols subsequent chapters One point worth mentioning means Internet changing It used machine Internet 1 ran TCP IP protocol stack 2 IP address 3 could send IP packets machines Internet However ISPs often reuse IP addresses depending computers use moment home networks often share one IP address multiple computers This practice undermines second condition Security measures firewalls also partly block computers receiving packets undermining third condition Despite difficulties makes sense regard machines Internet connected ISPs Also worth mentioning passing companies interconnected existing internal networks often using technology Internet These intranets typically accessible company premises company notebooks otherwise work way Internet SEC 1 5 EXAMPLE NETWORKS 1 5 2 Third Generation Mobile Phone Networks People love talk phone even like surf Internet made mobile phone network successful network world It four billion subscribers worldwide To put number perspective roughly 60 world population number Internet hosts fixed telephone lines combined ITU 2009 The architecture mobile phone network changed greatly past 40 years along tremendous growth First generation mobile phone systems transmitted voice calls continuously varying analog signals rather sequences digital bits AMPS Advanced Mobile Phone System deployed United States 1982 widely used firstgeneration system Second generation mobile phone systems switched transmitting voice calls digital form increase capacity improve security offer text messaging GSM Global System Mobile communications deployed starting 1991 become widely used mobile phone system world 2G system The third generation 3G systems initially deployed 2001 offer digital voice broadband digital data services They also come lot jargon many different standards choose 3G loosely defined ITU international standards body discuss next section providing rates least 2 Mbps stationary walking users 384 kbps moving vehicle UMTS Universal Mobile Telecommunications System also called WCDMA Wideband Code Division Multiple Access main 3G system rapidly deployed worldwide It provide 14 Mbps downlink almost 6 Mbps uplink Future releases use multiple antennas radios provide even greater speeds users The scarce resource 3G systems 2G 1G systems radio spectrum Governments license right use parts spectrum mobile phone network operators often using spectrum auction network operators submit bids Having piece licensed spectrum makes easier design operate systems since one else allowed transmit spectrum often costs serious amount money In UK 2000 example five 3G licenses auctioned total 40 billion It scarcity spectrum led cellular network design shown used mobile phone networks To manage radio interference users coverage area divided cells Within cell users assigned channels interfere cause much interference adjacent cells This allows good reuse spectrum frequency reuse neighboring cells increases capacity network In 1G systems carried voice call specific frequency band frequencies carefully chosen conflict neighboring cells In way given frequency might reused 66 INTRODUCTION several cells Modern 3G systems allow cell use frequencies way results tolerable level interference neighboring cells There variations cellular design including use directional sectored antennas cell towers reduce interference basic idea Cells Base station Cellular design mobile phone networks The architecture mobile phone network different Internet It several parts shown simplified version UMTS architecture First air interface This term fancy name radio communication protocol used air mobile device e g cell phone cellular base station Advances air interface past decades greatly increased wireless data rates The UMTS air interface based Code Division Multiple Access CDMA technique study Chap 2 The cellular base station together controller forms radio access network This part wireless side mobile phone network The controller node RNC Radio Network Controller controls spectrum used The base station implements air interface It called Node B temporary label stuck The rest mobile phone network carries traffic radio access network It called core network The UMTS core network evolved core network used 2G GSM system came However something surprising happening UMTS core network Since beginning networking war going people support packet networks e connectionless subnets people support circuit networks e connection oriented subnets The main proponents packets come Internet community In connectionless design every packet routed independently every packet As consequence routers go session harm done long system SEC 1 5 Air interface Uu EXAMPLE NETWORKS Node B RNC Circuits Iu CS Access Core interface Iu MSC MGW PSTN GGSN Internet HSS RNC Packets Iu PS GMSC MGW SGSN Packets Radio access network Core network Architecture UMTS 3G mobile phone network dynamically reconfigure subsequent packets find route destination even different previous packets used The circuit camp comes world telephone companies In telephone system caller must dial called party number wait connection talking sending data This connection setup establishes route telephone system maintained call terminated All words packets follow route If line switch path goes call aborted making less fault tolerant connectionless design The advantage circuits support quality service easily By setting connection advance subnet reserve resources link bandwidth switch buffer space CPU If attempt made set call insufficient resources available call rejected caller gets kind busy signal In way connection set connection get good service With connectionless network many packets arrive router moment router choke probably lose packets The sender eventually notice resend quality service jerky unsuitable audio video unless network lightly loaded Needless say providing adequate audio quality something telephone companies care much hence preference connections The surprise packet circuit switched equipment core network This shows mobile phone network transition mobile phone companies able implement one sometimes 68 INTRODUCTION alternatives Older mobile phone networks used circuit switched core style traditional phone network carry voice calls This legacy seen UMTS network MSC Mobile Switching Center GMSC Gateway Mobile Switching Center MGW Media Gateway elements set connections circuit switched core network PSTN Public Switched Telephone Network Data services become much important part mobile phone network used starting text messaging early packet data services GPRS General Packet Radio Service GSM system These older data services ran tens kbps users wanted Newer mobile phone networks carry packet data rates multiple Mbps For comparison voice call carried rate 64 kbps typically 3 4x less compression To carry data UMTS core network nodes connect directly packet switched network The SGSN Serving GPRS Support Node GGSN Gateway GPRS Support Node deliver data packets mobiles interface external packet networks Internet This transition set continue mobile phone networks planned deployed Internet protocols even used mobiles set connections voice calls packet data network manner voiceover IP IP packets used way radio access core network Of course way IP networks designed also changing support better quality service If problems chopped audio jerky video would impress paying customers We return subject Chap 5 Another difference mobile phone networks traditional Internet mobility When user moves range one cellular base station range another one flow data must routed old new cell base station This technique known handover handoff illustrated b Mobile phone handover b Either mobile device base station may request handover quality signal drops In cell networks usually based CDMA SEC 1 5 EXAMPLE NETWORKS technology possible connect new base station disconnecting old base station This improves connection quality mobile break service mobile actually connected two base stations short This way handover called soft handover distinguish hard handover mobile disconnects old base station connecting new one A related issue find mobile first place incoming call Each mobile phone network HSS Home Subscriber Server core network knows location subscriber well profile information used authentication authorization In way mobile found contacting HSS A final area discuss security Historically phone companies taken security much seriously Internet companies long time need bill service avoid payment fraud Unfortunately saying much Nevertheless evolution 1G 3G technologies mobile phone companies able roll basic security mechanisms mobiles Starting 2G GSM system mobile phone divided handset removable chip containing subscriber identity account information The chip informally called SIM card short Subscriber Identity Module SIM cards switched different handsets activate provide basis security When GSM customers travel countries vacation business often bring handsets buy new SIM card dollars upon arrival order make local calls roaming charges To reduce fraud information SIM cards also used mobile phone network authenticate subscribers check allowed use network With UMTS mobile also uses information SIM card check talking legitimate network Another aspect security privacy Wireless signals broadcast nearby receivers make difficult eavesdrop conversations cryptographic keys SIM card used encrypt transmissions This approach provides much better privacy 1G systems easily tapped panacea due weaknesses encryption schemes Mobile phone networks destined play central role future networks They mobile broadband applications voice calls major implications air interfaces core network architecture security future networks 4G technologies faster better drawing board name LTE Long Term Evolution even 3G design deployment continues Other wireless technologies also offer broadband Internet access fixed mobile clients notably 802 16 networks common name WiMAX It entirely possible LTE WiMAX collision course hard predict happen 70 INTRODUCTION 1 5 3 Wireless LANs 802 11 Almost soon laptop computers appeared many people dream walking office magically laptop computer connected Internet Consequently various groups began working ways accomplish goal The practical approach equip office laptop computers short range radio transmitters receivers allow talk Work field rapidly led wireless LANs marketed variety companies The trouble two compatible The proliferation standards meant computer equipped brand X radio would work room equipped brand Y base station In mid 1990s industry decided wireless LAN standard might good idea IEEE committee standardized wired LANs given task drawing wireless LAN standard The first decision easiest call All LAN standards numbers like 802 1 802 2 802 3 802 10 wireless LAN standard dubbed 802 11 A common slang name WiFi important standard deserves respect call proper name 802 11 The rest harder The first problem find suitable frequency band available preferably worldwide The approach taken opposite used mobile phone networks Instead expensive licensed spectrum 802 11 systems operate unlicensed bands ISM Industrial Scientific Medical bands defined ITU R e g 902 928 MHz 2 4 2 5 GHz 5 725 5 825 GHz All devices allowed use spectrum provided limit transmit power let different devices coexist Of course means 802 11 radios may find competing cordless phones garage door openers microwave ovens 802 11 networks made clients laptops mobile phones infrastructure called APs access points installed buildings Access points sometimes called base stations The access points connect wired network communication clients goes access point It also possible clients radio range talk directly two computers office without access point This arrangement called ad hoc network It used much less often access point mode Both modes shown 802 11 transmission complicated wireless conditions vary even small changes environment At frequencies used 802 11 radio signals reflected solid objects multiple echoes transmission may reach receiver along different paths The echoes cancel reinforce causing received signal fluctuate greatly This phenomenon called multipath fading shown The key idea overcoming variable wireless conditions path diversity sending information along multiple independent paths In way SEC 1 5 EXAMPLE NETWORKS Access To wired network point b Wireless network access point b Ad hoc network information likely received even one paths happens poor due fade These independent paths typically built digital modulation scheme physical layer Options include using different frequencies across allowed band following different spatial paths different pairs antennas repeating bits different periods time Multiple paths Non faded signal Wireless transmitter Reflector Wireless receiver Faded signal Multipath fading Different versions 802 11 used techniques The initial 1997 standard defined wireless LAN ran either 1 Mbps 2 Mbps hopping frequencies spreading signal across allowed spectrum Almost immediately people complained slow work began faster standards The spread spectrum design extended became 1999 802 11b standard running rates 11 Mbps The 802 11a 1999 802 11g 2003 standards switched different modulation scheme called OFDM Orthogonal Frequency Division Multiplexing It divides wide band spectrum many narrow slices different bits sent parallel This improved scheme study Chap 2 boosted 802 11a g bit 72 INTRODUCTION rates 54 Mbps That significant increase people still wanted throughput support demanding uses The latest version 802 11n 2009 It uses wider frequency bands four antennas per computer achieve rates 450 Mbps Since wireless inherently broadcast medium 802 11 radios also deal problem multiple transmissions sent time collide may interfere reception To handle problem 802 11 uses CSMA Carrier Sense Multiple Access scheme draws ideas classic wired Ethernet ironically drew early wireless network developed Hawaii called ALOHA Computers wait short random interval transmitting defer transmissions hear someone else already transmitting This scheme makes less likely two computers send time It work well case wired networks though To see examine Suppose computer A transmitting computer B radio range A transmitter short reach computer C If C wants transmit B listen starting fact hear anything mean transmission succeed The inability C hear A starting causes collisions occur After collision sender waits another longer random delay retransmits packet Despite issues scheme works well enough practice Range A radio A Range C radio B C The range single radio may cover entire system Another problem mobility If mobile client moved away access point using range different access point way handing needed The solution 802 11 network consist multiple cells access point distribution system connects cells The distribution system often switched Ethernet use technology As clients move may find another access point better signal one currently using change association From outside entire system looks like single wired LAN SEC 1 5 EXAMPLE NETWORKS That said mobility 802 11 limited value far compared mobility mobile phone network Typically 802 11 used nomadic clients go one fixed location another rather used go Mobility really needed nomadic usage Even 802 11 mobility used extends single 802 11 network might cover large building Future schemes need provide mobility across different networks across different technologies e g 802 21 Finally problem security Since wireless transmissions broadcast easy nearby computers receive packets information intended To prevent 802 11 standard included encryption scheme known WEP Wired Equivalent Privacy The idea make wireless security like wired security It good idea unfortunately scheme flawed soon broken Borisov et al 2001 It since replaced newer schemes different cryptographic details 802 11i standard also called WiFi Protected Access initially called WPA replaced WPA2 802 11 caused revolution wireless networking set continue Beyond buildings starting installed trains planes boats automobiles people surf Internet wherever go Mobile phones manner consumer electronics game consoles digital cameras communicate We come back detail Chap 4 1 5 4 RFID Sensor Networks The networks studied far made computing devices easy recognize computers mobile phones With Radio Frequency IDentification RFID everyday objects also part computer network An RFID tag looks like postage stamp sized sticker affixed embedded object tracked The object might cow passport book shipping pallet The tag consists small microchip unique identifier antenna receives radio transmissions RFID readers installed tracking points find tags come range interrogate information shown Applications include checking identities managing supply chain timing races replacing barcodes There many kinds RFID different properties perhaps fascinating aspect RFID technology RFID tags neither electric plug battery Instead energy needed operate supplied form radio waves RFID readers This technology called passive RFID distinguish less common active RFID power source tag One common form RFID UHF RFID Ultra High Frequency RFID It used shipping pallets drivers licenses Readers send signals 74 INTRODUCTION RFID tag RFID reader RFID used network everyday objects 902 928 MHz band United States Tags communicate distances several meters changing way reflect reader signals reader able pick reflections This way operating called backscatter Another popular kind RFID HF RFID High Frequency RFID It operates 13 56 MHz likely passport credit cards books noncontact payment systems HF RFID short range typically meter less physical mechanism based induction rather backscatter There also forms RFID using frequencies LF RFID Low Frequency RFID developed HF RFID used animal tracking It kind RFID likely cat RFID readers must somehow solve problem dealing multiple tags within reading range This means tag simply respond hears reader signals multiple tags may collide The solution similar approach taken 802 11 tags wait short random interval responding identification allows reader narrow individual tags interrogate Security another problem The ability RFID readers easily track object hence person uses invasion privacy Unfortunately difficult secure RFID tags lack computation communication power run strong cryptographic algorithms Instead weak measures like passwords easily cracked used If identity card remotely read official border stop card tracked people without knowledge Not much RFID tags started identification chips rapidly turning fullfledged computers For example many tags memory updated later queried information happened tagged object stored Rieback et al 2006 demonstrated means usual problems computer malware apply cat passport might used spread RFID virus A step capability RFID sensor network Sensor networks deployed monitor aspects physical world So far mostly used scientific experimentation monitoring bird habitats volcanic activity zebra migration business applications including healthcare SEC 1 5 EXAMPLE NETWORKS monitoring equipment vibration tracking frozen refrigerated otherwise perishable goods far behind Sensor nodes small computers often size key fob temperature vibration sensors Many nodes placed environment monitored Typically batteries though may scavenge energy vibrations sun As RFID enough energy key challenge nodes must communicate carefully able deliver sensor information external collection point A common strategy nodes self organize relay messages shown This design called multihop network Wireless hop Sensor node Data collection point Multihop topology sensor network RFID sensor networks likely become much capable pervasive future Researchers already combined best technologies prototyping programmable RFID tags light movement sensors Sample et al 2008 1 6 NETWORK STANDARDIZATION Many network vendors suppliers exist ideas things done Without coordination would complete chaos users would get nothing done The way agree network standards Not good standards allow different computers communicate also increase market products adhering standards A larger market leads mass production economies scale manufacturing better implementations benefits decrease price increase acceptance In section take quick look important little known world international standardization But let us first discuss belongs 76 INTRODUCTION standard A reasonable person might assume standard tells protocol work good job implementing That person would wrong Standards define needed interoperability less That lets larger market emerge also lets companies compete basis good products For example 802 11 standard defines many transmission rates say sender use rate key factor good performance That whoever makes product Often getting interoperability way difficult since many implementation choices standards usually define many options For 802 11 many problems strategy become common practice trade group called WiFi Alliance started work interoperability within 802 11 standard Similarly protocol standard defines protocol wire service interface inside box except help explain protocol Real service interfaces often proprietary For example way TCP interfaces IP within computer matter talking remote host It matters remote host speaks TCP IP In fact TCP IP commonly implemented together without distinct interface That said good service interfaces like good APIs valuable getting protocols used best ones Berkeley sockets become popular Standards fall two categories de facto de jure De facto Latin fact standards happened without formal plan HTTP protocol Web runs started life de facto standard It part early WWW browsers developed Tim Berners Lee CERN use took growth Web Bluetooth another example It originally developed Ericsson everyone using De jure Latin law standards contrast adopted rules formal standardization body International standardization authorities generally divided two classes established treaty among national governments comprising voluntary nontreaty organizations In area computer network standards several organizations type notably ITU ISO IETF IEEE discuss In practice relationships standards companies standardization bodies complicated De facto standards often evolve de jure standards especially successful This happened case HTTP quickly picked IETF Standards bodies often ratify others standards looks like patting one another back increase market technology These days many ad hoc business alliances formed around particular technologies also play significant role developing refining network standards For example 3GPP Third Generation Partnership Project collaboration telecommunications associations drives UMTS 3G mobile phone standards SEC 1 6 NETWORK STANDARDIZATION 1 6 1 Who Who Telecommunications World The legal status world telephone companies varies considerably country country At one extreme United States 2000 separate mostly small privately owned telephone companies A added breakup AT T 1984 world largest corporation providing telephone service 80 percent America telephones Telecommunications Act 1996 overhauled regulation foster competition At extreme countries national government complete monopoly communication including mail telegraph telephone often radio television Much world falls category In cases telecommunication authority nationalized company others simply branch government usually known PTT Post Telegraph Telephone administration Worldwide trend toward liberalization competition away government monopoly Most European countries partially privatized PTTs elsewhere process still slowly gaining steam With different suppliers services clearly need provide compatibility worldwide scale ensure people computers one country call counterparts another one Actually need existed long time In 1865 representatives many European governments met form predecessor today ITU International Telecommunication Union Its job standardize international telecommunications days meant telegraphy Even clear half countries used Morse code half used code going problem When telephone put international service ITU took job standardizing telephony pronounced te LEF ony well In 1947 ITU became agency United Nations ITU 200 governmental members including almost every member United Nations Since United States PTT somebody else represent ITU This task fell State Department probably grounds ITU foreign countries State Department specialty ITU also 700 sector associate members They include telephone companies e g AT T Vodafone Sprint telecom equipment manufacturers e g Cisco Nokia Nortel computer vendors e g Microsoft Agilent Toshiba chip manufacturers e g Intel Motorola TI interested companies e g Boeing CBS VeriSign ITU three main sectors We focus primarily ITU T Telecommunications Standardization Sector concerned telephone data communication systems Before 1993 sector called CCITT acronym French name Comite Consultatif International Te le graphique et Te le phonique ITU R Radiocommunications Sector concerned 78 INTRODUCTION coordinating use competing interest groups radio frequencies worldwide The sector ITU D Development Sector It promotes development information communication technologies narrow digital divide countries effective access information technologies countries limited access ITU T task make technical recommendations telephone telegraph data communication interfaces These often become internationally recognized standards though technically recommendations suggestions governments adopt ignore wish governments like 13 year old boys take kindly given orders In practice country wishes adopt telephone standard different used rest world free price cutting everyone else This might work North Korea elsewhere would real problem The real work ITU T done Study Groups There currently 10 Study Groups often large 400 people cover topics ranging telephone billing multimedia services security SG 15 example standardizes DSL technologies popularly used connect Internet In order make possible get anything done Study Groups divided Working Parties turn divided Expert Teams turn divided ad hoc groups Once bureaucracy always bureaucracy Despite ITU T actually get things done Since inception produced 3000 recommendations many widely used practice For example Recommendation H 264 also ISO standard known MPEG 4 AVC widely used video compression X 509 public key certificates used secure Web browsing digitally signed email As field telecommunications completes transition started 1980s entirely national entirely global standards become increasingly important organizations want become involved setting For information ITU see Irmer 1994 1 6 2 Who Who International Standards World International standards produced published ISO International Standards Organization voluntary nontreaty organization founded 1946 Its members national standards organizations 157 member countries These members include ANSI U S BSI Great Britain AFNOR France DIN Germany 153 others ISO issues standards truly vast number subjects ranging nuts bolts literally telephone pole coatings mention cocoa beans ISO 2451 fishing nets ISO 1530 women underwear ISO 4416 quite For purist ISO true name International Organization Standardization SEC 1 6 NETWORK STANDARDIZATION subjects one might think subject standardization On issues telecommunication standards ISO ITU T often cooperate ISO member ITU T avoid irony two official mutually incompatible international standards Over 17 000 standards issued including OSI standards ISO 200 Technical Committees TCs numbered order creation dealing specific subject TC1 deals nuts bolts standardizing screw thread pitches JTC1 deals information technology including networks computers software It first far Joint Technical Committee created 1987 merging TC97 activities IEC yet another standardization body Each TC subcommittees SCs divided working groups WGs The real work done largely WGs 100 000 volunteers worldwide Many volunteers assigned work ISO matters employers whose products standardized Others government officials keen country way things become international standard Academic experts also active many WGs The procedure used ISO adopting standards designed achieve broad consensus possible The process begins one national standards organizations feels need international standard area A working group formed come CD Committee Draft The CD circulated member bodies get 6 months criticize If substantial majority approves revised document called DIS Draft International Standard produced circulated comments voting Based results round final text IS International Standard prepared approved published In areas great controversy CD DIS may go several versions acquiring enough votes whole process take years NIST National Institute Standards Technology part U S Department Commerce It used called National Bureau Standards It issues standards mandatory purchases made U S Government except Department Defense defines standards Another major player standards world IEEE Institute Electrical Electronics Engineers largest professional organization world In addition publishing scores journals running hundreds conferences year IEEE standardization group develops standards area electrical engineering computing IEEE 802 committee standardized many kinds LANs We study output later book The actual work done collection working groups listed The success rate various 802 working groups low 802 x number guarantee success Still impact success stories especially 802 3 802 11 industry world enormous 80 INTRODUCTION Number Topic 802 1 Overview architecture LANs 802 2 Logical link control 802 3 Ethernet 802 4 Token bus briefly used manufacturing plants 802 5 Token ring IBM entry LAN world 802 6 Dual queue dual bus early metropolitan area network 802 7 Technical advisory group broadband technologies 802 8 Technical advisory group fiber optic technologies 802 9 Isochronous LANs real time applications 802 10 Virtual LANs security 802 11 Wireless LANs WiFi 802 12 Demand priority Hewlett Packard AnyLAN 802 13 Unlucky number nobody wanted 802 14 Cable modems defunct industry consortium got first 802 15 Personal area networks Bluetooth Zigbee 802 16 Broadband wireless WiMAX 802 17 Resilient packet ring 802 18 Technical advisory group radio regulatory issues 802 19 Technical advisory group coexistence standards 802 20 Mobile broadband wireless similar 802 16e 802 21 Media independent handoff roaming technologies 802 22 Wireless regional area network The 802 working groups The important ones marked The ones marked hibernating The one marked gave disbanded 1 6 3 Who Who Internet Standards World The worldwide Internet standardization mechanisms different ITU T ISO The difference crudely summed saying people come ITU ISO standardization meetings wear suits people come Internet standardization meetings wear jeans except meet San Diego wear shorts T shirts ITU T ISO meetings populated corporate officials government civil servants standardization job They regard standardization Good Thing devote lives Internet people hand prefer anarchy matter principle However hundreds millions SEC 1 6 NETWORK STANDARDIZATION people thing little communication occur Thus standards however regrettable sometimes needed In context David Clark M I T made famous remark Internet standardization consisting rough consensus running code When ARPANET set DoD created informal committee oversee In 1983 committee renamed IAB Internet Activities Board given slighter broader mission namely keep researchers involved ARPANET Internet pointed less direction activity unlike herding cats The meaning acronym IAB later changed Internet Architecture Board Each approximately ten members IAB headed task force issue importance The IAB met several times year discuss results give feedback DoD NSF providing funding time When standard needed e g new routing algorithm IAB members would thrash announce change graduate students heart software effort could implement Communication done series technical reports called RFCs Request For Comments RFCs stored online fetched anyone interested www ietf org rfc They numbered chronological order creation Over 5000 exist We refer many RFCs book By 1989 Internet grown large highly informal style longer worked Many vendors offered TCP IP products want change ten researchers thought better idea In summer 1989 IAB reorganized The researchers moved IRTF Internet Research Task Force made subsidiary IAB along IETF Internet Engineering Task Force The IAB repopulated people representing broader range organizations research community It initially self perpetuating group members serving 2 year term new members appointed old ones Later Internet Society created populated people interested Internet The Internet Society thus sense comparable ACM IEEE It governed elected trustees appoint IAB members The idea split IRTF concentrate long term research IETF dealt short term engineering issues The IETF divided working groups specific problem solve The chairmen working groups initially met steering committee direct engineering effort The working group topics include new applications user information OSI integration routing addressing security network management standards Eventually many working groups formed 70 grouped areas area chairmen met steering committee In addition formal standardization process adopted patterned ISOs To become Proposed Standard basic idea must explained RFC sufficient interest community warrant consideration 82 INTRODUCTION To advance Draft Standard stage working implementation must rigorously tested least two independent sites least 4 months If IAB convinced idea sound software works declare RFC Internet Standard Some Internet Standards become DoD standards MIL STD making mandatory DoD suppliers For Web standards World Wide Web Consortium W3C develops protocols guidelines facilitate long term growth Web It industry consortium led Tim Berners Lee set 1994 Web really begun take W3C 300 members around world produced 100 W3C Recommendations standards called covering topics HTML Web privacy 1 7 METRIC UNITS To avoid confusion worth stating explicitly book computer science general metric units used instead traditional English units furlong stone fortnight system The principal metric prefixes listed The prefixes typically abbreviated first letters units greater 1 capitalized KB MB etc One exception historical reasons kbps kilobits sec Thus 1 Mbps communication line transmits 106 bits sec 100 psec 100 ps clock ticks every 10 10 seconds Since milli micro begin letter choice made Normally used milli Greek letter mu used micro Exp 3 10 6 9 Explicit Prefix Exp 0 001 milli Explicit Prefix 1 000 0 000001 micro 1 000 000 1 000 000 000 Giga 1 000 000 000 000 Tera Kilo Mega 0 000000001 nano 10 12 0 000000000001 pico 10 15 0 000000000000001 femto 1 000 000 000 000 000 Peta 10 18 0 0000000000000000001 atto 1 000 000 000 000 000 000 Exa 21 10 24 1 000 000 000 000 000 000 000 Zetta 1 000 000 000 000 000 000 000 000 Yotta 0 0000000000000000000001 zepto 0 0000000000000000000000001 yocto The principal metric prefixes It also worth pointing measuring memory disk file database sizes common industry practice units slightly different meanings There kilo means 210 1024 rather 103 1000 memories always power two Thus 1 KB memory contains 1024 bytes 1000 bytes Note also capital B usage mean bytes units eight SEC 1 7 METRIC UNITS bits instead lowercase b means bits Similarly 1 MB memory contains 220 1 048 576 bytes 1 GB memory contains 230 1 073 741 824 bytes 1 TB database contains 240 1 099 511 627 776 bytes However 1 kbps communication line transmits 1000 bits per second 10 Mbps LAN runs 10 000 000 bits sec speeds powers two Unfortunately many people tend mix two systems especially disk sizes To avoid ambiguity book use symbols KB MB GB TB 210 220 230 240 bytes respectively symbols kbps Mbps Gbps Tbps 103 106 109 1012 bits sec respectively 1 8 OUTLINE OF THE REST OF THE BOOK This book discusses principles practice computer networking Most chapters start discussion relevant principles followed number examples illustrate principles These examples usually taken Internet wireless networks mobile phone network since important different Other examples given relevant The book structured according hybrid model Starting Chap 2 begin working way protocol hierarchy beginning bottom We provide background field data communication covers wired wireless transmission systems This material concerned deliver information physical channels although cover architectural rather hardware aspects Several examples physical layer public switched telephone network mobile telephone network cable television network also discussed Chapters 3 4 discuss data link layer two parts Chap 3 looks problem send packets across link including error detection correction We look DSL used broadband Internet access phone lines real world example data link protocol In Chap 4 examine medium access sublayer This part data link layer deals share channel multiple computers The examples look include wireless 802 11 RFID wired LANs classic Ethernet Link layer switches connect LANs switched Ethernet also discussed Chapter 5 deals network layer especially routing Many routing algorithms static dynamic covered Even good routing algorithms though traffic offered network handle packets delayed discarded We discuss issue prevent congestion guarantee certain quality service Connecting heterogeneous networks form internetworks also leads numerous problems discussed The network layer Internet given extensive coverage 84 INTRODUCTION Chapter 6 deals transport layer Much emphasis connection oriented protocols reliability since many applications need Both Internet transport protocols UDP TCP covered detail performance issues Chapter 7 deals application layer protocols applications The first topic DNS Internet telephone book Next comes email including discussion protocols Then move Web detailed discussions static dynamic content happens client server sides We follow look networked multimedia including streaming audio video Finally discuss content delivery networks including peer peer technology Chapter 8 network security This topic aspects relate layers easiest treat layers thoroughly explained The chapter starts introduction cryptography Later shows cryptography used secure communication email Web The chapter ends discussion areas security collides privacy freedom speech censorship social issues Chapter 9 contains annotated list suggested readings arranged chapter It intended help readers would like pursue study networking The chapter also alphabetical bibliography references cited book The authors Web site Pearson http www pearsonhighered com tanenbaum page links many tutorials FAQs companies industry consortia professional organizations standards organizations technologies papers 1 9 SUMMARY Computer networks many uses companies individuals home move Companies use networks computers share corporate information typically using client server model employee desktops acting clients accessing powerful servers machine room For individuals networks offer access variety information entertainment resources well way buy sell products services Individuals often access Internet via phone cable providers home though increasingly wireless access used laptops phones Technology advances enabling new kinds mobile applications networks computers embedded appliances consumer devices The advances raise social issues privacy concerns Roughly speaking networks divided LANs MANs WANs internetworks LANs typical cover building operate high speeds MANs SEC 1 9 SUMMARY usually cover city An example cable television system used many people access Internet WANs may cover country continent Some technologies used build networks point point e g cable others broadcast e g wireless Networks interconnected routers form internetworks Internet largest best known example Wireless networks example 802 11 LANs 3G mobile telephony also becoming extremely popular Network software built around protocols rules processes communicate Most networks support protocol hierarchies layer providing services layer insulating details protocols used lower layers Protocol stacks typically based either OSI model TCP IP model Both link network transport application layers differ layers Design issues include reliability resource allocation growth security Much book deals protocols design Networks provide various services users These services range connectionless best efforts packet delivery connection oriented guaranteed delivery In networks connectionless service provided one layer connection oriented service provided layer Well known networks include Internet 3G mobile telephone network 802 11 LANs The Internet evolved ARPANET networks added form internetwork The present day Internet actually collection many thousands networks use TCP IP protocol stack The 3G mobile telephone network provides wireless mobile access Internet speeds multiple Mbps course carries voice calls well Wireless LANs based IEEE 802 11 standard deployed many homes cafes provide connectivity rates excess 100 Mbps New kinds networks emerging embedded sensor networks networks based RFID technology Enabling multiple computers talk requires large amount standardization hardware software Organizations ITU T ISO IEEE IAB manage different parts standardization process PROBLEMS 1 Imagine trained St Bernard Bernie carry box three 8 mm tapes instead flask brandy When disk fills consider emergency These tapes contain 7 gigabytes The dog travel side wherever may 18 km hour For range distances Bernie higher data rate transmission line whose data rate excluding overhead 150 Mbps How answer change Bernie speed doubled ii tape capacity doubled iii data rate transmission line doubled 86 INTRODUCTION 2 An alternative LAN simply big timesharing system terminals users Give two advantages client server system using LAN 3 The performance client server system strongly influenced two major network characteristics bandwidth network many bits sec transport latency many seconds takes first bit get client server Give example network exhibits high bandwidth also high latency Then give example one low bandwidth low latency 4 Besides bandwidth latency parameter needed give good characterization quality service offered network used digitized voice traffic ii video traffic iii financial transaction traffic 5 A factor delay store forward packet switching system long takes store forward packet switch If switching time 10 sec likely major factor response client server system client New York server California Assume propagation speed copper fiber 2 3 speed light vacuum 6 A client server system uses satellite network satellite height 40 000 km What best case delay response request 7 In future everyone home terminal connected computer network instant public referendums important pending legislation become possible Ultimately existing legislatures could eliminated let people expressed directly The positive aspects direct democracy fairly obvious discuss negative aspects 8 Five routers connected point point subnet Between pair routers designers may put high speed line medium speed line low speed line line If takes 100 ms computer time generate inspect topology long take inspect 9 A disadvantage broadcast subnet capacity wasted multiple hosts attempt access channel time As simplistic example suppose time divided discrete slots n hosts attempting use channel probability p slot What fraction slots wasted due collisions 10 What two reasons using layered protocols What one possible disadvantage using layered protocols 11 The president Specialty Paint Corp gets idea work local beer brewer produce invisible beer anti litter measure The president tells legal department look turn ask engineering help As result chief engineer calls counterpart brewery discuss technical aspects project The engineers report back respective legal departments confer telephone arrange legal aspects Finally two corporate presidents discuss financial side deal What principle multilayer protocol sense OSI model communication mechanism violate CHAP 1 PROBLEMS 12 Two networks provide reliable connection oriented service One offers reliable byte stream offers reliable message stream Are identical If distinction made If give example differ 13 What negotiation mean discussing network protocols Give example 14 In service shown Are services implicit figure If If 15 In networks data link layer handles transmission errors requesting damaged frames retransmitted If probability frame damaged p mean number transmissions required send frame Assume acknowledgements never lost 16 A system n layer protocol hierarchy Applications generate messages length M bytes At layers h byte header added What fraction network bandwidth filled headers 17 What main difference TCP UDP 18 The subnet b designed withstand nuclear war How many bombs would take partition nodes two disconnected sets Assume bomb wipes node links connected 19 The Internet roughly doubling size every 18 months Although one really knows sure one estimate put number hosts 600 million 2009 Use data compute expected number Internet hosts year 2018 Do believe Explain 20 When file transferred two computers two acknowledgement strategies possible In first one file chopped packets individually acknowledged receiver file transfer whole acknowledged In second one packets acknowledged individually entire file acknowledged arrives Discuss two approaches 21 Mobile phone network operators need know subscribers mobile phones hence users located Explain bad users Now give reasons good users 22 How long bit original 802 3 standard meters Use transmission speed 10 Mbps assume propagation speed coax 2 3 speed light vacuum 23 An image 1600 1200 pixels 3 bytes pixel Assume image uncompressed How long take transmit 56 kbps modem channel Over 1 Mbps cable modem Over 10 Mbps Ethernet Over 100 Mbps Ethernet Over gigabit Ethernet 24 Ethernet wireless networks similarities differences One property Ethernet one frame time transmitted Ethernet Does 802 11 share property Ethernet Discuss answer 25 List two advantages two disadvantages international standards network protocols 88 INTRODUCTION 26 When system permanent part removable part CD ROM drive CD ROM important system standardized different companies make permanent removable parts everything still works together Give three examples outside computer industry international standards exist Now give three areas outside computer industry exist 27 Suppose algorithms used implement operations layer k changed How impact operations layers k 1 k 1 28 Suppose change service set operations provided layer k How impact services layers k 1 k 1 29 Provide list reasons response time client may larger best case delay 30 What disadvantages using small fixed length cells ATM 31 Make list activities every day computer networks used How would life altered networks suddenly switched 32 Find networks used school place work Describe network types topologies switching methods used 33 The ping program allows send test packet given location see long takes get back Try using ping see long takes get location several known locations From data plot one way transit time Internet function distance It best use universities since location servers known accurately For example berkeley edu Berkeley California mit edu Cambridge Massachusetts vu nl Amsterdam The Netherlands www usyd edu au Sydney Australia www uct ac za Cape Town South Africa 34 Go IETF Web site www ietf org see Pick project like write half page report problem proposed solution 35 The Internet made large number networks Their arrangement determines topology Internet A considerable amount information Internet topology available line Use search engine find Internet topology write short report summarizing findings 36 Search Internet find important peering points used routing packets Internet present 37 Write program implements message flow top layer bottom layer 7 layer protocol model Your program include separate protocol function layer Protocol headers sequence 64 characters Each protocol function two parameters message passed higher layer protocol char buffer size message This function attaches header front message prints new message standard output invokes protocol function lower layer protocol Program input application message sequence 80 characters less 2 THE PHYSICAL LAYER In chapter look lowest layer protocol model physical layer It defines electrical timing interfaces bits sent signals channels The physical layer foundation network built The properties different kinds physical channels determine performance e g throughput latency error rate good place start journey networkland We begin theoretical analysis data transmission discover Mother Parent Nature puts limits sent channel Then cover three kinds transmission media guided copper wire fiber optics wireless terrestrial radio satellite Each technologies different properties affect design performance networks use This material provide background information key transmission technologies used modern networks Next comes digital modulation analog signals converted digital bits back After look multiplexing schemes exploring multiple conversations put transmission medium time without interfering one another Finally look three examples communication systems used practice wide area computer networks fixed telephone system mobile phone system cable television system Each important practice devote fair amount space one 90 THE PHYSICAL LAYER 2 1 THE THEORETICAL BASIS FOR DATA COMMUNICATION Information transmitted wires varying physical property voltage current By representing value voltage current single valued function time f model behavior signal analyze mathematically This analysis subject following sections 2 1 1 Fourier Analysis In early 19th century French mathematician Jean Baptiste Fourier proved reasonably behaved periodic function g period T constructed sum possibly infinite number sines cosines g c sin 2 nft bn cos 2 nft n 1 n 1 2 1 f 1 T fundamental frequency bn sine cosine amplitudes nth harmonics terms c constant Such decomposition called Fourier series From Fourier series function reconstructed That period T known amplitudes given original function time found performing sums Eq 2 1 A data signal finite duration handled imagining repeats entire pattern forever e interval T 2T 0 T etc The amplitudes computed given g multiplying sides Eq 2 1 sin 2 kft integrating 0 T Since T 0 k n sin 2 kft sin 2 nft dt T 2 k n one term summation survives The bn summation vanishes completely Similarly multiplying Eq 2 1 cos 2 kft integrating 0 T derive bn By integrating sides equation stands find c The results performing operations follows T g sin 2 nft dt T0 T T bn g cos 2 nft dt T0 c g dt T0 2 1 2 Bandwidth Limited Signals The relevance data communication real channels affect different frequency signals differently Let us consider specific example transmission ASCII character b encoded 8 bit byte The bit pattern transmitted 01100010 The left hand part shows SEC 2 1 THE THEORETICAL BASIS FOR DATA COMMUNICATION voltage output transmitting computer The Fourier analysis signal yields coefficients cos n 4 cos 3 n 4 cos 6 n 4 cos 7 n 4 n bn sin 3 n 4 sin n 4 sin 7 n 4 sin 6 n 4 n c 3 4 The root mean square amplitudes 2n b 2n first terms shown right hand side These values interest squares proportional energy transmitted corresponding frequency No transmission facility transmit signals without losing power process If Fourier components equally diminished resulting signal would reduced amplitude distorted e would nice squared shape Unfortunately transmission facilities diminish different Fourier components different amounts thus introducing distortion Usually wire amplitudes transmitted mostly undiminished 0 frequency fc measured cycles sec Hertz Hz frequencies cutoff frequency attenuated The width frequency range transmitted without strongly attenuated called bandwidth In practice cutoff really sharp often quoted bandwidth 0 frequency received power fallen half The bandwidth physical property transmission medium depends example construction thickness length wire fiber Filters often used limit bandwidth signal 802 11 wireless channels allowed use roughly 20 MHz example 802 11 radios filter signal bandwidth size As another example traditional analog television channels occupy 6 MHz wire air This filtering lets signals share given region spectrum improves overall efficiency system It means frequency range signals start zero matter The bandwidth still width band frequencies passed information carried depends width starting ending frequencies Signals run 0 maximum frequency called baseband signals Signals shifted occupy higher range frequencies case wireless transmissions called passband signals Now let us consider signal would look bandwidth low lowest frequencies transmitted e function approximated first terms Eq 2 1 b shows signal results channel allows first harmonic 92 Time rms amplitude THE PHYSICAL LAYER T 0 50 0 25 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Harmonic number 1 harmonic b 2 harmonics 1 2 c 4 harmonics 1 2 3 4 8 harmonics 1 2 3 4 5 6 7 8 Harmonic number Time e A binary signal root mean square Fourier amplitudes b e Successive approximations original signal SEC 2 1 THE THEORETICAL BASIS FOR DATA COMMUNICATION fundamental f pass Similarly c e show spectra reconstructed functions higher bandwidth channels For digital transmission goal receive signal enough fidelity reconstruct sequence bits sent We already easily e wasteful use harmonics receive accurate replica Given bit rate b bits sec time required send 8 bits example 1 bit time 8 b sec frequency first harmonic signal b 8 Hz An ordinary telephone line often called voice grade line artificially introduced cutoff frequency 3000 Hz The presence restriction means number highest harmonic passed roughly 3000 b 8 24 000 b cutoff sharp For data rates numbers work shown From numbers clear trying send 9600 bps voice grade telephone line transform something looking like c making accurate reception original binary bit stream tricky It obvious data rates much higher 38 4 kbps hope binary signals even transmission facility completely noiseless In words limiting bandwidth limits data rate even perfect channels However coding schemes make use several voltage levels exist achieve higher data rates We discuss later chapter Bps T msec First harmonic Hz Harmonics sent 26 67 37 5 13 33 6 67 3 33 1 67 0 83 0 42 0 21 Relation data rate harmonics example There much confusion bandwidth means different things electrical engineers computer scientists To electrical engineers analog bandwidth described quantity measured Hz To computer scientists digital bandwidth maximum data rate channel quantity measured bits sec That data rate end result using analog bandwidth physical channel digital transmission two related discuss next In book clear context whether mean analog bandwidth Hz digital bandwidth bits sec 94 THE PHYSICAL LAYER 2 1 3 The Maximum Data Rate Channel As early 1924 AT T engineer Henry Nyquist realized even perfect channel finite transmission capacity He derived equation expressing maximum data rate finite bandwidth noiseless channel In 1948 Claude Shannon carried Nyquist work extended case channel subject random thermodynamic noise Shannon 1948 This paper important paper information theory We briefly summarize classical results Nyquist proved arbitrary signal run low pass filter bandwidth B filtered signal completely reconstructed making 2B exact samples per second Sampling line faster 2B times per second pointless higher frequency components sampling could recover already filtered If signal consists V discrete levels Nyquist theorem states maximum data rate 2B log2 V bits sec 2 2 For example noiseless 3 kHz channel transmit binary e two level signals rate exceeding 6000 bps So far considered noiseless channels If random noise present situation deteriorates rapidly And always random thermal noise present due motion molecules system The amount thermal noise present measured ratio signal power noise power called SNR Signal Noise Ratio If denote signal power S noise power N signal noise ratio S N Usually ratio expressed log scale quantity 10 log10 S N vary tremendous range The units log scale called decibels dB deci meaning 10 bel chosen honor Alexander Graham Bell invented telephone An S N ratio 10 10 dB ratio 100 20 dB ratio 1000 30 dB The manufacturers stereo amplifiers often characterize bandwidth frequency range products linear giving 3dB frequency end These points amplification factor approximately halved 10 log10 0 5 3 Shannon major result maximum data rate capacity noisy channel whose bandwidth B Hz whose signal noise ratio S N given maximum number bits sec B log2 1 S N 2 3 This tells us best capacities real channels For example ADSL Asymmetric Digital Subscriber Line provides Internet access normal telephone lines uses bandwidth around 1 MHz The SNR depends strongly distance home telephone exchange SNR around 40 dB short lines 1 2 km good With characteristics SEC 2 1 THE THEORETICAL BASIS FOR DATA COMMUNICATION channel never transmit much 13 Mbps matter many signal levels used matter often infrequently samples taken In practice ADSL specified 12 Mbps though users often see lower rates This data rate actually good 60 years communications techniques greatly reduced gap Shannon capacity capacity real systems Shannon result derived information theory arguments applies channel subject thermal noise Counterexamples treated category perpetual motion machines For ADSL exceed 13 Mbps must either improve SNR example inserting digital repeaters lines closer customers use bandwidth done evolution ASDL2 2 2 GUIDED TRANSMISSION MEDIA The purpose physical layer transport bits one machine another Various physical media used actual transmission Each one niche terms bandwidth delay cost ease installation maintenance Media roughly grouped guided media copper wire fiber optics unguided media terrestrial wireless satellite lasers air We look guided media section unguided media next sections 2 2 1 Magnetic Media One common ways transport data one computer another write onto magnetic tape removable media e g recordable DVDs physically transport tape disks destination machine read back Although method sophisticated using geosynchronous communication satellite often cost effective especially applications high bandwidth cost per bit transported key factor A simple calculation make point clear An industry standard Ultrium tape hold 800 gigabytes A box 60 60 60 cm hold 1000 tapes total capacity 800 terabytes 6400 terabits 6 4 petabits A box tapes delivered anywhere United States 24 hours Federal Express companies The effective bandwidth transmission 6400 terabits 86 400 sec bit 70 Gbps If destination hour away road bandwidth increased 1700 Gbps No computer network even approach Of course networks getting faster tape densities increasing If look cost get similar picture The cost Ultrium tape around 40 bought bulk A tape reused least 10 times 96 THE PHYSICAL LAYER tape cost maybe 4000 per box per usage Add another 1000 shipping probably much less cost roughly 5000 ship 800 TB This amounts shipping gigabyte little half cent No network beat The moral story Never underestimate bandwidth station wagon full tapes hurtling highway 2 2 2 Twisted Pairs Although bandwidth characteristics magnetic tape excellent delay characteristics poor Transmission time measured minutes hours milliseconds For many applications online connection needed One oldest still common transmission media twisted pair A twisted pair consists two insulated copper wires typically 1 mm thick The wires twisted together helical form like DNA molecule Twisting done two parallel wires constitute fine antenna When wires twisted waves different twists cancel wire radiates less effectively A signal usually carried difference voltage two wires pair This provides better immunity external noise noise tends affect wires leaving differential unchanged The common application twisted pair telephone system Nearly telephones connected telephone company telco office twisted pair Both telephone calls ADSL Internet access run lines Twisted pairs run several kilometers without amplification longer distances signal becomes attenuated repeaters needed When many twisted pairs run parallel substantial distance wires coming apartment building telephone company office bundled together encased protective sheath The pairs bundles would interfere one another twisting In parts world telephone lines run poles ground common see bundles several centimeters diameter Twisted pairs used transmitting either analog digital information The bandwidth depends thickness wire distance traveled several megabits sec achieved kilometers many cases Due adequate performance low cost twisted pairs widely used likely remain years come Twisted pair cabling comes several varieties The garden variety deployed many office buildings called Category 5 cabling Cat 5 A category 5 twisted pair consists two insulated wires gently twisted together Four pairs typically grouped plastic sheath protect wires keep together This arrangement shown Different LAN standards may use twisted pairs differently For example 100 Mbps Ethernet uses two four pairs one pair direction SEC 2 2 GUIDED TRANSMISSION MEDIA Twisted pair Category 5 UTP cable four twisted pairs To reach higher speeds 1 Gbps Ethernet uses four pairs directions simultaneously requires receiver factor signal transmitted locally Some general terminology order Links used directions time like two lane road called full duplex links In contrast links used either direction one way time like single track railroad line called half duplex links A third category consists links allow traffic one direction like one way street They called simplex links Returning twisted pair Cat 5 replaced earlier Category 3 cables similar cable uses connector twists per meter More twists result less crosstalk better quality signal longer distances making cables suitable high speed computer communication especially 100 Mbps 1 Gbps Ethernet LANs New wiring likely Category 6 even Category 7 These categories stringent specifications handle signals greater bandwidths Some cables Category 6 rated signals 500 MHz support 10 Gbps links soon deployed Through Category 6 wiring types referred UTP Unshielded Twisted Pair consist simply wires insulators In contrast Category 7 cables shielding individual twisted pairs well around entire cable inside plastic protective sheath Shielding reduces susceptibility external interference crosstalk nearby cables meet demanding performance specifications The cables reminiscent high quality bulky expensive shielded twisted pair cables IBM introduced early 1980s prove popular outside IBM installations Evidently time try 2 2 3 Coaxial Cable Another common transmission medium coaxial cable known many friends coax pronounced co ax It better shielding greater bandwidth unshielded twisted pairs span longer distances 98 THE PHYSICAL LAYER higher speeds Two kinds coaxial cable widely used One kind 50 ohm cable commonly used intended digital transmission start The kind 75 ohm cable commonly used analog transmission cable television This distinction based historical rather technical factors e g early dipole antennas impedance 300 ohms easy use existing 4 1 impedance matching transformers Starting mid1990s cable TV operators began provide Internet access cable made 75 ohm cable important data communication A coaxial cable consists stiff copper wire core surrounded insulating material The insulator encased cylindrical conductor often closely woven braided mesh The outer conductor covered protective plastic sheath A cutaway view coaxial cable shown Copper core Insulating material Braided outer conductor Protective plastic covering A coaxial cable The construction shielding coaxial cable give good combination high bandwidth excellent noise immunity The bandwidth possible depends cable quality length Modern cables bandwidth GHz Coaxial cables used widely used within telephone system long distance lines largely replaced fiber optics longhaul routes Coax still widely used cable television metropolitan area networks however 2 2 4 Power Lines The telephone cable television networks sources wiring reused data communication There yet common kind wiring electrical power lines Power lines deliver electrical power houses electrical wiring within houses distributes power electrical outlets The use power lines data communication old idea Power lines used electricity companies low rate communication remote metering many years well home control devices e g X10 standard In recent years renewed interest high rate communication lines inside home LAN outside home SEC 2 2 GUIDED TRANSMISSION MEDIA broadband Internet access We concentrate common scenario using electrical wires inside home The convenience using power lines networking clear Simply plug TV receiver wall must anyway need power send receive movies electrical wiring This configuration shown There plug radio The data signal superimposed low frequency power signal active hot wire signals use wiring time Electric cable Data signal Power signal A network uses household electrical wiring The difficulty using household electrical wiring network designed distribute power signals This task quite different distributing data signals household wiring horrible job Electrical signals sent 50 60 Hz wiring attenuates much higher frequency MHz signals needed high rate data communication The electrical properties wiring vary one house next change appliances turned causes data signals bounce around wiring Transient currents appliances switch create electrical noise wide range frequencies And without careful twisting twisted pairs electrical wiring acts fine antenna picking external signals radiating signals This behavior means meet regulatory requirements data signal must exclude licensed frequencies amateur radio bands Despite difficulties practical send least 100 Mbps typical household electrical wiring using communication schemes resist impaired frequencies bursts errors Many products use various proprietary standards power line networking international standards actively development 2 2 5 Fiber Optics Many people computer industry take enormous pride fast computer technology improving follows Moore law predicts doubling number transistors per chip roughly every two years Schaller 100 THE PHYSICAL LAYER 1997 The original 1981 IBM PC ran clock speed 4 77 MHz Twentyeight years later PCs could run four core CPU 3 GHz This increase gain factor around 2500 16 per decade Impressive In period wide area communication links went 45 Mbps T3 line telephone system 100 Gbps modern long distance line This gain similarly impressive factor 2000 close 16 per decade time error rate went 10 5 per bit almost zero Furthermore single CPUs beginning approach physical limits number CPUs increased per chip In contrast achievable bandwidth fiber technology excess 50 000 Gbps 50 Tbps nowhere near reaching limits The current practical limit around 100 Gbps due inability convert electrical optical signals faster To build higher capacity links many channels simply carried parallel single fiber In section study fiber optics learn transmission technology works In ongoing race computing communication communication may yet win fiber optic networks The implication would essentially infinite bandwidth new conventional wisdom computers hopelessly slow networks try avoid computation costs matter much bandwidth wastes This change take sink generation computer scientists engineers taught think terms low Shannon limits imposed copper Of course scenario tell whole story include cost The cost install fiber last mile reach consumers bypass low bandwidth wires limited availability spectrum tremendous It also costs energy move bits compute We may always islands inequities either computation communication essentially free For example edge Internet throw computation storage problem compressing caching content make better use Internet access links Within Internet may reverse companies Google moving huge amounts data across network cheaper store compute Fiber optics used long haul transmission network backbones highspeed LANs although far copper always managed catch eventually high speed Internet access FttH Fiber Home An optical transmission system three key components light source transmission medium detector Conventionally pulse light indicates 1 bit absence light indicates 0 bit The transmission medium ultra thin fiber glass The detector generates electrical pulse light falls By attaching light source one end optical fiber detector unidirectional data transmission system accepts electrical signal converts transmits light pulses reconverts output electrical signal receiving end SEC 2 2 GUIDED TRANSMISSION MEDIA This transmission system would leak light useless practice interesting principle physics When light ray passes one medium another example fused silica air ray refracted bent silica air boundary shown Here see light ray incident boundary angle 1 emerging angle 1 The amount refraction depends properties two media particular indices refraction For angles incidence certain critical value light refracted back silica none escapes air Thus light ray incident critical angle trapped inside fiber shown b propagate many kilometers virtually loss Air silica boundary Air 1 1 2 2 Silica Total internal reflection 3 3 Light source b Three examples light ray inside silica fiber impinging air silica boundary different angles b Light trapped total internal reflection The sketch b shows one trapped ray since light ray incident boundary critical angle reflected internally many different rays bouncing around different angles Each ray said different mode fiber property called multimode fiber However fiber diameter reduced wavelengths light fiber acts like wave guide light propagate straight line without bouncing yielding single mode fiber Single mode fibers expensive widely used longer distances Currently available single mode fibers transmit data 100 Gbps 100 km without amplification Even higher data rates achieved laboratory shorter distances Transmission Light Through Fiber Optical fibers made glass turn made sand inexpensive raw material available unlimited amounts Glassmaking known ancient Egyptians glass 1 mm thick 102 THE PHYSICAL LAYER light could shine Glass transparent enough useful windows developed Renaissance The glass used modern optical fibers transparent oceans full instead water seabed would visible surface ground airplane clear day The attenuation light glass depends wavelength light well physical properties glass It defined ratio input output signal power For kind glass used fibers attenuation shown units decibels per linear kilometer fiber For example factor two loss signal power gives attenuation 10 log10 2 3 dB The figure shows near infrared part spectrum used practice Visible light slightly shorter wavelengths 0 4 0 7 microns 1 micron 10 6 meters The true metric purist would refer wavelengths 400 nm 700 nm stick traditional usage 2 0 0 85 Band 1 30 Band 1 55 Band Attenuation dB km 1 8 1 6 1 4 1 2 1 0 0 8 0 6 0 4 0 2 0 8 0 9 1 0 1 1 1 2 1 3 1 4 Wavelength microns 1 5 1 6 1 7 1 8 Attenuation light fiber infrared region Three wavelength bands commonly used present optical communication They centered 0 85 1 30 1 55 microns respectively All three bands 25 000 30 000 GHz wide The 0 85 micron band used first It higher attenuation used shorter distances wavelength lasers electronics could made material gallium arsenide The last two bands good attenuation properties less 5 loss per kilometer The 1 55 micron band widely used erbium doped amplifiers work directly optical domain SEC 2 2 GUIDED TRANSMISSION MEDIA Light pulses sent fiber spread length propagate This spreading called chromatic dispersion The amount wavelength dependent One way keep spread pulses overlapping increase distance done reducing signaling rate Fortunately discovered making pulses special shape related reciprocal hyperbolic cosine causes nearly dispersion effects cancel possible send pulses thousands kilometers without appreciable shape distortion These pulses called solitons A considerable amount research going take solitons lab field Fiber Cables Fiber optic cables similar coax except without braid shows single fiber viewed side At center glass core light propagates In multimode fibers core typically 50 microns diameter thickness human hair In single mode fibers core 8 10 microns Sheath Jacket Core Cladding Core glass Cladding glass Jacket plastic b Side view single fiber b End view sheath three fibers The core surrounded glass cladding lower index refraction core keep light core Next comes thin plastic jacket protect cladding Fibers typically grouped bundles protected outer sheath b shows sheath three fibers Terrestrial fiber sheaths normally laid ground within meter surface occasionally subject attacks backhoes gophers Near shore transoceanic fiber sheaths buried trenches kind seaplow In deep water lie bottom snagged fishing trawlers attacked giant squid Fibers connected three different ways First terminate connectors plugged fiber sockets Connectors lose 10 20 light make easy reconfigure systems Second spliced mechanically Mechanical splices lay two carefully cut ends next special sleeve clamp 104 THE PHYSICAL LAYER place Alignment improved passing light junction making small adjustments maximize signal Mechanical splices take trained personnel 5 minutes result 10 light loss Third two pieces fiber fused melted form solid connection A fusion splice almost good single drawn fiber even small amount attenuation occurs For three kinds splices reflections occur point splice reflected energy interfere signal Two kinds light sources typically used signaling These LEDs Light Emitting Diodes semiconductor lasers They different properties shown They tuned wavelength inserting Fabry Perot Mach Zehnder interferometers source fiber Fabry Perot interferometers simple resonant cavities consisting two parallel mirrors The light incident perpendicular mirrors The length cavity selects wavelengths fit inside integral number times Mach Zehnder interferometers separate light two beams The two beams travel slightly different distances They recombined end phase certain wavelengths Item Data rate LED Low Semiconductor laser High Fiber type Multi mode Multi mode single mode Distance Short Long Lifetime Long life Short life Temperature sensitivity Minor Substantial Cost Low cost Expensive A comparison semiconductor diodes LEDs light sources The receiving end optical fiber consists photodiode gives electrical pulse struck light The response time photodiodes convert signal optical electrical domain limits data rates 100 Gbps Thermal noise also issue pulse light must carry enough energy detected By making pulses powerful enough error rate made arbitrarily small Comparison Fiber Optics Copper Wire It instructive compare fiber copper Fiber many advantages To start handle much higher bandwidths copper This alone would require use high end networks Due low attenuation repeaters needed every 50 km long lines versus every 5 km copper SEC 2 2 GUIDED TRANSMISSION MEDIA resulting big cost saving Fiber also advantage affected power surges electromagnetic interference power failures Nor affected corrosive chemicals air important harsh factory environments Oddly enough telephone companies like fiber different reason thin lightweight Many existing cable ducts completely full room add new capacity Removing copper replacing fiber empties ducts copper excellent resale value copper refiners see high grade ore Also fiber much lighter copper One thousand twisted pairs 1 km long weigh 8000 kg Two fibers capacity weigh 100 kg reduces need expensive mechanical support systems must maintained For new routes fiber wins hands due much lower installation cost Finally fibers leak light difficult tap These properties give fiber good security potential wiretappers On downside fiber less familiar technology requiring skills engineers fibers damaged easily bent much Since optical transmission inherently unidirectional two way communication requires either two fibers two frequency bands one fiber Finally fiber interfaces cost electrical interfaces Nevertheless future fixed data communication short distances clearly fiber For discussion aspects fiber optics networks see Hecht 2005 2 3 WIRELESS TRANSMISSION Our age given rise information junkies people need online time For mobile users twisted pair coax fiber optics use They need get hits data laptop notebook shirt pocket palmtop wristwatch computers without tethered terrestrial communication infrastructure For users wireless communication answer In following sections look wireless communication general It many important applications besides providing connectivity users want surf Web beach Wireless advantages even fixed devices circumstances For example running fiber building difficult due terrain mountains jungles swamps etc wireless may better It noteworthy modern wireless digital communication began Hawaiian Islands large chunks Pacific Ocean separated users computer center telephone system inadequate 2 3 1 The Electromagnetic Spectrum When electrons move create electromagnetic waves propagate space even vacuum These waves predicted British physicist James Clerk Maxwell 1865 first observed German 106 THE PHYSICAL LAYER physicist Heinrich Hertz 1887 The number oscillations per second wave called frequency f measured Hz honor Heinrich Hertz The distance two consecutive maxima minima called wavelength universally designated Greek letter lambda When antenna appropriate size attached electrical circuit electromagnetic waves broadcast efficiently received receiver distance away All wireless communication based principle In vacuum electromagnetic waves travel speed matter frequency This speed usually called speed light c approximately 3 108 sec 1 foot 30 cm per nanosecond A case could made redefining foot distance light travels vacuum 1 nsec rather basing shoe size long dead king In copper fiber speed slows 2 3 value becomes slightly frequency dependent The speed light ultimate speed limit No object signal ever move faster The fundamental relation f c vacuum f c 2 4 Since c constant know f find vice versa As rule thumb meters f MHz f 300 For example 100 MHz waves 3 meters long 1000 MHz waves 0 3 meters long 0 1meter waves frequency 3000 MHz The electromagnetic spectrum shown The radio microwave infrared visible light portions spectrum used transmitting information modulating amplitude frequency phase waves Ultraviolet light X rays gamma rays would even better due higher frequencies hard produce modulate propagate well buildings dangerous living things The bands listed bottom official ITU International Telecommunication Union names based wavelengths LF band goes 1 km 10 km approximately 30 kHz 300 kHz The terms LF MF HF refer Low Medium High Frequency respectively Clearly names assigned nobody expected go 10 MHz higher bands later named Very Ultra Super Extremely Tremendously High Frequency bands Beyond names Incredibly Astonishingly Prodigiously High Frequency IHF AHF PHF would sound nice We know Shannon Eq 2 3 amount information signal electromagnetic wave carry depends received power proportional bandwidth From obvious networking people like fiber optics much Many GHz bandwidth available tap data transmission microwave band even fiber right logarithmic scale As example consider 1 30 micron band width 0 17 microns If use SEC 2 3 f Hz 100 WIRELESS TRANSMISSION Radio Microwave Infrared UV X ray Gamma ray Visible light f Hz 104 Satellite Twisted pair Coax AM Maritime radio 1014 1015 Fiber optics Terrestrial microwave FM radio TV Band LF MF HF VHF UHF SHF EHF THF The electromagnetic spectrum uses communication Eq 2 4 find start end frequencies start end wavelengths find frequency range 30 000 GHz With reasonable signalto noise ratio 10 dB 300 Tbps Most transmissions use relatively narrow frequency band e f f 1 They concentrate signals narrow band use spectrum efficiently obtain reasonable data rates transmitting enough power However cases wider band used three variations In frequency hopping spread spectrum transmitter hops frequency frequency hundreds times per second It popular military communication makes transmissions hard detect next impossible jam It also offers good resistance multipath fading narrowband interference receiver stuck impaired frequency long enough shut communication This robustness makes useful crowded parts spectrum ISM bands describe shortly This technique used commercially example Bluetooth older versions 802 11 As curious footnote technique coinvented Austrian born sex goddess Hedy Lamarr first woman appear nude motion picture 1933 Czech film Extase Her first husband armaments manufacturer told easy block radio signals used control torpedoes When discovered selling weapons Hitler horrified disguised maid escape fled Hollywood continue career movie actress In spare time invented frequency hopping help Allied war effort Her scheme used 88 frequencies number keys 108 THE PHYSICAL LAYER frequencies piano For invention friend musical composer George Antheil received U S patent 2 292 387 However unable convince U S Navy invention practical use never received royalties Only years patent expired become popular A second form spread spectrum direct sequence spread spectrum uses code sequence spread data signal wider frequency band It widely used commercially spectrally efficient way let multiple signals share frequency band These signals given different codes method called CDMA Code Division Multiple Access return later chapter This method shown contrast frequency hopping It forms basis 3G mobile phone networks also used GPS Global Positioning System Even without different codes direct sequence spread spectrum like frequency hopping spread spectrum tolerate narrowband interference multipath fading fraction desired signal lost It used role older 802 11b wireless LANs For fascinating detailed history spread spectrum communication see Scholtz 1982 CDMA user different code Direct sequence spread spectrum Frequency hopping spread spectrum Ultrawideband underlay CDMA user different code Frequency Spread spectrum ultra wideband UWB communication A third method communication wider band UWB UltraWideBand communication UWB sends series rapid pulses varying positions communicate information The rapid transitions lead signal spread thinly wide frequency band UWB defined signals bandwidth least 500 MHz least 20 center frequency frequency band UWB also shown With much bandwidth UWB potential communicate high rates Because spread across wide band frequencies tolerate substantial amount relatively strong interference narrowband signals Just importantly since UWB little energy given frequency used short range transmission cause harmful interference narrowband radio signals It said underlay signals This peaceful coexistence led application wireless PANs run 1 Gbps although commercial success mixed It also used imaging solid objects ground walls bodies part precise location systems SEC 2 3 WIRELESS TRANSMISSION We discuss various parts electromagnetic spectrum used starting radio We assume transmissions use narrow frequency band unless otherwise stated 2 3 2 Radio Transmission Radio frequency RF waves easy generate travel long distances penetrate buildings easily widely used communication indoors outdoors Radio waves also omnidirectional meaning travel directions source transmitter receiver carefully aligned physically Sometimes omnidirectional radio good sometimes bad In 1970s General Motors decided equip new Cadillacs computer controlled antilock brakes When driver stepped brake pedal computer pulsed brakes instead locking hard One fine day Ohio Highway Patrolman began using new mobile radio call headquarters suddenly Cadillac next began behaving like bucking bronco When officer pulled car driver claimed done nothing car gone crazy Eventually pattern began emerge Cadillacs would sometimes go berserk major highways Ohio Highway Patrol watching For long long time General Motors could understand Cadillacs worked fine states also minor roads Ohio Only much searching discover Cadillac wiring made fine antenna frequency used Ohio Highway Patrol new radio system The properties radio waves frequency dependent At low frequencies radio waves pass obstacles well power falls sharply distance source least fast 1 r 2 air signal energy spread thinly larger surface This attenuation called path loss At high frequencies radio waves tend travel straight lines bounce obstacles Path loss still reduces power though received signal depend strongly reflections well High frequency radio waves also absorbed rain obstacles larger extent low frequency ones At frequencies radio waves subject interference motors electrical equipment It interesting compare attenuation radio waves signals guided media With fiber coax twisted pair signal drops fraction per unit distance example 20 dB per 100m twisted pair With radio signal drops fraction distance doubles example 6 dB per doubling free space This behavior means radio waves travel long distances interference users problem For reason governments tightly regulate use radio transmitters notable exceptions discussed later chapter 110 THE PHYSICAL LAYER In VLF LF MF bands radio waves follow ground illustrated These waves detected perhaps 1000 km lower frequencies less higher ones AM radio broadcasting uses MF band ground waves Boston AM radio stations heard easily New York Radio waves bands pass buildings easily portable radios work indoors The main problem using bands data communication low bandwidth see Eq 2 4 Ground wave Ion osph ere Earth surface Earth surface b In VLF LF MF bands radio waves follow curvature earth b In HF band bounce ionosphere In HF VHF bands ground waves tend absorbed earth However waves reach ionosphere layer charged particles circling earth height 100 500 km refracted sent back earth shown b Under certain atmospheric conditions signals bounce several times Amateur radio operators hams use bands talk long distance The military also communicate HF VHF bands 2 3 3 Microwave Transmission Above 100 MHz waves travel nearly straight lines therefore narrowly focused Concentrating energy small beam means parabolic antenna like familiar satellite TV dish gives much higher signalto noise ratio transmitting receiving antennas must accurately aligned In addition directionality allows multiple transmitters lined row communicate multiple receivers row without interference provided minimum spacing rules observed Before fiber optics decades microwaves formed heart long distance telephone transmission system In fact MCI one AT T first competitors deregulated built entire system microwave communications passing towers tens kilometers apart Even company name reflected MCI stood Microwave Communications Inc MCI since gone fiber long series corporate mergers bankruptcies telecommunications shuffle become part Verizon SEC 2 3 WIRELESS TRANSMISSION Microwaves travel straight line towers far apart earth get way think Seattle Amsterdam link Thus repeaters needed periodically The higher towers farther apart The distance repeaters goes roughly square root tower height For 100 meter high towers repeaters 80 km apart Unlike radio waves lower frequencies microwaves pass buildings well In addition even though beam may well focused transmitter still divergence space Some waves may refracted low lying atmospheric layers may take slightly longer arrive direct waves The delayed waves may arrive phase direct wave thus cancel signal This effect called multipath fading often serious problem It weather frequency dependent Some operators keep 10 channels idle spares switch multipath fading temporarily wipes frequency band The demand spectrum drives operators yet higher frequencies Bands 10 GHz routine use 4 GHz new problem sets absorption water These waves centimeters long absorbed rain This effect would fine one planning build huge outdoor microwave oven roasting passing birds communication severe problem As multipath fading solution shut links rained route around In summary microwave communication widely used long distance telephone communication mobile phones television distribution purposes severe shortage spectrum developed It several key advantages fiber The main one right way needed lay cables By buying small plot ground every 50 km putting microwave tower one bypass telephone system entirely This MCI managed get started new long distance telephone company quickly Sprint another early competitor deregulated AT T went completely different route formed Southern Pacific Railroad already owned large amount right way buried fiber next tracks Microwave also relatively inexpensive Putting two simple towers big poles four guy wires putting antennas one may cheaper burying 50 km fiber congested urban area mountain may also cheaper leasing telephone company fiber especially telephone company yet even fully paid copper ripped put fiber The Politics Electromagnetic Spectrum To prevent total chaos national international agreements gets use frequencies Since everyone wants higher data rate everyone wants spectrum National governments allocate spectrum AM 112 THE PHYSICAL LAYER FM radio television mobile phones well telephone companies police maritime navigation military government many competing users Worldwide agency ITU R WRC tries coordinate allocation devices work multiple countries manufactured However countries bound ITU R recommendations FCC Federal Communication Commission allocation United States occasionally rejected ITU R recommendations usually required politically powerful group give piece spectrum Even piece spectrum allocated use mobile phones additional issue carrier allowed use frequencies Three algorithms widely used past The oldest algorithm often called beauty contest requires carrier explain proposal serves public interest best Government officials decide nice stories enjoy Having government official award property worth billions dollars favorite company often leads bribery corruption nepotism worse Furthermore even scrupulously honest government official thought foreign company could better job national companies would lot explaining This observation led algorithm 2 holding lottery among interested companies The problem idea companies interest using spectrum enter lottery If say fast food restaurant shoe store chain wins resell spectrum carrier huge profit risk Bestowing huge windfalls alert otherwise random companies severely criticized many led algorithm 3 auction bandwidth highest bidder When British government auctioned frequencies needed third generation mobile systems 2000 expected get 4 billion It actually received 40 billion carriers got feeding frenzy scared death missing mobile boat This event switched nearby governments greedy bits inspired hold auctions It worked also left carriers much debt close bankruptcy Even best cases take many years recoup licensing fee A completely different approach allocating frequencies allocate Instead let everyone transmit regulate power used stations short range interfere Accordingly governments set aside frequency bands called ISM Industrial Scientific Medical bands unlicensed usage Garage door openers cordless phones radio controlled toys wireless mice numerous wireless household devices use ISM bands To minimize interference uncoordinated devices FCC mandates devices ISM bands limit transmit power e g 1 watt use techniques spread signals range frequencies Devices may also need take care avoid interference radar installations SEC 2 3 WIRELESS TRANSMISSION The location bands varies somewhat country country In United States example bands networking devices use practice without requiring FCC license shown The 900 MHz band used early versions 802 11 crowded The 2 4 GHz band available countries widely used 802 11b g Bluetooth though subject interference microwave ovens radar installations The 5 GHz part spectrum includes U NII Unlicensed National Information Infrastructure bands The 5 GHz bands relatively undeveloped since bandwidth used 802 11a quickly gaining popularity ISM band ISM band MHz 83 5 MHz 902 928 MHz MHz 2 4 2 4835 GHz GHz ISM bandMHz MHz 5 25 5 35 5 47 GHz GHz GHz MHz 5 725 5 825 GHz GHz U NII bands ISM U NII bands used United States wireless devices The unlicensed bands roaring success past decade The ability use spectrum freely unleashed huge amount innovation wireless LANs PANs evidenced widespread deployment technologies 802 11 Bluetooth To continue innovation spectrum needed One exciting development U S FCC decision 2009 allow unlicensed use white spaces around 700 MHz White spaces frequency bands allocated used locally The transition analog digital television broadcasts U S 2010 freed white spaces around 700 MHz The difficulty use white spaces unlicensed devices must able detect nearby licensed transmitters including wireless microphones first rights use frequency band Another flurry activity happening around 60 GHz band The FCC opened 57 GHz 64 GHz unlicensed operation 2001 This range enormous portion spectrum ISM bands combined support kind high speed networks would needed stream high definition TV air across living room At 60 GHz radio 114 THE PHYSICAL LAYER waves absorbed oxygen This means signals propagate far making well suited short range networks The high frequencies 60 GHz Extremely High Frequency millimeter band infrared radiation posed initial challenge equipment makers products market 2 3 4 Infrared Transmission Unguided infrared waves widely used short range communication The remote controls used televisions VCRs stereos use infrared communication They relatively directional cheap easy build major drawback pass solid objects Try standing remote control television see still works In general go long wave radio toward visible light waves behave like light less less like radio On hand fact infrared waves pass solid walls well also plus It means infrared system one room building interfere similar system adjacent rooms buildings control neighbor television remote control Furthermore security infrared systems eavesdropping better radio systems precisely reason Therefore government license needed operate infrared system contrast radio systems must licensed outside ISM bands Infrared communication limited use desktop example connect notebook computers printers IrDA Infrared Data Association standard major player communication game 2 3 5 Light Transmission Unguided optical signaling free space optics use centuries Paul Revere used binary optical signaling Old North Church prior famous ride A modern application connect LANs two buildings via lasers mounted rooftops Optical signaling using lasers inherently unidirectional end needs laser photodetector This scheme offers high bandwidth low cost relatively secure difficult tap narrow laser beam It also relatively easy install unlike microwave transmission require FCC license The laser strength narrow beam also weakness Aiming laser beam 1 mm wide target size pin head 500 meters away requires marksmanship latter day Annie Oakley Usually lenses put system defocus beam slightly To add difficulty wind temperature changes distort beam laser beams also penetrate rain thick fog although normally work well sunny days However many factors issue use connect two spacecraft SEC 2 3 WIRELESS TRANSMISSION One authors AST attended conference modern hotel Europe conference organizers thoughtfully provided room full terminals allow attendees read email boring presentations Since local PTT unwilling install large number telephone lines 3 days organizers put laser roof aimed university computer science building kilometers away They tested night conference worked perfectly At 9 A M bright sunny day link failed completely stayed day The pattern repeated next two days It conference organizers discovered problem heat sun daytime caused convection currents rise roof building shown This turbulent air diverted beam made dance around detector much like shimmering road hot day The lesson work well difficult conditions well good conditions unguided optical links need engineered sufficient margin error Laser beam misses detector Photodetector Region turbulent seeing Laser Heat rising building Convection currents interfere laser communication systems A bidirectional system two lasers pictured Unguided optical communication may seem like exotic networking technology today might soon become much prevalent We surrounded 116 THE PHYSICAL LAYER cameras sense light displays emit light using LEDs technology Data communication layered top displays encoding information pattern LEDs turn threshold human perception Communicating visible light way inherently safe creates low speed network immediate vicinity display This could enable sorts fanciful ubiquitous computing scenarios The flashing lights emergency vehicles might alert nearby traffic lights vehicles help clear path Informational signs might broadcast maps Even festive lights might broadcast songs synchronized display 2 4 COMMUNICATION SATELLITES In 1950s early 1960s people tried set communication systems bouncing signals metallized weather balloons Unfortunately received signals weak practical use Then U S Navy noticed kind permanent weather balloon sky moon built operational system ship shore communication bouncing signals Further progress celestial communication field wait first communication satellite launched The key difference artificial satellite real one artificial one amplify signals sending back turning strange curiosity powerful communication system Communication satellites interesting properties make attractive many applications In simplest form communication satellite thought big microwave repeater sky It contains several transponders listens portion spectrum amplifies incoming signal rebroadcasts another frequency avoid interference incoming signal This mode operation known bent pipe Digital processing added separately manipulate redirect data streams overall band digital information even received satellite rebroadcast Regenerating signals way improves performance compared bent pipe satellite amplify noise upward signal The downward beams broad covering substantial fraction earth surface narrow covering area hundreds kilometers diameter According Kepler law orbital period satellite varies radius orbit 3 2 power The higher satellite longer period Near surface earth period 90 minutes Consequently low orbit satellites pass view fairly quickly many needed provide continuous coverage ground antennas must track At altitude 35 800 km period 24 hours At altitude 384 000 km period one month anyone observed moon regularly testify SEC 2 4 COMMUNICATION SATELLITES A satellite period important issue determining place Another issue presence Van Allen belts layers highly charged particles trapped earth magnetic field Any satellite flying within would destroyed fairly quickly particles These factors lead three regions satellites placed safely These regions properties illustrated Below briefly describe satellites inhabit regions Altitude km Type Latency ms Sats needed 35 000 GEO MEO 35 85 1 7 30 000 25 000 20 000 Upper Van Allen belt 15 000 10 000 5 000 Lower Van Allen beltLEO Communication satellites properties including altitude earth round trip delay time number satellites needed global coverage 2 4 1 Geostationary Satellites In 1945 science fiction writer Arthur C Clarke calculated satellite altitude 35 800 km circular equatorial orbit would appear remain motionless sky would need tracked Clarke 1945 He went describe complete communication system used manned geostationary satellites including orbits solar panels radio frequencies launch procedures Unfortunately concluded satellites impractical due impossibility putting power hungry fragile vacuum tube amplifiers orbit never pursued idea although wrote science fiction stories The invention transistor changed first artificial communication satellite Telstar launched July 1962 Since communication satellites become multibillion dollar business aspect outer space become highly profitable These high flying satellites often called GEO Geostationary Earth Orbit satellites 118 THE PHYSICAL LAYER With current technology unwise geostationary satellites spaced much closer 2 degrees 360 degree equatorial plane avoid interference With spacing 2 degrees 360 2 180 satellites sky However transponder use multiple frequencies polarizations increase available bandwidth To prevent total chaos sky orbit slot allocation done ITU This process highly political countries barely stone age demanding orbit slots purpose leasing highest bidder Other countries however maintain national property rights extend moon country legal right orbit slots territory To add fight commercial telecommunication application Television broadcasters governments military also want piece orbiting pie Modern satellites quite large weighing 5000 kg consuming several kilowatts electric power produced solar panels The effects solar lunar planetary gravity tend move away assigned orbit slots orientations effect countered board rocket motors This fine tuning activity called station keeping However fuel motors exhausted typically 10 years satellite drifts tumbles helplessly turned Eventually orbit decays satellite reenters atmosphere burns rarely crashes earth Orbit slots bone contention Frequencies issue downlink transmissions interfere existing microwave users Consequently ITU allocated certain frequency bands satellite users The main ones listed The C band first designated commercial satellite traffic Two frequency ranges assigned lower one downlink traffic satellite upper one uplink traffic satellite To allow traffic go ways time two channels required These channels already overcrowded also used common carriers terrestrial microwave links The L S bands added international agreement 2000 However narrow also crowded Band Downlink Uplink Bandwidth Problems L 1 5 GHz 1 6 GHz 15 MHz Low bandwidth crowded S 1 9 GHz 2 2 GHz 70 MHz Low bandwidth crowded C 4 0 GHz 6 0 GHz 500 MHz Terrestrial interference Ku 11 GHz 14 GHz 500 MHz Rain Ka 20 GHz 30 GHz 3500 MHz Rain equipment cost The principal satellite bands SEC 2 4 COMMUNICATION SATELLITES The next highest band available commercial telecommunication carriers Ku K band This band yet congested higher frequencies satellites spaced close 1 degree However another problem exists rain Water absorbs short microwaves well Fortunately heavy storms usually localized using several widely separated ground stations instead one circumvents problem price extra antennas extra cables extra electronics enable rapid switching stations Bandwidth also allocated Ka K band commercial satellite traffic equipment needed use expensive In addition commercial bands many government military bands also exist A modern satellite around 40 transponders often 36 MHz bandwidth Usually transponder operates bent pipe recent satellites board processing capacity allowing sophisticated operation In earliest satellites division transponders channels static bandwidth simply split fixed frequency bands Nowadays transponder beam divided time slots various users taking turns We study two techniques frequency division multiplexing time division multiplexing detail later chapter The first geostationary satellites single spatial beam illuminated 1 3 earth surface called footprint With enormous decline price size power requirements microelectronics much sophisticated broadcasting strategy become possible Each satellite equipped multiple antennas multiple transponders Each downward beam focused small geographical area multiple upward downward transmissions take place simultaneously Typically called spot beams elliptically shaped small hundred km diameter A communication satellite United States typically one wide beam contiguous 48 states plus spot beams Alaska Hawaii A recent development communication satellite world development low cost microstations sometimes called VSATs Very Small Aperture Terminals Abramson 2000 These tiny terminals 1 meter smaller antennas versus 10 standard GEO antenna put 1 watt power The uplink generally good 1 Mbps downlink often several megabits sec Direct broadcast satellite television uses technology one way transmission In many VSAT systems microstations enough power communicate directly one another via satellite course Instead special ground station hub large high gain antenna needed relay traffic VSATs shown In mode operation either sender receiver large antenna powerful amplifier The trade longer delay return cheaper end user stations VSATs great potential rural areas It widely appreciated half world population lives hour walk nearest 120 THE PHYSICAL LAYER Communication satellite 3 VSAT Hub VSATs using hub telephone Stringing telephone wires thousands small villages far beyond budgets Third World governments installing 1 meter VSAT dishes powered solar cells often feasible VSATs provide technology wire world Communication satellites several properties radically different terrestrial point point links To begin even though signals satellite travel speed light nearly 300 000 km sec long round trip distance introduces substantial delay GEO satellites Depending distance user ground station elevation satellite horizon end end transit time 250 300 msec A typical value 270 msec 540 msec VSAT system hub For comparison purposes terrestrial microwave links propagation delay roughly 3 sec km coaxial cable fiber optic links delay approximately 5 sec km The latter slower former electromagnetic signals travel faster air solid materials Another important property satellites inherently broadcast media It cost send message thousands stations within transponder footprint send one For applications property useful For example one could imagine satellite broadcasting popular Web pages caches large number computers spread wide area Even broadcasting simulated point point lines SEC 2 4 COMMUNICATION SATELLITES satellite broadcasting may much cheaper On hand privacy point view satellites complete disaster everybody hear everything Encryption essential security required Satellites also property cost transmitting message independent distance traversed A call across ocean costs service call across street Satellites also excellent error rates deployed almost instantly major consideration disaster response military communication 2 4 2 Medium Earth Orbit Satellites At much lower altitudes two Van Allen belts find MEO Medium Earth Orbit satellites As viewed earth drift slowly longitude taking something like 6 hours circle earth Accordingly must tracked move sky Because lower GEOs smaller footprint ground require less powerful transmitters reach Currently used navigation systems rather telecommunications examine The constellation roughly 30 GPS Global Positioning System satellites orbiting 20 200 km examples MEO satellites 2 4 3 Low Earth Orbit Satellites Moving altitude come LEO Low Earth Orbit satellites Due rapid motion large numbers needed complete system On hand satellites close earth ground stations need much power round trip delay milliseconds The launch cost substantially cheaper In section examine two examples satellite constellations voice service Iridium Globalstar For first 30 years satellite era low orbit satellites rarely used zip view quickly In 1990 Motorola broke new ground filing application FCC asking permission launch 77 low orbit satellites Iridium project element 77 iridium The plan later revised use 66 satellites project renamed Dysprosium element 66 probably sounded much like disease The idea soon one satellite went view another would replace This proposal set feeding frenzy among communication companies All sudden everyone wanted launch chain low orbit satellites After seven years cobbling together partners financing communication service began November 1998 Unfortunately commercial demand large heavy satellite telephones negligible mobile phone network grown spectacular way since 1990 As consequence Iridium 122 THE PHYSICAL LAYER profitable forced bankruptcy August 1999 one spectacular corporate fiascos history The satellites assets worth 5 billion later purchased investor 25 million kind extraterrestrial garage sale Other satellite business ventures promptly followed suit The Iridium service restarted March 2001 growing ever since It provides voice data paging fax navigation service everywhere land air sea via hand held devices communicate directly Iridium satellites Customers include maritime aviation oil exploration industries well people traveling parts world lacking telecom infrastructure e g deserts mountains South Pole Third World countries The Iridium satellites positioned altitude 750 km circular polar orbits They arranged north south necklaces one satellite every 32 degrees latitude shown Each satellite maximum 48 cells spot beams capacity 3840 channels used paging navigation others used data voice Each satellite four neighbors The Iridium satellites form six necklaces around earth With six satellite necklaces entire earth covered suggested An interesting property Iridium communication distant customers takes place space shown Here see caller North Pole contacting satellite directly overhead Each satellite four neighbors communicate two necklace shown two adjacent necklaces shown The satellites relay call across grid finally sent callee South Pole An alternative design Iridium Globalstar It based 48 LEO satellites uses different switching scheme Iridium Whereas Iridium relays calls satellite satellite requires sophisticated switching equipment satellites Globalstar uses traditional bent pipe design The call originating North Pole b sent back earth picked SEC 2 4 COMMUNICATION SATELLITES Satellite switches space Bent pipe satellite Switching ground b Relaying space b Relaying ground large ground station Santa Workshop The call routed via terrestrial network ground station nearest callee delivered bent pipe connection shown The advantage scheme puts much complexity ground easier manage Also use large ground station antennas put powerful signal receive weak one means lower powered telephones used After telephone puts milliwatts power signal gets back ground station fairly weak even amplified satellite Satellites continue launched rate around 20 per year including ever larger satellites weigh 5000 kilograms But also small satellites budget conscious organization To make space research accessible academics Cal Poly Stanford got together 1999 define standard miniature satellites associated launcher would greatly lower launch costs Nugent et al 2008 CubeSats satellites units 10 cm 10 cm 10 cm cubes weighing 1 kilogram launched little 40 000 The launcher flies secondary payload commercial space missions It basically tube takes three units cubesats uses springs release orbit Roughly 20 cubesats launched far many works Most communicate ground stations UHF VHF bands 2 4 4 Satellites Versus Fiber A comparison satellite communication terrestrial communication instructive As recently 25 years ago case could made future communication lay communication satellites After telephone system 124 THE PHYSICAL LAYER changed little previous 100 years showed signs changing next 100 years This glacial movement caused small part regulatory environment telephone companies expected provide good voice service reasonable prices return got guaranteed profit investment For people data transmit 1200 bps modems available That pretty much The introduction competition 1984 United States somewhat later Europe changed radically Telephone companies began replacing long haul networks fiber introduced high bandwidth services like ADSL Asymmetric Digital Subscriber Line They also stopped long time practice charging artificially high prices long distance users subsidize local service All sudden terrestrial fiber connections looked like winner Nevertheless communication satellites major niche markets fiber sometimes address First rapid deployment critical satellites win easily A quick response useful military communication systems times war disaster response times peace Following massive December 2004 Sumatra earthquake subsequent tsunami example communications satellites able restore communications first responders within 24 hours This rapid response possible developed satellite service provider market large players Intelsat 50 satellites rent capacity pretty much anywhere needed For customers served existing satellite networks VSAT set easily quickly provide megabit sec link elsewhere world A second niche communication places terrestrial infrastructure poorly developed Many people nowadays want communicate everywhere go Mobile phone networks cover locations good population density adequate job places e g sea desert Conversely Iridium provides voice service everywhere Earth even South Pole Terrestrial infrastructure also expensive install depending terrain necessary rights way Indonesia example satellite domestic telephone traffic Launching one satellite cheaper stringing thousands undersea cables among 13 677 islands archipelago A third niche broadcasting essential A message sent satellite received thousands ground stations Satellites used distribute much network TV programming local stations reason There large market satellite broadcasts digital TV radio directly end users satellite receivers homes cars All sorts content broadcast For example organization transmitting stream stock bond commodity prices thousands dealers might find satellite system much cheaper simulating broadcasting ground In short looks like mainstream communication future terrestrial fiber optics combined cellular radio specialized uses SEC 2 4 COMMUNICATION SATELLITES satellites better However one caveat applies economics Although fiber offers bandwidth conceivable terrestrial satellite communication could compete aggressively price If advances technology radically cut cost deploying satellite e g future space vehicle toss dozens satellites one launch low orbit satellites catch big way certain fiber win markets 2 5 DIGITAL MODULATION AND MULTIPLEXING Now studied properties wired wireless channels turn attention problem sending digital information Wires wireless channels carry analog signals continuously varying voltage light intensity sound intensity To send digital information must devise analog signals represent bits The process converting bits signals represent called digital modulation We start schemes directly convert bits signal These schemes result baseband transmission signal occupies frequencies zero maximum depends signaling rate It common wires Then consider schemes regulate amplitude phase frequency carrier signal convey bits These schemes result passband transmission signal occupies band frequencies around frequency carrier signal It common wireless optical channels signals must reside given frequency band Channels often shared multiple signals After much convenient use single wire carry several signals install wire every signal This kind sharing called multiplexing It accomplished several different ways We present methods time frequency code division multiplexing The modulation multiplexing techniques describe section widely used wires fiber terrestrial wireless satellite channels In following sections look examples networks see action 2 5 1 Baseband Transmission The straightforward form digital modulation use positive voltage represent 1 negative voltage represent 0 For optical fiber presence light might represent 1 absence light might represent 0 This scheme called NRZ Non Return Zero The odd name historical reasons simply means signal follows data An example shown b Once sent NRZ signal propagates wire At end receiver converts bits sampling signal regular intervals time 126 THE PHYSICAL LAYER Bit stream b Non Return Zero NRZ c NRZ Invert NRZI Manchester Clock XORed bits e Bipolar encoding also Alternate Mark Inversion AMI Line codes Bits b NRZ c NRZI Manchester e Bipolar AMI This signal look exactly like signal sent It attenuated distorted channel noise receiver To decode bits receiver maps signal samples closest symbols For NRZ positive voltage taken indicate 1 sent negative voltage taken indicate 0 sent NRZ good starting point studies simple seldom used practice More complex schemes convert bits signals better meet engineering considerations These schemes called line codes Below describe line codes help bandwidth efficiency clock recovery DC balance Bandwidth Efficiency With NRZ signal may cycle positive negative levels every 2 bits case alternating 1s 0s This means need bandwidth least B 2 Hz bit rate B bits sec This relation comes Nyquist rate Eq 2 2 It fundamental limit run NRZ faster without using bandwidth Bandwidth often limited resource even wired channels Higher frequency signals increasingly attenuated making less useful higher frequency signals also require faster electronics One strategy using limited bandwidth efficiently use two signaling levels By using four voltages instance send 2 bits single symbol This design work long signal receiver sufficiently strong distinguish four levels The rate signal changes half bit rate needed bandwidth reduced SEC 2 5 DIGITAL MODULATION AND MULTIPLEXING We call rate signal changes symbol rate distinguish bit rate The bit rate symbol rate multiplied number bits per symbol An older name symbol rate particularly context devices called telephone modems convey digital data telephone lines baud rate In literature terms bit rate baud rate often used incorrectly Note number signal levels need power two Often levels used protecting errors simplifying design receiver Clock Recovery For schemes encode bits symbols receiver must know one symbol ends next symbol begins correctly decode bits With NRZ symbols simply voltage levels long run 0s 1s leaves signal unchanged After hard tell bits apart 15 zeros look much like 16 zeros unless accurate clock Accurate clocks would help problem expensive solution commodity equipment Remember timing bits links run many megabits sec clock would drift less fraction microsecond longest permitted run This might reasonable slow links short messages general solution One strategy send separate clock signal receiver Another clock line big deal computer buses short cables many lines parallel wasteful network links since another line send signal could use send data A clever trick mix clock signal data signal XORing together extra line needed The results shown The clock makes clock transition every bit time runs twice bit rate When XORed 0 level makes low high transition simply clock This transition logical 0 When XORed 1 level inverted makes high tolow transition This transition logical 1 This scheme called Manchester encoding used classic Ethernet The downside Manchester encoding requires twice much bandwidth NRZ clock learned bandwidth often matters A different strategy based idea code data ensure enough transitions signal Consider NRZ clock recovery problems long runs 0s 1s If frequent transitions easy receiver stay synchronized incoming stream symbols As step right direction simplify situation coding 1 transition 0 transition vice versa This coding called NRZI Non Return Zero Inverted twist NRZ An example shown 128 THE PHYSICAL LAYER c The popular USB Universal Serial Bus standard connecting computer peripherals uses NRZI With long runs 1s cause problem Of course long runs 0s still cause problem must fix If telephone company might simply require sender transmit many 0s Older digital telephone lines U S called T1 lines fact require 15 consecutive 0s sent work correctly To really fix problem break runs 0s mapping small groups bits transmitted groups successive 0s mapped slightly longer patterns many consecutive 0s A well known code called 4B 5B Every 4 bits mapped a5 bit pattern fixed translation table The five bit patterns chosen never run three consecutive 0s The mapping shown This scheme adds 25 overhead better 100 overhead Manchester encoding Since 16 input combinations 32 output combinations output combinations used Putting aside combinations many successive 0s still codes left As bonus use nondata codes represent physical layer control signals For example uses 11111 represents idle line 11000 represents start frame Data 4B Codeword 5B Data 4B Codeword 5B 4B 5B mapping An alternative approach make data look random known scrambling In case likely frequent transitions A scrambler works XORing data pseudorandom sequence transmitted This mixing make data random pseudorandom sequence assuming independent pseudorandom sequence The receiver XORs incoming bits pseudorandom sequence recover real data For practical pseudorandom sequence must easy create It commonly given seed simple random number generator Scrambling attractive adds bandwidth time overhead In fact often helps condition signal energy SEC 2 5 DIGITAL MODULATION AND MULTIPLEXING dominant frequency components caused repetitive data patterns might radiate electromagnetic interference Scrambling helps random signals tend white energy spread across frequency components However scrambling guarantee long runs It possible get unlucky occasionally If data pseudorandom sequence XOR 0s This outcome generally occur long pseudorandom sequence difficult predict However short predictable sequence might possible malicious users send bit patterns cause long runs 0s scrambling cause links fail Early versions standards sending IP packets SONET links telephone system defect Malis Simpson 1999 It possible users send certain killer packets guaranteed cause problems Balanced Signals Signals much positive voltage negative voltage even short periods time called balanced signals They average zero means DC electrical component The lack DC component advantage channels coaxial cable lines transformers strongly attenuate DC component due physical properties Also one method connecting receiver channel called capacitive coupling passes AC portion signal In either case send signal whose average zero waste energy DC component filtered Balancing helps provide transitions clock recovery since mix positive negative voltages It also provides simple way calibrate receivers average signal measured used decision threshold decode symbols With unbalanced signals average may drift away true decision level due density 1s example would cause symbols decoded errors A straightforward way construct balanced code use two voltage levels represent logical 1 say 1 V 1 V 0 V representing logical zero To send 1 transmitter alternates 1 V 1 V levels always average This scheme called bipolar encoding In telephone networks called AMI Alternate Mark Inversion building old terminology 1 called mark 0 called space An example given e Bipolar encoding adds voltage level achieve balance Alternatively use mapping like 4B 5B achieve balance well transitions clock recovery An example kind balanced code 8B 10B line code It maps 8 bits input 10 bits output 80 efficient like 4B 5B line code The 8 bits split group 5 bits mapped 6 bits group 3 bits mapped 4 bits The 6 bit 4 bit symbols 130 THE PHYSICAL LAYER concatenated In group input patterns mapped balanced output patterns number 0s 1s For example 001 mapped 1001 balanced But enough combinations output patterns balanced For cases input pattern mapped two output patterns One extra 1 alternate extra 0 For example 000 mapped 1011 complement 0100 As input bits mapped output bits encoder remembers disparity previous symbol The disparity total number 0s 1s signal balance The encoder selects either output pattern alternate reduce disparity With 8B 10B disparity 2 bits Thus signal never far balanced There also never five consecutive 1s 0s help clock recovery 2 5 2 Passband Transmission Often want use range frequencies start zero send information across channel For wireless channels practical send low frequency signals size antenna needs fraction signal wavelength becomes large In case regulatory constraints need avoid interference usually dictate choice frequencies Even wires placing signal given frequency band useful let different kinds signals coexist channel This kind transmission called passband transmission arbitrary band frequencies used pass signal Fortunately fundamental results earlier chapter terms bandwidth width frequency band The absolute frequency values matter capacity This means take baseband signal occupies 0 B Hz shift occupy passband S S B Hz without changing amount information carry even though signal look different To process signal receiver shift back baseband convenient detect symbols Digital modulation accomplished passband transmission regulating modulating carrier signal sits passband We modulate amplitude frequency phase carrier signal Each methods corresponding name In ASK Amplitude Shift Keying two different amplitudes used represent 0 1 An example nonzero zero level shown b More two levels used represent symbols Similarly FSK Frequency Shift Keying two different tones used The example c uses two frequencies In simplest form PSK Phase Shift Keying carrier wave systematically shifted 0 180 degrees symbol period Because two phases called BPSK Binary Phase Shift Keying Binary refers two symbols symbols represent 2 bits An example shown c A SEC 2 5 DIGITAL MODULATION AND MULTIPLEXING better scheme uses channel bandwidth efficiently use four shifts e g 45 135 225 315 degrees transmit 2 bits information per symbol This version called QPSK Quadrature Phase Shift Keying b c Phase changes A binary signal b Amplitude shift keying c Frequency shift keying Phase shift keying We combine schemes use levels transmit bits per symbol Only one frequency phase modulated time related frequency rate change phase time Usually amplitude phase modulated combination Three examples shown In example points give legal amplitude phase combinations symbol In see equidistant dots 45 135 225 315 degrees The phase dot indicated angle line origin makes positive x axis The amplitude dot distance origin This figure representation QPSK This kind diagram called constellation diagram In b see modulation scheme denser constellation Sixteen combinations amplitudes phase used modulation scheme used transmit 132 THE PHYSICAL LAYER b c QPSK b QAM 16 c QAM 64 4 bits per symbol It called QAM 16 QAM stands Quadrature Amplitude Modulation c still denser modulation scheme 64 different combinations 6 bits transmitted per symbol It called QAM 64 Even higher order QAMs used As might suspect constellations easier build electronics produce symbols combination values axis combination amplitude phase values That patterns look like squares rather concentric circles The constellations seen far show bits assigned symbols When making assignment important consideration small burst noise receiver lead many bit errors This might happen assigned consecutive bit values adjacent symbols With QAM 16 example one symbol stood 0111 neighboring symbol stood 1000 receiver mistakenly picks adjacent symbol cause bits wrong A better solution map bits symbols adjacent symbols differ 1 bit position This mapping called Gray code shows QAM 16 constellation Gray coded Now receiver decodes symbol error make single bit error expected case decoded symbol close transmitted symbol 2 5 3 Frequency Division Multiplexing The modulation schemes seen let us send one signal convey bits along wired wireless link However economies scale play important role use networks It costs essentially amount money install maintain high bandwidth transmission line low bandwidth line two different offices e costs come dig trench kind cable fiber goes Consequently multiplexing schemes developed share lines among many signals SEC 2 5 DIGITAL MODULATION AND MULTIPLEXING Q B E C A When 1101 sent D I Point Decodes Bit errors A B C D E 1100111111 Gray coded QAM 16 FDM Frequency Division Multiplexing takes advantage passband transmission share channel It divides spectrum frequency bands user exclusive possession band send signal AM radio broadcasting illustrates FDM The allocated spectrum 1 MHz roughly 500 1500 kHz Different frequencies allocated different logical channels stations operating portion spectrum interchannel separation great enough prevent interference For detailed example show three voice grade telephone channels multiplexed using FDM Filters limit usable bandwidth 3100 Hz per voice grade channel When many channels multiplexed together 4000 Hz allocated per channel The excess called guard band It keeps channels well separated First voice channels raised frequency different amount Then combined two channels occupy portion spectrum Notice even though gaps channels thanks guard bands overlap adjacent channels The overlap real filters ideal sharp edges This means strong spike edge one channel felt adjacent one nonthermal noise This scheme used multiplex calls telephone system many years multiplexing time preferred instead However FDM continues used telephone networks well cellular terrestrial wireless satellite networks higher level granularity When sending digital data possible divide spectrum efficiently without using guard bands In OFDM Orthogonal Frequency Division Multiplexing channel bandwidth divided many subcarriers independently send data e g QAM The subcarriers packed tightly together frequency domain Thus signals subcarrier extend adjacent ones However seen frequency response subcarrier 134 THE PHYSICAL LAYER Channel 1 Attenuation factor Channel 2 Channel 1 Channel 3 Channel 2Channel 3 Frequency kHz c Frequency Hz Frequency kHz b Frequency division multiplexing The original bandwidths b The bandwidths raised frequency c The multiplexed channel designed zero center adjacent subcarriers The subcarriers therefore sampled center frequencies without interference neighbors To make work guard time needed repeat portion symbol signals time desired frequency response However overhead much less needed many guard bands Power One OFDM subcarrier shaded Separation f Frequency f1 f2 f3 f4 f5 Orthogonal frequency division multiplexing OFDM The idea OFDM around long time last decade widely adopted following realization possible SEC 2 5 DIGITAL MODULATION AND MULTIPLEXING implement OFDM efficiently terms Fourier transform digital data subcarriers instead separately modulating subcarrier OFDM used 802 11 cable networks power line networking planned fourth generation cellular systems Usually one high rate stream digital information split many low rate streams transmitted subcarriers parallel This division valuable degradations channel easier cope subcarrier level subcarriers may degraded excluded favor subcarriers received well 2 5 4 Time Division Multiplexing An alternative FDM TDM Time Division Multiplexing Here users take turns round robin fashion one periodically getting entire bandwidth little burst time An example three streams multiplexed TDM shown Bits input stream taken fixed time slot output aggregate stream This stream runs sum rate individual streams For work streams must synchronized time Small intervals guard time analogous frequency guard band may added accommodate small timing variations 2 Round robin TDM multiplexer Guard time Time Division Multiplexing TDM TDM used widely part telephone cellular networks To avoid one point confusion let us clear quite different alternative STDM Statistical Time Division Multiplexing The prefix statistical added indicate individual streams contribute multiplexed stream fixed schedule according statistics demand STDM packet switching another name 2 5 5 Code Division Multiplexing There third kind multiplexing works completely different way FDM TDM CDM Code Division Multiplexing form spread spectrum communication narrowband signal spread wider frequency band This make tolerant interference well allowing multiple signals different users share frequency band Because code division multiplexing mostly used latter purpose commonly called CDMA Code Division Multiple Access 136 THE PHYSICAL LAYER CDMA allows station transmit entire frequency spectrum time Multiple simultaneous transmissions separated using coding theory Before getting algorithm let us consider analogy airport lounge many pairs people conversing TDM comparable pairs people room taking turns speaking FDM comparable pairs people speaking different pitches high pitched low pitched pair hold conversation time independently others CDMA comparable pair people talking different language The French speaking couple hones French rejecting everything French noise Thus key CDMA able extract desired signal rejecting everything else random noise A somewhat simplified description CDMA follows In CDMA bit time subdivided short intervals called chips Typically 64 128 chips per bit example given use 8 chips bit simplicity Each station assigned unique bit code called chip sequence For pedagogical purposes convenient use bipolar notation write codes sequences 1 1 We show chip sequences parentheses To transmit 1 bit station sends chip sequence To transmit 0 bit sends negation chip sequence No patterns permitted Thus 8 station A assigned chip sequence 1 1 1 1 1 1 1 1 send 1 bit transmiting chip sequence 0 transmitting 1 1 1 1 1 1 1 1 It really signals voltage levels sent sufficient us think terms sequences Increasing amount information sent b bits sec mb chips sec station means bandwidth needed CDMA greater factor bandwidth needed station using CDMA assuming changes modulation encoding techniques If 1 MHz band available 100 stations FDM one would 10 kHz could send 10 kbps assuming 1 bit per Hz With CDMA station uses full 1 MHz chip rate 100 chips per bit spread station bit rate 10 kbps across channel In b show chip sequences assigned four example stations signals represent Each station unique chip sequence Let us use symbol S indicate chip vector station S S negation All chip sequences pairwise orthogonal mean normalized inner product two distinct chip sequences S T written S T 0 It known generate orthogonal chip sequences using method known Walsh codes In mathematical terms orthogonality chip sequences expressed follows S T 1 Si Ti 0 1 2 5 SEC 2 5 DIGITAL MODULATION AND MULTIPLEXING In plain English many pairs different This orthogonality property prove crucial later Note S T 0 S T also 0 The normalized inner product chip sequence 1 S S 1 1 2 1 1 2 1 Si Si Si 1 1 1 This follows terms inner product 1 sum Also note S S 1 A 1 1 1 1 1 1 1 1 B 1 1 1 1 1 1 1 1 C 1 1 1 1 1 1 1 1 D 1 1 1 1 1 1 1 1 S1 C 1 1 1 1 1 1 1 1 S2 B C 2 0 0 0 2 2 0 2 0 0 2 2 0 2 0 2 S3 A B S4 A B C 1 1 3 3 1 1 1 1 S5 A B C D 4 0 2 0 2 0 2 2 S6 A B C D 2 2 0 2 0 2 4 0 c b S1 C 1 1 1 1 1 1 1 1 8 1 S2 C 2 0 0 0 2 2 0 2 8 1 S3 C 0 0 2 2 0 2 0 2 8 0 S4 C 1 1 3 3 1 1 1 1 8 1 S5 C 4 0 2 0 2 0 2 2 8 1 S6 C 2 2 0 2 0 2 4 0 8 1 Chip sequences four stations b Signals sequences represent c Six examples transmissions Recovery station C signal During bit time station transmit 1 sending chip sequence transmit 0 sending negative chip sequence silent transmit nothing We assume stations synchronized time chip sequences begin instant When two stations transmit simultaneously bipolar sequences add linearly For example one chip period three stations output 1 one station outputs 1 2 received One think signals add voltages superimposed channel three stations output 1 V one station outputs 1 V 2 V received For instance c see six examples one stations transmitting 1 bit time In first example C transmits 1 bit get C chip sequence In second example B C transmit 1 bits get sum bipolar chip sequences namely 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 0 0 0 2 2 0 2 To recover bit stream individual station receiver must know station chip sequence advance It recovery computing normalized inner product received chip sequence chip sequence station whose bit stream trying recover If received chip sequence S receiver trying listen station whose chip sequence C computes normalized inner product S C 138 THE PHYSICAL LAYER To see works imagine two stations A C transmit 1 bit time B transmits 0 bit case third example The receiver sees sum S A B C computes S C A B C C A C B C C C 0 0 1 1 The first two terms vanish pairs chip sequences carefully chosen orthogonal shown Eq 2 5 Now clear property must imposed chip sequences To make decoding process concrete show six examples Suppose receiver interested extracting bit sent station C six signals S 1 S 6 It calculates bit summing pairwise products received S C vector taking 1 8 result since 8 The examples include cases C silent sends 1 bit sends 0 bit individually combination transmissions As shown correct bit decoded time It like speaking French In principle given enough computing capacity receiver listen senders running decoding algorithm parallel In real life suffice say easier said done useful know senders might transmitting In ideal noiseless CDMA system studied number stations send concurrently made arbitrarily large using longer chip sequences For 2n stations Walsh codes provide 2n orthogonal chip sequences length 2n However one significant limitation assumed chips synchronized time receiver This synchronization even approximately true applications cellular networks CDMA widely deployed starting 1990s It leads different designs We return topic later chapter describe asynchronous CDMA differs synchronous CDMA As well cellular networks CDMA used satellites cable networks We glossed many complicating factors brief introduction Engineers want gain deep understanding CDMA read Viterbi 1995 Lee Miller 1998 These references require quite bit background communication engineering however 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK When two computers owned company organization located close need communicate often easiest run cable LANs work way However distances large many computers cables pass public road public right way costs running private cables usually prohibitive SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK Furthermore every country world stringing private transmission lines across underneath public property also illegal Consequently network designers must rely existing telecommunication facilities These facilities especially PSTN Public Switched Telephone Network usually designed many years ago completely different goal mind transmitting human voice less recognizable form Their suitability use computer computer communication often marginal best To see size problem consider cheap commodity cable running two computers transfer data 1 Gbps In contrast typical ADSL blazingly fast alternative telephone modem runs around 1 Mbps The difference two difference cruising airplane taking leisurely stroll Nonetheless telephone system tightly intertwined wide area computer networks worth devoting time study detail The limiting factor networking purposes turns last mile customers connect trunks switches inside telephone network This situation changing gradual rollout fiber digital technology edge network take time money During long wait computer systems designers used working systems give least three orders magnitude better performance devoted much time effort figure use telephone network efficiently In following sections describe telephone system show works For additional information innards telephone system see Bellamy 2000 2 6 1 Structure Telephone System Soon Alexander Graham Bell patented telephone 1876 hours ahead rival Elisha Gray enormous demand new invention The initial market sale telephones came pairs It customer string single wire If telephone owner wanted talk n telephone owners separate wires strung n houses Within year cities covered wires passing houses trees wild jumble It became immediately obvious model connecting every telephone every telephone shown going work To credit Bell saw problem early formed Bell Telephone Company opened first switching office New Haven Connecticut 1878 The company ran wire customer house office To make call customer would crank phone make ringing sound telephone company office attract attention operator would manually connect caller callee using short jumper cable connect caller callee The model single switching office illustrated b 140 THE PHYSICAL LAYER b c Fully interconnected network b Centralized switch c Two level hierarchy Pretty soon Bell System switching offices springing everywhere people wanted make long distance calls cities Bell System began connect switching offices The original problem soon returned connect every switching office every switching office means wire quickly became unmanageable second level switching offices invented After multiple second level offices needed illustrated c Eventually hierarchy grew five levels By 1890 three major parts telephone system place switching offices wires customers switching offices balanced insulated twisted pairs instead open wires earth return long distance connections switching offices For short technical history telephone system see Hawley 1991 While improvements three areas since basic Bell System model remained essentially intact 100 years The following description highly simplified gives essential flavor nevertheless Each telephone two copper wires coming go directly telephone company nearest end office also called local central office The distance typically 1 10 km shorter cities rural areas In United States alone 22 000 end offices The two wire connections subscriber telephone end office known trade local loop If world local loops stretched end end would extend moon back 1000 times At one time 80 AT T capital value copper local loops AT T effect world largest copper mine Fortunately fact well known investment community Had known corporate raider might bought AT T ended telephone service United States ripped wire sold copper refiner quick payback SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK If subscriber attached given end office calls another subscriber attached end office switching mechanism within office sets direct electrical connection two local loops This connection remains intact duration call If called telephone attached another end office different procedure used Each end office number outgoing lines one nearby switching centers called toll offices within local area tandem offices These lines called toll connecting trunks The number different kinds switching centers topology varies country country depending country telephone density If caller callee end offices happen toll connecting trunk toll office likely occurrence relatively close connection may established within toll office A telephone network consisting telephones small dots end offices large dots toll offices squares shown c If caller callee toll office common path established two toll offices The toll offices communicate via high bandwidth intertoll trunks also called interoffice trunks Prior 1984 breakup AT T U S telephone system used hierarchical routing find path going higher levels hierarchy switching office common This replaced flexible nonhierarchical routing shows long distance connection might routed Telephone Local loop End office Toll connecting trunk Toll office Intermediate switching office Very high bandwidth intertoll trunks Toll office End office Toll connecting trunk Telephone Local loop A typical circuit route long distance call A variety transmission media used telecommunication Unlike modern office buildings wiring commonly Category 5 local loops homes mostly consist Category 3 twisted pairs fiber starting appear Between switching offices coaxial cables microwaves especially fiber optics widely used In past transmission throughout telephone system analog actual voice signal transmitted electrical voltage source destination With advent fiber optics digital electronics computers trunks switches digital leaving local loop last piece 142 THE PHYSICAL LAYER analog technology system Digital transmission preferred necessary accurately reproduce analog waveform passed many amplifiers long call Being able correctly distinguish 0 1 enough This property makes digital transmission reliable analog It also cheaper easier maintain In summary telephone system consists three major components 1 Local loops analog twisted pairs going houses businesses 2 Trunks digital fiber optic links connecting switching offices 3 Switching offices calls moved one trunk another After short digression politics telephones come back three components detail The local loops provide everyone access whole system critical Unfortunately also weakest link system For long haul trunks main issue collect multiple calls together send fiber This calls multiplexing apply FDM TDM Finally two fundamentally different ways switching look 2 6 2 The Politics Telephones For decades prior 1984 Bell System provided local long distance service throughout United States In 1970s U S Federal Government came believe illegal monopoly sued break The government January 1 1984 AT T broken AT T Long Lines 23 BOCs Bell Operating Companies pieces The 23 BOCs grouped seven regional BOCs RBOCs make economically viable The entire nature telecommunication United States changed overnight court order act Congress The exact specifications divestiture described called MFJ Modified Final Judgment oxymoron ever one judgment could modified clearly final This event led increased competition better service lower long distance rates consumers businesses However prices local service rose cross subsidies longdistance calling eliminated local service become self supporting Many countries introduced competition along similar lines Of direct relevance studies new competitive framework caused key technical feature added architecture telephone network To make clear could United States divided 164 LATAs Local Access Transport Areas Very roughly LATA big area covered one area code Within LATA one LEC Local Exchange Carrier monopoly traditional telephone SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK service within area The important LECs BOCs although LATAs contained one 1500 independent telephone companies operating LECs The new feature inter LATA traffic handled different kind company IXC IntereXchange Carrier Originally AT T Long Lines serious IXC well established competitors Verizon Sprint IXC business One concerns breakup ensure IXCs would treated equally terms line quality tariffs number digits customers would dial use The way handled illustrated Here see three example LATAs several end offices LATAs 2 3 also small hierarchy tandem offices intra LATA toll offices IXC 1 toll office IXC 2 toll office IXC POP Tandem office End office To local loops LATA 1 LATA 2 LATA 3 The relationship LATAs LECs IXCs All circles LEC switching offices Each hexagon belongs IXC whose number Any IXC wishes handle calls originating LATA build switching office called POP Point Presence The LEC required connect IXC every end office either directly LATAs 1 3 indirectly LATA 2 Furthermore terms connection technical financial must identical IXCs This requirement enables subscriber say LATA 1 choose IXC use calling subscribers LATA 3 As part MFJ IXCs forbidden offer local telephone service LECs forbidden offer inter LATA telephone service although 144 THE PHYSICAL LAYER free enter business operating fried chicken restaurants In 1984 fairly unambiguous statement Unfortunately technology funny way making law obsolete Neither cable television mobile phones covered agreement As cable television went one way two way mobile phones exploded popularity LECs IXCs began buying merging cable mobile operators By 1995 Congress saw trying maintain distinction various kinds companies longer tenable drafted bill preserve accessibility competition allow cable TV companies local telephone companies long distance carriers mobile operators enter one another businesses The idea company could offer customers single integrated package containing cable TV telephone information services different companies would compete service price The bill enacted law February 1996 major overhaul telecommunications regulation As result BOCs became IXCs companies cable television operators began offering local telephone service competition LECs One interesting property 1996 law requirement LECs implement local number portability This means customer change local telephone companies without get new telephone number Portability mobile phone numbers fixed mobile lines followed suit 2003 These provisions removed huge hurdle many people making much inclined switch LECs As result U S telecommunications landscape became much competitive countries followed suit Often countries wait see kind experiment works U S If works well thing works badly try something else 2 6 3 The Local Loop Modems ADSL Fiber It time start detailed study telephone system works Let us begin part people familiar two wire local loop coming telephone company end office houses The local loop also frequently referred last mile although length several miles It carried analog information 100 years likely continue years come due high cost converting digital Much effort devoted squeezing data networking copper local loops already deployed Telephone modems send digital data computers narrow channel telephone network provides voice call They widely used largely displaced broadband technologies ADSL reuse local loop send digital data customer end office siphoned Internet SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK Both modems ADSL must deal limitations old local loops relatively narrow bandwidth attenuation distortion signals susceptibility electrical noise crosstalk In places local loop modernized installing optical fiber close home Fiber way future These installations support computer networks ground local loop ample bandwidth data services The limiting factor people pay physics local loop In section study local loop old new We cover telephone modems ADSL fiber home Telephone Modems To send bits local loop physical channel matter must converted analog signals transmitted channel This conversion accomplished using methods digital modulation studied previous section At end channel analog signal converted back bits A device converts stream digital bits analog signal represents bits called modem short modulator demodulator Modems come many varieties telephone modems DSL modems cable modems wireless modems etc The modem may built computer common telephone modems separate box common DSL cable modems Logically modem inserted digital computer analog telephone system seen Trunk digital fiber Computer Digital line Local loop analog Modem ISP 2 Analog line Codec ISP 1 End office Codec Modem The use analog digital transmission computerto computer call Conversion done modems codecs Telephone modems used send bits two computers voice grade telephone line place conversation usually fills line The main difficulty voice grade telephone line limited 3100 Hz sufficient carry conversation This bandwidth four orders magnitude less bandwidth used Ethernet 146 THE PHYSICAL LAYER 802 11 WiFi Unsurprisingly data rates telephone modems also four orders magnitude less Ethernet 802 11 Let us run numbers see case The Nyquist theorem tells us even perfect 3000 Hz line telephone line decidedly point sending symbols rate faster 6000 baud In practice modems send rate 2400 symbols sec 2400 baud focus getting multiple bits per symbol allowing traffic directions time using different frequencies different directions The humble 2400 bps modem uses 0 volts logical 0 1 volt logical 1 1 bit per symbol One step use four different symbols four phases QPSK 2 bits symbol get data rate 4800 bps A long progression higher rates achieved technology improved Higher rates require larger set symbols constellation With many symbols even small amount noise detected amplitude phase result error To reduce chance errors standards higher speed modems use symbols error correction The schemes known TCM Trellis Coded Modulation Ungerboeck 1987 The V 32 modem standard uses 32 constellation points transmit 4 data bits 1 check bit per symbol 2400 baud achieve 9600 bps error correction The next step 9600 bps 14 400 bps It called V 32 bis transmits 6 data bits 1 check bit per symbol 2400 baud Then comes V 34 achieves 28 800 bps transmitting 12 data bits symbol 2400 baud The constellation thousands points The final modem series V 34 bis uses 14 data bits symbol 2400 baud achieve 33 600 bps Why stop The reason standard modems stop 33 600 Shannon limit telephone system 35 kbps based average length local loops quality lines Going faster would violate laws physics department thermodynamics However one way change situation At telephone company end office data converted digital form transmission within telephone network core telephone network converted analog digital long ago The 35 kbps limit situation two local loops one end Each adds noise signal If could get rid one local loops would increase SNR maximum rate would doubled This approach 56 kbps modems made work One end typically ISP gets high quality digital feed nearest end office Thus one end connection high quality signal ISPs maximum data rate high 70 kbps Between two home users modems analog lines maximum still 33 6 kbps The reason 56 kbps modems rather 70 kbps modems use Nyquist theorem A telephone channel carried inside telephone system digital samples Each telephone channel 4000 Hz wide SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK guard bands included The number samples per second needed reconstruct thus 8000 The number bits per sample U S 8 one may used control purposes allowing 56 000 bits sec user data In Europe 8 bits available users 64 000 bit sec modems could used get international agreement standard 56 000 chosen The end result V 90 V 92 modem standards They provide 56 kbps downstream channel ISP user 33 6 kbps 48 kbps upstream channel user ISP respectively The asymmetry usually data transported ISP user way It also means limited bandwidth allocated downstream channel increase chances actually working 56 kbps Digital Subscriber Lines When telephone industry finally got 56 kbps patted back job well done Meanwhile cable TV industry offering speeds 10 Mbps shared cables As Internet access became increasingly important part business telephone companies LECs began realize needed competitive product Their answer offer new digital services local loop Initially many overlapping high speed offerings general name xDSL Digital Subscriber Line various x Services bandwidth standard telephone service sometimes called broadband although term really marketing concept specific technical concept Later discuss become popular services ADSL Asymmetric DSL We also use term DSL xDSL shorthand flavors The reason modems slow telephones invented carrying human voice entire system carefully optimized purpose Data always stepchildren At point local loop terminates end office wire runs filter attenuates frequencies 300 Hz 3400 Hz The cutoff sharp 300 Hz 3400 Hz 3 dB points bandwidth usually quoted 4000 Hz even though distance 3 dB points 3100 Hz Data wire thus also restricted narrow band The trick makes xDSL work customer subscribes incoming line connected different kind switch one filter thus making entire capacity local loop available The limiting factor becomes physics local loop supports roughly 1 MHz artificial 3100 Hz bandwidth created filter Unfortunately capacity local loop falls rather quickly distance end office signal increasingly degraded along wire It also depends thickness general quality twisted pair A plot 148 THE PHYSICAL LAYER potential bandwidth function distance given This figure assumes factors optimal new wires modest bundles etc Mbps 3010Meters Bandwidth versus distance Category 3 UTP DSL The implication figure creates problem telephone company When picks speed offer simultaneously picking radius end offices beyond service offered This means distant customers try sign service may told Thanks lot interest live 100 meters far nearest end office get service Could please move The lower chosen speed larger radius customers covered But lower speed less attractive service fewer people willing pay This business meets technology The xDSL services designed certain goals mind First services must work existing Category 3 twisted pair local loops Second must affect customers existing telephones fax machines Third must much faster 56 kbps Fourth always monthly charge per minute charge To meet technical goals available 1 1 MHz spectrum local loop divided 256 independent channels 4312 5 Hz This arrangement shown The OFDM scheme saw previous section used send data channels though often called DMT Discrete MultiTone context ADSL Channel 0 used POTS Plain Old Telephone Service Channels 1 5 used keep voice data signals interfering Of remaining 250 channels one used upstream control one used downstream control The rest available user data In principle remaining channels used full duplex data stream harmonics crosstalk effects keep practical systems well SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK Power 256 4 kHz Channels Voice 1100 kHz Upstream Downstream Operation ADSL using discrete multitone modulation theoretical limit It provider determine many channels used upstream many downstream A 50 50 mix upstream downstream technically possible providers allocate something like 80 90 bandwidth downstream channel since users download data upload This choice gives rise A ADSL A common split 32 channels upstream rest downstream It also possible highest upstream channels bidirectional increased bandwidth although making optimization requires adding special circuit cancel echoes The international ADSL standard known G dmt approved 1999 It allows speeds much 8 Mbps downstream 1 Mbps upstream It superseded second generation 2002 called ADSL2 various improvements allow speeds much 12 Mbps downstream 1 Mbps upstream Now ADSL2 doubles downstream speed 24 Mbps doubling bandwidth use 2 2 MHz twisted pair However numbers quoted best case speeds good lines close within 1 2 km exchange Few lines support rates providers offer speeds Typically providers offer something like 1 Mbps downstream 256 kbps upstream standard service 4 Mbps downstream 1 Mbps upstream improved service 8 Mbps downstream 2 Mbps upstream premium service Within channel QAM modulation used rate roughly 4000 symbols sec The line quality channel constantly monitored data rate adjusted using larger smaller constellation like Different channels may different data rates 15 bits per symbol sent channel high SNR 2 1 bits per symbol sent channel low SNR depending standard A typical ADSL arrangement shown In scheme telephone company technician must install NID Network Interface Device customer premises This small plastic box marks end telephone company property start customer property Close NID sometimes combined splitter analog filter separates 150 THE PHYSICAL LAYER 0 4000 Hz band used POTS data The POTS signal routed existing telephone fax machine The data signal routed ADSL modem uses digital signal processing implement OFDM Since ADSL modems external computer must connected high speed Usually done using Ethernet USB cable 802 11 Voice switch Telephone Codec Splitter Telephone line Splitter NID Computer DSLAM To ISP Telephone company end office ADSL modem Ethernet Customer premises A typical ADSL equipment configuration At end wire end office side corresponding splitter installed Here voice portion signal filtered sent normal voice switch The signal 26 kHz routed new kind device called DSLAM Digital Subscriber Line Access Multiplexer contains kind digital signal processor ADSL modem Once bits recovered signal packets formed sent ISP This complete separation voice system ADSL makes relatively easy telephone company deploy ADSL All needed buying DSLAM splitter attaching ADSL subscribers splitter Other high bandwidth services e g ISDN require much greater changes existing switching equipment One disadvantage design need NID splitter customer premises Installing done telephone company technician necessitating expensive truck roll e sending technician customer premises Therefore alternative splitterless design informally called G lite also standardized It without customer splitter The existing telephone line used The difference microfilter inserted telephone jack SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK telephone ADSL modem wire The microfilter telephone low pass filter eliminating frequencies 3400 Hz microfilter ADSL modem high pass filter eliminating frequencies 26 kHz However system reliable splitter G lite used 1 5 Mbps versus 8 Mbps ADSL splitter For information ADSL see Starr 2003 Fiber To The Home Deployed copper local loops limit performance ADSL telephone modems To let provide faster better network services telephone companies upgrading local loops every opportunity installing optical fiber way houses offices The result called FttH Fiber To The Home While FttH technology available time deployments began take 2005 growth demand high speed Internet customers used DSL cable wanted download movies Around 4 U S houses connected FttH Internet access speeds 100 Mbps Several variations form FttX X stands basement curb neighborhood exist They used note fiber deployment may reach close house In case copper twisted pair coaxial cable provides fast enough speeds last short distance The choice far lay fiber economic one balancing cost expected revenue In case point optical fiber crossed traditional barrier last mile We focus FttH discussion Like copper wires fiber local loop passive This means powered equipment required amplify otherwise process signals The fiber simply carries signals home end office This turn reduces cost improves reliability Usually fibers houses joined together single fiber reaches end office per group 100 houses In downstream direction optical splitters divide signal end office reaches houses Encryption needed security one house able decode signal In upstream direction optical combiners merge signals houses single signal received end office This architecture called PON Passive Optical Network shown It common use one wavelength shared houses downstream transmission another wavelength upstream transmission Even splitting tremendous bandwidth low attenuation fiber mean PONs provide high rates users distances 20 km The actual data rates details depend type PON Two kinds common GPONs Gigabit capable PONs come world telecommunications defined ITU standard EPONs Ethernet PONs 152 THE PHYSICAL LAYER Fiber Rest network End office Optical splitter combiner Passive optical network Fiber To The Home tune world networking defined IEEE standard Both run around gigabit carry traffic different services including Internet video voice For example GPONs provide 2 4 Gbps downstream 1 2 2 4 Gbps upstream Some protocol needed share capacity single fiber end office different houses The downstream direction easy The end office send messages different house whatever order likes In upstream direction however messages different houses sent time different signals would collide The houses also hear transmissions listen transmitting The solution equipment houses requests granted time slots use equipment end office For work ranging process adjust transmission times houses signals received end office synchronized The design similar cable modems cover later chapter For information future PONs see Grobe Elbers 2008 2 6 4 Trunks Multiplexing Trunks telephone network much faster local loops different two respects The core telephone network carries digital information analog information bits voice This necessitates conversion end office digital form transmission longhaul trunks The trunks carry thousands even millions calls simultaneously This sharing important achieving economies scale since costs essentially amount money install maintain high bandwidth trunk low bandwidth trunk two switching offices It accomplished versions TDM FDM multiplexing Below briefly examine voice signals digitized transported telephone network After see TDM used carry bits trunks including TDM system used fiber optics SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK SONET Then turn FDM applied fiber optics called wavelength division multiplexing Digitizing Voice Signals Early development telephone network core handled voice calls analog information FDM techniques used many years multiplex 4000 Hz voice channels comprised 3100 Hz plus guard bands larger larger units For example 12 calls 60 kHz 108 kHz band known group five groups total 60 calls known supergroup These FDM methods still used copper wires microwave channels However FDM requires analog circuitry amenable done computer In contrast TDM handled entirely digital electronics become far widespread recent years Since TDM used digital data local loops produce analog signals conversion needed analog digital end office individual local loops come together combined onto outgoing trunks The analog signals digitized end office device called codec short coder decoder The codec makes 8000 samples per second 125 sec sample Nyquist theorem says sufficient capture information 4 kHz telephone channel bandwidth At lower sampling rate information would lost higher one extra information would gained Each sample amplitude signal quantized 8 bit number This technique called PCM Pulse Code Modulation It forms heart modern telephone system As consequence virtually time intervals within telephone system multiples 125 sec The standard uncompressed data rate voice grade telephone call thus 8 bits every 125 sec 64 kbps At end call analog signal recreated quantized samples playing smoothing time It exactly original analog signal even though sampled Nyquist rate samples quantized To reduce error due quantization quantization levels unevenly spaced A logarithmic scale used gives relatively bits smaller signal amplitudes relatively fewer bits large signal amplitudes In way error proportional signal amplitude Two versions quantization widely used law used North America Japan A law used Europe rest world Both versions specified standard ITU G 711 An equivalent way think process imagine dynamic range signal ratio largest smallest possible values compressed evenly quantized expanded analog signal recreated For reason called 154 THE PHYSICAL LAYER companding It also possible compress samples digitized require much less 64 kbps However leave topic explore audio applications voice IP Time Division Multiplexing TDM based PCM used carry multiple voice calls trunks sending sample call every 125 sec When digital transmission began emerging feasible technology ITU called CCITT unable reach agreement international standard PCM Consequently variety incompatible schemes use different countries around world The method used North America Japan T1 carrier depicted Technically speaking format called DS1 carrier called T1 following widespread industry tradition make subtle distinction The T1 carrier consists 24 voice channels multiplexed together Each 24 channels turn gets insert 8 bits output stream 193 bit frame 125 sec Channel Channel Channel Channel Channel0 Bit 1 framing code 7 Data bits per channel per sample Bit 8 signaling The T1 carrier 1 544 Mbps A frame consists 24 8 192 bits plus one extra bit control purposes yielding 193 bits every 125 sec This gives gross data rate 1 544 Mbps 8 kbps signaling The 193rd bit used frame synchronization signaling In one variation 193rd bit used across group 24 frames called extended superframe Six bits 4th 8th 12th 16th 20th 24th positions take alternating pattern 001011 Normally receiver keeps checking pattern make sure lost synchronization Six bits used send error check code help receiver confirm synchronized If get sync receiver scan pattern validate error check code get resynchronized The remaining 12 SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK bits used control information operating maintaining network performance reporting remote end The T1 format several variations The earlier versions sent signaling information band meaning channel data using data bits This design one form channel associated signaling channel private signaling subchannel In one arrangement least significant bit 8 bit sample channel used every sixth frame It colorful name robbed bit signaling The idea stolen bits matter voice calls No one hear difference For data however another story Delivering wrong bits unhelpful say least If older versions T1 used carry data 7 8 bits 56 kbps used 24 channels Instead newer versions T1 provide clear channels bits may used send data Clear channels businesses lease T1 line want send data across telephone network place voice samples Signaling voice calls handled band meaning separate channel data Often signaling done common channel signaling shared signaling channel One 24 channels may used purpose Outside North America Japan 2 048 Mbps E1 carrier used instead T1 This carrier 32 8 bit data samples packed basic 125 sec frame Thirty channels used information two used signaling Each group four frames provides 64 signaling bits half used signaling whether channel associated common channel half used frame synchronization reserved country use wishes Time division multiplexing allows multiple T1 carriers multiplexed higher order carriers shows done At left see four T1 channels multiplexed one T2 channel The multiplexing T2 done bit bit rather byte byte 24 voice channels make T1 frame Four T1 streams 1 544 Mbps generate 6 176 Mbps T2 actually 6 312 Mbps The extra bits used framing recovery case carrier slips T1 T3 widely used customers whereas T2 T4 used within telephone system well known At next level seven T2 streams combined bitwise form T3 stream Then six T3 streams joined form T4 stream At step small amount overhead added framing recovery case synchronization sender receiver lost Just little agreement basic carrier United States rest world equally little agreement multiplexed higher bandwidth carriers The U S scheme stepping 4 7 6 strike everyone else way go ITU standard calls multiplexing four streams one stream level Also framing 156 THE PHYSICAL LAYER 4 T1 streams 7 T2 streams 6 T3 streams 1 T2 stream 51 4 1 6 5 4 32 10 7 1 6 1 1 544 Mbps 6 312 Mbps 44 736 Mbps 274 176 Mbps T1 T2 T3 T4 Multiplexing T1 streams higher carriers recovery data different U S ITU standards The ITU hierarchy 32 128 512 2048 8192 channels runs speeds 2 048 8 848 34 304 139 264 565 148 Mbps SONET SDH In early days fiber optics every telephone company proprietary optical TDM system After AT T broken 1984 local telephone companies connect multiple long distance carriers different optical TDM systems need standardization became obvious In 1985 Bellcore RBOC research arm began working standard called SONET Synchronous Optical NETwork Later ITU joined effort resulted SONET standard set parallel ITU recommendations G 707 G 708 G 709 1989 The ITU recommendations called SDH Synchronous Digital Hierarchy differ SONET minor ways Virtually long distance telephone traffic United States much elsewhere uses trunks running SONET physical layer For additional information SONET see Bellamy 2000 Goralski 2002 Shepard 2001 The SONET design four major goals First foremost SONET make possible different carriers interwork Achieving goal required defining common signaling standard respect wavelength timing framing structure issues Second means needed unify U S European Japanese digital systems based 64 kbps PCM channels combined different incompatible ways Third SONET provide way multiplex multiple digital channels At time SONET devised highest speed digital carrier actually used widely United States T3 44 736 Mbps T4 defined used SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK much nothing even defined T4 speed Part SONET mission continue hierarchy gigabits sec beyond A standard way multiplex slower channels one SONET channel also needed Fourth SONET provide support operations administration maintenance OAM needed manage network Previous systems well An early decision make SONET traditional TDM system entire bandwidth fiber devoted one channel containing time slots various subchannels As SONET synchronous system Each sender receiver tied common clock The master clock controls system accuracy 1 part 109 Bits SONET line sent extremely precise intervals controlled master clock The basic SONET frame block 810 bytes put every 125 sec Since SONET synchronous frames emitted whether useful data send Having 8000 frames sec exactly matches sampling rate PCM channels used digital telephony systems The 810 byte SONET frames best described rectangle bytes 90 columns wide 9 rows high Thus 8 810 6480 bits transmitted 8000 times per second gross data rate 51 84 Mbps This layout basic SONET channel called STS 1 Synchronous Transport Signal 1 All SONET trunks multiples STS 1 The first three columns frame reserved system management information illustrated In block first three rows contain section overhead next six contain line overhead The section overhead generated checked start end section whereas line overhead generated checked start end line A SONET transmitter sends back back 810 byte frames without gaps even data case sends dummy data From receiver point view sees continuous bit stream know frame begins The answer first 2 bytes frame contain fixed pattern receiver searches If finds pattern place large number consecutive frames assumes sync sender In theory user could insert pattern payload regular way practice done due multiplexing multiple users frame reasons The remaining 87 columns frame hold 87 9 8 8000 50 112 Mbps user data This user data could voice samples T1 carriers swallowed whole packets SONET simply convenient container transporting bits The SPE Synchronous Payload Envelope carries user data always begin row 1 column 4 The SPE begin anywhere within frame A pointer first byte contained first row line overhead The first column SPE path overhead e header end end path sublayer protocol 158 THE PHYSICAL LAYER 3 Columns overhead 87 Columns Rows Section overhead Line overhead Path overhead Sonet frame 125 sec Sonet frame 125 sec SPE Two back back SONET frames The ability allow SPE begin anywhere within SONET frame even span two frames shown gives added flexibility system For example payload arrives source dummy SONET frame constructed inserted current frame instead held start next one The SONET SDH multiplexing hierarchy shown Rates STS 1 STS 768 defined ranging roughly T3 line 40 Gbps Even higher rates surely defined time OC 3072 160 Gbps next line becomes technologically feasible The optical carrier corresponding STS n called OC n bit bit except certain bit reordering needed synchronization The SDH names different start OC 3 ITU based systems rate near 51 84 Mbps We shown common rates proceed OC 3 multiples four The gross data rate includes overhead The SPE data rate excludes line section overhead The user data rate excludes overhead counts 87 payload columns As aside carrier OC 3 multiplexed carries data single source letter c concatenated appended designation OC 3 indicates 155 52 Mbps carrier consisting three separate OC 1 carriers OC 3c indicates data stream single source 155 52 Mbps The three OC 1 streams within OC 3c stream interleaved column first column 1 stream 1 column 1 stream 2 column 1 stream 3 followed column 2 stream 1 leading frame 270 columns wide 9 rows deep SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK SONET SDH Electrical Optical STS 1 OC 1 Optical Data rate Mbps Gross 51 84 SPE User 50 112 49 536 STS 3 OC 3 STM 1 155 52 150 336 148 608 STS 12 OC 12 STM 4 622 08 601 344 594 432 STS 48 OC 48 STM 16 2488 32 2405 376 2377 728 STS 192 OC 192 STM 64 9953 28 9621 504 9510 912 STS 768 OC 768 STM 256 39813 12 38486 016 38043 648 SONET SDH multiplex rates Wavelength Division Multiplexing A form frequency division multiplexing used well TDM harness tremendous bandwidth fiber optic channels It called WDM Wavelength Division Multiplexing The basic principle WDM fibers depicted Here four fibers come together optical combiner energy present different wavelength The four beams combined onto single shared fiber transmission distant destination At far end beam split many fibers input side Each output fiber contains short specially constructed core filters one wavelength The resulting signals routed destination recombined different ways additional multiplexed transport There really nothing new This way operating frequency division multiplexing high frequencies term WDM owing description fiber optic channels wavelength color rather frequency As long channel frequency e wavelength range ranges disjoint multiplexed together long haul fiber The difference electrical FDM optical system using diffraction grating completely passive thus highly reliable The reason WDM popular energy single channel typically gigahertz wide current limit fast convert electrical optical signals By running many channels parallel different wavelengths aggregate bandwidth increased linearly number channels Since bandwidth single fiber band 25 000 GHz see theoretically room 2500 10 Gbps channels even 1 bit Hz higher rates also possible WDM technology progressing rate puts computer technology shame WDM invented around 1990 The first commercial systems eight channels 2 5 Gbps per channel By 1998 systems 40 channels 160 THE PHYSICAL LAYER Fiber 1 Fiber 2 Fiber 3 Fiber 4 2 2 4 Filter 1 3 Spectrum shared fiber Power Fiber 4 spectrum Power Fiber 3 spectrum Power Fiber 2 spectrum Power Power Fiber 1 spectrum 1 2 3 4 Combiner 4 Splitter 1 Long haul shared fiber 3 Wavelength division multiplexing 2 5 Gbps market By 2006 products 192 channels 10 Gbps 64 channels 40 Gbps capable moving 2 56 Tbps This bandwidth enough transmit 80 full length DVD movies per second The channels also packed tightly fiber 200 100 little 50 GHz separation Technology demonstrations companies bragging rights shown 10 times capacity lab going lab field usually takes least years When number channels large wavelengths spaced close together system referred DWDM Dense WDM One drivers WDM technology development optical components Previously every 100 km necessary split channels convert one electrical signal amplification separately reconverting optical signals combining Nowadays optical amplifiers regenerate entire signal every 1000 km without need multiple opto electrical conversions In example fixed wavelength system Bits input fiber 1 go output fiber 3 bits input fiber 2 go output fiber 1 etc However also possible build WDM systems switched optical domain In device output filters tunable using Fabry Perot Mach Zehnder interferometers These devices allow selected frequencies changed dynamically control computer This ability provides large amount flexibility provision many different wavelength paths telephone network fixed set fibers For information optical networks WDM see Ramaswami et al 2009 SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK 2 6 5 Switching From point view average telephone engineer phone system divided two principal parts outside plant local loops trunks since physically outside switching offices inside plant switches inside switching offices We looked outside plant Now time examine inside plant Two different switching techniques used network nowadays circuit switching packet switching The traditional telephone system based circuit switching packet switching beginning make inroads rise voice IP technology We go circuit switching detail contrast packet switching Both kinds switching important enough come back get network layer Circuit Switching Conceptually computer places telephone call switching equipment within telephone system seeks physical path way telephone receiver telephone This technique called circuit switching It shown schematically Each six rectangles represents carrier switching office end office toll office etc In example office three incoming lines three outgoing lines When call passes switching office physical connection conceptually established line call came one output lines shown dotted lines In early days telephone connection made operator plugging jumper cable input output sockets In fact surprising little story associated invention automatic circuit switching equipment It invented 19th century Missouri undertaker named Almon B Strowger Shortly telephone invented someone died one survivors would call town operator say Please connect undertaker Unfortunately Mr Strowger two undertakers town one wife town telephone operator He quickly saw either going invent automatic telephone switching equipment going go business He chose first option For nearly 100 years circuit switching equipment used worldwide known Strowger gear History record whether unemployed switchboard operator got job information operator answering questions What phone number undertaker The model shown highly simplified course parts physical path two telephones may fact microwave fiber links onto thousands calls multiplexed Nevertheless basic idea valid call set dedicated path ends exists continue exist call finished 162 THE PHYSICAL LAYER Physical copper connection set call made Switching office Computer Packets queued subsequent transmission Computer b Circuit switching b Packet switching An important property circuit switching need set end end path data sent The elapsed time end dialing start ringing easily 10 sec long distance international calls During time interval telephone system hunting path shown Note data transmission even begin call request signal must propagate way destination acknowledged For many computer applications e g point sale credit verification long setup times undesirable As consequence reserved path calling parties setup completed delay data propagation time electromagnetic signal 5 msec per 1000 km Also consequence established path danger congestion call put never get busy signals Of course might get one connection established due lack switching trunk capacity Packet Switching The alternative circuit switching packet switching shown Fig 242 b described Chap 1 With technology packets sent soon available There need set dedicated path advance unlike SEC 2 6 THE PUBLIC SWITCHED TELEPHONE NETWORK Call request signal Pkt 1 Propagation delay Pkt 2 Queuing delay Pkt 1 Pkt 3 Pkt 2 Pkt 1 Pkt 3 Pkt 2 Time Time spent hunting outgoing trunk Pkt 3 Call accept signal Data BC trunk AB trunk A B CD trunk C D A B C D b Timing events circuit switching b packet switching circuit switching It routers use store forward transmission send packet way destination This procedure unlike circuit switching result connection setup reservation bandwidth way sender receiver All data circuit follows path Among properties data follow path means arrive order With packet switching fixed path different packets follow different paths depending network conditions time sent may arrive order Packet switching networks place tight upper limit size packets This ensures user monopolize transmission line long e g many milliseconds packet switched networks handle interactive traffic It also reduces delay since first packet long message forwarded second one fully arrived However store forward delay accumulating packet router memory sent 164 THE PHYSICAL LAYER next router exceeds circuit switching With circuit switching bits flow wire continuously Packet circuit switching also differ ways Because bandwidth reserved packet switching packets may wait forwarded This introduces queuing delay congestion many packets sent time On hand danger getting busy signal unable use network Thus congestion occurs different times circuit switching setup time packet switching packets sent If circuit reserved particular user traffic bandwidth wasted It used traffic Packet switching waste bandwidth thus efficient system perspective Understanding trade crucial comprehending difference circuit switching packet switching The trade guaranteed service wasting resources versus guaranteeing service wasting resources Packet switching fault tolerant circuit switching In fact invented If switch goes circuits using terminated traffic sent With packet switching packets routed around dead switches A final difference circuit packet switching charging algorithm With circuit switching charging historically based distance time For mobile phones distance usually play role except international calls time plays coarse role e g calling plan 2000 free minutes costs one 1000 free minutes sometimes nights weekends cheap With packet switching connect time issue volume traffic For home users ISPs usually charge flat monthly rate less work customers understand model backbone carriers charge regional networks based volume traffic The differences summarized Traditionally telephone networks used circuit switching provide high quality telephone calls computer networks used packet switching simplicity efficiency However notable exceptions Some older computer networks circuit switched covers e g X 25 newer telephone networks use packet switching voice IP technology This looks like standard telephone call outside users inside network packets voice data switched This approach let upstarts market cheap international calls via calling cards though perhaps lower call quality incumbents 2 7 THE MOBILE TELEPHONE SYSTEM The traditional telephone system even someday gets multigigabit end toend fiber still able satisfy growing group users people go People expect make phone calls use phones check SEC 2 7 THE MOBILE TELEPHONE SYSTEM Item Circuit switched Packet switched Call setup Required Not needed Dedicated physical path Yes No Each packet follows route Yes No Packets arrive order Yes No Is switch crash fatal Yes No Bandwidth available Fixed Dynamic Time possible congestion At setup time On every packet Potentially wasted bandwidth Yes No Store forward transmission No Yes Charging Per minute Per packet A comparison circuit switched packet switched networks email surf Web airplanes cars swimming pools jogging park Consequently tremendous amount interest wireless telephony In following sections study topic detail The mobile phone system used wide area voice data communication Mobile phones sometimes called cell phones gone three distinct generations widely called 1G 2G 3G The generations 1 Analog voice 2 Digital voice 3 Digital voice data Internet email etc Mobile phones confused cordless phones consist base station handset sold set use within home These never used networking examine Although discussion technology systems interesting note political tiny marketing decisions huge impact The first mobile system devised U S AT T mandated whole country FCC As result entire U S single analog system mobile phone purchased California also worked New York In contrast mobile phones came Europe every country devised system resulted fiasco Europe learned mistake digital came around government run PTTs got together standardized single system GSM European mobile phone work anywhere Europe By U S decided government standardization business left digital marketplace This decision resulted different equipment manufacturers producing different kinds mobile phones As consequence U S 166 THE PHYSICAL LAYER two major completely incompatible digital mobile phone systems deployed well minor systems Despite initial lead U S mobile phone ownership usage Europe far greater U S Having single system works anywhere Europe provider part reason A second area U S Europe differed humble matter phone numbers In U S mobile phones mixed regular fixed telephones Thus way caller see say 212 234 5678 fixed telephone cheap free call mobile phone expensive call To keep people getting nervous placing calls telephone companies decided make mobile phone owner pay incoming calls As consequence many people hesitated buying mobile phone fear running big bill receiving calls In Europe mobile phone numbers special area code analogous 800 900 numbers instantly recognizable Consequently usual rule caller pays also applies mobile phones Europe except international calls costs split A third issue large impact adoption widespread use prepaid mobile phones Europe 75 areas These purchased many stores formality buying digital camera You pay go They preloaded balance example 20 50 euros recharged using secret PIN code balance drops zero As consequence practically every teenager many small children Europe usually prepaid mobile phones parents locate without danger child running huge bill If mobile phone used occasionally use essentially free since monthly charge charge incoming calls 2 7 1 First Generation 1G Mobile Phones Analog Voice Enough politics marketing aspects mobile phones Now let us look technology starting earliest system Mobile radiotelephones used sporadically maritime military communication early decades 20th century In 1946 first system car based telephones set St Louis This system used single large transmitter top tall building single channel used sending receiving To talk user push button enabled transmitter disabled receiver Such systems known push talk systems installed several cities beginning late 1950s CB radio taxis police cars often use technology In 1960s IMTS Improved Mobile Telephone System installed It used high powered 200 watt transmitter top hill two frequencies one sending one receiving push talk button SEC 2 7 THE MOBILE TELEPHONE SYSTEM longer needed Since communication mobile telephones went inbound different channel outbound signals mobile users could hear unlike push talk system used taxis IMTS supported 23 channels spread 150 MHz 450 MHz Due small number channels users often wait long time getting dial tone Also due large power hilltop transmitters adjacent systems several hundred kilometers apart avoid interference All limited capacity made system impractical Advanced Mobile Phone System All changed AMPS Advanced Mobile Phone System invented Bell Labs first installed United States 1982 It also used England called TACS Japan called MCS L1 AMPS formally retired 2008 look understand context 2G 3G systems improved In mobile phone systems geographic region divided cells devices sometimes called cell phones In AMPS cells typically 10 20 km across digital systems cells smaller Each cell uses set frequencies used neighbors The key idea gives cellular systems far capacity previous systems use relatively small cells reuse transmission frequencies nearby adjacent cells Whereas IMTS system 100 km across one call frequency AMPS system might 100 10 km cells area able 10 15 calls frequency widely separated cells Thus cellular design increases system capacity least order magnitude cells get smaller Furthermore smaller cells mean less power needed leads smaller cheaper transmitters handsets The idea frequency reuse illustrated The cells normally roughly circular easier model hexagons In cells size They grouped units seven cells Each letter indicates group frequencies Notice frequency set buffer two cells wide frequency reused providing good separation low interference Finding locations high air place base station antennas major issue This problem led telecommunication carriers forge alliances Roman Catholic Church since latter owns substantial number exalted potential antenna sites worldwide conveniently single management In area number users grown point system overloaded power reduced overloaded cells split smaller 168 THE PHYSICAL LAYER B B C G A A D F D F C G E E B C G A D F E b Frequencies reused adjacent cells b To add users smaller cells used microcells permit frequency reuse shown b Telephone companies sometimes create temporary microcells using portable towers satellite links sporting events rock concerts places large numbers mobile users congregate hours At center cell base station telephones cell transmit The base station consists computer transmitter receiver connected antenna In small system base stations connected single device called MSC Mobile Switching Center MTSO Mobile Telephone Switching Office In larger one several MSCs may needed connected second level MSC The MSCs essentially end offices telephone system fact connected least one telephone system end office The MSCs communicate base stations PSTN using packet switching network At instant mobile telephone logically one specific cell control cell base station When mobile telephone physically leaves cell base station notices telephone signal fading away asks surrounding base stations much power getting When answers come back base station transfers ownership cell getting strongest signal conditions cell telephone located The telephone informed new boss call progress asked switch new channel old one reused adjacent cells This process called handoff takes 300 msec Channel assignment done MSC nerve center system The base stations really dumb radio relays SEC 2 7 THE MOBILE TELEPHONE SYSTEM Channels AMPS uses FDM separate channels The system uses 832 full duplex channels consisting pair simplex channels This arrangement known FDD Frequency Division Duplex The 832 simplex channels 824 849 MHz used mobile base station transmission 832 simplex channels 869 894 MHz used base station mobile transmission Each simplex channels 30 kHz wide The 832 channels divided four categories Control channels base mobile used manage system Paging channels base mobile alert mobile users calls Access channels bidirectional used call setup channel assignment Finally data channels bidirectional carry voice fax data Since frequencies reused nearby cells 21 channels reserved cell control actual number voice channels available per cell much smaller 832 typically 45 Call Management Each mobile telephone AMPS 32 bit serial number 10 digit telephone number programmable read memory The telephone number represented 3 digit area code 10 bits 7 digit subscriber number 24 bits When phone switched scans preprogrammed list 21 control channels find powerful signal The phone broadcasts 32 bit serial number 34 bit telephone number Like control information AMPS packet sent digital form multiple times error correcting code even though voice channels analog When base station hears announcement tells MSC records existence new customer also informs customer home MSC current location During normal operation mobile telephone reregisters every 15 minutes To make call mobile user switches phone enters number called keypad hits SEND button The phone transmits number called identity access channel If collision occurs tries later When base station gets request informs MSC If caller customer MSC company one partners MSC looks idle channel call If one found channel number sent back control channel The mobile phone automatically switches selected voice channel waits called party picks phone Incoming calls work differently To start idle phones continuously listen paging channel detect messages directed When call placed mobile phone either fixed phone another mobile phone packet sent callee home MSC find A packet 170 THE PHYSICAL LAYER sent base station current cell sends broadcast paging channel form Unit 14 The called phone responds Yes access channel The base says something like Unit 14 call channel 3 At point called phone switches channel 3 starts making ringing sounds playing melody owner given birthday present 2 7 2 Second Generation 2G Mobile Phones Digital Voice The first generation mobile phones analog second generation digital Switching digital several advantages It provides capacity gains allowing voice signals digitized compressed It improves security allowing voice control signals encrypted This turn deters fraud eavesdropping whether intentional scanning echoes calls due RF propagation Finally enables new services text messaging Just worldwide standardization first generation also worldwide standardization second either Several different systems developed three widely deployed DAMPS Digital Advanced Mobile Phone System digital version AMPS coexists AMPS uses TDM place multiple calls frequency channel It described International Standard IS 54 successor IS 136 GSM Global System Mobile communications emerged dominant system slow catch U S used virtually everywhere world Like D AMPS GSM based mix FDM TDM CDMA Code Division Multiple Access described International Standard IS 95 completely different kind system based neither FDM mor TDM While CDMA become dominant 2G system technology become basis 3G systems Also name PCS Personal Communications Services sometimes used marketing literature indicate second generation e digital system Originally meant mobile phone using 1900 MHz band distinction rarely made We describe GSM since dominant 2G system In next section say CDMA describe 3G systems GSM The Global System Mobile Communications GSM started life 1980s effort produce single European 2G standard The task assigned telecommunications group called French Groupe Speciale Mobile The first GSM systems deployed starting 1991 quick success It soon became clear GSM going European success uptake stretching countries far away Australia GSM renamed worldwide appeal SEC 2 7 THE MOBILE TELEPHONE SYSTEM GSM mobile phone systems study retain 1G systems design based cells frequency reuse across cells mobility handoffs subscribers move It details differ Here briefly discuss main properties GSM However printed GSM standard 5000 sic pages long A large fraction material relates engineering aspects system especially design receivers handle multipath signal propagation synchronizing transmitters receivers None even mentioned shows GSM architecture similar AMPS architecture though components different names The mobile divided handset removable chip subscriber account information called SIM card short Subscriber Identity Module It SIM card activates handset contains secrets let mobile network identify encrypt conversations A SIM card removed plugged different handset turn handset mobile far network concerned Air interface BSC SIM card MSC BSC Handset HLR PSTN VLR Cell tower base station GSM mobile network architecture The mobile talks cell base stations air interface describe moment The cell base stations connected BSC Base Station Controller controls radio resources cells handles handoff The BSC turn connected MSC AMPS routes calls connects PSTN Public Switched Telephone Network To able route calls MSC needs know mobiles currently found It maintains database nearby mobiles associated cells manages This database called VLR Visitor Location Register There also database mobile network gives last known location mobile It called HLR Home Location Register This database used route incoming calls right locations Both databases must kept date mobiles move cell cell We describe air interface detail GSM runs range frequencies worldwide including 900 1800 1900 MHz More spectrum allocated AMPS order support much larger number users GSM 172 THE PHYSICAL LAYER frequency division duplex cellular system like AMPS That mobile transmits one frequency receives another higher frequency 55 MHz higher GSM versus 80 MHz higher AMPS However unlike AMPS GSM single frequency pair split time division multiplexing time slots In way shared multiple mobiles To handle multiple mobiles GSM channels much wider AMPS channels 200 kHz versus 30 kHz One 200 kHz channel shown A GSM system operating 900 MHz region 124 pairs simplex channels Each simplex channel 200 kHz wide supports eight separate connections using time division multiplexing Each currently active station assigned one time slot one channel pair Theoretically 992 channels supported cell many available avoid frequency conflicts neighboring cells In eight shaded time slots belong connection four direction Transmitting receiving happen time slot GSM radios transmit receive time takes time switch one If mobile device assigned 890 4 935 4 MHz time slot 2 wanted transmit base station would use lower four shaded slots ones following time putting data slot data sent Frequency TDM frame Channel 959 8 MHz 935 4 MHz 935 2 MHz 1 914 8 MHz 890 4 MHz 1 890 2 MHz Base mobile Mobile base Time GSM uses 124 frequency channels uses eightslot TDM system The TDM slots shown part complex framing hierarchy Each TDM slot specific structure groups TDM slots form multiframes also specific structure A simplified version hierarchy shown Here see TDM slot consists 148 bit data frame occupies channel 577 sec including 30 sec guard time SEC 2 7 THE MOBILE TELEPHONE SYSTEM slot Each data frame starts ends three 0 bits frame delineation purposes It also contains two 57 bit Information fields one control bit indicates whether following Information field voice data Between Information fields 26 bit Sync training field used receiver synchronize sender frame boundaries 32 500 Bit multiframe sent 120 msec C 9 10 11 T 13 14 15 16 17 18 19 20 21 22 23 24 L Reserved future use 1250 Bit TDM frame sent 4 615 msec 8 25 bit 30 sec guard time 148 Bit data frame sent 547 sec 000 Information Bits Sync Information 000 Voice data bit A portion GSM framing structure A data frame transmitted 547 sec transmitter allowed send one data frame every 4 615 msec since sharing channel seven stations The gross rate channel 270 833 bps divided among eight users However AMPS overhead eats large fraction bandwidth ultimately leaving 24 7 kbps worth payload per user error correction After error correction 13 kbps left speech While substantially less 64 kbps PCM uncompressed voice signals fixed telephone network compression mobile device reach levels little loss quality As seen eight data frames make TDM frame 26 TDM frames make 120 msec multiframe Of 26 TDM frames multiframe slot 12 used control slot 25 reserved future use 24 available user traffic However addition 26 slot multiframe shown 51 slot multiframe shown also used Some slots used hold several control channels used manage system The broadcast control channel continuous stream output base station containing base station identity channel status All mobile stations monitor signal strength see moved new cell 174 THE PHYSICAL LAYER The dedicated control channel used location updating registration call setup In particular BSC maintains database mobile stations currently jurisdiction VLR Information needed maintain VLR sent dedicated control channel Finally common control channel split three logical subchannels The first subchannels paging channel base station uses announce incoming calls Each mobile station monitors continuously watch calls answer The second random access channel allows users request slot dedicated control channel If two requests collide garbled retried later Using dedicated control channel slot station set call The assigned slot announced third subchannel access grant channel Finally GSM differs AMPS handoff handled In AMPS MSC manages completely without help mobile devices With time slots GSM mobile neither sending receiving time The idle slots opportunity mobile measure signal quality nearby base stations It sends information BSC The BSC use determine mobile leaving one cell entering another perform handoff This design called MAHO Mobile Assisted HandOff 2 7 3 Third Generation 3G Mobile Phones Digital Voice Data The first generation mobile phones analog voice second generation digital voice The third generation mobile phones 3G called digital voice data A number factors driving industry First data traffic already exceeds voice traffic fixed network growing exponentially whereas voice traffic essentially flat Many industry experts expect data traffic dominate voice mobile devices well soon Second telephone entertainment computer industries gone digital rapidly converging Many people drooling lightweight portable devices act telephone music video player email terminal Web interface gaming machine worldwide wireless connectivity Internet high bandwidth Apple iPhone good example kind 3G device With people get hooked wireless data services AT T wireless data volumes rising steeply popularity iPhones The trouble iPhone uses 2 5G network enhanced 2G network true 3G network enough data capacity keep users happy 3G mobile telephony providing enough wireless bandwidth keep future users happy ITU tried get bit specific vision starting back around 1992 It issued blueprint getting called IMT 2000 IMT stood SEC 2 7 THE MOBILE TELEPHONE SYSTEM International Mobile Telecommunications The basic services IMT 2000 network supposed provide users 1 High quality voice transmission 2 Messaging replacing email fax SMS chat etc 3 Multimedia playing music viewing videos films television etc 4 Internet access Web surfing including pages audio video Additional services might video conferencing telepresence group game playing commerce waving telephone cashier pay store Furthermore services supposed available worldwide automatic connection via satellite terrestrial network located instantly always quality service guarantees ITU envisioned single worldwide technology IMT 2000 manufacturers could build single device could sold used anywhere world like CD players computers unlike mobile phones televisions Having single technology would also make life much simpler network operators would encourage people use services Format wars Betamax versus VHS battle videorecorders good business As turned bit optimistic The number 2000 stood three things 1 year supposed go service 2 frequency supposed operate MHz 3 bandwidth service kbps It make three counts Nothing implemented 2000 ITU recommended governments reserve spectrum 2 GHz devices could roam seamlessly country country China reserved required bandwidth nobody else Finally recognized 2 Mbps currently feasible users mobile due difficulty performing handoffs quickly enough More realistic 2 Mbps stationary indoor users compete head ADSL 384 kbps people walking 144 kbps connections cars Despite initial setbacks much accomplished since Several IMT proposals made winnowing came two main ones The first one WCDMA Wideband CDMA proposed Ericsson pushed European Union called UMTS Universal Mobile Telecommunications System The contender CDMA2000 proposed Qualcomm Both systems similar different based broadband CDMA WCDMA uses 5 MHz channels CDMA2000 uses 1 25MHz channels If Ericsson Qualcomm engineers put room told come common design probably could find one fairly quickly The trouble real problem engineering politics usual Europe wanted system interworked GSM whereas U S wanted 176 THE PHYSICAL LAYER system compatible one already widely deployed U S IS 95 Each side also supported local company Ericsson based Sweden Qualcomm California Finally Ericsson Qualcomm involved numerous lawsuits respective CDMA patents Worldwide 10 15 mobile subscribers already use 3G technologies In North America Europe around third mobile subscribers 3G Japan early adopter nearly mobile phones Japan 3G These figures include deployment UMTS CDMA2000 3G continues one great cauldron activity market shakes To add confusion UMTS became single 3G standard multiple incompatible options including CDMA2000 This change effort unify various camps papers technical differences obscures focus ongoing efforts We use UMTS mean WCDMA distinct CDMA2000 We focus discussion use CDMA cellular networks distinguishing feature systems CDMA neither FDM TDM kind mix user sends frequency band time When first proposed cellular systems industry gave approximately reaction Columbus first got Queen Isabella proposed reaching India sailing wrong direction However persistence single company Qualcomm CDMA succeeded 2G system IS 95 matured point became technical basis 3G To make CDMA work mobile phone setting requires basic CDMA technique described previous section Specifically described synchronous CDMA chip sequences exactly orthogonal This design works users synchronized start time chip sequences case base station transmitting mobiles The base station transmit chip sequences starting time signals orthogonal able separated However difficult synchronize transmissions independent mobile phones Without care transmissions would arrive base station different times guarantee orthogonality To let mobiles send base station without synchronization want code sequences orthogonal possible offsets simply aligned start While possible find sequences exactly orthogonal general case long pseudorandom sequences come close enough They property high probability low cross correlation offsets This means one sequence multiplied another sequence summed compute inner product result small would zero orthogonal Intuitively random sequences always look different Multiplying together produce random signal sum small result This lets receiver filter unwanted transmissions received signal Also auto correlation SEC 2 7 THE MOBILE TELEPHONE SYSTEM pseudorandom sequences also small high probability except zero offset This means one sequence multiplied delayed copy summed result small except delay zero Intuitively delayed random sequence looks like different random sequence back cross correlation case This lets receiver lock onto beginning wanted transmission received signal The use pseudorandom sequences lets base station receive CDMA messages unsynchronized mobiles However implicit assumption discussion CDMA power levels mobiles receiver If small cross correlation powerful signal might overwhelm large auto correlation weak signal Thus transmit power mobiles must controlled minimize interference competing signals It interference limits capacity CDMA systems The power levels received base station depend far away transmitters well much power transmit There may many mobile stations varying distances base station A good heuristic equalize received power mobile station transmit base station inverse power level receives base station In words mobile station receiving weak signal base station use power one getting strong signal For accuracy base station also gives mobile feedback increase decrease hold steady transmit power The feedback frequent 1500 times per second good power control important minimize interference Another improvement basic CDMA scheme described earlier allow different users send data different rates This trick accomplished naturally CDMA fixing rate chips transmitted assigning users chip sequences different lengths For example WCDMA chip rate 3 84 Mchips sec spreading codes vary 4 256 chips With 256chip code around 12 kbps left error correction capacity sufficient voice call With 4 chip code user data rate close 1 Mbps Intermediate length codes give intermediate rates get multiple Mbps mobile must use one 5 MHz channel Now let us describe advantages CDMA given dealt problems getting work It three main advantages First CDMA improve capacity taking advantage small periods transmitters silent In polite voice calls one party silent talks On average line busy 40 time However pauses may small difficult predict With TDM FDM systems possible reassign time slots frequency channels quickly enough benefit small silences However CDMA simply transmitting one user lowers interference users likely fraction users transmitting busy cell given time Thus CDMA takes advantage expected silences allow larger number simultaneous calls 178 THE PHYSICAL LAYER Second CDMA cell uses frequencies Unlike GSM AMPS FDM needed separate transmissions different users This eliminates complicated frequency planning tasks improves capacity It also makes easy base station use multiple directional antennas sectored antennas instead omnidirectional antenna Directional antennas concentrate signal intended direction reduce signal hence interference directions This turn increases capacity Three sector designs common The base station must track mobile moves sector sector This tracking easy CDMA frequencies used sectors Third CDMA facilitates soft handoff mobile acquired new base station previous one signs In way loss continuity Soft handoff shown It easy CDMA frequencies used cell The alternative hard handoff old base station drops call new one acquires If new one unable acquire e g available frequency call disconnected abruptly Users tend notice inevitable occasionally current design Hard handoff norm FDM designs avoid cost mobile transmit receive two frequencies simultaneously b c Soft handoff b c Much written 3G praising greatest thing since sliced bread Meanwhile many operators taken cautious steps direction 3G going sometimes called 2 5G although 2 1G might accurate One system EDGE Enhanced Data rates GSM Evolution GSM bits per symbol The trouble bits per symbol also means errors per symbol EDGE nine different schemes modulation error correction differing terms much bandwidth devoted fixing errors introduced higher speed EDGE one step along evolutionary path defined GSM WCDMA Similarly evolutionary path defined operators upgrade IS 95 CDMA2000 networks Even though 3G networks fully deployed yet researchers regard 3G done deal These people already working 4G systems SEC 2 7 THE MOBILE TELEPHONE SYSTEM name LTE Long Term Evolution Some proposed features 4G include high bandwidth ubiquity connectivity everywhere seamless integration wired wireless IP networks including 802 11 access points adaptive resource spectrum management high quality service multimedia For information see Astely et al 2009 Larmo et al 2009 Meanwhile wireless networks 4G levels performance already available The main example 802 16 also known WiMAX For overview mobile WiMAX see Ahmadi 2009 To say industry state flux huge understatement Check back years see happened 2 8 CABLE TELEVISION We studied fixed wireless telephone systems fair amount detail Both clearly play major role future networks But another major player emerged past decade Internet access cable television networks Many people nowadays get telephone Internet service cable In following sections look cable television network detail contrast telephone systems studied Some relevant references information Donaldson Jones 2001 Dutta Roy 2001 Fellows Jones 2001 2 8 1 Community Antenna Television Cable television conceived late 1940s way provide better reception people living rural mountainous areas The system initially consisted big antenna top hill pluck television signal air amplifier called headend strengthen coaxial cable deliver people houses illustrated Antenna picking distant signals Headend Drop cable Tap Coaxial cable An early cable television system In early years cable television called Community Antenna Television It much mom pop operation anyone handy electronics 180 THE PHYSICAL LAYER could set service town users would chip pay costs As number subscribers grew additional cables spliced onto original cable amplifiers added needed Transmission one way headend users By 1970 thousands independent systems existed In 1974 Time Inc started new channel Home Box Office new content movies distributed cable Other cable channels followed focusing news sports cooking many topics This development gave rise two changes industry First large corporations began buying existing cable systems laying new cable acquire new subscribers Second need connect multiple systems often distant cities order distribute new cable channels The cable companies began lay cable cities connect single system This pattern analogous happened telephone industry 80 years earlier connection previously isolated end offices make long distance calling possible 2 8 2 Internet Cable Over course years cable system grew cables various cities replaced high bandwidth fiber similar happened telephone system A system fiber long haul runs coaxial cable houses called HFC Hybrid Fiber Coax system The electrooptical converters interface optical electrical parts system called fiber nodes Because bandwidth fiber much greater coax fiber node feed multiple coaxial cables Part modern HFC system shown Over past decade many cable operators decided get Internet access business often telephony business well Technical differences cable plant telephone plant effect done achieve goals For one thing one way amplifiers system replaced two way amplifiers support upstream well downstream transmissions While happening early Internet cable systems used cable television network downstream transmissions dialup connection via telephone network upstream transmissions It clever workaround much network compared could However another difference HFC system telephone system b much harder remove Down neighborhoods single cable shared many houses whereas telephone system every house private local loop When used television broadcasting sharing natural fit All programs broadcast cable matter whether 10 viewers 10 000 viewers When cable used Internet access however matters lot 10 users 10 000 If one user decides download large file bandwidth potentially taken away users The users SEC 2 8 Switch CABLE TELEVISION High bandwidth fiber trunk Coaxial cable Fiber node Headend Tap House Fiber House Toll office High bandwidth fiber trunk End office Local loop Fiber Copper twisted pair b Cable television b The fixed telephone system competition bandwidth The telephone system particular property downloading large file ADSL line reduce neighbor bandwidth On hand bandwidth coax much higher twisted pairs get lucky neighbors use Internet much The way cable industry tackled problem split long cables connect one directly fiber node The bandwidth headend fiber node effectively infinite long many subscribers cable segment amount traffic manageable Typical 182 THE PHYSICAL LAYER cables nowadays 500 2000 houses people subscribe Internet cable load may become great requiring splitting fiber nodes 2 8 3 Spectrum Allocation Throwing TV channels using cable infrastructure strictly Internet access would probably generate fair number irate customers cable companies hesitant Furthermore cities heavily regulate cable cable operators would allowed even really wanted As consequence needed find way television Internet peacefully coexist cable The solution build frequency division multiplexing Cable television channels North America occupy 54 550 MHz region except FM radio 88 108 MHz These channels 6 MHz wide including guard bands carry one traditional analog television channel several digital television channels In Europe low end usually 65 MHz channels 6 8 MHz wide higher resolution required PAL SECAM otherwise allocation scheme similar The low part band used Modern cables also operate well 550 MHz often 750 MHz The solution chosen introduce upstream channels 5 42 MHz band slightly higher Europe use frequencies high end downstream signals The cable spectrum illustrated 5 42 54 88 Upstream frequencies Upstream data TV FM TV 750 MHz Downstream data Downstream frequencies Frequency allocation typical cable TV system used Internet access Note since television signals downstream possible use upstream amplifiers work 5 42 MHz region downstream amplifiers work 54 MHz shown figure Thus get asymmetry upstream downstream bandwidths spectrum available television On hand users want downstream traffic cable operators unhappy fact SEC 2 8 CABLE TELEVISION life As saw earlier telephone companies usually offer asymmetric DSL service even though technical reason In addition upgrading amplifiers operator upgrade headend dumb amplifier intelligent digital computer system high bandwidth fiber interface ISP Often name gets upgraded well headend CMTS Cable Modem Termination System In following text refrain name upgrade stick traditional headend 2 8 4 Cable Modems Internet access requires cable modem device two interfaces one computer one cable network In early years cable Internet operator proprietary cable modem installed cable company technician However soon became apparent open standard would create competitive cable modem market drive prices thus encouraging use service Furthermore customers buy cable modems stores install wireless access points would eliminate dreaded truck rolls Consequently larger cable operators teamed company called CableLabs produce cable modem standard test products compliance This standard called DOCSIS Data Over Cable Service Interface Specification mostly replaced proprietary modems DOCSIS version 1 0 came 1997 soon followed DOCSIS 2 0 2001 It increased upstream rates better support symmetric services IP telephony The recent version standard DOCSIS 3 0 came 2006 It uses bandwidth increase rates directions The European version standards called EuroDOCSIS Not cable operators like idea standard however since many making good money leasing modems captive customers An open standard dozens manufacturers selling cable modems stores ends lucrative practice The modem computer interface straightforward It normally Ethernet occasionally USB The end complicated uses FDM TDM CDMA share bandwidth cable subscribers When cable modem plugged powered scans downstream channels looking special packet periodically put headend provide system parameters modems come online Upon finding packet new modem announces presence one upstream channels The headend responds assigning modem upstream downstream channels These assignments changed later headend deems necessary balance load The use 6 MHz 8 MHz channels FDM part Each cable modem sends data one upstream one downstream channel multiple channels 184 THE PHYSICAL LAYER DOCSIS 3 0 The usual scheme take 6 8 MHz downstream channel modulate QAM 64 cable quality exceptionally good QAM 256 With 6 MHz channel QAM 64 get 36 Mbps When overhead subtracted net payload 27 Mbps With QAM256 net payload 39 Mbps The European values 1 3 larger For upstream RF noise system originally designed data noise multiple subscribers funneled headend conservative scheme used This ranges QPSK QAM 128 symbols used error protection Trellis Coded Modulation With fewer bits per symbol upstream asymmetry upstream downstream rates much suggested TDM used share bandwidth upstream across multiple subscribers Otherwise transmissions would collide headend Time divided minislots different subscribers send different minislots To make work modem determines distance headend sending special packet seeing long takes get response This process called ranging It important modem know distance get timing right Each upstream packet must fit one consecutive minislots headend received The headend announces start new round minislots periodically starting gun heard modems simultaneously due propagation time cable By knowing far headend modem compute long ago first minislot really started Minislot length network dependent A typical payload 8 bytes During initialization headend assigns modem minislot use requesting upstream bandwidth When computer wants send packet transfers packet modem requests necessary number minislots If request accepted headend puts acknowledgement downstream channel telling modem minislots reserved packet The packet sent starting minislot allocated Additional packets requested using field header As rule multiple modems assigned minislot leads contention Two different possibilities exist dealing The first CDMA used share minislot subscribers This solves contention problem subscribers CDMA code sequence send time albeit reduced rate The second option CDMA used case may acknowledgement request collision In case modem waits random time tries After successive failure randomization time doubled For readers already somewhat familiar networking algorithm slotted ALOHA binary exponential backoff Ethernet used cable stations sense medium We come back issues Chap 4 The downstream channels managed differently upstream channels For starters one sender headend contention SEC 2 8 CABLE TELEVISION need minislots actually statistical time division multiplexing For another amount traffic downstream usually much larger upstream fixed packet size 204 bytes used Part ReedSolomon error correcting code overhead leaving user payload 184 bytes These numbers chosen compatibility digital television using MPEG 2 TV downstream data channels formatted way Logically connections depicted Typical details upstream downstream channels North America 2 8 5 ADSL Versus Cable Which better ADSL cable That like asking operating system better Or language better Or religion Which answer get depends ask Let us compare ADSL cable points Both use fiber backbone differ edge Cable uses coax ADSL uses twisted pair The theoretical carrying capacity coax hundreds times twisted pair However full capacity cable available data users much cable bandwidth wasted useless stuff television programs In practice hard generalize effective capacity ADSL providers give specific statements bandwidth e g 1 Mbps downstream 256 kbps upstream generally achieve 80 consistently Cable providers may artificially cap bandwidth user help make performance predictions really give guarantees effective capacity depends many people currently active user cable segment Sometimes may better ADSL sometimes may worse What annoying though unpredictability Having great service one minute guarantee great service next minute since biggest bandwidth hog town may turned computer 186 THE PHYSICAL LAYER As ADSL system acquires users increasing numbers little effect existing users since user dedicated connection With cable subscribers sign Internet service performance existing users drop The cure cable operator split busy cables connect one fiber node directly Doing costs time money business pressures avoid As aside already studied another system shared channel like cable mobile telephone system Here group users could call cellmates share fixed amount bandwidth For voice traffic fairly smooth bandwidth rigidly divided fixed chunks among active users using FDM TDM But data traffic rigid division inefficient data users frequently idle case reserved bandwidth wasted As cable dynamic means used allocate shared bandwidth Availability issue ADSL cable differ Everyone telephone users close enough end offices get ADSL On hand everyone cable cable company provides Internet access get Distance fiber node headend issue It also worth noting since cable started television distribution medium businesses Being point point medium ADSL inherently secure cable Any cable user easily read packets going cable For reason decent cable provider encrypt traffic directions Nevertheless neighbor get encrypted messages still less secure get anything The telephone system generally reliable cable For example backup power continues work normally even power outage With cable power amplifier along chain fails downstream users cut instantly Finally ADSL providers offer choice ISPs Sometimes even required law Such always case cable operators The conclusion ADSL cable much alike different They offer comparable service competition heats probably comparable prices 2 9 SUMMARY The physical layer basis networks Nature imposes two fundamental limits channels determine bandwidth These limits Nyquist limit deals noiseless channels Shannon limit deals noisy channels SEC 2 9 SUMMARY Transmission media guided unguided The principal guided media twisted pair coaxial cable fiber optics Unguided media include terrestrial radio microwaves infrared lasers air satellites Digital modulation methods send bits guided unguided media analog signals Line codes operate baseband signals placed passband modulating amplitude frequency phase carrier Channels shared users time frequency code division multiplexing A key element wide area networks telephone system Its main components local loops trunks switches ADSL offers speeds 40 Mbps local loop dividing many subcarriers run parallel This far exceeds rates telephone modems PONs bring fiber home even greater access rates ADSL Trunks carry digital information They multiplexed WDM provision many high capacity links individual fibers well TDM share high rate link users Both circuit switching packet switching important For mobile applications fixed telephone system suitable Mobile phones currently widespread use voice increasingly data They gone three generations The first generation 1G analog dominated AMPS 2G digital GSM presently widely deployed mobile phone system world 3G digital based broadband CDMA WCDMA also CDMA2000 deployed An alternative system network access cable television system It gradually evolved coaxial cable hybrid fiber coax television television Internet Potentially offers high bandwidth bandwidth practice depends heavily users shared PROBLEMS 1 Compute Fourier coefficients function f 0 1 2 A noiseless 4 kHz channel sampled every 1 msec What maximum data rate How maximum data rate change channel noisy signal noise ratio 30 dB 3 Television channels 6 MHz wide How many bits sec sent four level digital signals used Assume noiseless channel 4 If binary signal sent 3 kHz channel whose signal noise ratio 20 dB maximum achievable data rate 5 What signal noise ratio needed put T1 carrier 50 kHz line 6 What advantages fiber optics copper transmission medium Is downside using fiber optics copper 188 THE PHYSICAL LAYER 7 How much bandwidth 0 1 microns spectrum wavelength 1 micron 8 It desired send sequence computer screen images optical fiber The screen 2560 1600 pixels pixel 24 bits There 60 screen images per second How much bandwidth needed many microns wavelength needed band 1 30 microns 9 Is Nyquist theorem true high quality single mode optical fiber copper wire 10 Radio antennas often work best diameter antenna equal wavelength radio wave Reasonable antennas range 1 cm 5 meters diameter What frequency range cover 11 A laser beam 1 mm wide aimed detector 1 mm wide 100 away roof building How much angular diversion degrees laser misses detector 12 The 66 low orbit satellites Iridium project divided six necklaces around earth At altitude using period 90 minutes What average interval handoffs stationary transmitter 13 Calculate end end transit time packet GEO altitude 35 800 km MEO altitude 18 000 km LEO altitude 750 km satellites 14 What latency call originating North Pole reach South Pole call routed via Iridium satellites Assume switching time satellites 10 microseconds earth radius 6371 km 15 What minimum bandwidth needed achieve data rate B bits sec signal transmitted using NRZ MLT 3 Manchester encoding Explain answer 16 Prove 4B 5B encoding signal transition occur least every four bit times 17 How many end office codes pre 1984 end office named three digit area code first three digits local number Area codes started digit range 2 9 0 1 second digit ended digit The first two digits local number always range 2 9 The third digit could digit 18 A simple telephone system consists two end offices single toll office end office connected 1 MHz full duplex trunk The average telephone used make four calls per 8 hour workday The mean call duration 6 min Ten percent calls long distance e pass toll office What maximum number telephones end office support Assume 4 kHz per circuit Explain telephone company may decide support lesser number telephones maximum number end office 19 A regional telephone company 10 million subscribers Each telephones connected central office copper twisted pair The average length twisted pairs 10 km How much copper local loops worth Assume CHAP 2 PROBLEMS cross section strand circle 1 mm diameter density copper 9 0 grams cm3 copper sells 6 per kilogram 20 Is oil pipeline simplex system half duplex system full duplex system none What river walkie talkie style communication 21 The cost fast microprocessor dropped point possible put one modem How affect handling telephone line errors Does negate need error checking correction layer 2 22 A modem constellation diagram similar data points following coordinates 1 1 1 1 1 1 1 1 How many bps modem parameters achieve 1200 symbols second 23 What maximum bit rate achievable V 32 standard modem baud rate 1200 error correction used 24 How many frequencies full duplex QAM 64 modem use 25 Ten signals requiring 4000 Hz multiplexed onto single channel using FDM What minimum bandwidth required multiplexed channel Assume guard bands 400 Hz wide 26 Why PCM sampling time set 125 sec 27 What percent overhead T1 carrier That percent 1 544 Mbps delivered end user How relate percent overhead OC 1 OC 768 lines 28 Compare maximum data rate noiseless 4 kHz channel using Analog encoding e g QPSK 2 bits per sample b The T1 PCM system 29 If T1 carrier system slips loses track tries resynchronize using first bit frame How many frames inspected average resynchronize probability 0 001 wrong 30 What difference demodulator part modem coder part codec After convert analog signals digital ones 31 SONET clocks drift rate 1 part 109 How long take drift equal width 1 bit Do see practical implications calculation If 32 How long take transmit 1 GB file one VSAT another using hub shown Assume uplink 1 Mbps downlink 7 Mbps circuit switching used 1 2 sec circuit setup time 33 Calculate transmit time previous problem packet switching used instead Assume packet size 64 KB switching delay satellite hub 10 microseconds packet header size 32 bytes 34 In user data rate OC 3 stated 148 608 Mbps Show number derived SONET OC 3 parameters What gross SPE user data rates OC 3072 line 190 THE PHYSICAL LAYER 35 To accommodate lower data rates STS 1 SONET system virtual tributaries VTs A VT partial payload inserted STS 1 frame combined partial payloads fill data frame VT1 5 uses 3 columns VT2 uses 4 columns VT3 uses 6 columns VT6 uses 12 columns STS 1 frame Which VT accommodate A DS 1 service 1 544 Mbps b European CEPT 1 service 2 048 Mbps c A DS 2 service 6 312 Mbps 36 What available user bandwidth OC 12c connection 37 Three packet switching networks contain n nodes The first network star topology central switch second bidirectional ring third fully interconnected wire every node every node What best average worst case transmission paths hops 38 Compare delay sending x bit message k hop path circuit switched network lightly loaded packet switched network The circuit setup time sec propagation delay sec per hop packet size p bits data rate b bps Under conditions packet network lower delay Also explain conditions packet switched network preferable circuitswitched network 39 Suppose x bits user data transmitted k hop path packetswitched network series packets containing p data bits h header bits x p h The bit rate lines b bps propagation delay negligible What value p minimizes total delay 40 In typical mobile phone system hexagonal cells forbidden reuse frequency band adjacent cell If 840 frequencies available many used given cell 41 The actual layout cells seldom regular shown Even shapes individual cells typically irregular Give possible reason might How irregular shapes affect frequency assignment cell 42 Make rough estimate number PCS microcells 100 diameter would take cover San Francisco 120 square km 43 Sometimes mobile user crosses boundary one cell another current call abruptly terminated even though transmitters receivers functioning perfectly Why 44 Suppose A B C simultaneously transmitting 0 bits using CDMA system chip sequences What resulting chip sequence 45 Consider different way looking orthogonality property CDMA chip sequences Each bit pair sequences match match Express orthogonality property terms matches mismatches 46 A CDMA receiver gets following chips 1 1 3 1 1 3 1 1 Assuming chip sequences defined stations transmitted bits one send CHAP 2 PROBLEMS 47 In four stations transmit Suppose four stations added Provide chip sequences stations 48 At low end telephone system star shaped local loops neighborhood converging end office In contrast cable television consists single long cable snaking way past houses neighborhood Suppose future TV cable 10 Gbps fiber instead copper Could used simulate telephone model everybody private line end office If many one telephone houses could hooked single fiber 49 A cable company decides provide Internet access cable neighborhood consisting 5000 houses The company uses coaxial cable spectrum allocation allowing 100 Mbps downstream bandwidth per cable To attract customers company decides guarantee least 2 Mbps downstream bandwidth house time Describe cable company needs provide guarantee 50 Using spectral allocation shown information given text many Mbps cable system allocate upstream many downstream 51 How fast cable user receive data network otherwise idle Assume user interface 10 Mbps Ethernet b 100 Mbps Ethernet c 54 Mbps Wireless 52 Multiplexing STS 1 multiple data streams called tributaries plays important role SONET A 3 1 multiplexer multiplexes three input STS 1 tributaries onto one output STS 3 stream This multiplexing done byte byte That first three output bytes first bytes tributaries 1 2 3 respectively next three output bytes second bytes tributaries 1 2 3 respectively Write program simulates 3 1 multiplexer Your program consist five processes The main process creates four processes one three STS 1 tributaries one multiplexer Each tributary process reads STS 1 frame input file sequence 810 bytes They send frames byte byte multiplexer process The multiplexer process receives bytes outputs STS 3 frame byte byte writing standard output Use pipes communication among processes 53 Write program implement CDMA Assume length chip sequence eight number stations transmitting four Your program consists three sets processes four transmitter processes t0 t1 t2 t3 one joiner process four receiver processes r0 r1 r2 r3 The main program also acts joiner process first reads four chip sequences bipolar notation standard input sequence 4 bits 1 bit per transmitter process transmitted forks four pairs transmitter receiver processes Each pair transmitter receiver processes t0 r0 t1 r1 t2 r2 t3 r3 assigned one chip sequence transmitter process assigned 1 bit first bit t0 second bit t1 Next transmitter process computes signal transmitted sequence 8 bits sends joiner process After receiving signals four transmitter processes joiner process combines signals sends combined signal 192 THE PHYSICAL LAYER four receiver processes Each receiver process computes bit received prints standard output Use pipes communication processes 3 THE DATA LINK LAYER In chapter study design principles second layer model data link layer This study deals algorithms achieving reliable efficient communication whole units information called frames rather individual bits physical layer two adjacent machines By adjacent mean two machines connected communication channel acts conceptually like wire e g coaxial cable telephone line wireless channel The essential property channel makes wire like bits delivered exactly order sent At first might think problem trivial nothing study machine A puts bits wire machine B takes Unfortunately communication channels make errors occasionally Furthermore finite data rate nonzero propagation delay time bit sent time received These limitations important implications efficiency data transfer The protocols used communications must take factors consideration These protocols subject chapter After introduction key design issues present data link layer start study protocols looking nature errors detected corrected Then study series increasingly complex protocols one solving problems present layer Finally conclude examples data link protocols 194 THE DATA LINK LAYER 3 1 DATA LINK LAYER DESIGN ISSUES The data link layer uses services physical layer send receive bits communication channels It number functions including 1 Providing well defined service interface network layer 2 Dealing transmission errors 3 Regulating flow data slow receivers swamped fast senders To accomplish goals data link layer takes packets gets network layer encapsulates frames transmission Each frame contains frame header payload field holding packet frame trailer illustrated Frame management forms heart data link layer In following sections examine abovementioned issues detail Sending machine Receiving machine Packet Packet Frame Header Payload field Trailer Header Payload field Trailer Relationship packets frames Although chapter explicitly data link layer protocols many principles study error control flow control found transport protocols well That reliability overall goal achieved layers work together In fact many networks functions found mostly upper layers data link layer minimal job good enough However matter found principles pretty much They often show simplest purest forms data link layer making good place examine detail 3 1 1 Services Provided Network Layer The function data link layer provide services network layer The principal service transferring data network layer source machine network layer destination machine On source machine SEC 3 1 DATA LINK LAYER DESIGN ISSUES entity call process network layer hands bits data link layer transmission destination The job data link layer transmit bits destination machine handed network layer shown The actual transmission follows path b easier think terms two data link layer processes communicating using data link protocol For reason implicitly use model throughout chapter Host 1 Host 2 Virtual data path Host 1 Host 2 Actual data path b Virtual communication b Actual communication The data link layer designed offer various services The actual services offered vary protocol protocol Three reasonable possibilities consider turn 1 Unacknowledged connectionless service 2 Acknowledged connectionless service 3 Acknowledged connection oriented service Unacknowledged connectionless service consists source machine send independent frames destination machine without destination machine acknowledge Ethernet good example data link layer provides class service No logical connection established beforehand released afterward If frame lost due noise line 196 THE DATA LINK LAYER attempt made detect loss recover data link layer This class service appropriate error rate low recovery left higher layers It also appropriate real time traffic voice late data worse bad data The next step terms reliability acknowledged connectionless service When service offered still logical connections used frame sent individually acknowledged In way sender knows whether frame arrived correctly lost If arrived within specified time interval sent This service useful unreliable channels wireless systems 802 11 WiFi good example class service It perhaps worth emphasizing providing acknowledgements data link layer optimization never requirement The network layer always send packet wait acknowledged peer remote machine If acknowledgement forthcoming timer expires sender send entire message The trouble strategy inefficient Links usually strict maximum frame length imposed hardware known propagation delays The network layer know parameters It might send large packet broken say 10 frames 2 lost average It would take long time packet get Instead individual frames acknowledged retransmitted errors corrected directly quickly On reliable channels fiber overhead heavyweight data link protocol may unnecessary inherently unreliable wireless channels well worth cost Getting back services sophisticated service data link layer provide network layer connection oriented service With service source destination machines establish connection data transferred Each frame sent connection numbered data link layer guarantees frame sent indeed received Furthermore guarantees frame received exactly frames received right order Connection oriented service thus provides network layer processes equivalent reliable bit stream It appropriate long unreliable links satellite channel long distance telephone circuit If acknowledged connectionless service used conceivable lost acknowledgements could cause frame sent received several times wasting bandwidth When connection oriented service used transfers go three distinct phases In first phase connection established sides initialize variables counters needed keep track frames received ones In second phase one frames actually transmitted In third final phase connection released freeing variables buffers resources used maintain connection SEC 3 1 DATA LINK LAYER DESIGN ISSUES 3 1 2 Framing To provide service network layer data link layer must use service provided physical layer What physical layer accept raw bit stream attempt deliver destination If channel noisy wireless wired links physical layer add redundancy signals reduce bit error rate tolerable level However bit stream received data link layer guaranteed error free Some bits may different values number bits received may less equal number bits transmitted It data link layer detect necessary correct errors The usual approach data link layer break bit stream discrete frames compute short token called checksum frame include checksum frame transmitted Checksum algorithms discussed later chapter When frame arrives destination checksum recomputed If newly computed checksum different one contained frame data link layer knows error occurred takes steps deal e g discarding bad frame possibly also sending back error report Breaking bit stream frames difficult first appears A good design must make easy receiver find start new frames using little channel bandwidth We look four methods 1 Byte count 2 Flag bytes byte stuffing 3 Flag bits bit stuffing 4 Physical layer coding violations The first framing method uses field header specify number bytes frame When data link layer destination sees byte count knows many bytes follow hence end frame This technique shown four small example frames sizes 5 5 8 8 bytes respectively The trouble algorithm count garbled transmission error For example byte count 5 second frame b becomes 7 due single bit flip destination get synchronization It unable locate correct start next frame Even checksum incorrect destination knows frame bad still way telling next frame starts Sending frame back source asking retransmission help either since destination know many bytes skip get start retransmission For reason byte count method rarely used 198 THE DATA LINK LAYER One byte Byte count Frame 2 5 bytes Frame 1 5 bytes 3 4 Frame 3 8 bytes Frame 4 8 bytes Error Frame 1 Frame 2 Wrong 4 5 Now byte count b A byte stream Without errors b With one error The second framing method gets around problem resynchronization error frame start end special bytes Often byte called flag byte used starting ending delimiter This byte shown FLAG Two consecutive flag bytes indicate end one frame start next Thus receiver ever loses synchronization search two flag bytes find end current frame start next frame However still problem solve It may happen flag byte occurs data especially binary data photographs songs transmitted This situation would interfere framing One way solve problem sender data link layer insert special escape byte ESC accidental flag byte data Thus framing flag byte distinguished one data absence presence escape byte The data link layer receiving end removes escape bytes giving data network layer This technique called byte stuffing Of course next question happens escape byte occurs middle data The answer stuffed escape byte At receiver first escape byte removed leaving data byte follows might another escape byte flag byte Some examples shown b In cases byte sequence delivered destuffing exactly original byte sequence We still search frame boundary looking two flag bytes row without bothering undo escapes The byte stuffing scheme depicted slight simplification one used PPP Point Point Protocol used carry packets communications links We discuss PPP near end chapter SEC 3 1 DATA LINK LAYER DESIGN ISSUES FLAG Header Payload field Trailer FLAG Original bytes After stuffing A FLAG B A ESC FLAG B A ESC B A ESC ESC B A ESC FLAG B A ESC ESC ESC FLAG B A ESC ESC B A ESC ESC ESC ESC B b A frame delimited flag bytes b Four examples byte sequences byte stuffing The third method delimiting bit stream gets around disadvantage byte stuffing tied use 8 bit bytes Framing also done bit level frames contain arbitrary number bits made units size It developed popular HDLC Highlevel Data Link Control protocol Each frame begins ends special bit pattern 01111110 0x7E hexadecimal This pattern flag byte Whenever sender data link layer encounters five consecutive 1s data automatically stuffs 0 bit outgoing bit stream This bit stuffing analogous byte stuffing escape byte stuffed outgoing character stream flag byte data It also ensures minimum density transitions help physical layer maintain synchronization USB Universal Serial Bus uses bit stuffing reason When receiver sees five consecutive incoming 1 bits followed 0 bit automatically destuffs e deletes 0 bit Just byte stuffing completely transparent network layer computers bit stuffing If user data contain flag pattern 01111110 flag transmitted 011111010 stored receiver memory 01111110 gives example bit stuffing With bit stuffing boundary two frames unambiguously recognized flag pattern Thus receiver loses track scan input flag sequences since occur frame boundaries never within data 200 THE DATA LINK LAYER 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 b 0 1 1 0 1 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 0 1 0 0 1 0 Stuffed bits c 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 Bit stuffing The original data b The data appear line c The data stored receiver memory destuffing With bit byte stuffing side effect length frame depends contents data carries For instance flag bytes data 100 bytes might carried frame roughly 100 bytes If however data consists solely flag bytes flag byte escaped frame become roughly 200 bytes long With bit stuffing increase would roughly 12 5 1 bit added every byte The last method framing use shortcut physical layer We saw Chap 2 encoding bits signals often includes redundancy help receiver This redundancy means signals occur regular data For example 4B 5B line code 4 data bits mapped 5 signal bits ensure sufficient bit transitions This means 16 32 signal possibilities used We use reserved signals indicate start end frames In effect using coding violations delimit frames The beauty scheme reserved signals easy find start end frames need stuff data Many data link protocols use combination methods safety A common pattern used Ethernet 802 11 frame begin well defined pattern called preamble This pattern might quite long 72 bits typical 802 11 allow receiver prepare incoming packet The preamble followed length e count field header used locate end frame 3 1 3 Error Control Having solved problem marking start end frame come next problem make sure frames eventually delivered network layer destination proper order Assume moment receiver tell whether frame receives contains correct faulty information look codes used detect correct transmission errors Sec 3 2 For unacknowledged connectionless service might fine sender kept outputting frames without regard whether SEC 3 1 DATA LINK LAYER DESIGN ISSUES arriving properly But reliable connection oriented service would fine The usual way ensure reliable delivery provide sender feedback happening end line Typically protocol calls receiver send back special control frames bearing positive negative acknowledgements incoming frames If sender receives positive acknowledgement frame knows frame arrived safely On hand negative acknowledgement means something gone wrong frame must transmitted An additional complication comes possibility hardware troubles may cause frame vanish completely e g noise burst In case receiver react since reason react Similarly acknowledgement frame lost sender know proceed It clear protocol sender transmits frame waits acknowledgement positive negative hang forever frame ever lost due example malfunctioning hardware faulty communication channel This possibility dealt introducing timers data link layer When sender transmits frame generally also starts timer The timer set expire interval long enough frame reach destination processed acknowledgement propagate back sender Normally frame correctly received acknowledgement get back timer runs case timer canceled However either frame acknowledgement lost timer go alerting sender potential problem The obvious solution transmit frame However frames may transmitted multiple times danger receiver accept frame two times pass network layer To prevent happening generally necessary assign sequence numbers outgoing frames receiver distinguish retransmissions originals The whole issue managing timers sequence numbers ensure frame ultimately passed network layer destination exactly less important part duties data link layer higher layers Later chapter look series increasingly sophisticated examples see management done 3 1 4 Flow Control Another important design issue occurs data link layer higher layers well sender systematically wants transmit frames faster receiver accept This situation occur sender running fast powerful computer receiver running slow low end machine A common situation smart phone requests Web page far powerful server turns fire hose 202 THE DATA LINK LAYER blasts data poor helpless phone completely swamped Even transmission error free receiver may unable handle frames fast arrive lose Clearly something done prevent situation Two approaches commonly used In first one feedback based flow control receiver sends back information sender giving permission send data least telling sender receiver In second one rate based flow control protocol built mechanism limits rate senders may transmit data without using feedback receiver In chapter study feedback based flow control schemes primarily rate based schemes seen part transport layer Chap 5 Feedback based schemes seen link layer higher layers The latter common days case link layer hardware designed run fast enough cause loss For example hardware implementations link layer NICs Network Interface Cards sometimes said run wire speed meaning handle frames fast arrive link Any overruns link problem handled higher layers Various feedback based flow control schemes known use basic principle The protocol contains well defined rules sender may transmit next frame These rules often prohibit frames sent receiver granted permission either implicitly explicitly For example connection set receiver might say You may send n frames sent send I told continue We examine details shortly 3 2 ERROR DETECTION AND CORRECTION We saw Chap 2 communication channels range characteristics Some channels like optical fiber telecommunications networks tiny error rates transmission errors rare occurrence But channels especially wireless links aging local loops error rates orders magnitude larger For links transmission errors norm They avoided reasonable expense cost terms performance The conclusion transmission errors stay We learn deal Network designers developed two basic strategies dealing errors Both add redundant information data sent One strategy include enough redundant information enable receiver deduce transmitted data must The include enough redundancy allow receiver deduce error occurred error SEC 3 2 ERROR DETECTION AND CORRECTION request retransmission The former strategy uses error correcting codes latter uses error detecting codes The use error correcting codes often referred FEC Forward Error Correction Each techniques occupies different ecological niche On channels highly reliable fiber cheaper use error detecting code retransmit occasional block found faulty However channels wireless links make many errors better add redundancy block receiver able figure originally transmitted block FEC used noisy channels retransmissions likely error first transmission A key consideration codes type errors likely occur Neither error correcting codes error detecting codes handle possible errors since redundant bits offer protection likely received error data bits compromise protection It would nice channel treated redundant bits differently data bits They bits channel This means avoid undetected errors code must strong enough handle expected errors One model errors caused extreme values thermal noise overwhelm signal briefly occasionally giving rise isolated single bit errors Another model errors tend come bursts rather singly This model follows physical processes generate deep fade wireless channel transient electrical interference wired channel Both models matter practice different trade offs Having errors come bursts advantages disadvantages isolated singlebit errors On advantage side computer data always sent blocks bits Suppose block size 1000 bits error rate 0 001 per bit If errors independent blocks would contain error If errors came bursts 100 however one block 100 would affected average The disadvantage burst errors occur much harder correct isolated errors Other types errors also exist Sometimes location error known perhaps physical layer received analog signal far expected value 0 1 declared bit lost This situation called erasure channel It easier correct errors erasure channels channels flip bits even value bit lost least know bit error However often benefit erasures We examine error correcting codes error detecting codes next Please keep two points mind though First cover codes link layer first place run problem reliably transmitting groups bits However codes widely used reliability overall concern Error correcting codes also seen physical layer particularly noisy channels higher layers particularly 204 THE DATA LINK LAYER real time media content distribution Error detecting codes commonly used link network transport layers The second point bear mind error codes applied mathematics Unless particularly adept Galois fields properties sparse matrices get codes good properties reliable source rather making In fact many protocol standards codes coming In material study simple code detail briefly describe advanced codes In way understand trade offs simple code talk codes used practice via advanced codes 3 2 1 Error Correcting Codes We examine four different error correcting codes 1 Hamming codes 2 Binary convolutional codes 3 Reed Solomon codes 4 Low Density Parity Check codes All codes add redundancy information sent A frame consists data e message bits r redundant e check bits In block code r check bits computed solely function data bits associated though bits looked large table find corresponding r check bits In systematic code data bits sent directly along check bits rather encoded sent In linear code r check bits computed linear function data bits Exclusive OR XOR modulo 2 addition popular choice This means encoding done operations matrix multiplications simple logic circuits The codes look section linear systematic block codes unless otherwise noted Let total length block n e n r We describe n code An n bit unit containing data check bits referred nbit codeword The code rate simply rate fraction codeword carries information redundant n The rates used practice vary widely They might 1 2 noisy channel case half received information redundant close 1 high quality channel small number check bits added large message To understand errors handled necessary first look closely error really Given two codewords may transmitted received say 10001001 10110001 possible determine many SEC 3 2 ERROR DETECTION AND CORRECTION corresponding bits differ In case 3 bits differ To determine many bits differ XOR two codewords count number 1 bits result For example 10110001 The number bit positions two codewords differ called Hamming distance Hamming 1950 Its significance two codewords Hamming distance apart require single bit errors convert one Given algorithm computing check bits possible construct complete list legal codewords list find two codewords smallest Hamming distance This distance Hamming distance complete code In data transmission applications 2m possible data messages legal due way check bits computed 2n possible codewords used In fact r check bits small fraction 2m 2n 1 2r possible messages legal codewords It sparseness message embedded space codewords allows receiver detect correct errors The error detecting error correcting properties block code depend Hamming distance To reliably detect errors need distance 1 code code way single bit errors change valid codeword another valid codeword When receiver sees illegal codeword tell transmission error occurred Similarly correct errors need distance 2d 1 code way legal codewords far apart even changes original codeword still closer codeword This means original codeword uniquely determined based assumption larger number errors less likely As simple example error correcting code consider code four valid codewords 0000000000 0000011111 1111100000 1111111111 This code distance 5 means correct double errors detect quadruple errors If codeword 0000000111 arrives expect single double bit errors receiver know original must 0000011111 If however triple error changes 0000000000 0000000111 error corrected properly Alternatively expect errors detect None received codewords legal codewords error must occurred It apparent example correct double errors detect quadruple errors would require us interpret received codeword two different ways 206 THE DATA LINK LAYER In example task decoding finding legal codeword closest received codeword done inspection Unfortunately general case codewords need evaluated candidates task time consuming search Instead practical codes designed admit shortcuts find likely original codeword Imagine want design code message bits r check bits allow single errors corrected Each 2m legal messages n illegal codewords distance 1 These formed systematically inverting n bits n bit codeword formed Thus 2m legal messages requires n 1 bit patterns dedicated Since total number bit patterns 2n must n 1 2m 2n Using n r requirement becomes r 1 2r 3 1 Given puts lower limit number check bits needed correct single errors This theoretical lower limit fact achieved using method due Hamming 1950 In Hamming codes bits codeword numbered consecutively starting bit 1 left end bit 2 immediate right The bits powers 2 1 2 4 8 16 etc check bits The rest 3 5 6 7 9 etc filled data bits This pattern shown 11 7 Hamming code 7 data bits 4 check bits Each check bit forces modulo 2 sum parity collection bits including even odd A bit may included several check bit computations To see check bits data bit position k contributes rewrite k sum powers 2 For example 11 1 2 8 29 1 4 8 16 A bit checked check bits occurring expansion e g bit 11 checked bits 1 2 8 In example check bits computed even parity sums message ASCII letter A Syndrome 01 01 Check bits 1 bit error A p1 p2 m3 p4 m5 m6 m7 p8 m9 m10 m11 Message Sent codeword 0 0 1 0 0 0 0 1 0 0 1 Channel Flip bit 5 Check results 0 0 1 0 1 0 0 1 0 0 1 Received codeword AMessage Example 11 7 Hamming code correcting single bit error This construction gives code Hamming distance 3 means correct single errors detect double errors The reason careful numbering message check bits becomes apparent decoding SEC 3 2 ERROR DETECTION AND CORRECTION process When codeword arrives receiver redoes check bit computations including values received check bits We call check results If check bits correct even parity sums check result zero In case codeword accepted valid If check results zero however error detected The set check results forms error syndrome used pinpoint correct error In single bit error occurred channel check results 0 1 0 1 k 8 4 2 1 respectively This gives syndrome 0101 4 1 5 By design scheme means fifth bit error Flipping incorrect bit might check bit data bit discarding check bits gives correct message ASCII A Hamming distances valuable understanding block codes Hamming codes used error correcting memory However networks use stronger codes The second code look convolutional code This code one cover block code In convolutional code encoder processes sequence input bits generates sequence output bits There natural message size encoding boundary block code The output depends current previous input bits That encoder memory The number previous bits output depends called constraint length code Convolutional codes specified terms rate constraint length Convolutional codes widely used deployed networks example part GSM mobile phone system satellite communications 802 11 As example popular convolutional code shown This code known NASA convolutional code r 1 2 k 7 since first used Voyager space missions starting 1977 Since liberally reused example part 802 11 Output bit 1 Input bit S1 S2 S3 S4 S5 S6 Output bit 2 The NASA binary convolutional code used 802 11 In input bit left hand side produces two output bits right hand side XOR sums input internal state Since deals bits performs linear operations binary linear convolutional code Since 1 input bit produces 2 output bits code rate 1 2 It systematic since none output bits simply input bit 208 THE DATA LINK LAYER The internal state kept six memory registers Each time another bit input values registers shifted right For example 111 input initial state zeros internal state written left right become 100000 110000 111000 first second third bits input The output bits 11 followed 10 01 It takes seven shifts flush input completely affect output The constraint length code thus k 7 A convolutional code decoded finding sequence input bits likely produced observed sequence output bits includes errors For small values k done widely used algorithm developed Viterbi Forney 1973 The algorithm walks observed sequence keeping step possible internal state input sequence would produced observed sequence fewest errors The input sequence requiring fewest errors end likely message Convolutional codes popular practice easy factor uncertainty bit 0 1 decoding For example suppose 1V logical 0 level 1V logical 1 level might receive 0 9V 0 1V 2 bits Instead mapping signals 1 0 right away would like treat 0 9V likely 1 0 1V maybe 0 correct sequence whole Extensions Viterbi algorithm work uncertainties provide stronger error correction This approach working uncertainty bit called soft decision decoding Conversely deciding whether bit 0 1 subsequent error correction called hard decision decoding The third kind error correcting code describe Reed Solomon code Like Hamming codes Reed Solomon codes linear block codes often systematic Unlike Hamming codes operate individual bits Reed Solomon codes operate bit symbols Naturally mathematics involved describe operation analogy Reed Solomon codes based fact every n degree polynomial uniquely determined n 1 points For example line form ax b determined two points Extra points line redundant helpful error correction Imagine two data points represent line send two data points plus two check points chosen lie line If one points received error still recover data points fitting line received points Three points lie line one point one error By finding line corrected error Reed Solomon codes actually defined polynomials operate finite fields work similar manner For bit symbols codewords 2m 1 symbols long A popular choice make 8 symbols bytes A codeword 255 bytes long The 255 233 code widely used adds 32 redundant symbols 233 data symbols Decoding error correction SEC 3 2 ERROR DETECTION AND CORRECTION done algorithm developed Berlekamp Massey efficiently perform fitting task moderate length codes Massey 1969 Reed Solomon codes widely used practice strong error correction properties particularly burst errors They used DSL data cable satellite communications perhaps ubiquitously CDs DVDs Blu ray discs Because based bit symbols single bit error bit burst error treated simply one symbol error When 2t redundant symbols added Reed Solomon code able correct errors transmitted symbols This means example 255 233 code 32 redundant symbols correct 16 symbol errors Since symbols may consecutive 8 bits error burst 128 bits corrected The situation even better error model one erasures e g scratch CD obliterates symbols In case 2t errors corrected Reed Solomon codes often used combination codes convolutional code The thinking follows Convolutional codes effective handling isolated bit errors fail likely burst errors many errors received bit stream By adding Reed Solomon code within convolutional code Reed Solomon decoding mop error bursts task good The overall code provides good protection single burst errors The final error correcting code cover LDPC Low Density Parity Check code LDPC codes linear block codes invented Robert Gallagher doctoral thesis Gallagher 1962 Like theses promptly forgotten reinvented 1995 advances computing power made practical In LDPC code output bit formed fraction input bits This leads matrix representation code low density 1s hence name code The received codewords decoded approximation algorithm iteratively improves best fit received data legal codeword This corrects errors LDPC codes practical large block sizes excellent error correction abilities outperform many codes including ones looked practice For reason rapidly included new protocols They part standard digital video broadcasting 10 Gbps Ethernet power line networks latest version 802 11 Expect see future networks 3 2 2 Error Detecting Codes Error correcting codes widely used wireless links notoriously noisy error prone compared optical fibers Without error correcting codes would hard get anything However fiber 210 THE DATA LINK LAYER high quality copper error rate much lower error detection retransmission usually efficient dealing occasional error We examine three different error detecting codes They linear systematic block codes 1 Parity 2 Checksums 3 Cyclic Redundancy Checks CRCs To see efficient error correcting codes consider first error detecting code single parity bit appended data The parity bit chosen number 1 bits codeword even odd Doing equivalent computing even parity bit modulo 2 sum XOR data bits For example 1011010 sent even parity bit added end make 10110100 With odd parity 1011010 becomes 10110101 A code single parity bit distance 2 since single bit error produces codeword wrong parity This means detect single bit errors Consider channel errors isolated error rate 10 6 per bit This may seem tiny error rate best fair rate long wired cable challenging error detection Typical LAN links provide bit error rates 10 10 Let block size 1000 bits To provide error correction 1000 bit blocks know Eq 3 1 10 check bits needed Thus megabit data would require 10 000 check bits To merely detect block single 1 bit error one parity bit per block suffice Once every 1000 blocks block found error extra block 1001 bits transmitted repair error The total overhead error detection retransmission method 2001 bits per megabit data versus 10 000 bits Hamming code One difficulty scheme single parity bit reliably detect single bit error block If block badly garbled long burst error probability error detected 0 5 hardly acceptable The odds improved considerably block sent regarded rectangular matrix n bits wide k bits high Now compute send one parity bit row k bit errors reliably detected long one error per row However something else provides better protection burst errors compute parity bits data different order order data bits transmitted Doing called interleaving In case compute parity bit n columns send data bits k rows sending rows top bottom bits row left right usual manner At last row send n parity bits This transmission order shown n 7 k 7 SEC 3 2 ERROR DETECTION AND CORRECTION N e w r k 1 00111011101001101111 111 0010101111 0 Parity bits Transmit order Channel N c l w r k 1100011 11 0110011 0111111 01011 Burst error Parity errors Interleaving parity bits detect burst error Interleaving general technique convert code detects corrects isolated errors code detects corrects burst errors In burst error length n 7 occurs bits error spread across different columns A burst error imply bits wrong implies least first last wrong In 4 bits flipped range 7 bits At 1 bit n columns affected parity bits columns detect error This method uses n parity bits blocks kn data bits detect single burst error length n less A burst length n 1 pass undetected however first bit inverted last bit inverted bits correct If block badly garbled long burst multiple shorter bursts probability n columns correct parity accident 0 5 probability bad block accepted 2 n The second kind error detecting code checksum closely related groups parity bits The word checksum often used mean group check bits associated message regardless calculated A group parity bits one example checksum However stronger checksums based running sum data bits message The checksum usually placed end message complement sum function This way errors may detected summing entire received codeword data bits checksum If result comes zero error detected One example checksum 16 bit Internet checksum used Internet packets part IP protocol Braden et al 1988 This checksum sum message bits divided 16 bit words Because method operates words rather bits parity errors leave parity unchanged still alter sum detected For example lowest order bit two different words flipped 0 1 parity check across bits would fail detect error However two 1s added 16 bit checksum produce different result The error detected 212 THE DATA LINK LAYER The Internet checksum computed one complement arithmetic instead modulo 216 sum In one complement arithmetic negative number bitwise complement positive counterpart Modern computers run two complement arithmetic negative number one complement plus one On two complement computer one complement sum equivalent taking sum modulo 216 adding overflow high order bits back low order bits This algorithm gives uniform coverage data checksum bits Otherwise two high order bits added overflow lost without changing sum There another benefit One complement two representations zero 0s 1s This allows one value e g 0s indicate checksum without need another field For decades always assumed frames checksummed contain random bits All analyses checksum algorithms made assumption Inspection real data Partridge et al 1995 shown assumption quite wrong As consequence undetected errors cases much common previously thought The Internet checksum particular efficient simple provides weak protection cases precisely simple sum It detect deletion addition zero data swapping parts message provides weak protection message splices parts two packets put together These errors may seem unlikely occur random processes sort errors occur buggy hardware A better choice Fletcher checksum Fletcher 1982 It includes positional component adding product data position running sum This provides stronger detection changes position data Although two preceding schemes may sometimes adequate higher layers practice third stronger kind error detecting code widespread use link layer CRC Cyclic Redundancy Check also known polynomial code Polynomial codes based upon treating bit strings representations polynomials coefficients 0 1 A k bit frame regarded coefficient list polynomial k terms ranging x k 1 x 0 Such polynomial said degree k 1 The high order leftmost bit coefficient x k 1 next bit coefficient x k 2 For example 110001 6 bits thus represents six term polynomial coefficients 1 1 0 0 0 1 1x 5 1x 4 0x 3 0x 2 0x 1 1x 0 Polynomial arithmetic done modulo 2 according rules algebraic field theory It carries addition borrows subtraction Both addition subtraction identical exclusive OR For example 11001010 11001101 10100110 10101111 1111111011111010 Long division carried exactly way binary except SEC 3 2 ERROR DETECTION AND CORRECTION subtraction done modulo 2 A divisor said go dividend dividend many bits divisor When polynomial code method employed sender receiver must agree upon generator polynomial G x advance Both high loworder bits generator must 1 To compute CRC frame bits corresponding polynomial M x frame must longer generator polynomial The idea append CRC end frame way polynomial represented checksummed frame divisible G x When receiver gets checksummed frame tries dividing G x If remainder transmission error The algorithm computing CRC follows 1 Let r degree G x Append r zero bits low order end frame contains r bits corresponds polynomial x r M x 2 Divide bit string corresponding G x bit string corresponding x r M x using modulo 2 division 3 Subtract remainder always r fewer bits bit string corresponding x r M x using modulo 2 subtraction The result checksummed frame transmitted Call polynomial T x illustrates calculation frame 1101011111 using generator G x x 4 x 1 It clear T x divisible modulo 2 G x In division problem diminish dividend remainder left divisible divisor For example base 10 divide 210 278 10 941 remainder 2399 If subtract 2399 210 278 left 207 879 divisible 10 941 Now let us analyze power method What kinds errors detected Imagine transmission error occurs instead bit string T x arriving T x E x arrives Each 1 bit E x corresponds bit inverted If k 1 bits E x k single bit errors occurred A single burst error characterized initial 1 mixture 0s 1s final 1 bits 0 Upon receiving checksummed frame receiver divides G x computes T x E x G x T x G x 0 result computation simply E x G x Those errors happen correspond polynomials containing G x factor slip errors caught If single bit error E x x determines bit error If G x contains two terms never divide E x single bit errors detected 214 THE DATA LINK LAYER Frame Generator 1 0 0 1 1 Transmitted frame 1 1 0 1 0 1 1 1 1 1 1 0 0 1 1 1 1 0 0 0 0 1 1 1 0 1 0 1 1 1 1 1 0 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 1 1 1 1 0 1 0 0 1 1 1 1 0 1 1 0 0 1 1 0 0 1 0 0 0 0 0 0 1 1 0 0 0 0 1 1 0 1 1 0 1 0 0 0 0 1 0 1 1 0 1 0 1 1 1 1 1 0 0 1 0 Quotient thrown away Frame four zeros appended Remainder Frame four zeros appended minus remainder Example calculation CRC If two isolated single bit errors E x x x j j Alternatively written E x x j x j 1 If assume G x divisible x sufficient condition double errors detected G x divide x k 1 k maximum value j e maximum frame length Simple low degree polynomials give protection long frames known For example x 15 x 14 1 divide x k 1 value k 32 768 If odd number bits error E X contains odd number terms e g x 5 x 2 1 x 2 1 Interestingly polynomial odd number terms x 1 factor modulo 2 system By making x 1 factor G x catch errors odd number inverted bits Finally importantly polynomial code r check bits detect burst errors length r A burst error length k represented x x k 1 1 determines far right hand end received frame burst located If G x contains x 0 term x factor degree parenthesized expression less degree G x remainder never zero SEC 3 2 ERROR DETECTION AND CORRECTION If burst length r 1 remainder division G x zero burst identical G x By definition burst first last bits must 1 whether matches depends r 1 intermediate bits If combinations regarded equally likely probability incorrect frame accepted valid r 1 It also shown error burst longer r 1 bits occurs several shorter bursts occur probability bad frame getting unnoticed r assuming bit patterns equally likely Certain polynomials become international standards The one used IEEE 802 followed example Ethernet x 32 x 26 x 23 x 22 x 16 x 12 x 11 x 10 x 8 x 7 x 5 x 4 x 2 x 1 1 Among desirable properties property detects bursts length 32 less bursts affecting odd number bits It used widely since 1980s However mean best choice Using exhaustive computational search Castagnoli et al 1993 Koopman 2002 found best CRCs These CRCs Hamming distance 6 typical message sizes IEEE standard CRC 32 Hamming distance 4 Although calculation required compute CRC may seem complicated easy compute verify CRCs hardware simple shift register circuits Peterson Brown 1961 In practice hardware nearly always used Dozens networking standards include various CRCs including virtually LANs e g Ethernet 802 11 point point links e g packets SONET 3 3 ELEMENTARY DATA LINK PROTOCOLS To introduce subject protocols begin looking three protocols increasing complexity For interested readers simulator subsequent protocols available via Web see preface Before look protocols useful make explicit assumptions underlying model communication To start assume physical layer data link layer network layer independent processes communicate passing messages back forth A common implementation shown The physical layer process data link layer process run dedicate hardware called NIC Network Interface Card The rest link layer process network layer process run main CPU part operating system software link layer process often taking form device driver However implementations also possible e g three processes offloaded dedicated hardware called network accelerator three processes running 216 THE DATA LINK LAYER main CPU software defined ratio Actually preferred implementation changes decade decade technology trade offs In event treating three layers separate processes makes discussion conceptually cleaner also serves emphasize independence layers Computer Application Operating system Network Driver Link Link Network Interface Card NIC PHY Cable medium Implementation physical data link network layers Another key assumption machine A wants send long stream data machine B using reliable connection oriented service Later consider case B also wants send data A simultaneously A assumed infinite supply data ready send never wait data produced Instead A data link layer asks data network layer always able comply immediately This restriction dropped later We also assume machines crash That protocols deal communication errors problems caused computers crashing rebooting As far data link layer concerned packet passed across interface network layer pure data whose every bit delivered destination network layer The fact destination network layer may interpret part packet header concern data link layer When data link layer accepts packet encapsulates packet frame adding data link header trailer see Thus frame consists embedded packet control information header checksum trailer The frame transmitted data link layer machine We assume exist suitable library procedures physical layer send frame physical layer receive frame These procedures compute append check checksum usually done hardware need worry part protocols develop section They might use CRC algorithm discussed previous section example Initially receiver nothing It sits around waiting something happen In example protocols throughout chapter indicate data link layer waiting something happen procedure call SEC 3 3 ELEMENTARY DATA LINK PROTOCOLS define MAX PKT 1024 determines packet size bytes typedef enum false true boolean typedef unsigned int seq nr typedef struct unsigned char data MAX PKT packet typedef enum data ack nak frame kind boolean type sequence ack numbers packet definition frame kind definition typedef struct frame kind kind seq nr seq seq nr ack packet info frame frames transported layer kind frame sequence number acknowledgement number network layer packet Wait event happen return type event void wait event event type event Fetch packet network layer transmission channel void network layer packet p Deliver information inbound frame network layer void network layer packet p Go get inbound frame physical layer copy r void physical layer frame r Pass frame physical layer transmission void physical layer frame Start clock running enable timeout event void start timer seq nr k Stop clock disable timeout event void stop timer seq nr k Start auxiliary timer enable ack timeout event void start ack timer void Stop auxiliary timer disable ack timeout event void stop ack timer void Allow network layer cause network layer ready event void enable network layer void Forbid network layer causing network layer ready event void disable network layer void Macro inc expanded line increment k circularly define inc k k MAX SEQ k k 1 else k 0 Some definitions needed protocols follow These definitions located file protocol h 218 THE DATA LINK LAYER wait event event This procedure returns something happened e g frame arrived Upon return variable event tells happened The set possible events differs various protocols described defined separately protocol Note realistic situation data link layer sit tight loop waiting event suggested receive interrupt cause stop whatever go handle incoming frame Nevertheless simplicity ignore details parallel activity within data link layer assume dedicated full time handling one channel When frame arrives receiver checksum recomputed If checksum frame incorrect e transmission error data link layer informed event cksum err If inbound frame arrived undamaged data link layer also informed event frame arrival acquire frame inspection using physical layer As soon receiving data link layer acquired undamaged frame checks control information header everything right passes packet portion network layer Under circumstances frame header ever given network layer There good reason network layer must never given part frame header keep network data link protocols completely separate As long network layer knows nothing data link protocol frame format things changed without requiring changes network layer software This happens whenever new NIC installed computer Providing rigid interface network data link layers greatly simplifies design task communication protocols different layers evolve independently shows declarations C common many protocols discussed later Five data structures defined boolean seq nr packet frame kind frame A boolean enumerated type take values true false A seq nr small integer used number frames tell apart These sequence numbers run 0 including MAX SEQ defined protocol needing A packet unit information exchanged network layer data link layer machine network layer peers In model always contains MAX PKT bytes realistically would variable length A frame composed four fields kind seq ack info first three contain control information last may contain actual data transferred These control fields collectively called frame header The kind field tells whether data frame protocols distinguish frames containing control information containing data well The seq ack fields used sequence numbers acknowledgements respectively use described detail later The info field data frame contains single packet info field SEC 3 3 ELEMENTARY DATA LINK PROTOCOLS control frame used A realistic implementation would use variablelength info field omitting altogether control frames Again important understand relationship packet frame The network layer builds packet taking message transport layer adding network layer header This packet passed data link layer inclusion info field outgoing frame When frame arrives destination data link layer extracts packet frame passes packet network layer In manner network layer act though machines exchange packets directly A number procedures also listed These library routines whose details implementation dependent whose inner workings concern us following discussions The procedure wait event sits tight loop waiting something happen mentioned earlier The procedures network layer network layer used data link layer pass packets network layer accept packets network layer respectively Note physical layer physical layer pass frames data link layer physical layer In words network layer network layer deal interface layers 2 3 whereas physical layer physical layer deal interface layers 1 2 In protocols assume channel unreliable loses entire frames upon occasion To able recover calamities sending data link layer must start internal timer clock whenever sends frame If reply received within certain predetermined time interval clock times data link layer receives interrupt signal In protocols handled allowing procedure wait event return event timeout The procedures start timer stop timer turn timer respectively Timeout events possible timer running stop timer called It explicitly permitted call start timer timer running call simply resets clock cause next timeout full timer interval elapsed unless reset turned The procedures start ack timer stop ack timer control auxiliary timer used generate acknowledgements certain conditions The procedures enable network layer disable network layer used sophisticated protocols longer assume network layer always packets send When data link layer enables network layer network layer permitted interrupt packet sent We indicate event network layer ready When network layer disabled may cause events By careful enables disables network layer data link layer prevent network layer swamping packets buffer space Frame sequence numbers always range 0 MAX SEQ inclusive MAX SEQ different different protocols It frequently necessary 220 THE DATA LINK LAYER advance sequence number 1 circularly e MAX SEQ followed 0 The macro inc performs incrementing It defined macro used line within critical path As see later factor limiting network performance often protocol processing defining simple operations like macros affect readability code improve performance The declarations part protocols discuss shortly To save space provide convenient reference extracted listed together conceptually merged protocols In C merging done putting definitions special header file case protocol h using include facility C preprocessor include protocol files 3 3 1 A Utopian Simplex Protocol As initial example consider protocol simple worry possibility anything going wrong Data transmitted one direction Both transmitting receiving network layers always ready Processing time ignored Infinite buffer space available And best communication channel data link layers never damages loses frames This thoroughly unrealistic protocol nickname Utopia simply show basic structure build It implementation shown The protocol consists two distinct procedures sender receiver The sender runs data link layer source machine receiver runs data link layer destination machine No sequence numbers acknowledgements used MAX SEQ needed The event type possible frame arrival e arrival undamaged frame The sender infinite loop pumping data onto line fast The body loop consists three actions go fetch packet always obliging network layer construct outbound frame using variable send frame way Only info field frame used protocol fields error flow control errors flow control restrictions The receiver equally simple Initially waits something happen possibility arrival undamaged frame Eventually frame arrives procedure wait event returns event set frame arrival ignored anyway The call physical layer removes newly arrived frame hardware buffer puts variable r receiver code get Finally data portion passed network layer data link layer settles back wait next frame effectively suspending frame arrives SEC 3 3 ELEMENTARY DATA LINK PROTOCOLS Protocol 1 Utopia provides data transmission one direction sender receiver The communication channel assumed error free receiver assumed able process input infinitely quickly Consequently sender sits loop pumping data onto line fast typedef enum frame arrival event type include protocol h void sender1 void frame packet buffer buffer outbound frame buffer outbound packet true network layer buffer info buffer physical layer void receiver1 void frame r event type event go get something send copy transmission send way Tomorrow tomorrow tomorrow Creeps petty pace day day To last syllable recorded time Macbeth V v filled wait used true wait event event physical layer r network layer r info possibility frame arrival go get inbound frame pass data network layer A utopian simplex protocol The utopia protocol unrealistic handle either flow control error correction Its processing close unacknowledged connectionless service relies higher layers solve problems though even unacknowledged connectionless service would error detection 3 3 2 A Simplex Stop Wait Protocol Error Free Channel Now tackle problem preventing sender flooding receiver frames faster latter able process This situation easily happen practice able prevent great importance 222 THE DATA LINK LAYER The communication channel still assumed error free however data traffic still simplex One solution build receiver powerful enough process continuous stream back back frames equivalently define link layer slow enough receiver keep It must sufficient buffering processing abilities run line rate must able pass frames received network layer quickly enough However worst case solution It requires dedicated hardware wasteful resources utilization link mostly low Moreover shifts problem dealing sender fast elsewhere case network layer A general solution problem receiver provide feedback sender After passed packet network layer receiver sends little dummy frame back sender effect gives sender permission transmit next frame After sent frame sender required protocol bide time little dummy e acknowledgement frame arrives This delay simple example flow control protocol Protocols sender sends one frame waits acknowledgement proceeding called stop wait gives example simplex stop wait protocol Although data traffic example simplex going sender receiver frames travel directions Consequently communication channel two data link layers needs capable bidirectional information transfer However protocol entails strict alternation flow first sender sends frame receiver sends frame sender sends another frame receiver sends another one A halfduplex physical channel would suffice As protocol 1 sender starts fetching packet network layer using construct frame sending way But unlike protocol 1 sender must wait acknowledgement frame arrives looping back fetching next packet network layer The sending data link layer need even inspect incoming frame one possibility The incoming frame always acknowledgement The difference receiver1 receiver2 delivering packet network layer receiver2 sends acknowledgement frame back sender entering wait loop Because arrival frame back sender important contents receiver need put particular information 3 3 3 A Simplex Stop Wait Protocol Noisy Channel Now let us consider normal situation communication channel makes errors Frames may either damaged lost completely However assume frame damaged transit receiver hardware detect SEC 3 3 ELEMENTARY DATA LINK PROTOCOLS Protocol 2 Stop wait also provides one directional flow data sender receiver The communication channel assumed error free protocol 1 However time receiver finite buffer capacity finite processing speed protocol must explicitly prevent sender flooding receiver data faster handled typedef enum frame arrival event type include protocol h void sender2 void frame packet buffer event type event buffer outbound frame buffer outbound packet frame arrival possibility true network layer buffer info buffer physical layer wait event event go get something send copy transmission bye bye little frame proceed given go ahead void receiver2 void frame r event type event true wait event event physical layer r network layer r info physical layer buffers frames frame arrival possibility possibility frame arrival go get inbound frame pass data network layer send dummy frame awaken sender A simplex stop wait protocol computes checksum If frame damaged way checksum nevertheless correct unlikely occurrence protocol protocols fail e deliver incorrect packet network layer At first glance might seem variation protocol 2 would work adding timer The sender could send frame receiver would send acknowledgement frame data correctly received If damaged frame arrived receiver would discarded After sender would time send frame This process would repeated frame finally arrived intact This scheme fatal flaw though Think problem try discover might go wrong reading 224 THE DATA LINK LAYER To see might go wrong remember goal data link layer provide error free transparent communication network layer processes The network layer machine A gives series packets data link layer must ensure identical series packets delivered network layer machine B data link layer In particular network layer B way knowing packet lost duplicated data link layer must guarantee combination transmission errors however unlikely cause duplicate packet delivered network layer Consider following scenario 1 The network layer A gives packet 1 data link layer The packet correctly received B passed network layer B B sends acknowledgement frame back A 2 The acknowledgement frame gets lost completely It never arrives Life would great deal simpler channel mangled lost data frames control frames sad say channel discriminating 3 The data link layer A eventually times Not received acknowledgement incorrectly assumes data frame lost damaged sends frame containing packet 1 4 The duplicate frame also arrives intact data link layer B unwittingly passed network layer If A sending file B part file duplicated e copy file made B incorrect error detected In words protocol fail Clearly needed way receiver able distinguish frame seeing first time retransmission The obvious way achieve sender put sequence number header frame sends Then receiver check sequence number arriving frame see new frame duplicate discarded Since protocol must correct sequence number field header likely small use link efficiently question arises minimum number bits needed sequence number The header might provide 1 bit bits 1 byte multiple bytes sequence number depending protocol The important point must carry sequence numbers large enough protocol work correctly much protocol The ambiguity protocol frame direct successor 1 If frame lost damaged receiver acknowledge sender keep trying send Once correctly received receiver send acknowledgement sender It potential SEC 3 3 ELEMENTARY DATA LINK PROTOCOLS trouble crops Depending upon whether acknowledgement frame gets back sender correctly sender may try send 1 At sender event triggers transmission frame 1 arrival acknowledgement frame But situation implies 1 correctly received furthermore acknowledgement also correctly received sender Otherwise sender would begun let alone considering 1 As consequence ambiguity frame immediate predecessor successor predecessor successor A 1 bit sequence number 0 1 therefore sufficient At instant time receiver expects particular sequence number next When frame containing correct sequence number arrives accepted passed network layer acknowledged Then expected sequence number incremented modulo 2 e 0 becomes 1 1 becomes 0 Any arriving frame containing wrong sequence number rejected duplicate However last valid acknowledgement repeated sender eventually discover frame received An example kind protocol shown Protocols sender waits positive acknowledgement advancing next data item often called ARQ Automatic Repeat reQuest PAR Positive Acknowledgement Retransmission Like protocol 2 one also transmits data one direction Protocol 3 differs predecessors sender receiver variable whose value remembered data link layer wait state The sender remembers sequence number next frame send next frame send receiver remembers sequence number next frame expected frame expected Each protocol short initialization phase entering infinite loop After transmitting frame sender starts timer running If already running reset allow another full timer interval The interval chosen allow enough time frame get receiver receiver process worst case acknowledgement frame propagate back sender Only interval elapsed safe assume either transmitted frame acknowledgement lost send duplicate If timeout interval set short sender transmit unnecessary frames While extra frames affect correctness protocol hurt performance After transmitting frame starting timer sender waits something exciting happen Only three possibilities exist acknowledgement frame arrives undamaged damaged acknowledgement frame staggers timer expires If valid acknowledgement comes sender fetches next packet network layer puts buffer overwriting previous packet It also advances sequence number If damaged frame arrives 226 THE DATA LINK LAYER timer expires neither buffer sequence number changed duplicate sent In cases contents buffer either next packet duplicate sent When valid frame arrives receiver sequence number checked see duplicate If accepted passed network layer acknowledgement generated Duplicates damaged frames passed network layer cause last correctly received frame acknowledged signal sender advance next frame retransmit damaged frame 3 4 SLIDING WINDOW PROTOCOLS In previous protocols data frames transmitted one direction In practical situations need transmit data directions One way achieving full duplex data transmission run two instances one previous protocols using separate link simplex data traffic different directions Each link comprised forward channel data reverse channel acknowledgements In cases capacity reverse channel almost entirely wasted A better idea use link data directions After protocols 2 3 already used transmit frames ways reverse channel normally capacity forward channel In model data frames A B intermixed acknowledgement frames A B By looking kind field header incoming frame receiver tell whether frame data acknowledgement Although interleaving data control frames link big improvement two separate physical links yet another improvement possible When data frame arrives instead immediately sending separate control frame receiver restrains waits network layer passes next packet The acknowledgement attached outgoing data frame using ack field frame header In effect acknowledgement gets free ride next outgoing data frame The technique temporarily delaying outgoing acknowledgements hooked onto next outgoing data frame known piggybacking The principal advantage using piggybacking distinct acknowledgement frames better use available channel bandwidth The ack field frame header costs bits whereas separate frame would need header acknowledgement checksum In addition fewer frames sent generally means lighter processing load receiver In next protocol examined piggyback field costs 1 bit frame header It rarely costs bits However piggybacking introduces complication present separate acknowledgements How long data link layer wait packet onto SEC 3 4 SLIDING WINDOW PROTOCOLS Protocol 3 PAR allows unidirectional data flow unreliable channel must 1 protocol 3 define MAX SEQ 1 typedef enum frame arrival cksum err timeout event type include protocol h void sender3 void seq nr next frame send frame packet buffer event type event next frame send 0 network layer buffer true info buffer seq next frame send physical layer start timer seq wait event event event frame arrival physical layer ack next frame send stop timer ack network layer buffer inc next frame send seq number next outgoing frame scratch variable buffer outbound packet initialize outbound sequence numbers fetch first packet construct frame transmission insert sequence number frame send way answer takes long time frame arrival cksum err timeout get acknowledgement turn timer get next one send invert next frame send void receiver3 void seq nr frame expected frame r event type event frame expected 0 true wait event event event frame arrival physical layer r r seq frame expected network layer r info inc frame expected ack 1 frame expected physical layer possibilities frame arrival cksum err valid frame arrived go get newly arrived frame waiting pass data network layer next time expect sequence nr tell frame acked send acknowledgement A positive acknowledgement retransmission protocol 228 THE DATA LINK LAYER piggyback acknowledgement If data link layer waits longer sender timeout period frame retransmitted defeating whole purpose acknowledgements If data link layer oracle could foretell future would know next network layer packet going come could decide either wait send separate acknowledgement immediately depending long projected wait going Of course data link layer foretell future must resort ad hoc scheme waiting fixed number milliseconds If new packet arrives quickly acknowledgement piggybacked onto Otherwise new packet arrived end time period data link layer sends separate acknowledgement frame The next three protocols bidirectional protocols belong class called sliding window protocols The three differ among terms efficiency complexity buffer requirements discussed later In sliding window protocols outbound frame contains sequence number ranging 0 maximum The maximum usually 2n 1 sequence number fits exactly n bit field The stop wait sliding window protocol uses n 1 restricting sequence numbers 0 1 sophisticated versions use arbitrary n The essence sliding window protocols instant time sender maintains set sequence numbers corresponding frames permitted send These frames said fall within sending window Similarly receiver also maintains receiving window corresponding set frames permitted accept The sender window receiver window need lower upper limits even size In protocols fixed size others grow shrink course time frames sent received Although protocols give data link layer freedom order may send receive frames definitely dropped requirement protocol must deliver packets destination network layer order passed data link layer sending machine Nor changed requirement physical communication channel wire like must deliver frames order sent The sequence numbers within sender window represent frames sent sent yet acknowledged Whenever new packet arrives network layer given next highest sequence number upper edge window advanced one When acknowledgement comes lower edge advanced one In way window continuously maintains list unacknowledged frames shows example Since frames currently within sender window may ultimately lost damaged transit sender must keep frames memory possible retransmission Thus maximum window size n sender needs n buffers hold unacknowledged frames If window ever grows SEC 3 4 SLIDING WINDOW PROTOCOLS Sender Receiver b c A sliding window size 1 3 bit sequence number Initially b After first frame sent c After first frame received After first acknowledgement received maximum size sending data link layer must forcibly shut network layer another buffer becomes free The receiving data link layer window corresponds frames may accept Any frame falling within window put receiver buffer When frame whose sequence number equal lower edge window received passed network layer window rotated one Any frame falling outside window discarded In cases subsequent acknowledgement generated sender may work proceed Note window size 1 means data link layer accepts frames order larger windows The network layer contrast always fed data proper order regardless data link layer window size shows example maximum window size 1 Initially frames outstanding lower upper edges sender window equal time goes situation progresses shown Unlike sender window receiver window always remains initial size rotating next frame accepted delivered network layer 3 4 1 A One Bit Sliding Window Protocol Before tackling general case let us examine sliding window protocol window size 1 Such protocol uses stop wait since sender transmits frame waits acknowledgement sending next one 230 THE DATA LINK LAYER depicts protocol Like others starts defining variables Next frame send tells frame sender trying send Similarly frame expected tells frame receiver expecting In cases 0 1 possibilities Protocol 4 Sliding window bidirectional must 1 protocol 4 define MAX SEQ 1 typedef enum frame arrival cksum err timeout event type include protocol h void protocol4 void 0 1 seq nr next frame send 0 1 seq nr frame expected frame r scratch variables packet buffer current packet sent event type event next frame outbound stream next frame send 0 frame expected next frame expected 0 fetch packet network layer network layer buffer info buffer prepare send initial frame insert sequence number frame seq next frame send piggybacked ack ack 1 frame expected transmit frame physical layer start timer running start timer seq true frame arrival cksum err timeout wait event event frame arrived undamaged event frame arrival go get physical layer r handle inbound frame stream r seq frame expected pass packet network layer network layer r info invert seq number expected next inc frame expected r ack next frame send stop timer r ack network layer buffer inc next frame send info buffer seq next frame send ack 1 frame expected physical layer start timer seq handle outbound frame stream turn timer fetch new pkt network layer invert sender sequence number construct outbound frame insert sequence number seq number last received frame transmit frame start timer running A 1 bit sliding window protocol SEC 3 4 SLIDING WINDOW PROTOCOLS Under normal circumstances one two data link layers goes first transmits first frame In words one data link layer programs contain physical layer start timer procedure calls outside main loop The starting machine fetches first packet network layer builds frame sends When frame arrives receiving data link layer checks see duplicate protocol 3 If frame one expected passed network layer receiver window slid The acknowledgement field contains number last frame received without error If number agrees sequence number frame sender trying send sender knows done frame stored buffer fetch next packet network layer If sequence number disagrees must continue trying send frame Whenever frame received frame also sent back Now let us examine protocol 4 see resilient pathological scenarios Assume computer A trying send frame 0 computer B B trying send frame 0 A Suppose A sends frame B A timeout interval little short Consequently A may time repeatedly sending series identical frames seq 0 ack 1 When first valid frame arrives computer B accepted frame expected set value 1 All subsequent frames received rejected B expecting frames sequence number 1 0 Furthermore since duplicates ack 1 B still waiting acknowledgement 0 B go fetch new packet network layer After every rejected duplicate comes B send A frame containing seq 0 ack 0 Eventually one arrive correctly A causing A begin sending next packet No combination lost frames premature timeouts cause protocol deliver duplicate packets either network layer skip packet deadlock The protocol correct However show subtle protocol interactions note peculiar situation arises sides simultaneously send initial packet This synchronization difficulty illustrated In part normal operation protocol shown In b peculiarity illustrated If B waits A first frame sending one sequence shown every frame accepted However A B simultaneously initiate communication first frames cross data link layers get situation b In frame arrival brings new packet network layer duplicates In b half frames contain duplicates even though transmission errors Similar situations occur result premature timeouts even one side clearly starts first In fact multiple premature timeouts occur frames may sent three times wasting valuable bandwidth 232 THE DATA LINK LAYER A sends 0 1 A0 A sends 0 1 A0 B sends 0 1 B0 B gets 0 1 A0 B sends 0 0 B0 B gets 0 1 A0 B sends 0 0 B0 A gets 0 0 B0 A sends 1 0 A1 A gets 0 1 B0 A sends 0 0 A0 B gets 1 0 A1 B sends 1 1 B1 B gets 0 0 A0 B sends 1 0 B1 A gets 1 1 B1 A sends 0 1 A2 A gets 0 0 B0 A sends 1 0 A1 B gets 0 1 A2 B sends 0 0 B2 A gets 0 0 B2 A sends 1 0 A3 A gets 1 0 B1 A sends 1 1 A1 B gets 1 0 A3 B sends 1 1 B3 B gets 1 0 A1 B sends 1 1 B1 Time B gets 1 1 A1 B sends 0 1 B2 b Two scenarios protocol 4 Normal case b Abnormal case The notation seq ack packet number An asterisk indicates network layer accepts packet 3 4 2 A Protocol Using Go Back N Until made tacit assumption transmission time required frame arrive receiver plus transmission time acknowledgement come back negligible Sometimes assumption clearly false In situations long round trip time important implications efficiency bandwidth utilization As example consider 50 kbps satellite channel 500 msec round trip propagation delay Let us imagine trying use protocol 4 send 1000 bit frames via satellite At 0 sender starts sending first frame At 20 msec frame completely sent Not 270 msec frame fully arrived receiver 520 msec acknowledgement arrived back sender best circumstances waiting receiver short acknowledgement frame This means sender blocked 500 520 96 time In words 4 available bandwidth used Clearly combination long transit time high bandwidth short frame length disastrous terms efficiency The problem described viewed consequence rule requiring sender wait acknowledgement sending another frame If relax restriction much better efficiency achieved Basically solution lies allowing sender transmit w frames blocking instead 1 With large enough choice w sender able continuously transmit frames since acknowledgements arrive previous frames window becomes full preventing sender blocking SEC 3 4 SLIDING WINDOW PROTOCOLS To find appropriate value w need know many frames fit inside channel propagate sender receiver This capacity determined bandwidth bits sec multiplied one way transit time bandwidth delay product link We divide quantity number bits frame express number frames Call quantity BD Then w set 2BD 1 Twice bandwidth delay number frames outstanding sender continuously sends frames round trip time receive acknowledgement considered The 1 acknowledgement frame sent complete frame received For example link bandwidth 50 kbps one way transit time 250 msec bandwidth delay product 12 5 kbit 12 5 frames 1000 bits 2BD 1 26 frames Assume sender begins sending frame 0 sends new frame every 20 msec By time finished sending 26 frames 520 msec acknowledgement frame 0 arrived Thereafter acknowledgements arrive every 20 msec sender always get permission continue needs From onwards 25 26 unacknowledged frames always outstanding Put terms sender maximum window size 26 For smaller window sizes utilization link less 100 since sender blocked sometimes We write utilization fraction time sender blocked link utilization w 1 2BD This value upper bound allow frame processing time treats acknowledgement frame zero length since usually short The equation shows need large window w whenever bandwidth delay product large If delay high sender rapidly exhaust window even moderate bandwidth satellite example If bandwidth high even moderate delay sender exhaust window quickly unless large window e g 1 Gbps link 1 msec delay holds 1 megabit With stop wait w 1 even one frame worth propagation delay efficiency less 50 This technique keeping multiple frames flight example pipelining Pipelining frames unreliable communication channel raises serious issues First happens frame middle long stream damaged lost Large numbers succeeding frames arrive receiver sender even finds anything wrong When damaged frame arrives receiver obviously discarded receiver correct frames following Remember receiving data link layer obligated hand packets network layer sequence 234 THE DATA LINK LAYER Two basic approaches available dealing errors presence pipelining shown Timeout interval E D Error D D D D D k3 k6 Ac Ac k7 Ac k5 Ac k4 Ac k2 Ac Ac k0 Ac k1 Frames discarded data link layer Time Error Ac k1 Ac k1 k1 k1 k8 k6 Ac Ac Ac Ac E Ac k2 Ac Na Ac k7 k5 Ac Ac k1 k0 k9 Frames buffered data link layer b Pipelining error recovery Effect error receiver window size 1 b receiver window size large One option called go back n receiver simply discard subsequent frames sending acknowledgements discarded frames This strategy corresponds receive window size 1 In words data link layer refuses accept frame except next one must give network layer If sender window fills timer runs pipeline begin empty Eventually sender time retransmit unacknowledged frames order starting damaged lost one This approach waste lot bandwidth error rate high In b see go back n case receiver window large Frames 0 1 correctly received acknowledged Frame 2 however damaged lost The sender unaware problem continues send frames timer frame 2 expires Then backs frame 2 starts sending 2 3 4 etc The general strategy handling errors frames pipelined called selective repeat When used bad frame received discarded good frames received accepted buffered When sender times oldest unacknowledged frame retransmitted If frame SEC 3 4 SLIDING WINDOW PROTOCOLS arrives correctly receiver deliver network layer sequence frames buffered Selective repeat corresponds receiver window larger 1 This approach require large amounts data link layer memory window large Selective repeat often combined receiver send negative acknowledgement NAK detects error example receives checksum error frame sequence NAKs stimulate retransmission corresponding timer expires thus improve performance In b frames 0 1 correctly received acknowledged frame 2 lost When frame 3 arrives receiver data link layer notices missed frame sends back NAK 2 buffers 3 When frames 4 5 arrive buffered data link layer instead passed network layer Eventually NAK 2 gets back sender immediately resends frame 2 When arrives data link layer 2 3 4 5 pass network layer correct order It also acknowledge frames including 5 shown figure If NAK get lost eventually sender time frame 2 send accord may quite later These two alternative approaches trade offs efficient use bandwidth data link layer buffer space Depending resource scarcer one used shows go back n protocol receiving data link layer accepts frames order frames following error discarded In protocol first time dropped assumption network layer always infinite supply packets send When network layer packet wants send cause network layer ready event happen However enforce flow control limit sender window number unacknowledged frames may outstanding time data link layer must able keep network layer bothering work The library procedures enable network layer disable network layer job The maximum number frames may outstanding instant size sequence number space For go back n MAX SEQ frames may outstanding instant even though MAX SEQ 1 distinct sequence numbers 0 1 MAX SEQ We see even tighter restriction next protocol selective repeat To see restriction required consider following scenario MAX SEQ 7 1 The sender sends frames 0 7 2 A piggybacked acknowledgement 7 comes back sender 3 The sender sends another eight frames sequence numbers 0 7 4 Now another piggybacked acknowledgement frame 7 comes 236 THE DATA LINK LAYER Protocol 5 Go back n allows multiple outstanding frames The sender may transmit MAX SEQ frames without waiting ack In addition unlike previous protocols network layer assumed new packet time Instead network layer causes network layer ready event packet send define MAX SEQ 7 typedef enum frame arrival cksum err timeout network layer ready event type include protocol h static boolean seq nr seq nr b seq nr c Return true b c circularly false otherwise b b c c b b c c return true else return false static void send data seq nr frame nr seq nr frame expected packet buffer Construct send data frame frame scratch variable insert packet frame info buffer frame nr insert sequence number frame seq frame nr ack frame expected MAX SEQ MAX SEQ 1 piggyback ack transmit frame physical layer start timer running start timer frame nr void protocol5 void seq nr next frame send seq nr ack expected seq nr frame expected frame r packet buffer MAX SEQ 1 seq nr nbuffered seq nr event type event MAX SEQ 1 used outbound stream oldest frame yet unacknowledged next frame expected inbound stream scratch variable buffers outbound stream number output buffers currently use used index buffer array enable network layer ack expected 0 next frame send 0 frame expected 0 nbuffered 0 allow network layer ready events next ack expected inbound next frame going number frame expected inbound initially packets buffered true wait event event four possibilities see event type SEC 3 4 SLIDING WINDOW PROTOCOLS switch event network layer packet send case network layer ready Accept save transmit new frame network layer buffer next frame send fetch new packet nbuffered nbuffered 1 expand sender window send data next frame send frame expected buffer transmit frame advance sender upper window edge inc next frame send break case frame arrival physical layer r data control frame arrived get incoming frame physical layer r seq frame expected Frames accepted order pass packet network layer network layer r info advance lower edge receiver window inc frame expected Ack n implies n 1 n 2 etc Check ack expected r ack next frame send Handle piggybacked ack nbuffered nbuffered 1 one frame fewer buffered frame arrived intact stop timer stop timer ack expected contract sender window inc ack expected break case cksum err break ignore bad frames case timeout trouble retransmit outstanding frames start retransmitting next frame send ack expected 1 nbuffered send data next frame send frame expected buffer resend frame prepare send next one inc next frame send nbuffered MAX SEQ enable network layer else disable network layer A sliding window protocol using go back n The question eight frames belonging second batch arrive successfully eight get lost counting discards following error lost In cases receiver would sending frame 7 acknowledgement 238 THE DATA LINK LAYER The sender way telling For reason maximum number outstanding frames must restricted MAX SEQ Although protocol 5 buffer frames arriving error escape problem buffering altogether Since sender may retransmit unacknowledged frames future time must hang transmitted frames knows sure accepted receiver When acknowledgement comes frame n frames n 1 n 2 also automatically acknowledged This type acknowledgement called cumulative acknowledgement This property especially important previous acknowledgement bearing frames lost garbled Whenever acknowledgement comes data link layer checks see buffers released If buffers released e room available window previously blocked network layer allowed cause network layer ready events For protocol assume always reverse traffic piggyback acknowledgements Protocol 4 need assumption since sends back one frame every time receives frame even already sent frame In next protocol solve problem one way traffic elegant way Because protocol 5 multiple outstanding frames logically needs multiple timers one per outstanding frame Each frame times independently ones However timers easily simulated software using single hardware clock causes interrupts periodically The pending timeouts form linked list node list containing number clock ticks timer expires frame timed pointer next node Real time 10 00 00 000 10 00 00 005 Pointer next timeout Frame timed Ticks go b Simulation multiple timers software The queued timeouts b The situation first timeout expired As illustration timers could implemented consider example Assume clock ticks every 1 msec Initially SEC 3 4 SLIDING WINDOW PROTOCOLS real time 10 00 00 000 three timeouts pending 10 00 00 005 10 00 00 013 10 00 00 019 Every time hardware clock ticks real time updated tick counter head list decremented When tick counter becomes zero timeout caused node removed list shown b Although organization requires list scanned start timer stop timer called require much work per tick In protocol 5 routines given parameter indicating frame timed 3 4 3 A Protocol Using Selective Repeat The go back n protocol works well errors rare line poor wastes lot bandwidth retransmitted frames An alternative strategy selective repeat protocol allow receiver accept buffer frames following damaged lost one In protocol sender receiver maintain window outstanding acceptable sequence numbers respectively The sender window size starts 0 grows predefined maximum The receiver window contrast always fixed size equal predetermined maximum The receiver buffer reserved sequence number within fixed window Associated buffer bit arrived telling whether buffer full empty Whenever frame arrives sequence number checked function see falls within window If already received accepted stored This action taken without regard whether frame contains next packet expected network layer Of course must kept within data link layer passed network layer lower numbered frames already delivered network layer correct order A protocol using algorithm given Nonsequential receive introduces constraints frame sequence numbers compared protocols frames accepted order We illustrate trouble easily example Suppose 3 bit sequence number sender permitted transmit seven frames required wait acknowledgement Initially sender receiver windows shown The sender transmits frames 0 6 The receiver window allows accept frame sequence number 0 6 inclusive All seven frames arrive correctly receiver acknowledges advances window allow receipt 7 0 1 2 3 4 5 shown b All seven buffers marked empty It point disaster strikes form lightning bolt hitting telephone pole wiping acknowledgements The protocol operate correctly despite disaster The sender eventually times retransmits frame 0 When frame arrives receiver check made see falls within receiver window Unfortunately b frame 0 240 THE DATA LINK LAYER Protocol 6 Selective repeat accepts frames order passes packets network layer order Associated outstanding frame timer When timer expires frame retransmitted outstanding frames protocol 5 2 n 1 define MAX SEQ 7 define NR BUFS MAX SEQ 1 2 typedef enum frame arrival cksum err timeout network layer ready ack timeout event type include protocol h nak sent yet boolean nak true initial value simulator seq nr oldest frame MAX SEQ 1 static boolean seq nr seq nr b seq nr c Same protocol 5 shorter obscure return b b c c b b c c static void send frame frame kind fk seq nr frame nr seq nr frame expected packet buffer Construct send data ack nak frame frame scratch variable kind fk kind data ack nak fk data info buffer frame nr NR BUFS meaningful data frames seq frame nr ack frame expected MAX SEQ MAX SEQ 1 one nak per frame please fk nak nak false transmit frame physical layer fk data start timer frame nr NR BUFS need separate ack frame stop ack timer void protocol6 void seq nr ack expected seq nr next frame send seq nr frame expected seq nr far int frame r packet buf NR BUFS packet buf NR BUFS boolean arrived NR BUFS seq nr nbuffered event type event enable network layer ack expected 0 next frame send 0 frame expected 0 far NR BUFS nbuffered 0 0 NR BUFS arrived false lower edge sender window upper edge sender window 1 lower edge receiver window upper edge receiver window 1 index buffer pool scratch variable buffers outbound stream buffers inbound stream inbound bit map many output buffers currently used initialize next ack expected inbound stream number next outgoing frame initially packets buffered SEC 3 4 SLIDING WINDOW PROTOCOLS true five possibilities see event type wait event event switch event accept save transmit new frame case network layer ready nbuffered nbuffered 1 expand window network layer buf next frame send NR BUFS fetch new packet send frame data next frame send frame expected buf transmit frame advance upper window edge inc next frame send break data control frame arrived case frame arrival fetch incoming frame physical layer physical layer r r kind data An undamaged frame arrived r seq frame expected nak send frame nak 0 frame expected buf else start ack timer frame expected r seq far arrived r seq NR BUFS false Frames may accepted order mark buffer full arrived r seq NR BUFS true insert data buffer buf r seq NR BUFS r info arrived frame expected NR BUFS Pass frames advance window network layer buf frame expected NR BUFS nak true arrived frame expected NR BUFS false advance lower edge receiver window inc frame expected advance upper edge receiver window inc far see separate ack needed start ack timer r kind nak ack expected r ack 1 MAX SEQ 1 next frame send send frame data r ack 1 MAX SEQ 1 frame expected buf ack expected r ack next frame send nbuffered nbuffered 1 handle piggybacked ack frame arrived intact stop timer ack expected NR BUFS advance lower edge sender window inc ack expected break case cksum err nak send frame nak 0 frame expected buf damaged frame break case timeout send frame data oldest frame frame expected buf timed break case ack timeout ack timer expired send ack send frame ack 0 frame expected buf nbuffered NR BUFS enable network layer else disable network layer A sliding window protocol using selective repeat 242 THE DATA LINK LAYER within new window accepted new frame The receiver also sends piggybacked acknowledgement frame 6 since 0 6 received The sender happy learn transmitted frames actually arrive correctly advances window immediately sends frames 7 0 1 2 3 4 5 Frame 7 accepted receiver packet passed directly network layer Immediately thereafter receiving data link layer checks see valid frame 0 already discovers passes old buffered packet network layer new packet Consequently network layer gets incorrect packet protocol fails The essence problem receiver advanced window new range valid sequence numbers overlapped old one Consequently following batch frames might either duplicates acknowledgements lost new ones acknowledgements received The poor receiver way distinguishing two cases The way dilemma lies making sure receiver advanced window overlap original window To ensure overlap maximum window size half range sequence numbers This situation shown c With 3 bits sequence numbers range 0 7 Only four unacknowledged frames outstanding instant That way receiver accepted frames 0 3 advanced window permit acceptance frames 4 7 unambiguously tell subsequent frames retransmissions 0 3 new ones 4 7 In general window size protocol 6 MAX SEQ 1 2 An interesting question many buffers must receiver Under conditions ever accept frames whose sequence numbers lower edge window frames whose sequence numbers upper edge window Consequently number buffers needed equal window size range sequence numbers In preceding example 3 bit sequence number four buffers numbered 0 3 needed When frame arrives put buffer mod 4 Notice although 4 mod 4 competing buffer never within window time would imply window size least 5 For reason number timers needed equal number buffers size sequence space Effectively timer associated buffer When timer runs contents buffer retransmitted Protocol 6 also relaxes implicit assumption channel heavily loaded We made assumption protocol 5 relied frames sent reverse direction piggyback acknowledgements If reverse traffic light acknowledgements may held long period time cause problems In extreme lot traffic one SEC 3 4 SLIDING WINDOW PROTOCOLS Sender 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 Receiver 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 b c Initial situation window size7 b After 7 frames sent received acknowledged c Initial situation window size 4 After 4 frames sent received acknowledged direction traffic direction protocol block sender window reaches maximum To relax assumption auxiliary timer started start ack timer sequence data frame arrives If reverse traffic presented timer expires separate acknowledgement frame sent An interrupt due auxiliary timer called ack timeout event With arrangement traffic flow one direction possible lack reverse data frames onto acknowledgements piggybacked longer obstacle Only one auxiliary timer exists start ack timer called timer running effect The timer reset extended since purpose provide minimum rate acknowledgements It essential timeout associated auxiliary timer appreciably shorter timeout used timing data frames This condition required ensure correctly received frame acknowledged early enough frame retransmission timer expire retransmit frame Protocol 6 uses efficient strategy protocol 5 dealing errors Whenever receiver reason suspect error occurred sends negative acknowledgement NAK frame back sender Such frame request retransmission frame specified NAK In two cases receiver suspicious damaged frame arrives frame expected one arrives potential lost frame To avoid making multiple requests retransmission lost frame receiver keep track whether NAK already sent given frame The variable nak protocol 6 true NAK sent yet frame expected If NAK gets mangled lost real harm done since sender eventually time retransmit missing frame anyway If wrong frame arrives NAK sent lost nak true auxiliary timer started When expires ACK sent resynchronize sender receiver current status 244 THE DATA LINK LAYER In situations time required frame propagate destination processed acknowledgement come back nearly constant In situations sender adjust timer tight slightly larger normal time interval expected sending frame receiving acknowledgement NAKs useful case However situations time highly variable For example reverse traffic sporadic time acknowledgement shorter reverse traffic longer The sender faced choice either setting interval small value risking unnecessary retransmissions setting large value going idle long period error Both choices waste bandwidth In general standard deviation acknowledgement interval large compared interval timer set loose conservative NAKs appreciably speed retransmission lost damaged frames Closely related matter timeouts NAKs question determining frame caused timeout In protocol 5 always ack expected always oldest In protocol 6 trivial way determine timed Suppose frames 0 4 transmitted meaning list outstanding frames 01234 order oldest youngest Now imagine 0 times 5 new frame transmitted 1 times 2 times 6 another new frame transmitted At point list outstanding frames 3405126 oldest youngest If inbound traffic e acknowledgement bearing frames lost seven outstanding frames time order To keep example getting even complicated already shown timer administration Instead assume variable oldest frame set upon timeout indicate frame timed 3 5 EXAMPLE DATA LINK PROTOCOLS Within single building LANs widely used interconnection wide area network infrastructure built point point lines In Chap 4 look LANs Here examine data link protocols found point point lines Internet two common situations The first situation packets sent SONET optical fiber links wide area networks These links widely used example connect routers different locations ISP network The second situation ADSL links running local loop telephone network edge Internet These links connect millions individuals businesses Internet The Internet needs point point links uses well dial modems leased lines cable modems A standard protocol called PPP SEC 3 5 EXAMPLE DATA LINK PROTOCOLS Point Point Protocol used send packets links PPP defined RFC 1661 elaborated RFC 1662 RFCs Simpson 1994a 1994b SONET ADSL links apply PPP different ways 3 5 1 Packet SONET SONET covered Sec 2 6 4 physical layer protocol commonly used wide area optical fiber links make backbone communications networks including telephone system It provides bitstream runs well defined rate example 2 4 Gbps OC 48 link This bitstream organized fixed size byte payloads recur every 125 sec whether user data send To carry packets across links framing mechanism needed distinguish occasional packets continuous bitstream transported PPP runs IP routers provide mechanism shown Router IP packet IP IP PPP PPP SONET Optical fiber SONET PPP frame SONET payload SONET payload b Packet SONET A protocol stack b Frame relationships PPP improves earlier simpler protocol called SLIP Serial Line Internet Protocol used handle error detection link configuration support multiple protocols permit authentication With wide set options PPP provides three main features 1 A framing method unambiguously delineates end one frame start next one The frame format also handles error detection 2 A link control protocol bringing lines testing negotiating options bringing gracefully longer needed This protocol called LCP Link Control Protocol 3 A way negotiate network layer options way independent network layer protocol used The method chosen different NCP Network Control Protocol network layer supported 246 THE DATA LINK LAYER The PPP frame format chosen closely resemble frame format HDLC High level Data Link Control widely used instance earlier family protocols since need reinvent wheel The primary difference PPP HDLC PPP byte oriented rather bit oriented In particular PPP uses byte stuffing frames integral number bytes HDLC uses bit stuffing allows frames say 30 25 bytes There second major difference practice however HDLC provides reliable transmission sliding window acknowledgements timeouts manner studied PPP also provide reliable transmission noisy environments wireless networks exact details defined RFC 1663 However rarely done practice Instead unnumbered mode nearly always used Internet provide connectionless unacknowledged service The PPP frame format shown All PPP frames begin standard HDLC flag byte 0x7E 01111110 The flag byte stuffed occurs within Payload field using escape byte 0x7D The following byte escaped byte XORed 0x20 flips 5th bit For example 0x7D 0x5E escape sequence flag byte 0x7E This means start end frames searched simply scanning byte 0x7E since occur elsewhere The destuffing rule receiving frame look 0x7D remove XOR following byte 0x20 Also one flag byte needed frames Multiple flag bytes used fill link frames sent After start frame flag byte comes Address field This field always set binary value 11111111 indicate stations accept frame Using value avoids issue assign data link addresses Bytes 1 2 Variable 2 4 Flag Address Control Protocol Payload Checksum Flag The PPP full frame format unnumbered mode operation The Address field followed Control field default value 00000011 This value indicates unnumbered frame Since Address Control fields always constant default configuration LCP provides necessary mechanism two parties negotiate option omit altogether save 2 bytes per frame The fourth PPP field Protocol field Its job tell kind packet Payload field Codes starting 0 bit defined IP version 4 IP version 6 network layer protocols might used IPX SEC 3 5 EXAMPLE DATA LINK PROTOCOLS AppleTalk Codes starting 1 bit used PPP configuration protocols including LCP different NCP network layer protocol supported The default size Protocol field 2 bytes negotiated 1 byte using LCP The designers perhaps overly cautious thinking someday might 256 protocols use The Payload field variable length negotiated maximum If length negotiated using LCP line setup default length 1500 bytes used Padding may follow payload needed After Payload field comes Checksum field normally 2 bytes 4 byte checksum negotiated The 4 byte checksum fact 32 bit CRC whose generator polynomial given end Sec 3 2 2 The 2byte checksum also industry standard CRC PPP framing mechanism carry packets multiple protocols many types physical layers To use PPP SONET choices make spelled RFC 2615 Malis Simpson 1999 A 4 byte checksum used since primary means detecting transmission errors physical link network layers It recommended Address Control Protocol fields compressed since SONET links already run relatively high rates There also one unusual feature The PPP payload scrambled described Sec 2 5 1 inserted SONET payload Scrambling XORs payload long pseudorandom sequence transmitted The issue SONET bitstream needs frequent bit transitions synchronization These transitions come naturally variation voice signals data communication user chooses information sent might send packet long run 0s With scrambling likelihood user able cause problems sending long run 0s made extremely low Before PPP frames carried SONET lines PPP link must established configured The phases link goes brought used taken shown The link starts DEAD state means connection physical layer When physical layer connection established link moves ESTABLISH At point PPP peers exchange series LCP packets carried Payload field PPP frame select PPP options link possibilities mentioned The initiating peer proposes options responding peer either accepts rejects whole part The responder also make alternative proposals If LCP option negotiation successful link reaches AUTHENTICATE state Now two parties check identities desired If authentication successful NETWORK state entered series NCP packets sent configure network layer It difficult generalize NCP protocols one specific network layer protocol allows configuration requests made specific protocol 248 THE DATA LINK LAYER Carrier detected Both sides agree options ESTABLISH Authentication successful AUTHENTICATE Failed DEAD Failed TERMINATE Carrier dropped Done NETWORK OPEN NCP configuration State diagram bringing PPP link For IP example assignment IP addresses ends link important possibility Once OPEN reached data transport take place It state IP packets carried PPP frames across SONET line When data transport finished link moves TERMINATE state moves back DEAD state physical layer connection dropped 3 5 2 ADSL Asymmetric Digital Subscriber Loop ADSL connects millions home subscribers Internet megabit sec rates telephone local loop used plain old telephone service In Sec 2 5 3 described device called DSL modem added home side It sends bits local loop device called DSLAM DSL Access Multiplexer pronounced dee slam telephone company local office Now explore detail packets carried ADSL links The overall picture protocols devices used ADSL shown Different protocols deployed different networks chosen show popular scenario Inside home computer PC sends IP packets DSL modem using link layer like Ethernet The DSL modem sends IP packets local loop DSLAM using protocols study At DSLAM router connected depending implementation IP packets extracted enter ISP network may reach destination Internet The protocols shown ADSL link start bottom ADSL physical layer They based digital modulation scheme called SEC 3 5 EXAMPLE DATA LINK PROTOCOLS IP PPP PC Ethernet Ethernet IP AAL5 ATM ATM Local loop DSLAM router PPP AAL5 ADSL Customer home DSL modem Link Internet ADSL ISP office ADSL protocol stacks orthogonal frequency division multiplexing also known discrete multitone saw Sec 2 5 3 Near top stack IP network layer PPP This protocol PPP studied packet SONET transports It works way establish configure link carry IP packets In ADSL PPP ATM AAL5 These new protocols seen ATM Asynchronous Transfer Mode designed early 1990s launched incredible hype It promised network technology would solve world telecommunications problems merging voice data cable television telegraph carrier pigeon tin cans connected strings tom toms everything else integrated system could everything everyone This happen In large part problems ATM similar described concerning OSI protocols bad timing technology implementation politics Nevertheless ATM much successful OSI While taken world remains widely used niches including broadband access lines DSL WAN links inside telephone networks ATM link layer based transmission fixed length cells information The Asynchronous name means cells always need sent way bits continuously sent synchronous lines SONET Cells need sent information carry ATM connection oriented technology Each cell carries virtual circuit identifier header devices use identifier forward cells along paths established connections The cells 53 bytes long consisting 48 byte payload plus 5 byte header By using small cells ATM flexibly divide bandwidth physical layer link among different users fine slices This ability useful example sending voice data one link without long data packets would cause large variations delay voice samples The unusual choice cell length e g compared natural choice 250 THE DATA LINK LAYER power 2 indication political design ATM The 48 byte size payload compromise resolve deadlock Europe wanted 32 byte cells U S wanted 64 byte cells A brief overview ATM given Siu Jain 1995 To send data ATM network needs mapped sequence cells This mapping done ATM adaptation layer process called segmentation reassembly Several adaptation layers defined different services ranging periodic voice samples packet data The main one used packet data AAL5 ATM Adaptation Layer 5 An AAL5 frame shown Instead header trailer gives length 4 byte CRC error detection Naturally CRC one used PPP IEEE 802 LANs like Ethernet Wang Crowcroft 1992 shown strong enough detect nontraditional errors cell reordering As well payload AAL5 frame padding This rounds overall length multiple 48 bytes frame evenly divided cells No addresses needed frame virtual circuit identifier carried cell get right destination Bytes 1 2 Variable 0 47 PPP protocol PPP payload Pad Unused Length CRC AAL5 payload AAL5 trailer AAL5 frame carrying PPP data Now described ATM describe PPP makes use ATM case ADSL It done yet another standard called PPPoA PPP ATM This standard really protocol appear specification work PPP AAL5 frames It described RFC 2364 Gross et al 1998 Only PPP protocol payload fields placed AAL5 payload shown The protocol field indicates DSLAM far end whether payload IP packet packet another protocol LCP The far end knows cells contain PPP information ATM virtual circuit set purpose Within AAL5 frame PPP framing needed would serve purpose ATM AAL5 already provide framing More framing would worthless The PPP CRC also needed AAL5 already includes CRC This error detection mechanism supplements ADSL physical layer coding Reed Solomon code error correction 1 byte CRC detection remaining errors otherwise caught This scheme much sophisticated error recovery mechanism packets sent SONET line ADSL much noisier channel SEC 3 6 SUMMARY 3 6 SUMMARY The task data link layer convert raw bit stream offered physical layer stream frames use network layer The link layer present stream varying levels reliability ranging connectionless unacknowledged service reliable connection oriented service Various framing methods used including byte count byte stuffing bit stuffing Data link protocols provide error control detect correct damaged frames retransmit lost frames To prevent fast sender overrunning slow receiver data link protocol also provide flow control The sliding window mechanism widely used integrate error control flow control simple way When window size 1 packet protocol stop wait Codes error correction detection add redundant information messages using variety mathematical techniques Convolutional codes Reed Solomon codes widely deployed error correction low density parity check codes increasing popularity The codes error detection used practice include cyclic redundancy checks checksums All codes applied link layer well physical layer higher layers We examined series protocols provide reliable link layer using acknowledgements retransmissions ARQ Automatic Repeat reQuest realistic assumptions Starting error free environment receiver handle frame sent introduced flow control followed error control sequence numbers stop wait algorithm Then used sliding window algorithm allow bidirectional communication introduce concept piggybacking The last two protocols pipeline transmission multiple frames prevent sender blocking link long propagation delay The receiver either discard frames next one sequence buffer order frames send negative acknowledgements greater bandwidth efficiency The former strategy go back n protocol latter strategy selective repeat protocol The Internet uses PPP main data link protocol point point lines It provides connectionless unacknowledged service using flag bytes delimit frames CRC error detection It used carry packets across range links including SONET links wide area networks ADSL links home PROBLEMS 1 An upper layer packet split 10 frames 80 chance arriving undamaged If error control done data link protocol many times must message sent average get entire thing 252 THE DATA LINK LAYER 2 The following character encoding used data link protocol A 01000111 B 11100011 FLAG 01111110 ESC 11100000 Show bit sequence transmitted binary four character frame A B ESC FLAG following framing methods used Byte count b Flag bytes byte stuffing c Starting ending flag bytes bit stuffing 3 The following data fragment occurs middle data stream bytestuffing algorithm described text used A B ESC C ESC FLAG FLAG D What output stuffing 4 What maximum overhead byte stuffing algorithm 5 One classmates Scrooge pointed wasteful end frame flag byte begin next one second flag byte One flag byte could job well byte saved byte earned Do agree 6 A bit string 0111101111101111110 needs transmitted data link layer What string actually transmitted bit stuffing 7 Can think circumstances open loop protocol e g Hamming code might preferable feedback type protocols discussed throughout chapter 8 To provide reliability single parity bit give error detecting coding scheme uses one parity bit checking odd numbered bits second parity bit even numbered bits What Hamming distance code 9 Sixteen bit messages transmitted using Hamming code How many check bits needed ensure receiver detect correct single bit errors Show bit pattern transmitted message 1101001100110101 Assume even parity used Hamming code 10 A 12 bit Hamming code whose hexadecimal value 0xE4F arrives receiver What original value hexadecimal Assume 1 bit error 11 One way detecting errors transmit data block n rows k bits per row add parity bits row column The bitin lower right corner parity bit checks row column Will scheme detect single errors Double errors Triple errors Show scheme detect four bit errors 12 Suppose data transmitted blocks sizes 1000 bits What maximum error rate error detection retransmission mechanism 1 parity bit per block better using Hamming code Assume bit errors independent one another bit error occurs retransmission 13 A block bits n rows k columns uses horizontal vertical parity bits error detection Suppose exactly 4 bits inverted due transmission errors Derive expression probability error undetected CHAP 3 PROBLEMS 14 Using convolutional coder output sequence input sequence 10101010 left right internal state initially zero 15 Suppose message 1001 1100 1010 0011 transmitted using Internet Checksum 4 bit word What value checksum 16 What remainder obtained dividing x 7 x 5 1 generator polynomial x 3 1 17 A bit stream 10011101 transmitted using standard CRC method described text The generator polynomial x 3 1 Show actual bit string transmitted Suppose third bit left inverted transmission Show error detected receiver end Give example bit errors bit string transmitted detected receiver 18 A 1024 bit message sent contains 992 data bits 32 CRC bits CRC computed using IEEE 802 standardized 32 degree CRC polynomial For following explain whether errors message transmission detected receiver There single bit error b There two isolated bit errors c There 18 isolated bit errors There 47 isolated bit errors e There 24 bit long burst error f There 35 bit long burst error 19 In discussion ARQ protocol Section 3 3 3 scenario outlined resulted receiver accepting two copies frame due loss acknowledgement frame Is possible receiver may accept multiple copies frame none frames message acknowledgement lost 20 A channel bit rate 4 kbps propagation delay 20 msec For range frame sizes stop wait give efficiency least 50 21 In protocol 3 possible sender start timer already running If might occur If impossible 22 A 3000 km long T1 trunk used transmit 64 byte frames using protocol 5 If propagation speed 6 sec km many bits sequence numbers 23 Imagine sliding window protocol using many bits sequence numbers wraparound never occurs What relations must hold among four window edges window size constant sender receiver 24 If procedure protocol 5 checked condition b c instead condition b c would effect protocol correctness efficiency Explain answer 25 In protocol 6 data frame arrives check made see sequence number differs one expected nak true If conditions hold NAK sent Otherwise auxiliary timer started Suppose else clause omitted Would change affect protocol correctness 254 THE DATA LINK LAYER 26 Suppose three statement loop near end protocol 6 removed code Would affect correctness protocol performance Explain answer 27 The distance earth distant planet approximately 9 1010 What channel utilization stop wait protocol used frame transmission 64 Mbps point point link Assume frame size 32 KB speed light 3 108 28 In previous problem suppose sliding window protocol used instead For send window size link utilization 100 You may ignore protocol processing times sender receiver 29 In protocol 6 code frame arrival section used NAKs This section invoked incoming frame NAK another condition met Give scenario presence condition essential 30 Consider operation protocol 6 1 Mbps perfect e error free line The maximum frame size 1000 bits New packets generated 1 second apart The timeout interval 10 msec If special acknowledgement timer eliminated unnecessary timeouts would occur How many times would average message transmitted 31 In protocol 6 MAX SEQ 2n 1 While condition obviously desirable make efficient use header bits demonstrated essential Does protocol work correctly MAX SEQ 4 example 32 Frames 1000 bits sent 1 Mbps channel using geostationary satellite whose propagation time earth 270 msec Acknowledgements always piggybacked onto data frames The headers short Three bit sequence numbers used What maximum achievable channel utilization Stop wait b Protocol 5 c Protocol 6 33 Compute fraction bandwidth wasted overhead headers retransmissions protocol 6 heavily loaded 50 kbps satellite channel data frames consisting 40 header 3960 data bits Assume signal propagation time earth satellite 270 msec ACK frames never occur NAK frames 40 bits The error rate data frames 1 error rate NAK frames negligible The sequence numbers 8 bits 34 Consider error free 64 kbps satellite channel used send 512 byte data frames one direction short acknowledgements coming back way What maximum throughput window sizes 1 7 15 127 The earth satellite propagation time 270 msec 35 A 100 km long cable runs T1 data rate The propagation speed cable 2 3 speed light vacuum How many bits fit cable 36 Give least one reason PPP uses byte stuffing instead bit stuffing prevent accidental flag bytes within payload causing confusion CHAP 3 PROBLEMS 37 What minimum overhead send IP packet using PPP Count overhead introduced PPP IP header overhead What maximum overhead 38 A 100 byte IP packet transmitted local loop using ADSL protocol stack How many ATM cells transmitted Briefly describe contents 39 The goal lab exercise implement error detection mechanism using standard CRC algorithm described text Write two programs generator verifier The generator program reads standard input line ASCII text containing n bit message consisting string 0s 1s The second line kbit polynomial also ASCII It outputs standard output line ASCII text n k 0s 1s representing message transmitted Then outputs polynomial read The verifier program reads output generator program outputs message indicating whether correct Finally write program alter inverts 1 bit first line depending argument bit number counting leftmost bit 1 copies rest two lines correctly By typing generator file verifier see message correct typing generator file alter arg verifier get error message This page intentionally left blank 4 THE MEDIUM ACCESS CONTROL SUBLAYER Network links divided two categories using point point connections using broadcast channels We studied point point links Chap 2 chapter deals broadcast links protocols In broadcast network key issue determine gets use channel competition To make point consider conference call six people six different telephones connected one hear talk others It likely one stops speaking two start talking leading chaos In face face meeting chaos avoided external means For example meeting people raise hands request permission speak When single channel available much harder determine go next Many protocols solving problem known They form contents chapter In literature broadcast channels sometimes referred multiaccess channels random access channels The protocols used determine goes next multiaccess channel belong sublayer data link layer called MAC Medium Access Control sublayer The MAC sublayer especially important LANs particularly wireless ones wireless naturally broadcast channel WANs contrast use point point links except satellite networks Because multiaccess channels LANs closely related chapter discuss LANs 258 THE MEDIUM ACCESS CONTROL SUBLAYER general including issues strictly part MAC sublayer main subject control channel Technically MAC sublayer bottom part data link layer logically studied examining point point protocols Chap 3 Nevertheless people easier understand protocols involving multiple parties two party protocols well understood For reason deviated slightly strict bottom order presentation 4 1 THE CHANNEL ALLOCATION PROBLEM The central theme chapter allocate single broadcast channel among competing users The channel might portion wireless spectrum geographic region single wire optical fiber multiple nodes connected It matter In cases channel connects user users user makes full use channel interferes users also wish use channel We first look shortcomings static allocation schemes bursty traffic Then lay key assumptions used model dynamic schemes examine following sections 4 1 1 Static Channel Allocation The traditional way allocating single channel telephone trunk among multiple competing users chop capacity using one multiplexing schemes described Sec 2 5 FDM Frequency Division Multiplexing If N users bandwidth divided N equal sized portions user assigned one portion Since user private frequency band interference among users When small constant number users steady stream heavy load traffic division simple efficient allocation mechanism A wireless example FM radio stations Each station gets portion FM band uses time broadcast signal However number senders large varying traffic bursty FDM presents problems If spectrum cut N regions fewer N users currently interested communicating large piece valuable spectrum wasted And N users want communicate denied permission lack bandwidth even users assigned frequency band hardly ever transmit receive anything Even assuming number users could somehow held constant N dividing single available channel number static subchannels SEC 4 1 THE CHANNEL ALLOCATION PROBLEM inherently inefficient The basic problem users quiescent bandwidth simply lost They using one else allowed use either A static allocation poor fit computer systems data traffic extremely bursty often peak traffic mean traffic ratios 1000 1 Consequently channels idle time The poor performance static FDM easily seen simple queueing theory calculation Let us start finding mean time delay T send frame onto channel capacity C bps We assume frames arrive randomly average arrival rate frames sec frames vary length average length 1 bits With parameters service rate channel C frames sec A standard queueing theory result T C For curious result M M 1 queue It requires randomness times frame arrivals frame lengths follow exponential distribution equivalently result Poisson process In example C 100 Mbps mean frame length 1 10 000 bits frame arrival rate 5000 frames sec T 200 sec Note ignored queueing delay asked long takes send 10 000bit frame 100 Mbps network would get incorrect answer 100 sec That result holds contention channel Now let us divide single channel N independent subchannels capacity C N bps The mean input rate subchannels N Recomputing T get TN N NT C C N N 4 1 The mean delay divided channel N times worse frames somehow magically arranged orderly big central queue This result says bank lobby full ATM machines better single queue feeding machines separate queue front machine Precisely arguments apply FDM also apply ways statically dividing channel If use time division multiplexing TDM allocate user every Nth time slot user use allocated slot would lie fallow The would hold split networks physically Using previous example replace 100 Mbps network 10 networks 10 Mbps statically allocate user one mean delay would jump 200 sec 2 msec Since none traditional static channel allocation methods work well bursty traffic explore dynamic methods 260 THE MEDIUM ACCESS CONTROL SUBLAYER 4 1 2 Assumptions Dynamic Channel Allocation Before get first many channel allocation methods chapter worthwhile carefully formulate allocation problem Underlying work done area following five key assumptions 1 Independent Traffic The model consists N independent stations e g computers telephones program user generates frames transmission The expected number frames generated interval length constant arrival rate new frames Once frame generated station blocked nothing frame successfully transmitted 2 Single Channel A single channel available communication All stations transmit receive The stations assumed equally capable though protocols may assign different roles e g priorities 3 Observable Collisions If two frames transmitted simultaneously overlap time resulting signal garbled This event called collision All stations detect collision occurred A collided frame must transmitted later No errors generated collisions occur 4 Continuous Slotted Time Time may assumed continuous case frame transmission begin instant Alternatively time may slotted divided discrete intervals called slots Frame transmissions must begin start slot A slot may contain 0 1 frames corresponding idle slot successful transmission collision respectively 5 Carrier Sense No Carrier Sense With carrier sense assumption stations tell channel use trying use No station attempt use channel sensed busy If carrier sense stations sense channel trying use They go ahead transmit Only later determine whether transmission successful Some discussion assumptions order The first one says frame arrivals independent across stations particular station frames generated unpredictably constant rate Actually assumption particularly good model network traffic well known packets come bursts range time scales Paxson Floyd 1995 Leland et al 1994 Nonetheless Poisson models frequently called useful mathematically tractable They help us analyze SEC 4 1 THE CHANNEL ALLOCATION PROBLEM protocols understand roughly performance changes operating range compares designs The single channel assumption heart model No external ways communicate exist Stations raise hands request teacher call come better solutions The remaining three assumptions depend engineering system say assumptions hold examine particular protocol The collision assumption basic Stations need way detect collisions retransmit frames rather let lost For wired channels node hardware designed detect collisions occur The stations terminate transmissions prematurely avoid wasting capacity This detection much harder wireless channels collisions usually inferred fact lack expected acknowledgement frame It also possible frames involved collision successfully received depending details signals receiving hardware However situation common case assume frames involved collision lost We also see protocols designed prevent collisions occurring first place The reason two alternative assumptions time slotted time used improve performance However requires stations follow master clock synchronize actions divide time discrete intervals Hence always available We discuss analyze systems kinds time For given system one holds Similarly network may carrier sensing Wired networks generally carrier sense Wireless networks always use effectively every station may within radio range every station Similarly carrier sense available settings station communicate directly stations example cable modem stations must communicate via cable headend Note word carrier sense refers signal channel nothing common carriers e g telephone companies date back days Pony Express To avoid misunderstanding worth noting multiaccess protocol guarantees reliable delivery Even absence collisions receiver may copied frame incorrectly various reasons Other parts link layer higher layers provide reliability 4 2 MULTIPLE ACCESS PROTOCOLS Many algorithms allocating multiple access channel known In following sections study small sample interesting ones give examples commonly used practice 262 THE MEDIUM ACCESS CONTROL SUBLAYER 4 2 1 ALOHA The story first MAC starts pristine Hawaii early 1970s In case pristine interpreted working telephone system This make life pleasant researcher Norman Abramson colleagues University Hawaii trying connect users remote islands main computer Honolulu Stringing cables Pacific Ocean cards looked different solution The one found used short range radios user terminal sharing upstream frequency send frames central computer It included simple elegant method solve channel allocation problem Their work extended many researchers since Schwartz Abramson 2009 Although Abramson work called ALOHA system used groundbased radio broadcasting basic idea applicable system uncoordinated users competing use single shared channel We discuss two versions ALOHA pure slotted They differ respect whether time continuous pure version divided discrete slots frames must fit Pure ALOHA The basic idea ALOHA system simple let users transmit whenever data sent There collisions course colliding frames damaged Senders need way find case In ALOHA system station sent frame central computer computer rebroadcasts frame stations A sending station thus listen broadcast hub see frame gotten In systems wired LANs sender might able listen collisions transmitting If frame destroyed sender waits random amount time sends The waiting time must random frames collide lockstep Systems multiple users share common channel way lead conflicts known contention systems A sketch frame generation ALOHA system given We made frames length throughput ALOHA systems maximized uniform frame size rather allowing variable length frames Whenever two frames try occupy channel time collision seen garbled If first bit new frame overlaps last bit frame almost finished frames totally destroyed e incorrect checksums retransmitted later The checksum distinguish total loss near miss Bad bad SEC 4 2 MULTIPLE ACCESS PROTOCOLS User A B C D E Collision Time Collision In pure ALOHA frames transmitted completely arbitrary times An interesting question efficiency ALOHA channel In words fraction transmitted frames escape collisions chaotic circumstances Let us first consider infinite collection users typing terminals stations A user always one two states typing waiting Initially users typing state When line finished user stops typing waiting response The station transmits frame containing line shared channel central computer checks channel see successful If user sees reply goes back typing If user continues wait station retransmits frame successfully sent Let frame time denote amount time needed transmit standard fixed length frame e frame length divided bit rate At point assume new frames generated stations well modeled Poisson distribution mean N frames per frame time The infinitepopulation assumption needed ensure N decrease users become blocked If N 1 user community generating frames higher rate channel handle nearly every frame suffer collision For reasonable throughput would expect 0 N 1 In addition new frames stations also generate retransmissions frames previously suffered collisions Let us assume old new frames combined well modeled Poisson distribution mean G frames per frame time Clearly G N At low load e N 0 collisions hence retransmissions G N At high load many collisions G N Under loads throughput S offered load G times probability P 0 transmission succeeding S GP 0 P 0 probability frame suffer collision A frame suffer collision frames sent within one frame time start shown Under conditions 264 THE MEDIUM ACCESS CONTROL SUBLAYER shaded frame arrive undamaged Let time required send one frame If user generated frame time 0 0 end frame collide beginning shaded one In fact shaded frame fate already sealed even first bit sent since pure ALOHA station listen channel transmitting way knowing another frame already underway Similarly frame started 0 0 2t bump end shaded frame Collides start shaded frame t0 t0 Collides end shaded frame t0 2t t0 3t Time Vulnerable Vulnerable period shaded frame The probability k frames generated given frame time G frames expected given Poisson distribution Pr k G k e G k 4 2 probability zero frames e G In interval two frame times long mean number frames generated 2G The probability frames initiated entire vulnerable period thus given P 0 e 2G Using S GP 0 get S Ge 2G The relation offered traffic throughput shown The maximum throughput occurs G 0 5 S 1 2e 0 184 In words best hope channel utilization 18 This result encouraging everyone transmitting could hardly expected 100 success rate Slotted ALOHA Soon ALOHA came onto scene Roberts 1972 published method doubling capacity ALOHA system His proposal divide time discrete intervals called slots interval corresponding one frame This 265 MULTIPLE ACCESS PROTOCOLS S throughput per frame time 0 40 Slotted ALOHA S Ge G 0 30 0 20 Pure ALOHA S Ge 2G 0 10 0 5 1 0 1 5 2 0 3 0 G attempts per packet time Throughput versus offered traffic ALOHA systems approach requires users agree slot boundaries One way achieve synchronization would one special station emit pip start interval like clock In Roberts method come known slotted ALOHA contrast Abramson pure ALOHA station permitted send whenever user types line Instead required wait beginning next slot Thus continuous time ALOHA turned discrete time one This halves vulnerable period To see look imagine collisions possible The probability traffic slot test frame e G leads S Ge G 4 3 As see slotted ALOHA peaks G 1 throughput S 1 e 0 368 twice pure ALOHA If system operating G 1 probability empty slot 0 368 Eq 4 2 The best hope using slotted ALOHA 37 slots empty 37 successes 26 collisions Operating higher values G reduces number empties increases number collisions exponentially To see rapid growth collisions G comes consider transmission test frame The probability avoid collision e G probability stations silent slot The probability collision 1 e G The probability transmission requiring exactly k attempts e k 1 collisions followed one success Pk e G 1 e G k 1 The expected number transmissions E per line typed terminal k 1 k 1 E kPk ke G 1 e G k 1 e G 266 THE MEDIUM ACCESS CONTROL SUBLAYER As result exponential dependence E upon G small increases channel load drastically reduce performance Slotted ALOHA notable reason may initially obvious It devised 1970s used early experimental systems almost forgotten When Internet access cable invented sudden problem allocate shared channel among multiple competing users Slotted ALOHA pulled garbage save day Later multiple RFID tags talk RFID reader presented another variation problem Slotted ALOHA dash ideas mixed came rescue It often happened protocols perfectly valid fall disuse political reasons e g big company wants everyone things way due ever changing technology trends Then years later clever person realizes long discarded protocol solves current problem For reason chapter study number elegant protocols currently widespread use might easily used future applications provided enough network designers aware Of course also study many protocols current use well 4 2 2 Carrier Sense Multiple Access Protocols With slotted ALOHA best channel utilization achieved 1 e This low result hardly surprising since stations transmitting without knowing stations bound many collisions In LANs however often possible stations detect stations thus adapt behavior accordingly These networks achieve much better utilization 1 e In section discuss protocols improving performance Protocols stations listen carrier e transmission act accordingly called carrier sense protocols A number proposed long ago analyzed detail For example see Kleinrock Tobagi 1975 Below look several versions carrier sense protocols Persistent Nonpersistent CSMA The first carrier sense protocol study called 1 persistent CSMA Carrier Sense Multiple Access That bit mouthful simplest CSMA scheme When station data send first listens channel see anyone else transmitting moment If channel idle stations sends data Otherwise channel busy station waits becomes idle Then station transmits frame If collision occurs SEC 4 2 MULTIPLE ACCESS PROTOCOLS station waits random amount time starts The protocol called 1 persistent station transmits probability 1 finds channel idle You might expect scheme avoids collisions except rare case simultaneous sends fact If two stations become ready middle third station transmission wait politely transmission ends begin transmitting exactly simultaneously resulting collision If impatient would fewer collisions More subtly propagation delay important effect collisions There chance station begins sending another station become ready send sense channel If first station signal yet reached second one latter sense idle channel also begin sending resulting collision This chance depends number frames fit channel bandwidth delay product channel If tiny fraction frame fits channel case LANs since propagation delay small chance collision happening small The larger bandwidth delay product important effect becomes worse performance protocol Even protocol better performance pure ALOHA stations decency desist interfering third station frame Exactly holds slotted ALOHA A second carrier sense protocol nonpersistent CSMA In protocol conscious attempt made less greedy previous one As station senses channel wants send frame one else sending station begins However channel already use station continually sense purpose seizing immediately upon detecting end previous transmission Instead waits random period time repeats algorithm Consequently algorithm leads better channel utilization longer delays 1 persistent CSMA The last protocol p persistent CSMA It applies slotted channels works follows When station becomes ready send senses channel If idle transmits probability p With probability q 1 p defers next slot If slot also idle either transmits defers probabilities p q This process repeated either frame transmitted another station begun transmitting In latter case unlucky station acts collision e waits random time starts If station initially senses channel busy waits next slot applies algorithm IEEE 802 11 uses refinement p persistent CSMA discuss Sec 4 4 shows computed throughput versus offered traffic three protocols well pure slotted ALOHA 268 THE MEDIUM ACCESS CONTROL SUBLAYER 0 01 persistent CSMA 1 0 S throughput per packet time 0 9 Nonpersistent CSMA 0 8 0 1 persistent CSMA 0 7 0 5 persistent CSMA 0 6 0 5 Slotted ALOHA 0 4 0 3 1 persistent CSMA Pure ALOHA 0 2 0 15G attempts per packet time Comparison channel utilization versus load various random access protocols CSMA Collision Detection Persistent nonpersistent CSMA protocols definitely improvement ALOHA ensure station begins transmit channel busy However two stations sense channel idle begin transmitting simultaneously signals still collide Another improvement stations quickly detect collision abruptly stop transmitting rather finishing since irretrievably garbled anyway This strategy saves time bandwidth This protocol known CSMA CD CSMA Collision Detection basis classic Ethernet LAN worth devoting time looking detail It important realize collision detection analog process The station hardware must listen channel transmitting If signal reads back different signal putting knows collision occurring The implications received signal must tiny compared transmitted signal difficult wireless received signals may 1 000 000 times weaker transmitted signals modulation must chosen allow collisions detected e g collision two 0volt signals may well impossible detect CSMA CD well many LAN protocols uses conceptual model At point marked 0 station finished transmitting frame Any station frame send may attempt If two stations decide transmit simultaneously collision If station detects collision aborts transmission waits random period time tries assuming station started transmitting SEC 4 2 MULTIPLE ACCESS PROTOCOLS meantime Therefore model CSMA CD consist alternating contention transmission periods idle periods occurring stations quiet e g lack work Contention slots Frame Frame Frame Transmission Contention period period Frame Idle period Time CSMA CD contention transmission idle state Now let us look details contention algorithm Suppose two stations begin transmitting exactly time 0 How long take realize collided The answer vital determining length contention period hence delay throughput The minimum time detect collision time takes signal propagate one station Based information might think station heard collision time equal full cable propagation time starting transmission sure seized cable By seized mean stations know transmitting interfere This conclusion wrong Consider following worst case scenario Let time signal propagate two farthest stations At 0 one station begins transmitting At 0 instant signal arrives distant station station also begins transmitting Of course detects collision almost instantly stops little noise burst caused collision get back original station time 2 In words worst case station sure seized channel transmitted 2 without hearing collision With understanding think CSMA CD contention slotted ALOHA system slot width 2 On 1 km long coaxial cable 5 sec The difference CSMA CD compared slotted ALOHA slots one station transmits e channel seized followed rest frame This difference greatly improve performance frame time much longer propagation time 4 2 3 Collision Free Protocols Although collisions occur CSMA CD station unambiguously captured channel still occur contention period These collisions adversely affect system performance especially 270 THE MEDIUM ACCESS CONTROL SUBLAYER bandwidth delay product large cable long e large frames short Not collisions reduce bandwidth make time send frame variable good fit real time traffic voice IP CSMA CD also universally applicable In section examine protocols resolve contention channel without collisions even contention period Most protocols currently used major systems rapidly changing field protocols excellent properties available future systems often good thing In protocols described assume exactly N stations programmed unique address 0 N 1 It matter stations may inactive part time We also assume propagation delay negligible The basic question remains station gets channel successful transmission We continue using model discrete contention slots A Bit Map Protocol In first collision free protocol basic bit map method contention period consists exactly N slots If station 0 frame send transmits 1 bit slot 0 No station allowed transmit slot Regardless station 0 station 1 gets opportunity transmit 1 bit slot 1 frame queued In general station j may announce frame send inserting 1 bit slot j After N slots passed station complete knowledge stations wish transmit At point begin transmitting frames numerical order see Frames 8 Contention slots 0 1 2 3 4 5 6 7 8 Contention slots 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 The basic bit map protocol Since everyone agrees goes next never collisions After last ready station transmitted frame event stations easily monitor another N bit contention period begun If station becomes ready bit slot passed luck must remain silent every station chance bit map come around SEC 4 2 MULTIPLE ACCESS PROTOCOLS Protocols like desire transmit broadcast actual transmission called reservation protocols reserve channel ownership advance prevent collisions Let us briefly analyze performance protocol For convenience measure time units contention bit slot data frames consisting time units Under conditions low load bit map simply repeated lack data frames Consider situation point view low numbered station 0 1 Typically becomes ready send current slot somewhere middle bit map On average station wait N 2 slots current scan finish another full N slots following scan run completion may begin transmitting The prospects high numbered stations brighter Generally wait half scan N 2 bit slots starting transmit Highnumbered stations rarely wait next scan Since low numbered stations must wait average 1 5N slots high numbered stations must wait average 0 5N slots mean stations N slots The channel efficiency low load easy compute The overhead per frame N bits amount data bits efficiency N At high load stations something send time Nbit contention period prorated N frames yielding overhead 1 bit per frame efficiency 1 The mean delay frame equal sum time queues inside station plus additional N 1 N gets head internal queue This interval long takes wait stations turn sending frame another bitmap Token Passing The essence bit map protocol lets every station transmit frame turn predefined order Another way accomplish thing pass small message called token one station next predefined order The token represents permission send If station frame queued transmission receives token send frame passes token next station If queued frame simply passes token In token ring protocol topology network used define order stations send The stations connected one next single ring Passing token next station simply consists receiving token one direction transmitting direction seen Frames also transmitted direction token This way circulate around ring reach whichever station destination However stop frame circulating indefinitely like token station needs 272 THE MEDIUM ACCESS CONTROL SUBLAYER remove ring This station may either one originally sent frame gone complete cycle station intended recipient frame Station Token Direction transmission Token ring Note need physical ring implement token passing The channel connecting stations might instead single long bus Each station uses bus send token next station predefined sequence Possession token allows station use bus send one frame This protocol called token bus The performance token passing similar bit map protocol though contention slots frames one cycle intermingled After sending frame station must wait N stations including send token neighbors N 1 stations send frame one A subtle difference since positions cycle equivalent bias low high numbered stations For token ring station also sending token far neighboring station protocol takes next step Each token need propagate stations protocol advances next step Token rings cropped MAC protocols consistency An early token ring protocol called Token Ring standardized IEEE 802 5 popular 1980s alternative classic Ethernet In 1990s much faster token ring called FDDI Fiber Distributed Data Interface beaten switched Ethernet In 2000s token ring called RPR Resilient Packet Ring defined IEEE 802 17 standardize mix metropolitan area rings use ISPs We wonder 2010s offer Binary Countdown A problem basic bit map protocol extension token passing overhead 1 bit per station scale well networks thousands stations We better using binary station addresses channel combines transmissions A station wanting use SEC 4 2 MULTIPLE ACCESS PROTOCOLS channel broadcasts address binary bit string starting highorder bit All addresses assumed length The bits address position different stations BOOLEAN ORed together channel sent time We call protocol binary countdown It used Datakit Fraser 1987 It implicitly assumes transmission delays negligible stations see asserted bits essentially instantaneously To avoid conflicts arbitration rule must applied soon station sees high order bit position 0 address overwritten 1 gives For example stations 0010 0100 1001 1010 trying get channel first bit time stations transmit 0 0 1 1 respectively These ORed together form 1 Stations 0010 0100 see 1 know higher numbered station competing channel give current round Stations 1001 1010 continue The next bit 0 stations continue The next bit 1 station 1001 gives The winner station 1010 highest address After winning bidding may transmit frame another bidding cycle starts The protocol illustrated It property higher numbered stations higher priority lower numbered stations may either good bad depending context Bit time 0 1 2 3 0 0 1 0 0 0 1 0 0 0 1 0 0 1 1 0 0 1 0 1 0 1 0 1 0 Result 1 0 1 0 Stations 0010 0100 see 1 give Station 1001 sees 1 gives The binary countdown protocol A dash indicates silence The channel efficiency method log2 N If however frame format cleverly chosen sender address first field frame even log2 N bits wasted efficiency 100 Binary countdown example simple elegant efficient protocol waiting rediscovered Hopefully find new home day 274 THE MEDIUM ACCESS CONTROL SUBLAYER 4 2 4 Limited Contention Protocols We considered two basic strategies channel acquisition broadcast network contention CSMA collision free protocols Each strategy rated well respect two important performance measures delay low load channel efficiency high load Under conditions light load contention e pure slotted ALOHA preferable due low delay since collisions rare As load increases contention becomes increasingly less attractive overhead associated channel arbitration becomes greater Just reverse true collision free protocols At low load relatively high delay load increases channel efficiency improves since overheads fixed Obviously would nice could combine best properties contention collision free protocols arriving new protocol used contention low load provide low delay used collision free technique high load provide good channel efficiency Such protocols call limited contention protocols fact exist conclude study carrier sense networks Up contention protocols studied symmetric That station attempts acquire channel probability p stations using p Interestingly enough overall system performance sometimes improved using protocol assigns different probabilities different stations Before looking asymmetric protocols let us quickly review performance symmetric case Suppose k stations contending channel access Each probability p transmitting slot The probability station successfully acquires channel given slot probability one station transmits probability p k 1 stations defer probability 1 p This value kp 1 p k 1 To find optimal value p differentiate respect p set result zero solve p Doing find best value p 1 k Substituting p 1 k get k 1 Pr success optimal p k k 1 4 4 This probability plotted For small numbers stations chances success good soon number stations reaches even five probability dropped close asymptotic value 1 e From fairly obvious probability station acquiring channel increased decreasing amount competition The limited contention protocols precisely They first divide stations necessarily disjoint groups Only members group 0 permitted SEC 4 2 MULTIPLE ACCESS PROTOCOLS Probability success 1 0 0 8 0 6 0 4 0 2 0 0 15 Number ready stations Acquisition probability symmetric contention channel compete slot 0 If one succeeds acquires channel transmits frame If slot lies fallow collision members group 1 contend slot 1 etc By making appropriate division stations groups amount contention slot reduced thus operating slot near left end The trick assign stations slots Before looking general case let us consider special cases At one extreme group one member Such assignment guarantees never collisions one station contending given slot We seen protocols e g binary countdown The next special case assign two stations per group The probability try transmit slot p 2 small p negligible As stations assigned slot probability collision grows length bit map scan needed give everyone chance shrinks The limiting case single group containing stations e slotted ALOHA What need way assign stations slots dynamically many stations per slot load low even one station per slot load high The Adaptive Tree Walk Protocol One particularly simple way performing necessary assignment use algorithm devised U S Army testing soldiers syphilis World War II Dorfman 1943 In short Army took blood sample N soldiers A portion sample poured single test tube This mixed sample tested antibodies If none found soldiers group declared healthy If antibodies present two new mixed samples 276 THE MEDIUM ACCESS CONTROL SUBLAYER prepared one soldiers 1 N 2 one rest The process repeated recursively infected soldiers determined For computerized version algorithm Capetanakis 1979 convenient think stations leaves binary tree illustrated In first contention slot following successful frame transmission slot 0 stations permitted try acquire channel If one fine If collision slot 1 stations falling node 2 tree may compete If one acquires channel slot following frame reserved stations node 3 If hand two stations node 2 want transmit collision slot 1 case node 4 turn slot 2 Stations A B C D E F G H The tree eight stations In essence collision occurs slot 0 entire tree searched depth first locate ready stations Each bit slot associated particular node tree If collision occurs search continues recursively node left right children If bit slot idle one station transmits searching node stop ready stations located Were one would collision When load system heavy hardly worth effort dedicate slot 0 node 1 makes sense unlikely event precisely one station frame send Similarly one could argue nodes 2 3 skipped well reason Put general terms level tree search begin Clearly heavier load farther tree search begin We assume station good estimate number ready stations q example monitoring recent traffic To proceed let us number levels tree top node 1 level 0 nodes 2 3 level 1 etc Notice node level SEC 4 2 MULTIPLE ACCESS PROTOCOLS fraction 2 stations If q ready stations uniformly distributed expected number specific node level 2 q Intuitively would expect optimal level begin searching tree one mean number contending stations per slot 1 level 2 q 1 Solving equation find log2 q Numerous improvements basic algorithm discovered discussed detail Bertsekas Gallager 1992 For example consider case stations G H ones wanting transmit At node 1 collision occur 2 tried discovered idle It pointless probe node 3 since guaranteed collision know two stations 1 ready none 2 must 3 The probe 3 skipped 6 tried next When probe also turns nothing 7 skipped node G tried next 4 2 5 Wireless LAN Protocols A system laptop computers communicate radio regarded wireless LAN discussed Sec 1 5 3 Such LAN example broadcast channel It also somewhat different properties wired LAN leads different MAC protocols In section examine protocols In Sec 4 4 look 802 11 WiFi detail A common configuration wireless LAN office building access points APs strategically placed around building The APs wired together using copper fiber provide connectivity stations talk If transmission power APs laptops adjusted range tens meters nearby rooms become like single cell entire building becomes like cellular telephony systems studied Chap 2 except cell one channel This channel shared stations cell including AP It typically provides megabit sec bandwidths 600 Mbps We already remarked wireless systems normally detect collision occurring The received signal station may tiny perhaps million times fainter signal transmitted Finding like looking ripple ocean Instead acknowledgements used discover collisions errors fact There even important difference wireless LANs wired LANs A station wireless LAN may able transmit frames receive frames stations limited radio range stations In wired LANs one station sends frame stations receive The absence property wireless LANs causes variety complications We make simplifying assumption radio transmitter fixed range represented circular coverage region within another station sense receive station transmission It important realize 278 THE MEDIUM ACCESS CONTROL SUBLAYER practice coverage regions nearly regular propagation radio signals depends environment Walls obstacles attenuate reflect signals may cause range differ markedly different directions But simple circular model purposes A naive approach using wireless LAN might try CSMA listen transmissions transmit one else The trouble protocol really good way think wireless matters reception interference receiver sender To see nature problem consider four wireless stations illustrated For purposes matter APs laptops The radio range A B within range potentially interfere one another C also potentially interfere B D A A C B D Radio range A B C D Radio range b A wireless LAN A C hidden terminals transmitting B b B C exposed terminals transmitting A D First consider happens A C transmit B depicted If A sends C immediately senses medium hear A A range Thus C falsely conclude transmit B If C start transmitting interfere B wiping frame A We assume CDMA type scheme used provide multiple channels collisions garble signal destroy frames We want MAC protocol prevent kind collision happening wastes bandwidth The problem station able detect potential competitor medium competitor far away called hidden terminal problem Now let us look different situation B transmitting A time C wants transmit D shown b If C senses medium hear transmission falsely conclude may send D shown dashed line In fact transmission would cause bad reception zone B C neither intended receivers located We want MAC protocol prevents kind deferral happening wastes bandwidth The problem called exposed terminal problem The difficulty starting transmission station really wants know whether radio activity around receiver CSMA merely tells SEC 4 2 MULTIPLE ACCESS PROTOCOLS whether activity near transmitter sensing carrier With wire signals propagate stations distinction exist However one transmission take place anywhere system In system based short range radio waves multiple transmissions occur simultaneously different destinations destinations range one another We want concurrency happen cell gets larger larger way people party wait everyone room go silent talk multiple conversations take place large room long directed location An early influential protocol tackles problems wireless LANs MACA Multiple Access Collision Avoidance Karn 1990 The basic idea behind sender stimulate receiver outputting short frame stations nearby detect transmission avoid transmitting duration upcoming large data frame This technique used instead carrier sense MACA illustrated Let us see A sends frame B A starts sending RTS Request To Send frame B shown This short frame 30 bytes contains length data frame eventually follow Then B replies CTS Clear To Send frame shown b The CTS frame contains data length copied RTS frame Upon receipt CTS frame A begins transmission Range A transmitter C A RTS B D Range B transmitter C A CTS B E E b D The MACA protocol A sending RTS B b B responding CTS A Now let us see stations overhearing either frames react Any station hearing RTS clearly close A must remain silent long enough CTS transmitted back A without conflict Any station hearing CTS clearly close B must remain silent upcoming data transmission whose length tell examining CTS frame 280 THE MEDIUM ACCESS CONTROL SUBLAYER In C within range A within range B Therefore hears RTS A CTS B As long interfere CTS free transmit data frame sent In contrast D within range B A It hear RTS hear CTS Hearing CTS tips close station receive frame defers sending anything frame expected finished Station E hears control messages like D must silent data frame complete Despite precautions collisions still occur For example B C could send RTS frames A time These collide lost In event collision unsuccessful transmitter e one hear CTS within expected time interval waits random amount time tries later 4 3 ETHERNET We finished discussion channel allocation protocols abstract time see principles apply real systems Many designs personal local metropolitan area networks standardized name IEEE 802 A survived many saw Some people believe reincarnation think Charles Darwin came back member IEEE Standards Association weed unfit The important survivors 802 3 Ethernet 802 11 wireless LAN Bluetooth wireless PAN widely deployed standardized outside 802 15 With 802 16 wireless MAN early tell Please consult 6th edition book find We begin study real systems Ethernet probably ubiquitous kind computer network world Two kinds Ethernet exist classic Ethernet solves multiple access problem using techniques studied chapter switched Ethernet devices called switches used connect different computers It important note referred Ethernet quite different Classic Ethernet original form ran rates 3 10 Mbps Switched Ethernet Ethernet become runs 100 1000 10 000 Mbps forms called fast Ethernet gigabit Ethernet 10 gigabit Ethernet In practice switched Ethernet used nowadays We discuss historical forms Ethernet chronological order showing developed Since Ethernet IEEE 802 3 identical except minor difference discuss shortly many people use terms Ethernet IEEE 802 3 interchangeably We For information Ethernet see Spurgeon 2000 SEC 4 3 ETHERNET 4 3 1 Classic Ethernet Physical Layer The story Ethernet starts time ALOHA student named Bob Metcalfe got bachelor degree M I T moved river get Ph D Harvard During studies exposed Abramson work He became interested graduating Harvard decided spend summer Hawaii working Abramson starting work Xerox PARC Palo Alto Research Center When got PARC saw researchers designed built would later called personal computers But machines isolated Using knowledge Abramson work together colleague David Boggs designed implemented first local area network Metcalfe Boggs 1976 It used single long thick coaxial cable ran 3 Mbps They called system Ethernet luminiferous ether electromagnetic radiation thought propagate When 19th century British physicist James Clerk Maxwell discovered electromagnetic radiation could described wave equation scientists assumed space must filled ethereal medium radiation propagating Only famous Michelson Morley experiment 1887 physicists discover electromagnetic radiation could propagate vacuum The Xerox Ethernet successful DEC Intel Xerox drew standard 1978 10 Mbps Ethernet called DIX standard With minor change DIX standard became IEEE 802 3 standard 1983 Unfortunately Xerox already history making seminal inventions personal computer failing commercialize story told Fumbling Future Smith Alexander 1988 When Xerox showed little interest anything Ethernet helping standardize Metcalfe formed company 3Com sell Ethernet adapters PCs It sold many millions Classic Ethernet snaked around building single long cable computers attached This architecture shown The first variety popularly called thick Ethernet resembled yellow garden hose markings every 2 5 meters show attach computers The 802 3 standard actually require cable yellow suggest It succeeded thin Ethernet bent easily made connections using industry standard BNC connectors Thin Ethernet much cheaper easier install could run 185 meters per segment instead 500 thick Ethernet could handle 30 machines instead 100 Each version Ethernet maximum cable length per segment e unamplified length signal propagate To allow larger networks multiple cables connected repeaters A repeater physical layer device receives amplifies e regenerates retransmits signals directions As far software concerned series cable segments 282 THE MEDIUM ACCESS CONTROL SUBLAYER Transceiver Interface cable Ether Architecture classic Ethernet connected repeaters different single cable except small amount delay introduced repeaters Over cables information sent using Manchester encoding studied Sec 2 5 An Ethernet could contain multiple cable segments multiple repeaters two transceivers could 2 5 km apart path two transceivers could traverse four repeaters The reason restriction MAC protocol look next would work correctly 4 3 2 Classic Ethernet MAC Sublayer Protocol The format used send frames shown First comes Preamble 8 bytes containing bit pattern 10101010 exception last byte last 2 bits set 11 This last byte called Start Frame delimiter 802 3 The Manchester encoding pattern produces 10 MHz square wave 6 4 sec allow receiver clock synchronize sender The last two 1 bits tell receiver rest frame start Bytes 0 1500 0 46 Preamble Destination address Source address Type Data Pad Checksum b Preamble Destination address Source address Length Data Pad Checksum Frame formats Ethernet DIX b IEEE 802 3 Next come two addresses one destination one source They 6 bytes long The first transmitted bit destination address 0 SEC 4 3 ETHERNET ordinary addresses 1 group addresses Group addresses allow multiple stations listen single address When frame sent group address stations group receive Sending group stations called multicasting The special address consisting 1 bits reserved broadcasting A frame containing 1s destination field accepted stations network Multicasting selective involves group management define stations group Conversely broadcasting differentiate stations require group management An interesting feature station source addresses globally unique assigned centrally IEEE ensure two stations anywhere world address The idea station uniquely address station giving right 48 bit number To first 3 bytes address field used OUI Organizationally Unique Identifier Values field assigned IEEE indicate manufacturer Manufacturers assigned blocks 224 addresses The manufacturer assigns last 3 bytes address programs complete address NIC sold Next comes Type Length field depending whether frame Ethernet IEEE 802 3 Ethernet uses Type field tell receiver frame Multiple network layer protocols may use time machine Ethernet frame arrives operating system know one hand frame The Type field specifies process give frame For example type code 0x0800 means data contains IPv4 packet IEEE 802 3 wisdom decided field would carry length frame since Ethernet length determined looking inside data layering violation ever one Of course meant way receiver figure incoming frame That problem handled addition another header LLC Logical Link Control protocol within data It uses 8 bytes convey 2 bytes protocol type information Unfortunately time 802 3 published much hardware software DIX Ethernet already use manufacturers users enthusiastic repackaging Type Length fields In 1997 IEEE threw towel said ways fine Fortunately Type fields use 1997 values greater 1500 well established maximum data size Now rule number less equal 0x600 1536 interpreted Length number greater 0x600 interpreted Type Now IEEE maintain everyone using standard everybody else keep already bothering LLC without feeling guilty Next come data 1500 bytes This limit chosen somewhat arbitrarily time Ethernet standard cast stone mostly based fact 284 THE MEDIUM ACCESS CONTROL SUBLAYER transceiver needs enough RAM hold entire frame RAM expensive 1978 A larger upper limit would meant RAM hence expensive transceiver In addition maximum frame length also minimum frame length While data field 0 bytes sometimes useful causes problem When transceiver detects collision truncates current frame means stray bits pieces frames appear cable time To make easier distinguish valid frames garbage Ethernet requires valid frames must least 64 bytes long destination address checksum including If data portion frame less 46 bytes Pad field used fill frame minimum size Another important reason minimum length frame prevent station completing transmission short frame first bit even reached far end cable may collide another frame This problem illustrated At time 0 station A one end network sends frame Let us call propagation time frame reach end Just frame gets end e time distant station B starts transmitting When B detects receiving power putting knows collision occurred aborts transmission generates 48 bit noise burst warn stations In words jams ether make sure sender miss collision At time 2 sender sees noise burst aborts transmission It waits random time trying A Packet starts time 0 B A B b A B c Packet almost B Collision time A Noise burst gets back A 2 B Collision detection take long 2 If station tries transmit short frame conceivable collision occur transmission completed noise burst gets back station 2 The sender incorrectly conclude frame successfully sent To prevent situation occurring frames must take 2 send transmission still taking place SEC 4 3 ETHERNET noise burst gets back sender For 10 Mbps LAN maximum length 2500 meters four repeaters 802 3 specification round trip time including time propagate four repeaters determined nearly 50 sec worst case Therefore shortest allowed frame must take least long transmit At 10 Mbps bit takes 100 nsec 500 bits smallest frame guaranteed work To add margin safety number rounded 512 bits 64 bytes The final field Checksum It 32 bit CRC kind studied Sec 3 2 In fact defined exactly generator polynomial gave popped PPP ADSL links This CRC errordetecting code used determine bits frame received correctly It error detection frame dropped error detected CSMA CD Binary Exponential Backoff Classic Ethernet uses 1 persistent CSMA CD algorithm studied Sec 4 2 This descriptor means stations sense medium frame send send frame soon medium becomes idle They monitor channel collisions send If collision abort transmission short jam signal retransmit random interval Let us see random interval determined collision occurs new method The model still After collision time divided discrete slots whose length equal worst case roundtrip propagation time ether 2 To accommodate longest path allowed Ethernet slot time set 512 bit times 51 2 sec After first collision station waits either 0 1 slot times random trying If two stations collide one picks random number collide After second collision one picks either 0 1 2 3 random waits number slot times If third collision occurs probability happening 0 25 next time number slots wait chosen random interval 0 23 1 In general collisions random number 0 2i 1 chosen number slots skipped However 10 collisions reached randomization interval frozen maximum 1023 slots After 16 collisions controller throws towel reports failure back computer Further recovery higher layers This algorithm called binary exponential backoff chosen dynamically adapt number stations trying send If randomization interval collisions 1023 chance two stations colliding second time would negligible average wait collision would hundreds slot times introducing significant delay On hand station always 286 THE MEDIUM ACCESS CONTROL SUBLAYER delayed either 0 1 slots 100 stations ever tried send would collide 99 picked 1 remaining station picked 0 This might take years By randomization interval grow exponentially consecutive collisions occur algorithm ensures low delay stations collide also ensures collisions resolved reasonable interval many stations collide Truncating backoff 1023 keeps bound growing large If collision sender assumes frame probably successfully delivered That neither CSMA CD Ethernet provides acknowledgements This choice appropriate wired optical fiber channels low error rates Any errors occur must detected CRC recovered higher layers For wireless channels errors see acknowledgements used 4 3 3 Ethernet Performance Now let us briefly examine performance classic Ethernet conditions heavy constant load k stations always ready transmit A rigorous analysis binary exponential backoff algorithm complicated Instead follow Metcalfe Boggs 1976 assume constant retransmission probability slot If station transmits contention slot probability p probability A station acquires channel slot A kp 1 p k 1 4 5 A maximized p 1 k A 1 e k The probability contention interval exactly j slots A 1 A j 1 mean number slots per contention given jA 1 A j 1 A j 0 Since slot duration 2 mean contention interval w 2 A Assuming optimal p mean number contention slots never e w 2 e 5 4 If mean frame takes P sec transmit many stations frames send Channel efficiency P P 2 A 4 6 Here see maximum cable distance two stations enters performance figures The longer cable longer contention interval Ethernet standard specifies maximum cable length SEC 4 3 ETHERNET It instructive formulate Eq 4 6 terms frame length F network bandwidth B cable length L speed signal propagation c optimal case e contention slots per frame With P F B Eq 4 6 becomes Channel efficiency 1 2BLe cF 4 7 When second term denominator large network efficiency low More specifically increasing network bandwidth distance BL product reduces efficiency given frame size Unfortunately much research network hardware aimed precisely increasing product People want high bandwidth long distances fiber optic MANs example yet classic Ethernet implemented manner best system applications We see ways implementing Ethernet next section In channel efficiency plotted versus number ready stations 2 51 2 sec data rate 10 Mbps using Eq 4 7 With 64byte slot time surprising 64 byte frames efficient On hand 1024 byte frames asymptotic value e 64 byte slots per contention interval contention period 174 bytes long efficiency 85 This result much better 37 efficiency slotted ALOHA 1 0 0 9 1024 byte frames Channel efficiency 0 8 512 byte frames 0 7 256 byte frames 0 6 0 5 128 byte frames 0 4 0 3 64 byte frames 0 2 0 1832Number stations trying send Efficiency Ethernet 10 Mbps 512 bit slot times It probably worth mentioning large amount theoretical performance analysis Ethernet networks Most results taken grain better yet metric ton salt two reasons 288 THE MEDIUM ACCESS CONTROL SUBLAYER First virtually theoretical work assumes Poisson traffic As researchers begun looking real data appears network traffic rarely Poisson Instead self similar bursty range time scales Paxson Floyd 1995 Leland et al 1994 What means averaging long periods time smooth traffic As well using questionable models many analyses focus interesting performance cases abnormally high load Boggs et al 1988 showed experimentation Ethernet works well reality even moderately high load 4 3 4 Switched Ethernet Ethernet soon began evolve away single long cable architecture classic Ethernet The problems associated finding breaks loose connections drove toward different kind wiring pattern station dedicated cable running central hub A hub simply connects attached wires electrically soldered together This configuration shown Port Port Line Hub Line Switch b Hub b Switch The wires telephone company twisted pairs since office buildings already wired way normally plenty spares available This reuse win reduce maximum cable run hub 100 meters 200 meters high quality Category 5 twisted pairs used Adding removing station simpler configuration cable breaks detected easily With advantages able use existing wiring ease maintenance twisted pair hubs quickly became dominant form Ethernet However hubs increase capacity logically equivalent single long cable classic Ethernet As stations added station gets decreasing share fixed capacity Eventually LAN saturate One way go higher speed say 10 Mbps 100 Mbps 1 Gbps even higher speeds But growth multimedia powerful servers even 1 Gbps Ethernet become saturated SEC 4 3 ETHERNET Fortunately another way deal increased load switched Ethernet The heart system switch containing high speed backplane connects ports shown b From outside switch looks like hub They boxes typically 4 48 ports standard RJ 45 connector twisted pair cable Each cable connects switch hub single computer shown A switch advantages hub It easy add remove new station plugging unplugging wire easy find faults since flaky cable port usually affect one station There still shared component fail switch stations lose connectivity IT folks know fix problem replace whole switch Switch Hub Switch ports Twisted pair An Ethernet switch Inside switch however something different happening Switches output frames ports frames destined When switch port receives Ethernet frame station switch checks Ethernet addresses see port frame destined This step requires switch able work ports correspond addresses process describe Sec 4 8 get general case switches connected switches For assume switch knows frame destination port The switch forwards frame high speed backplane destination port The backplane typically runs many Gbps using proprietary protocol need standardized entirely hidden inside switch The destination port transmits frame wire reaches intended station None ports even knows frame exists What happens one stations ports wants send frame time Again switches differ hubs In hub stations collision domain They must use CSMA CD algorithm schedule transmissions In switch port independent collision domain In common case cable full duplex station port send frame cable time without worrying ports stations Collisions impossible CSMA CD needed However cable half duplex station port must contend transmission CSMA CD usual way 290 THE MEDIUM ACCESS CONTROL SUBLAYER A switch improves performance hub two ways First since collisions capacity used efficiently Second importantly switch multiple frames sent simultaneously different stations These frames reach switch ports travel switch backplane output proper ports However since two frames might sent output port time switch must buffering temporarily queue input frame transmitted output port Overall improvements give large performance win possible hub The total system throughput often increased order magnitude depending number ports traffic patterns The change ports frames output also security benefits Most LAN interfaces promiscuous mode frames given computer addressed With hub every computer attached see traffic sent computers Spies busybodies love feature With switch traffic forwarded ports destined This restriction provides better isolation traffic easily escape fall wrong hands However better encrypt traffic security really needed Because switch expects standard Ethernet frames input port possible use ports concentrators In port upper right corner connected single station 12 port hub instead As frames arrive hub contend ether usual way including collisions binary backoff Successful frames make hub switch treated like incoming frames The switch know fight way Once switch sent correct output line high speed backplane It also possible correct destination one lines attached hub case frame already delivered switch drops Hubs simpler cheaper switches due falling switch prices become endangered species Modern networks largely use switched Ethernet Nevertheless legacy hubs still exist 4 3 5 Fast Ethernet At time switches becoming popular speed 10 Mbps Ethernet coming pressure At first 10 Mbps seemed like heaven cable modems seemed like heaven users telephone modems But novelty wore quickly As kind corollary Parkinson Law Work expands fill time available completion seemed data expanded fill bandwidth available transmission Many installations needed bandwidth thus numerous 10 Mbps LANs connected maze repeaters hubs switches although network managers sometimes felt held together bubble SEC 4 3 ETHERNET gum chicken wire But even Ethernet switches maximum bandwidth single computer limited cable connected switch port It environment IEEE reconvened 802 3 committee 1992 instructions come faster LAN One proposal keep 802 3 exactly make go faster Another proposal redo totally give lots new features real time traffic digitized voice keep old name marketing reasons After wrangling committee decided keep 802 3 way make go faster This strategy would get job done technology changed avoid unforeseen problems brand new design The new design would also backwardcompatible existing Ethernet LANs The people behind losing proposal self respecting computer industry people would done circumstances stomped formed committee standardized LAN anyway eventually 802 12 It flopped miserably The work done quickly standards committees norms result 802 3u approved IEEE June 1995 Technically 802 3u new standard addendum existing 802 3 standard emphasize backward compatibility This strategy used lot Since practically everyone calls fast Ethernet rather 802 3u The basic idea behind fast Ethernet simple keep old frame formats interfaces procedural rules reduce bit time 100 nsec 10 nsec Technically would possible copy 10 Mbps classic Ethernet still detect collisions time reducing maximum cable length factor 10 However advantages twisted pair wiring overwhelming fast Ethernet based entirely design Thus fast Ethernet systems use hubs switches multidrop cables vampire taps BNC connectors permitted Nevertheless choices still made important wire types support One contender Category 3 twisted pair The argument practically every office Western world least four Category 3 better twisted pairs running telephone wiring closet within 100 meters Sometimes two cables existed Thus using Category 3 twisted pair would make possible wire desktop computers using fast Ethernet without rewire building enormous advantage many organizations The main disadvantage Category 3 twisted pair inability carry 100 Mbps 100 meters maximum computer hub distance specified 10 Mbps hubs In contrast Category 5 twisted pair wiring handle 100 easily fiber go much farther The compromise chosen allow three possibilities shown pep Category 3 solution give additional carrying capacity needed The Category 3 UTP scheme called 100Base T4 used signaling speed 25 MHz 25 faster standard Ethernet 20 MHz Remember 292 THE MEDIUM ACCESS CONTROL SUBLAYER Name Cable Max segment Advantages 100Base T4 Twisted pair 100 Uses category 3 UTP 100Base TX Twisted pair 100 Full duplex 100 Mbps Cat 5 UTP 100Base FX Fiber optics 2000 Full duplex 100 Mbps long runs The original fast Ethernet cabling Manchester encoding discussed Sec 2 5 requires two clock periods 10 million bits sent second However achieve necessary bit rate 100Base T4 requires four twisted pairs Of four pairs one always hub one always hub two switchable current transmission direction To get 100 Mbps three twisted pairs transmission direction fairly involved scheme used twisted pair It involves sending ternary digits three different voltage levels This scheme likely win prizes elegance skip details However since standard telephone wiring decades four twisted pairs per cable offices able use existing wiring plant Of course means giving office telephone surely small price pay faster email 100Base T4 fell wayside many office buildings rewired Category 5 UTP 100Base TX Ethernet came dominate market This design simpler wires handle clock rates 125 MHz Only two twisted pairs per station used one hub one Neither straight binary coding e NRZ Manchester coding used Instead 4B 5B encoding described Sec 2 5 used 4 data bits encoded 5 signal bits sent 125 MHz provide 100 Mbps This scheme simple sufficient transitions synchronization uses bandwidth wire relatively well The 100Base TX system full duplex stations transmit 100 Mbps one twisted pair receive 100 Mbps another twisted pair time The last option 100Base FX uses two strands multimode fiber one direction run full duplex 100 Mbps direction In setup distance station switch 2 km Fast Ethernet allows interconnection either hubs switches To ensure CSMA CD algorithm continues work relationship minimum frame size maximum cable length must maintained network speed goes 10 Mbps 100 Mbps So either minimum frame size 64 bytes must go maximum cable length 2500 must come proportionally The easy choice maximum distance two stations come factor 10 since hub 100 cables falls within new maximum already However 2 km 100Base FX cables SEC 4 3 ETHERNET long permit 100 Mbps hub normal Ethernet collision algorithm These cables must instead connected switch operate full duplex mode collisions Users quickly started deploy fast Ethernet throw away 10 Mbps Ethernet cards older computers As consequence virtually fast Ethernet switches handle mix 10 Mbps 100 Mbps stations To make upgrading easy standard provides mechanism called autonegotiation lets two stations automatically negotiate optimum speed 10 100 Mbps duplexity half full It works well time known lead duplex mismatch problems one end link autonegotiates end set full duplex mode Shalunov Carlson 2005 Most Ethernet products use feature configure 4 3 6 Gigabit Ethernet The ink barely dry fast Ethernet standard 802 committee began working yet faster Ethernet quickly dubbed gigabit Ethernet IEEE ratified popular form 802 3ab 1999 Below discuss key features gigabit Ethernet More information given Spurgeon 2000 The committee goals gigabit Ethernet essentially committee goals fast Ethernet increase performance tenfold maintaining compatibility existing Ethernet standards In particular gigabit Ethernet offer unacknowledged datagram service unicast broadcast use 48 bit addressing scheme already use maintain frame format including minimum maximum frame sizes The final standard met goals Like fast Ethernet configurations gigabit Ethernet use point point links In simplest configuration illustrated two computers directly connected The common case however uses switch hub connected multiple computers possibly additional switches hubs shown b In configurations individual Ethernet cable exactly two devices fewer Also like fast Ethernet gigabit Ethernet supports two different modes operation full duplex mode half duplex mode The normal mode fullduplex mode allows traffic directions time This mode used central switch connected computers switches periphery In configuration lines buffered computer switch free send frames whenever wants The sender sense channel see anybody else using contention impossible On line computer switch computer possible sender switch transmission succeed even switch currently sending frame computer line full duplex Since 294 THE MEDIUM ACCESS CONTROL SUBLAYER Switch hub Ethernet Computer Ethernet b A two station Ethernet b A multistation Ethernet contention possible CSMA CD protocol used maximum length cable determined signal strength issues rather long takes noise burst propagate back sender worst case Switch es free mix match speeds Autonegotiation supported fast Ethernet choice among 10 100 1000 Mbps The mode operation half duplex used computers connected hub rather switch A hub buffer incoming frames Instead electrically connects lines internally simulating multidrop cable used classic Ethernet In mode collisions possible standard CSMA CD protocol required Because 64 byte frame shortest allowed transmitted 100 times faster classic Ethernet maximum cable length must 100 times less 25 meters maintain essential property sender still transmitting noise burst gets back even worst case With 2500 meter long cable sender 64 byte frame 1 Gbps would long finished frame got even tenth way end let alone end back This length restriction painful enough two features added standard increase maximum cable length 200 meters probably enough offices The first feature called carrier extension essentially tells hardware add padding normal frame extend frame 512 bytes Since padding added sending hardware removed receiving hardware software unaware meaning changes needed existing software The downside using 512 bytes worth bandwidth transmit 46 bytes user data payload 64 byte frame line efficiency 9 The second feature called frame bursting allows sender transmit concatenated sequence multiple frames single transmission If total burst less 512 bytes hardware pads If enough frames waiting transmission scheme efficient preferred carrier extension SEC 4 3 ETHERNET In fairness hard imagine organization buying modern computers gigabit Ethernet cards connecting old fashioned hub simulate classic Ethernet collisions Gigabit Ethernet interfaces switches used expensive prices fell rapidly sales volumes picked Still backward compatibility sacred computer industry committee required put Today computers ship Ethernet interface capable 10 100 1000 Mbps operation compatible Gigabit Ethernet supports copper fiber cabling listed Signaling near 1 Gbps requires encoding sending bit every nanosecond This trick initially accomplished short shielded copper cables 1000Base CX version optical fibers For optical fibers two wavelengths permitted result two different versions 0 85 microns short 1000Base SX 1 3 microns long 1000Base LX Name Cable Max segment Advantages 1000Base SX Fiber optics 550 Multimode fiber 50 62 5 microns 1000Base LX Fiber optics 5000 Single 10 multimode 50 62 5 1000Base CX 2 Pairs STP 25 Shielded twisted pair 1000Base T 4 Pairs UTP 100 Standard category 5 UTP Gigabit Ethernet cabling Signaling short wavelength achieved cheaper LEDs It used multimode fiber useful connections within building run 500 50 micron fiber Signaling long wavelength requires expensive lasers On hand combined singlemode 10 micron fiber cable length 5 km This limit allows long distance connections buildings campus backbone dedicated point point link Later variations standard allowed even longer links single mode fiber To send bits versions gigabit Ethernet 8B 10B encoding described Sec 2 5 borrowed another networking technology called Fibre Channel That scheme encodes 8 bits data 10 bit codewords sent wire fiber hence name 8B 10B The codewords chosen could balanced e number 0s 1s sufficient transitions clock recovery Sending coded bits NRZ requires signaling bandwidth 25 required uncoded bits big improvement 100 expansion Manchester coding However options required new copper fiber cables support faster signaling None made use large amount Category 5 UTP installed along fast Ethernet Within year 1000Base T 296 THE MEDIUM ACCESS CONTROL SUBLAYER came along fill gap popular form gigabit Ethernet ever since People apparently dislike rewiring buildings More complicated signaling needed make Ethernet run 1000 Mbps Category 5 wires To start four twisted pairs cable used pair used directions time using digital signal processing separate signals Over wire five voltage levels carry 2 bits used signaling 125 Msymbols sec The mapping produce symbols bits straightforward It involves scrambling transitions followed error correcting code four values embedded five signal levels A speed 1 Gbps quite fast For example receiver busy task even 1 msec empty input buffer line 1953 frames may accumulated gap Also computer gigabit Ethernet shipping data line computer classic Ethernet buffer overruns likely As consequence two observations gigabit Ethernet supports flow control The mechanism consists one end sending special control frame end telling pause period time These PAUSE control frames normal Ethernet frames containing type 0x8808 Pauses given units minimum frame time For gigabit Ethernet time unit 512 nsec allowing pauses long 33 6 msec There one extension introduced along gigabit Ethernet Jumbo frames allow frames longer 1500 bytes usually 9 KB This extension proprietary It recognized standard used Ethernet longer compatible earlier versions vendors support anyway The rationale 1500 bytes short unit gigabit speeds By manipulating larger blocks information frame rate decreased along processing associated interrupting processor say frame arrived splitting recombining messages long fit one Ethernet frame 4 3 7 10 Gigabit Ethernet As soon gigabit Ethernet standardized 802 committee got bored wanted get back work IEEE told start 10 gigabit Ethernet This work followed much pattern previous Ethernet standards standards fiber shielded copper cable appearing first 2002 2004 followed standard copper twisted pair 2006 10 Gbps truly prodigious speed 1000x faster original Ethernet Where could needed The answer inside data centers exchanges connect high end routers switches servers well long distance high bandwidth trunks offices enabling entire metropolitan area networks based Ethernet fiber The long distance connections use optical fiber short connections may use copper fiber SEC 4 3 ETHERNET All versions 10 gigabit Ethernet support full duplex operation CSMA CD longer part design standards concentrate details physical layers run high speed Compatibility still matters though 10 gigabit Ethernet interfaces autonegotiate fall back highest speed supported ends line The main kinds 10 gigabit Ethernet listed Multimode fiber 0 85 short wavelength used medium distances singlemode fiber 1 3 long 1 5 extended used long distances 10GBase ER run distances 40 km making suitable wide area applications All versions send serial stream information produced scrambling data bits encoding 64B 66B code This encoding less overhead 8B 10B code Name Cable Max segment Advantages 10GBase SR Fiber optics Up 300 Multimode fiber 0 85 10GBase LR Fiber optics 10 km 10GBase ER Fiber optics 40 km Single mode fiber 1 5 10GBase CX4 4 Pairs twinax 15 Twinaxial copper 10GBase T 4 Pairs UTP 100 Category 6a UTP Single mode fiber 1 3 10 Gigabit Ethernet cabling The first copper version defined 10GBase CX4 uses cable four pairs twinaxial copper wiring Each pair uses 8B 10B coding runs 3 125 Gsymbols second reach 10 Gbps This version cheaper fiber early market remains seen whether beat long run 10 gigabit Ethernet garden variety twisted pair wiring 10GBase T version uses UTP cables While calls Category 6a wiring shorter runs use lower categories including Category 5 allow reuse installed cabling Not surprisingly physical layer quite involved reach 10 Gbps twisted pair We sketch high level details Each four twisted pairs used send 2500 Mbps directions This speed reached using signaling rate 800 Msymbols sec symbols use 16 voltage levels The symbols produced scrambling data protecting LDPC Low Density Parity Check code coding error correction 10 gigabit Ethernet still shaking market 802 3 committee already moved At end 2007 IEEE created group standardize Ethernet operating 40 Gbps 100 Gbps This upgrade let Ethernet compete high performance settings including long distance connections backbone networks short connections equipment backplanes The standard yet complete proprietary products already available 298 THE MEDIUM ACCESS CONTROL SUBLAYER 4 3 8 Retrospective Ethernet Ethernet around 30 years serious competitors sight likely around many years come Few CPU architectures operating systems programming languages king mountain three decades going strong Clearly Ethernet something right What Probably main reason longevity Ethernet simple flexible In practice simple translates reliable cheap easy maintain Once hub switch architecture adopted failures became extremely rare People hesitate replace something works perfectly time especially know awful lot things computer industry work poorly many called upgrades worse replaced Simple also translates cheap Twisted pair wiring relatively inexpensive hardware components They may start expensive transition example new gigabit Ethernet NICs switches merely additions well established network replacement prices fall quickly sales volume picks Ethernet easy maintain There software install drivers much way configuration tables manage get wrong Also adding new hosts simple plugging Another point Ethernet interworks easily TCP IP become dominant IP connectionless protocol fits perfectly Ethernet also connectionless IP fits much less well connection oriented alternatives ATM This mismatch definitely hurt ATM chances Lastly perhaps importantly Ethernet able evolve certain crucial ways Speeds gone several orders magnitude hubs switches introduced changes required changing software often allowed existing cabling reused time When network salesman shows large installation says I fantastic new network All throw hardware rewrite software problem Many alternative technologies probably even heard faster Ethernet introduced As well ATM list includes FDDI Fiber Distributed Data Interface Fibre Channel two ringbased optical LANs Both incompatible Ethernet Neither one made They complicated led complex chips high prices The lesson learned KISS Keep It Simple Stupid Eventually Ethernet caught terms speed often borrowing technology example 4B 5B coding FDDI 8B 10B coding Fibre Channel Then advantages left quietly died fell specialized roles It called Fibre Channel Fiber Channel document editor British SEC 4 3 ETHERNET It looks like Ethernet continue expand applications time 10 gigabit Ethernet freed distance constraints CSMA CD Much effort put carrier grade Ethernet let network providers offer Ethernet based services customers metropolitan wide area networks Fouli Maler 2009 This application carries Ethernet frames long distances fiber calls better management features help operators offer reliable high quality services Very high speed networks also finding uses backplanes connecting components large routers servers Both uses addition sending frames computers offices 4 4 WIRELESS LANS Wireless LANs increasingly popular homes offices cafes libraries airports zoos public places outfitted connect computers PDAs smart phones Internet Wireless LANs also used let two nearby computers communicate without using Internet The main wireless LAN standard 802 11 We gave background information Sec 1 5 3 Now time take closer look technology In following sections look protocol stack physical layer radio transmission techniques MAC sublayer protocol frame structure services provided For information 802 11 see Gast 2005 To get truth mouth horse consult published standard IEEE 802 11 2007 4 4 1 The 802 11 Architecture Protocol Stack 802 11 networks used two modes The popular mode connect clients laptops smart phones another network company intranet Internet This mode shown In infrastructure mode client associated AP Access Point turn connected network The client sends receives packets via AP Several access points may connected together typically wired network called distribution system form extended 802 11 network In case clients send frames clients via APs The mode shown b ad hoc network This mode collection computers associated directly send frames There access point Since Internet access killer application wireless ad hoc networks popular Now look protocols All 802 protocols including 802 11 Ethernet certain commonality structure A partial view 802 11 protocol stack given The stack clients 300 THE MEDIUM ACCESS CONTROL SUBLAYER Access point To network Client b 802 11 architecture Infrastructure mode b Ad hoc mode APs The physical layer corresponds fairly well OSI physical layer data link layer 802 protocols split two sublayers In 802 11 MAC Medium Access Control sublayer determines channel allocated gets transmit next Above LLC Logical Link Control sublayer whose job hide differences different 802 variants make indistinguishable far network layer concerned This could significant responsibility days LLC glue layer identifies protocol e g IP carried within 802 11 frame Upper layers Logical link layer Data link layer MAC sublayer Release date 802 11 legacy Frequency hopping infrared 802 11a OFDM 802 11b Spread spectrum 802 11g OFDM 802 11n MIMO OFDM 1997 1999 Physical layer Part 802 11 protocol stack Several transmission techniques added physical layer 802 11 evolved since first appeared 1997 Two initial techniques infrared manner television remote controls frequency hopping 2 4 GHz band defunct The third initial technique direct sequence spread spectrum 1 2 Mbps 2 4 GHz band extended run rates 11 Mbps quickly became hit It known 802 11b SEC 4 4 WIRELESS LANS To give wireless junkies much wanted speed boost new transmission techniques based OFDM Orthogonal Frequency Division Multiplexing scheme described Sec 2 5 3 introduced 1999 2003 The first called 802 11a uses different frequency band 5 GHz The second stuck 2 4 GHz compatibility It called 802 11g Both give rates 54 Mbps Most recently transmission techniques simultaneously use multiple antennas transmitter receiver speed boost finalized 802 11n Oct 2009 With four antennas wider channels 802 11 standard defines rates startling 600 Mbps We examine transmission techniques briefly We cover use however skipping legacy 802 11 transmission methods Technically belong physical layer examined Chap 2 since closely tied LANs general 802 11 LAN particular treat instead 4 4 2 The 802 11 Physical Layer Each transmission techniques makes possible send MAC frame air one station another They differ however technology used speeds achievable A detailed discussion technologies far beyond scope book words one relate techniques material covered Sec 2 5 provide interested readers key terms search elsewhere information All 802 11 techniques use short range radios transmit signals either 2 4 GHz 5 GHz ISM frequency bands described Sec 2 3 3 These bands advantage unlicensed hence freely available transmitter willing meet restrictions radiated power 1 W though 50 mW typical wireless LAN radios Unfortunately fact also known manufacturers garage door openers cordless phones microwave ovens countless devices compete laptops spectrum The 2 4 GHz band tends crowded 5 GHz band 5 GHz better applications even though shorter range due higher frequency All transmission methods also define multiple rates The idea different rates used depending current conditions If wireless signal weak low rate used If signal clear highest rate used This adjustment called rate adaptation Since rates vary factor 10 good rate adaptation important good performance Of course since needed interoperability standards say rate adaptation done The first transmission method shall look 802 11b It spread spectrum method supports rates 1 2 5 5 11 Mbps though practice operating rate nearly always 11 Mbps It similar CDMA system 302 THE MEDIUM ACCESS CONTROL SUBLAYER examined Sec 2 5 except one spreading code shared users Spreading used satisfy FCC requirement power spread ISM band The spreading sequence used 201 11b Barker sequence It property autocorrelation low except sequences aligned This property allows receiver lock onto start transmission To send rate 1 Mbps Barker sequence used BPSK modulation send 1 bit per 11 chips The chips transmitted rate 11 Mchips sec To send 2 Mbps used QPSK modulation send 2 bits per 11 chips The higher rates different These rates use technique called CCK Complementary Code Keying construct codes instead Barker sequence The 5 5 Mbps rate sends 4 bits every 8 chip code 11 Mbps rate sends 8 bits every 8 chip code Next come 802 11a supports rates 54 Mbps 5 GHz ISM band You might expected 802 11a come 802 11b case Although 802 11a group set first 802 11b standard approved first product got market well ahead 802 11a products partly difficulty operating higher 5 GHz band The 802 11a method based OFDM Orthogonal Frequency Division Multiplexing OFDM uses spectrum efficiently resists wireless signal degradations multipath Bits sent 52 subcarriers parallel 48 carrying data 4 used synchronization Each symbol lasts 4 sends 1 2 4 6 bits The bits coded error correction binary convolutional code first 1 2 2 3 3 4 bits redundant With different combinations 802 11a run eight different rates ranging 6 54 Mbps These rates significantly faster 802 11b rates less interference 5 GHz band However 802 11b range seven times greater 802 11a important many situations Even greater range 802 11b people intention letting upstart win speed championship Fortunately May 2002 FCC dropped long standing rule requiring wireless communications equipment operating ISM bands U S use spread spectrum got work 802 11g approved IEEE 2003 It copies OFDM modulation methods 802 11a operates narrow 2 4 GHz ISM band along 802 11b It offers rates 802 11a 6 54 Mbps plus course compatibility 802 11b devices happen nearby All different choices confusing customers common products support 802 11a b g single NIC Not content stop IEEE committee began work high throughput physical layer called 802 11n It ratified 2009 The goal 802 11n throughput least 100 Mbps wireless overheads removed This goal called raw speed increase least factor four To make happen committee doubled channels 20 MHz 40 MHz SEC 4 4 WIRELESS LANS reduced framing overheads allowing group frames sent together More significantly however 802 11n uses four antennas transmit four streams information time The signals streams interfere receiver separated using MIMO Multiple Input Multiple Output communications techniques The use multiple antennas gives large speed boost better range reliability instead MIMO like OFDM one clever communications ideas changing wireless designs likely hear lot future For brief introduction multiple antennas 802 11 see Halperin et al 2010 4 4 3 The 802 11 MAC Sublayer Protocol Let us return land electrical engineering land computer science The 802 11 MAC sublayer protocol quite different Ethernet due two factors fundamental wireless communication First radios nearly always half duplex meaning transmit listen noise bursts time single frequency The received signal easily million times weaker transmitted signal heard time With Ethernet station waits ether goes silent starts transmitting If receive noise burst back transmitting first 64 bytes frame almost assuredly delivered correctly With wireless collision detection mechanism work Instead 802 11 tries avoid collisions protocol called CSMA CA CSMA Collision Avoidance This protocol conceptually similar Ethernet CSMA CD channel sensing sending exponential back collisions However station frame send starts random backoff except case used channel recently channel idle It wait collision The number slots backoff chosen range 0 say 15 case OFDM physical layer The station waits channel idle sensing signal short period time called DIFS explain counts idle slots pausing frames sent It sends frame counter reaches 0 If frame gets destination immediately sends short acknowledgement Lack acknowledgement inferred indicate error whether collision otherwise In case sender doubles backoff period tries continuing exponential backoff Ethernet frame successfully transmitted maximum number retransmissions reached An example timeline shown Station A first send frame While A sending stations B C become ready send They see channel busy wait become idle Shortly A receives acknowledgement channel goes idle However rather sending frame right away colliding B C perform backoff C picks short backoff 304 THE MEDIUM ACCESS CONTROL SUBLAYER thus sends first B pauses countdown senses C using channel resumes C received acknowledgement B soon completes backoff sends frame Station A A sends D Data D acks A Ack B ready send B sends D Data B Wait idle Backoff C ready send C Wait idle C sends D Data D acks B Ack Rest backoff D acks C Ack Wait idle Backoff Time Sending frame CSMA CA Compared Ethernet two main differences First starting backoffs early helps avoid collisions This avoidance worthwhile collisions expensive entire frame transmitted even one occurs Second acknowledgements used infer collisions collisions detected This mode operation called DCF Distributed Coordination Function station acts independently without kind central control The standard also includes optional mode operation called PCF Point Coordination Function access point controls activity cell like cellular base station However PCF used practice normally way prevent stations another nearby network transmitting competing traffic The second problem transmission ranges different stations may different With wire system engineered stations hear With complexities RF propagation situation hold wireless stations Consequently situations hidden terminal problem mentioned earlier illustrated arise Since stations within radio range transmissions going one part cell may received elsewhere cell In example station C transmitting station B If A senses channel hear anything falsely conclude may start transmitting B This decision leads collision The inverse situation exposed terminal problem illustrated Fig 426 b Here B wants send C listens channel When hears SEC 4 4 WIRELESS LANS B wants send C mistakenly thinks transmission fail A wants send B hear B busy Range C radio A B Range A radio C A C transmitting A transmitting B C b The hidden terminal problem b The exposed terminal problem transmission falsely concludes may send C even though A may fact transmitting D shown This decision wastes transmission opportunity To reduce ambiguities station sending 802 11 defines channel sensing consist physical sensing virtual sensing Physical sensing simply checks medium see valid signal With virtual sensing station keeps logical record channel use tracking NAV Network Allocation Vector Each frame carries NAV field says long sequence frame part take complete Stations overhear frame know channel busy period indicated NAV regardless whether sense physical signal For example NAV data frame includes time needed send acknowledgement All stations hear data frame defer acknowledgement period whether hear acknowledgement An optional RTS CTS mechanism uses NAV prevent terminals sending frames time hidden terminals It shown In example A wants send B C station within range A possibly within range B matter D station within range B within range A The protocol starts A decides wants send data B A begins sending RTS frame B request permission send frame If B receives request answers CTS frame indicate channel clear send Upon receipt CTS A sends frame starts ACK timer Upon correct receipt data frame B responds ACK frame completing exchange If A ACK timer expires ACK gets back treated collision whole protocol run backoff 306 A B C THE MEDIUM ACCESS CONTROL SUBLAYER RTS Data CTS ACK NAV NAV D Time Virtual channel sensing using CSMA CA Now let us consider exchange viewpoints C D C within range A may receive RTS frame If realizes someone going send data soon From information provided RTS request estimate long sequence take including final ACK So good desists transmitting anything exchange completed It updating record NAV indicate channel busy shown D hear RTS hear CTS also updates NAV Note NAV signals transmitted internal reminders keep quiet certain period time However RTS CTS sounds good theory one designs proved little value practice Several reasons seldom used known It help short frames sent place RTS AP everyone hear definition For situations slows operation RTS CTS 802 11 little different MACA protocol saw Sec 4 2 everyone hearing RTS CTS remains quiet duration allow ACK get without collision Because help exposed terminals MACA hidden terminals Most often hidden terminals CSMA CA already helps slowing stations transmit unsuccessfully whatever cause make likely transmissions succeed CSMA CA physical virtual sensing core 802 11 protocol However several mechanisms developed go Each mechanisms driven needs real operation look briefly The first need look reliability In contrast wired networks wireless networks noisy unreliable small part due interference kinds devices microwave ovens also use unlicensed ISM bands The use acknowledgements retransmissions little help probability getting frame small first place SEC 4 4 WIRELESS LANS The main strategy used increase successful transmissions lower transmission rate Slower rates use robust modulations likely received correctly given signal noise ratio If many frames lost station lower rate If frames delivered little loss station occasionally test higher rate see used Another strategy improve chance frame getting undamaged send shorter frames If probability bit error p probability n bit frame received entirely correctly 1 p n For example p 10 4 probability receiving full Ethernet frame 12 144 bits correctly less 30 Most frames lost But frames third long 4048 bits two thirds received correctly Now frames get fewer retransmissions needed Shorter frames implemented reducing maximum size message accepted network layer Alternatively 802 11 allows frames split smaller pieces called fragments checksum The fragment size fixed standard parameter adjusted AP The fragments individually numbered acknowledged using stop wait protocol e sender may transmit fragment k 1 received acknowledgement fragment k Once channel acquired multiple fragments sent burst They go one acknowledgement possibly retransmissions either whole frame successfully sent transmission time reaches maximum allowed The NAV mechanism keeps stations quiet next acknowledgement another mechanism see used allow burst fragments sent without stations sending frame middle The second need discuss saving power Battery life always issue mobile wireless devices The 802 11 standard pays attention issue power management clients need waste power neither information send receive The basic mechanism saving power builds beacon frames Beacons periodic broadcasts AP e g every 100 msec The frames advertise presence AP clients carry system parameters identifier AP time long next beacon security settings Clients set power management bit frames send AP tell entering power save mode In mode client doze AP buffer traffic intended To check incoming traffic client wakes every beacon checks traffic map sent part beacon This map tells client buffered traffic If client sends poll message AP sends buffered traffic The client go back sleep next beacon sent Another power saving mechanism called APSD Automatic Power Save Delivery also added 802 11 2005 With new mechanism AP buffers frames sends client client sends frames 308 THE MEDIUM ACCESS CONTROL SUBLAYER AP The client go sleep traffic send receive This mechanism works well applications VoIP frequent traffic directions For example VoIP wireless phone might use send receive frames every 20 msec much frequently beacon interval 100 msec dozing The third last need examine quality service When VoIP traffic preceding example competes peer peer traffic VoIP traffic suffer It delayed due contention high bandwidth peer peer traffic even though VoIP bandwidth low These delays likely degrade voice calls To prevent degradation would like let VoIP traffic go ahead peer peer traffic higher priority IEEE 802 11 clever mechanism provide kind quality service introduced set extensions name 802 11e 2005 It works extending CSMA CA carefully defined intervals frames After frame sent certain amount idle time required station may send frame check channel longer use The trick define different time intervals different kinds frames Five intervals depicted The interval regular data frames called DIFS DCF InterFrame Spacing Any station may attempt acquire channel send new frame medium idle DIFS The usual contention rules apply binary exponential backoff may needed collision occurs The shortest interval SIFS Short InterFrame Spacing It used allow parties single dialog chance go first Examples include letting receiver send ACK control frame sequences like RTS CTS letting sender transmit burst fragments Sending next fragment waiting SIFS prevents another station jumping frame middle exchange Control frame next fragment may sent SIFS High priority frame AIFS1 Regular DCF frame DIFS Low priority frame AIFS4 Bad frame recovery done EIFS ACK Time Interframe spacing 802 11 The two AIFS Arbitration InterFrame Space intervals show examples two different priority levels The short interval AIFS1 smaller DIFS longer SIFS It used AP move voice high priority SEC 4 4 WIRELESS LANS traffic head line The AP wait shorter interval sends voice traffic thus send regular traffic The long interval AIFS4 larger DIFS It used background traffic deferred regular traffic The AP wait longer interval sends traffic giving regular traffic opportunity transmit first The complete quality service mechanism defines four different priority levels different backoff parameters well different idle parameters The last time interval EIFS Extended InterFrame Spacing used station received bad unknown frame report problem The idea since receiver may idea going wait avoid interfering ongoing dialog two stations A part quality service extensions notion TXOP transmission opportunity The original CSMA CA mechanism let stations send one frame time This design fine range rates increased With 802 11a g one station might sending 6 Mbps another station sending 54 Mbps They get send one frame 6 Mbps station takes nine times long ignoring fixed overheads 54 Mbps station send frame This disparity unfortunate side effect slowing fast sender competing slow sender roughly rate slow sender For example ignoring fixed overheads sending alone 6 Mbps 54 Mbps senders get rates sending together get 5 4 Mbps average It stiff penalty fast sender This issue known rate anomaly Heusse et al 2003 With transmission opportunities station gets equal amount airtime equal number frames Stations send higher rate airtime get higher throughput In example sending together 6 Mbps 54 Mbps senders get 3 Mbps 27 Mbps respectively 4 4 4 The 802 11 Frame Structure The 802 11 standard defines three different classes frames air data control management Each header variety fields used within MAC sublayer In addition headers used physical layer mostly deal modulation techniques used discuss We look format data frame example It shown First comes Frame control field made 11 subfields The first Protocol version set 00 It allow future versions 802 11 operate time cell Then come Type data control management Subtype fields e g RTS CTS For regular data frame without quality service set 10 0000 binary The To DS From DS bits set indicate whether frame going coming network connected APs called distribution 310 THE MEDIUM ACCESS CONTROL SUBLAYER system The More fragments bit means fragments follow The Retry bit marks retransmission frame sent earlier The Power management bit indicates sender going power save mode The More data bit indicates sender additional frames receiver The Protected Frame bit indicates frame body encrypted security We discuss security briefly next section Finally Order bit tells receiver higher layer expects sequence frames arrive strictly order Bytes Frame Address 1 Address 2 Address 3 Sequence Duration control recipient transmitter Version Type 00 10 Bits Subtype 0000 0 2312 Data Check sequence To From More Pwr More Retry Protected Order DS DS frag mgt data Format 802 11 data frame The second field data frame Duration field tells long frame acknowledgement occupy channel measured microseconds It present types frames including control frames stations use manage NAV mechanism Next come addresses Data frames sent AP three addresses standard IEEE 802 format The first address receiver second address transmitter They obviously needed third address Remember AP simply relay point frames travel client another point network perhaps distant client portal Internet The third address gives distant endpoint The Sequence field numbers frames duplicates detected Of 16 bits available 4 identify fragment 12 carry number advanced new transmission The Data field contains payload 2312 bytes The first bytes payload format known LLC Logical Link Control This layer glue identifies higher layer protocol e g IP payloads passed Last comes Frame check sequence 32 bit CRC saw Sec 3 2 2 elsewhere Management frames format data frames plus format data portion varies subtype e g parameters beacon frames Control frames short Like frames Frame control Duration Frame check sequence fields However may one address data portion Most key information conveyed Subtype field e g ACK RTS CTS SEC 4 4 WIRELESS LANS 4 4 5 Services The 802 11 standard defines services clients access points network connecting must conformant wireless LAN These services cluster several groups The association service used mobile stations connect APs Typically used station moves within radio range AP Upon arrival station learns identity capabilities AP either beacon frames directly asking AP The capabilities include data rates supported security arrangements power saving capabilities quality service support The station sends request associate AP The AP may accept reject request Reassociation lets station change preferred AP This facility useful mobile stations moving one AP another AP extended 802 11 LAN like handover cellular network If used correctly data lost consequence handover But 802 11 like Ethernet best effort service Either station AP may also disassociate breaking relationship A station use service shutting leaving network The AP may use going maintenance Stations must also authenticate send frames via AP authentication handled different ways depending choice security scheme If 802 11 network open anyone allowed use Otherwise credentials needed authenticate The recommended scheme called WPA2 WiFi Protected Access 2 implements security defined 802 11i standard Plain WPA interim scheme implements subset 802 11i We skip go straight complete scheme With WPA2 AP talk authentication server username password database determine station allowed access network Alternatively pre shared key fancy name network password may configured Several frames exchanged station AP challenge response lets station prove right credentials This exchange happens association The scheme used WPA called WEP Wired Equivalent Privacy For scheme authentication preshared key happens association However use discouraged design flaws make WEP easy compromise The first practical demonstration WEP broken came Adam Stubblefield summer intern AT T Stubblefield et al 2002 He able code test attack one week much spent getting permission management buy WiFi cards needed experiments Software crack WEP passwords freely available Once frames reach AP distribution service determines route If destination local AP frames sent directly air Otherwise forwarded wired network The 312 THE MEDIUM ACCESS CONTROL SUBLAYER integration service handles translation needed frame sent outside 802 11 LAN arrive outside 802 11 LAN The common case connecting wireless LAN Internet Data transmission 802 11 naturally provides data delivery service This service lets stations transmit receive data using protocols described earlier chapter Since 802 11 modeled Ethernet transmission Ethernet guaranteed 100 reliable transmission 802 11 guaranteed reliable either Higher layers must deal detecting correcting errors Wireless broadcast signal For information sent wireless LAN kept confidential must encrypted This goal accomplished privacy service manages details encryption decryption The encryption algorithm WPA2 based AES Advanced Encryption Standard U S government standard approved 2002 The keys used encryption determined authentication procedure To handle traffic different priorities QOS traffic scheduling service It uses protocols described give voice video traffic preferential treatment compared best effort background traffic A companion service also provides higher layer timer synchronization This lets stations coordinate actions may useful media processing Finally two services help stations manage use spectrum The transmit power control service gives stations information need meet regulatory limits transmit power vary region region The dynamic frequency selection service give stations information need avoid transmitting frequencies 5 GHz band used radar proximity With services 802 11 provides rich set functionality connecting nearby mobile clients Internet It huge success standard repeatedly amended add functionality For perspective standard heading see Hiertz et al 2010 4 5 BROADBAND WIRELESS We indoors long Let us go outdoors quite bit interesting networking called last mile With deregulation telephone systems many countries competitors entrenched telephone companies often allowed offer local voice high speed Internet service There certainly plenty demand The problem running fiber coax millions homes businesses prohibitively expensive What competitor The answer broadband wireless Erecting big antenna hill outside town much easier cheaper digging many trenches stringing SEC 4 5 BROADBAND WIRELESS cables Thus companies begun experiment providing multimegabit wireless communication services voice Internet movies demand etc To stimulate market IEEE formed group standardize broadband wireless metropolitan area network The next number available 802 numbering space 802 16 standard got number Informally technology called WiMAX Worldwide Interoperability Microwave Access We use terms 802 16 WiMAX interchangeably The first 802 16 standard approved December 2001 Early versions provided wireless local loop fixed points line sight This design soon changed make WiMAX competitive alternative cable DSL Internet access By January 2003 802 16 revised support non line sight links using OFDM technology frequencies 2 GHz 10 GHz This change made deployment much easier though stations still fixed locations The rise 3G cellular networks posed threat promising high data rates mobility In response 802 16 enhanced allow mobility vehicular speeds December 2005 Mobile broadband Internet access target current standard IEEE 802 16 2009 Like 802 standards 802 16 heavily influenced OSI model including sub layers terminology service primitives Unfortunately also like OSI fairly complicated In fact WiMAX Forum created define interoperable subsets standard commercial offerings In following sections give brief description highlights common forms 802 16 air interface treatment far complete leaves many details For additional information WiMAX broadband wireless general see Andrews et al 2007 4 5 1 Comparison 802 16 802 11 3G At point may thinking devise new standard Why use 802 11 3G In fact WiMAX combines aspects 802 11 3G making like 4G technology Like 802 11 WiMAX wirelessly connecting devices Internet megabit sec speeds instead using cable DSL The devices may mobile least portable WiMAX start adding low rate data side voice like cellular networks 802 16 designed carry IP packets air connect IP based wired network minimum fuss The packets may carry peer peer traffic VoIP calls streaming media support range applications Also like 802 11 based OFDM technology ensure good performance spite wireless signal degradations multipath fading MIMO technology achieve high levels throughput However WiMAX like 3G thus unlike 802 11 several key respects The key technical problem achieve high capacity efficient use spectrum large number subscribers coverage area get 314 THE MEDIUM ACCESS CONTROL SUBLAYER high throughput The typical distances least 10 times larger 802 11 network Consequently WiMAX base stations powerful 802 11 Access Points APs To handle weaker signals larger distances base station uses power better antennas performs processing handle errors To maximize throughput transmissions carefully scheduled base station particular subscriber spectrum use left chance CSMA CA may waste capacity collisions Licensed spectrum expected case WiMAX typically around 2 5 GHz U S The whole system substantially optimized 802 11 This complexity worth considering large amount money involved licensed spectrum Unlike 802 11 result managed reliable service good support quality service With features 802 16 closely resembles 4G cellular networks standardized name LTE Long Term Evolution While 3G cellular networks based CDMA support voice data 4G cellular networks based OFDM MIMO target data voice one application It looks like WiMAX 4G collision course terms technology applications Perhaps convergence unsurprising given Internet killer application OFDM MIMO best known technologies efficiently using spectrum 4 5 2 The 802 16 Architecture Protocol Stack The 802 16 architecture shown Base stations connect directly provider backbone network turn connected Internet The base stations communicate stations wireless air interface Two kinds stations exist Subscriber stations remain fixed location example broadband Internet access homes Mobile stations receive service moving example car equipped WiMAX The 802 16 protocol stack used across air interface shown The general structure similar 802 networks sublayers The bottom layer deals transmission shown popular offerings 802 16 fixed mobile WiMAX There different physical layer offering Both layers operate licensed spectrum 11 GHz use OFDM different ways Above physical layer data link layer consists three sublayers The bottom one deals privacy security far crucial public outdoor networks private indoor networks It manages encryption decryption key management Next comes MAC common sublayer part This part main protocols channel management located The model base station completely controls system It schedule downlink e base subscriber channels efficiently plays major role managing SEC 4 5 BROADBAND WIRELESS Air interface Mobile stations Backbone network Internet Base station Subscriber stations The 802 16 architecture Upper layers IP example Service specific convergence sublayer Data link layer MAC common sublayer Security sublayer Release date Fixed WiMAX OFDM 802 16a Mobile WiMAX Scalable OFDMA 802 16e Physical layer The 802 16 protocol stack uplink e subscriber base channels well An unusual feature MAC sublayer unlike 802 protocols completely connection oriented order provide quality service guarantees telephony multimedia communication The service specific convergence sublayer takes place logical link sublayer 802 protocols Its function provide interface network layer Different convergence layers defined integrate seamlessly different upper layers The important choice IP though standard defines mappings protocols Ethernet ATM Since IP connectionless 802 16 MAC sublayer connection oriented layer must map addresses connections 316 THE MEDIUM ACCESS CONTROL SUBLAYER 4 5 3 The 802 16 Physical Layer Most WiMAX deployments use licensed spectrum around either 3 5 GHz 2 5 GHz As 3G finding available spectrum key problem To help 802 16 standard designed flexibility It allows operation 2 GHz 11 GHz Channels different sizes supported example 3 5 MHz fixed WiMAX 1 25 MHz 20 MHz mobile WiMAX Transmissions sent channels OFDM technique described Sec 2 5 3 Compared 802 11 802 16 OFDM design optimized make licensed spectrum wide area transmissions The channel divided subcarriers longer symbol duration tolerate larger wireless signal degradations WiMAX parameters around 20 times larger comparable 802 11 parameters For example mobile WiMAX 512 subcarriers 5 MHz channel time send symbol subcarrier roughly 100 sec Symbols subcarrier sent QPSK QAM 16 QAM 64 modulation schemes described Sec 2 5 3 When mobile subscriber station near base station received signal high signal noise ratio SNR QAM 64 used send 6 bits per symbol To reach distant stations low SNR QPSK used deliver 2 bits per symbol The data first coded error correction convolutional coding better schemes described Sec 3 2 1 This coding common noisy channels tolerate bit errors without needing send retransmissions In fact modulation coding methods sound familiar used many networks studied including 802 11 cable DSL The net result base station support 12 6 Mbps downlink traffic 6 2 Mbps uplink traffic per 5 MHz channel pair antennas One thing designers 802 16 like certain aspect way GSM DAMPS work Both systems use equal frequency bands upstream downstream traffic That implicitly assume much upstream traffic downstream traffic For voice traffic symmetric part Internet access certainly Web surfing often downstream traffic upstream traffic The ratio often 2 1 3 1 1 So designers chose flexible scheme dividing channel stations called OFDMA Orthogonal Frequency Division Multiple Access With OFDMA different sets subcarriers assigned different stations one station send receive If 802 11 subcarriers would used one station send given moment The added flexibility bandwidth assigned increase performance given subcarrier might faded one receiver due multipath effects clear another Subcarriers assigned stations use best As well asymmetric traffic stations usually alternate sending receiving This method called TDD Time Division Duplex The SEC 4 5 BROADBAND WIRELESS alternative method station sends receives time different subcarrier frequencies called FDD Frequency Division Duplex WiMAX allows methods TDD preferred easier implement flexible Downlink Uplink Burst Burst Burst Burst Next frame Burst Uplink map Preamble Downlink map Last frame Subcarrier Burst Burst Burst Ranging Guard Time Frame structure OFDMA time division duplexing shows example frame structure repeated time It starts preamble synchronize stations followed downlink transmissions base station First base station sends maps tell stations downlink uplink subcarriers assigned frame The base station controls maps allocate different amounts bandwidth stations frame frame depending needs station Next base station sends bursts traffic different subscriber mobile stations subcarriers times given map The downlink transmissions end guard time stations switch receiving transmitting Finally subscriber mobile stations send bursts traffic base station uplink positions reserved map One uplink bursts reserved ranging process new stations adjust timing request initial bandwidth connect base station Since connection set stage new stations transmit hope collision 4 5 4 The 802 16 MAC Sublayer Protocol The data link layer divided three sublayers saw Since study cryptography Chap 8 difficult explain security sublayer works Suffice say encryption used keep secret data transmitted Only frame payloads encrypted headers 318 THE MEDIUM ACCESS CONTROL SUBLAYER This property means snooper see talking tell saying If already know something cryptography follows oneparagraph explanation security sublayer If know nothing cryptography likely find next paragraph terribly enlightening might consider rereading finishing Chap 8 When subscriber connects base station perform mutual authentication RSA public key cryptography using X 509 certificates The payloads encrypted using symmetric key system either AES Rijndael DES cipher block chaining Integrity checking uses SHA 1 Now bad Let us look MAC common sublayer part The MAC sublayer connection oriented point multipoint means one base station communicates multiple subscriber stations Much design borrowed cable modems one cable headend controls transmissions multiple cable modems customer premises The downlink direction fairly straightforward The base station controls physical layer bursts used send information different subscriber stations The MAC sublayer simply packs frames structure To reduce overhead several different options For example MAC frames may sent individually packed back back group The uplink channel complicated since competing subscribers need access Its allocation tied closely quality service issue Four classes service defined follows 1 Constant bit rate service 2 Real time variable bit rate service 3 Non real time variable bit rate service 4 Best effort service All service 802 16 connection oriented Each connection gets one service classes determined connection set This design different 802 11 Ethernet connectionless MAC sublayer Constant bit rate service intended transmitting uncompressed voice This service needs send predetermined amount data predetermined time intervals It accommodated dedicating certain bursts connection type Once bandwidth allocated bursts available automatically without need ask one Real time variable bit rate service compressed multimedia soft real time applications amount bandwidth needed instant may vary It accommodated base station polling subscriber fixed interval ask much bandwidth needed time SEC 4 5 BROADBAND WIRELESS Non real time variable bit rate service heavy transmissions real time large file transfers For service base station polls subscriber often rigidly prescribed time intervals Connections service also use best effort service described next request bandwidth Best effort service everything else No polling done subscriber must contend bandwidth best effort subscribers Requests bandwidth sent bursts marked uplink map available contention If request successful success noted next downlink map If successful unsuccessful subscriber try later To minimize collisions Ethernet binary exponential backoff algorithm used 4 5 5 The 802 16 Frame Structure All MAC frames begin generic header The header followed optional payload optional checksum CRC illustrated The payload needed control frames example requesting channel slots The checksum surprisingly also optional due error correction physical layer fact attempt ever made retransmit realtime frames If retransmissions attempted even bother checksum But checksum standard IEEE 802 CRC acknowledgements retransmissions used reliability Bits 1 1 0 E C 11 2 1 Type C EK I Length Connection ID Header CRC Bits 1 1 b 1 0 Type Bytes needed Connection ID Header CRC Data CRC A generic frame b A bandwidth request frame A quick rundown header fields follows The EC bit tells whether payload encrypted The Type field identifies frame type mostly telling whether packing fragmentation present The CI field indicates presence absence final checksum The EK field tells encryption keys used The Length field gives complete length frame including header The Connection identifier tells connection frame belongs Finally Header CRC field checksum header using polynomial x 8 x 2 x 1 The 802 16 protocol many kinds frames An example different type frame one used request bandwidth shown b It 320 THE MEDIUM ACCESS CONTROL SUBLAYER starts 1 bit instead 0 bit otherwise similar generic header except second third bytes form 16 bit number telling much bandwidth needed carry specified number bytes Bandwidth request frames carry payload full frame CRC A great deal could said 802 16 place say For information please consult IEEE 802 16 2009 standard 4 6 BLUETOOTH In 1994 L M Ericsson company became interested connecting mobile phones devices e g laptops without cables Together four companies IBM Intel Nokia Toshiba formed SIG Special Interest Group e consortium 1998 develop wireless standard interconnecting computing communication devices accessories using short range low power inexpensive wireless radios The project named Bluetooth Harald Blaatand Bluetooth II 940 981 Viking king unified e conquered Denmark Norway also without cables Bluetooth 1 0 released July 1999 since SIG never looked back All manner consumer electronic devices use Bluetooth mobile phones laptops headsets printers keyboards mice gameboxes watches music players navigation units The Bluetooth protocols let devices find connect act called pairing securely transfer data The protocols evolved past decade After initial protocols stabilized higher data rates added Bluetooth 2 0 2004 With 3 0 release 2009 Bluetooth used device pairing combination 802 11 high throughput data transfer The 4 0 release December 2009 specified low power operation That handy people want change batteries regularly devices around house We cover main aspects Bluetooth 4 6 1 Bluetooth Architecture Let us start study Bluetooth system quick overview contains intended The basic unit Bluetooth system piconet consists master node seven active slave nodes within distance 10 meters Multiple piconets exist large room even connected via bridge node takes part multiple piconets An interconnected collection piconets called scatternet In addition seven active slave nodes piconet 255 parked nodes net These devices master switched lowpower state reduce drain batteries In parked state device SEC 4 6 BLUETOOTH Piconet 1 Piconet 2 S S S S S M Active slave M S S S Parked slave S S S Bridge slave Two piconets connected form scatternet anything except respond activation beacon signal master Two intermediate power states hold sniff also exist concern us The reason master slave design designers intended facilitate implementation complete Bluetooth chips 5 The consequence decision slaves fairly dumb basically whatever master tells At heart piconet centralized TDM system master controlling clock determining device gets communicate time slot All communication master slave direct slave slave communication possible 4 6 2 Bluetooth Applications Most network protocols provide channels communicating entities let application designers figure want use For example 802 11 specify whether users use notebook computers reading email surfing Web something else In contrast Bluetooth SIG specifies particular applications supported provides different protocol stacks one At time writing 25 applications called profiles Unfortunately approach leads large amount complexity We omit complexity briefly look profiles see clearly Bluetooth SIG trying accomplish Six profiles different uses audio video For example intercom profile allows two telephones connect walkie talkies The headset hands free profiles provide voice communication headset base station might used hands free telephony driving car 322 THE MEDIUM ACCESS CONTROL SUBLAYER Other profiles streaming stereo quality audio video say portable music player headphones digital camera TV The human interface device profile connecting keyboards mice computers Other profiles let mobile phone computer receive images camera send images printer Perhaps interest profile use mobile phone remote control Bluetooth enabled TV Still profiles enable networking The personal area network profile lets Bluetooth devices form ad hoc network remotely access another network 802 11 LAN via access point The dial networking profile actually original motivation whole project It allows notebook computer connect mobile phone containing built modem without using wires Profiles higher layer information exchange also defined The synchronization profile intended loading data mobile phone leaves home collecting data returns We skip rest profiles except mention profiles serve building blocks profiles built The generic access profile profiles built provides way establish maintain secure links channels master slaves The generic profiles define basics object exchange audio video transport Utility profiles used widely functions emulating serial line especially useful many legacy applications Was really necessary spell applications detail provide different protocol stacks one Probably number different working groups devised different parts standard one focused specific problem generated profile Think Conway Law action In April 1968 issue Datamation magazine Melvin Conway observed assign n people write compiler get n pass compiler generally software structure mirrors structure group produced It would probably possible get away two protocol stacks instead 25 one file transfer one streaming real time communication 4 6 3 The Bluetooth Protocol Stack The Bluetooth standard many protocols grouped loosely layers shown The first observation make structure follow OSI model TCP IP model 802 model model The bottom layer physical radio layer corresponds fairly well physical layer OSI 802 models It deals radio transmission modulation Many concerns goal making system inexpensive become mass market item SEC 4 6 BLUETOOTH Applications Profile Profile Profile RFcomm Service discovery Upper layers L2CAP Host controller interface Link manager Datalink layer Link control Baseband Radio Physical layer The Bluetooth protocol architecture The link control baseband layer somewhat analogous MAC sublayer also includes elements physical layer It deals master controls time slots slots grouped frames Next come two protocols use link control protocol The link manager handles establishment logical channels devices including power management pairing encryption quality service It lies host controller interface line This interface convenience implementation typically protocols line implemented Bluetooth chip protocols line implemented Bluetooth device hosts chip The link protocol line L2CAP Logical Link Control Adaptation Protocol It frames variable length messages provides reliability needed Many protocols use L2CAP two utility protocols shown The service discovery protocol used locate services within network The RFcomm Radio Frequency communication protocol emulates standard serial port found PCs connecting keyboard mouse modem among devices The top layer applications located The profiles represented vertical boxes define slice protocol stack particular purpose Specific profiles headset profile usually contain protocols needed application others For example profiles may include L2CAP packets send skip L2CAP steady flow audio samples In following sections examine Bluetooth radio layer various link protocols since roughly correspond physical MAC sublayers procotol stacks studied 324 THE MEDIUM ACCESS CONTROL SUBLAYER 4 6 4 The Bluetooth Radio Layer The radio layer moves bits master slave vice versa It low power system range 10 meters operating 2 4 GHz ISM band 802 11 The band divided 79 channels 1 MHz To coexist networks using ISM band frequency hopping spread spectrum used There 1600 hops sec slots dwell time 625 sec All nodes piconet hop frequencies simultaneously following slot timing pseudorandom hop sequence dictated master Unfortunately turned early versions Bluetooth 802 11 interfered enough ruin transmissions Some companies responded banning Bluetooth altogether eventually technical solution devised The solution Bluetooth adapt hop sequence exclude channels RF signals This process reduces harmful interference It called adaptive frequency hopping Three forms modulation used send bits channel The basic scheme use frequency shift keying send 1 bit symbol every microsecond giving gross data rate 1 Mbps Enhanced rates introduced 2 0 version Bluetooth These rates use phase shift keying send either 2 3 bits per symbol gross data rates 2 3 Mbps The enhanced rates used data portion frames 4 6 5 The Bluetooth Link Layers The link control baseband layer closest thing Bluetooth MAC sublayer It turns raw bit stream frames defines key formats In simplest form master piconet defines series 625 sec time slots master transmissions starting even slots slaves transmissions starting odd ones This scheme traditional time division multiplexing master getting half slots slaves sharing half Frames 1 3 5 slots long Each frame overhead 126 bits access code header plus settling time 250 260 sec per hop allow inexpensive radio circuits become stable The payload frame encrypted confidentiality key chosen master slave connect Hops happen frames frame The result 5 slot frame much efficient 1 slot frame overhead constant data sent The link manager protocol sets logical channels called links carry frames master slave device discovered A pairing procedure followed make sure two devices allowed communicate link used The old pairing method devices must configured four digit PIN Personal Identification Number The matching PIN device would know connecting SEC 4 6 BLUETOOTH right remote device However unimaginative users devices default PINs 0000 1234 meant method provided little security practice The new secure simple pairing method enables users confirm devices displaying passkey observe passkey one device enter second device This method secure users choose set PIN They merely confirm longer device generated passkey Of course used devices limited input output hands free headset Once pairing complete link manager protocol sets links Two main kinds links exist carry user data The first SCO Synchronous Connection Oriented link It used real time data telephone connections This type link allocated fixed slot direction A slave may three SCO links master Each SCO link transmit one 64 000 bps PCM audio channel Due time critical nature SCO links frames sent never retransmitted Instead forward error correction used increase reliability The kind ACL Asynchronous ConnectionLess link This type link used packet switched data available irregular intervals ACL traffic delivered best effort basis No guarantees given Frames lost may retransmitted A slave may one ACL link master The data sent ACL links come L2CAP layer This layer four major functions First accepts packets 64 KB upper layers breaks frames transmission At far end frames reassembled packets Second handles multiplexing demultiplexing multiple packet sources When packet reassembled L2CAP layer determines upper layer protocol hand example RFcomm service discovery Third L2CAP handles error control retransmission It detects errors resends packets acknowledged Finally L2CAP enforces quality service requirements multiple links 4 6 6 The Bluetooth Frame Structure Bluetooth defines several frame formats important shown two forms It begins access code usually identifies master slaves within radio range two masters tell traffic Next comes 54 bit header containing typical MAC sublayer fields If frame sent basic rate data field comes next It 2744 bits five slot transmission For single time slot format except data field 240 bits If frame sent enhanced rate data portion may two three times many bits symbol carries 2 3 bits instead 1 326 Bits THE MEDIUM ACCESS CONTROL SUBLAYER 0 2744 Access code Header Data 1X rate 1 1 1 Addr Type F A S CRC Repeated 3 times Bits 0 8184 Access code Header Guard Sync Data 2X 3X rate Trailer 5 x 675 microsec slots Basic rate data frame top b Enhanced rate data frame bottom Typical Bluetooth data frame basic b enhanced data rates bit These data preceded guard field synchronization pattern used switch faster data rate That access code header carried basic rate data portion carried faster rate Enhanced rate frames end short trailer Let us take quick look common header The Address field identifies eight active devices frame intended The Type field identifies frame type ACL SCO poll null type error correction used data field many slots long frame The Flow bit asserted slave buffer full receive data This bit enables primitive form flow control The Acknowledgement bit used piggyback ACK onto frame The Sequence bit used number frames detect retransmissions The protocol stop wait 1 bit enough Then comes 8 bit header Checksum The entire 18 bit header repeated three times form 54 bit header shown On receiving side simple circuit examines three copies bit If three bit accepted If majority opinion wins Thus 54 bits transmission capacity used send 10 bits header The reason reliably send data noisy environment using cheap low powered 2 5 mW devices little computing capacity great deal redundancy needed Various formats used data field ACL SCO frames The basic rate SCO frames simple example study data field always 240 bits Three variants defined permitting 80 160 240 bits actual payload rest used error correction In reliable version 80 bit payload contents repeated three times header We work capacity frame follows Since slave may use odd slots gets 800 slots sec master With 80 bit SEC 4 6 BLUETOOTH payload channel capacity slave 64 000 bps channel capacity master This capacity exactly enough single full duplex PCM voice channel hop rate 1600 hops sec chosen That despite raw bandwidth 1 Mbps single full duplex uncompressed voice channel completely saturate piconet The efficiency 13 result spending 41 capacity settling time 20 headers 26 repetition coding This shortcoming highlights value enhanced rates frames single slot There much said Bluetooth space say For curious Bluetooth 4 0 specification contains details 4 7 RFID We looked MAC designs LANs MANs PANs As last example study category low end wireless devices people may recognize forming computer network RFID Radio Frequency IDentification tags readers described Sec 1 5 4 RFID technology takes many forms used smartcards implants pets passports library books The form look developed quest EPC Electronic Product Code started Auto ID Center Massachusetts Institute Technology 1999 An EPC replacement barcode carry larger amount information electronically readable distances 10 even visible It different technology example RFID used passports must placed quite close reader perform transaction The ability communicate distance makes EPCs relevant studies EPCglobal formed 2003 commercialize RFID technology developed Auto ID Center The effort got boost 2005 Walmart required top 100 suppliers label shipments RFID tags Widespread deployment hampered difficulty competing cheap printed barcodes new uses drivers licenses growing We describe second generation technology informally called EPC Gen 2 EPCglobal 2008 4 7 1 EPC Gen 2 Architecture The architecture EPC Gen 2 RFID network shown It two key components tags readers RFID tags small inexpensive devices unique 96 bit EPC identifier small amount memory read written RFID reader The memory might used record location history item example moves supply chain 328 THE MEDIUM ACCESS CONTROL SUBLAYER Often tags look like stickers placed example pairs jeans shelves store Most sticker taken antenna printed onto A tiny dot middle RFID integrated circuit Alternatively RFID tags integrated object driver license In cases tags battery must gather power radio transmissions nearby RFID reader run This kind tag called Class 1 tag distinguish capable tags batteries Reader signal RFID reader Backscatter signal RFID tag RFID architecture The readers intelligence system analogous base stations access points cellular WiFi networks Readers much powerful tags They power sources often multiple antennas charge tags send receive messages As commonly multiple tags within reading range readers must solve multiple access problem There may multiple readers contend area The main job reader inventory tags neighborhood discover identifiers nearby tags The inventory accomplished physical layer protocol tag identification protocol outlined following sections 4 7 2 EPC Gen 2 Physical Layer The physical layer defines bits sent RFID reader tags Much uses methods sending wireless signals seen previously In U S transmissions sent unlicensed 902 928 MHz ISM band This band falls UHF Ultra High Frequency range tags referred UHF RFID tags The reader performs frequency hopping least every 400 msec spread signal across channel limit interference satisfy regulatory requirements The reader tags use forms ASK Amplitude Shift Keying modulation described Sec 2 5 2 encode bits They take turns send bits link half duplex SEC 4 7 RFID There two main differences physical layers studied The first reader always transmitting signal regardless whether reader tag communicating Naturally reader transmits signal send bits tags For tags send bits reader reader transmits fixed carrier signal carries bits The tags harvest signal get power need run otherwise tag would able transmit first place To send data tag changes whether reflecting signal reader like radar signal bouncing target absorbing This method called backscatter It differs wireless situations seen far sender receiver never transmit time Backscatter low energy way tag create weak signal shows reader For reader decode incoming signal must filter outgoing signal transmitting Because tag signal weak tags send bits reader low rate tags receive even sense transmissions tags The second difference simple forms modulation used implemented tag runs little power costs cents make To send data tags reader uses two amplitude levels Bits determined either 0 1 depending long reader waits low power period The tag measures time low power periods compares time reference measured preamble As shown 1s longer 0s Tag responses consist tag alternating backscatter state fixed intervals create series pulses signal Anywhere one eight pulse periods used encode 0 1 depending need reliability 1s fewer transitions 0s shown example two pulse period coding Reader 0 Backscatter Reader 1 Tag 0 Tag 1 Power Time Reader tag backscatter signals 4 7 3 EPC Gen 2 Tag Identification Layer To inventory nearby tags reader needs receive message tag gives identifier tag This situation multiple access problem number tags unknown general case The reader might 330 THE MEDIUM ACCESS CONTROL SUBLAYER broadcast query ask tags send identifiers However tags replied right away would collide much way stations classic Ethernet We seen many ways tackling multiple access problem chapter The closest protocol current situation tags hear others transmissions slotted ALOHA one earliest protocols studied This protocol adapted use Gen 2 RFID The sequence messages used identify tag shown In first slot slot 0 reader sends Query message start process Each QRepeat message advances next slot The reader also tells tags range slots randomize transmissions Using range necessary reader synchronizes tags starts process unlike stations Ethernet tags wake message time choosing RFID reader RFID tag Query slot 0 QRepeat slot1 QRepeat slot 2 RN16 slot 2 Time Ack EPC identifier QRepeat slot 3 QRepeat slot N Example message exchange identify tag Tags pick random slot reply In tag replies slot 2 However tags send identifiers first reply Instead tag sends short 16 bit random number RN16 message If collision reader receives message sends ACK message At stage tag acquired slot sends EPC identifier The reason exchange EPC identifiers long collisions messages would expensive Instead short exchange used test whether tag safely use slot send identifier Once identifier successfully transmitted tag temporarily stops responding new Query messages remaining tags identified SEC 4 7 RFID A key problem reader adjust number slots avoid collisions without using many slots performance suffers This adjustment analogous binary exponential backoff Ethernet If reader sees many slots responses many slots collisions send QAdjust message decrease increase range slots tags responding The RFID reader perform operations tags For example select subset tags running inventory allowing collect responses say tagged jeans tagged shirts The reader also write data tags identified This feature could used record point sale relevant information 4 7 4 Tag Identification Message Formats The format Query message shown example reader tag message The message compact downlink rates limited 27 kbps 128 kbps The Command field carries code 1000 identify message Query Bits Command DR M TR Sel Session Target Q CRC Physical parameters Tag selection Format Query message The next flags DR M TR determine physical layer parameters reader transmissions tag responses For example response rate may set 5 kbps 640 kbps We skip details flags Then come three fields Sel Session Target select tags respond As well readers able select subset identifiers tags keep track four concurrent sessions whether identified sessions In way multiple readers operate overlapping coverage areas using different sessions Next important parameter command Q This field defines range slots tags respond 0 2Q 1 Finally CRC protect message fields At 5 bits shorter CRCs seen Query message much shorter packets Tag reader messages simpler Since reader control knows message expect response transmissions The tag responses simply carry data EPC identifier 332 THE MEDIUM ACCESS CONTROL SUBLAYER Originally tags identification purposes However grown time resemble small computers Some research tags sensors able run small programs gather process data Sample et al 2008 One vision technology Internet things connects objects physical world Internet Welbourne et al 2009 Gershenfeld et al 2004 4 8 DATA LINK LAYER SWITCHING Many organizations multiple LANs wish connect Would convenient could join LANs together make larger LAN In fact connections made devices called bridges The Ethernet switches described Sec 4 3 4 modern name bridges provide functionality goes beyond classic Ethernet Ethernet hubs make easy join multiple LANs larger faster network We shall use terms bridge switch interchangeably Bridges operate data link layer examine data link layer addresses forward frames Since supposed examine payload field frames forward handle IP packets well kinds packets AppleTalk packets In contrast routers examine addresses packets route based work protocols designed handle In section look bridges work used join multiple physical LANs single logical LAN We also look reverse treat one physical LAN multiple logical LANs called VLANs Virtual LANs Both technologies provide useful flexibility managing networks For comprehensive treatment bridges switches related topics see Seifert Edwards 2008 Perlman 2000 4 8 1 Uses Bridges Before getting technology bridges let us take look common situations bridges used We mention three reasons single organization may end multiple LANs First many university corporate departments LANs connect personal computers servers devices printers Since goals various departments differ different departments may set different LANs without regard departments Sooner later though need interaction bridges needed In example multiple LANs come existence due autonomy owners SEC 4 8 DATA LINK LAYER SWITCHING Second organization may geographically spread several buildings separated considerable distances It may cheaper separate LANs building connect bridges long distance fiber optic links run cables single central switch Even laying cables easy limits lengths e g 200 twisted pair gigabit Ethernet The network would work longer cables due excessive signal attenuation round trip delay The solution partition LAN install bridges join pieces increase total physical distance covered Third may necessary split logically single LAN separate LANs connected bridges accommodate load At many large universities example thousands workstations available student faculty computing Companies may also thousands employees The scale system precludes putting workstations single LAN computers ports Ethernet hub stations allowed single classic Ethernet Even possible wire workstations together putting stations Ethernet hub classic Ethernet would add capacity All stations share fixed amount bandwidth The stations less average bandwidth per station However two separate LANs twice capacity single LAN Bridges let LANs joined together keeping capacity The key send traffic onto ports needed LAN run full speed This behavior also increases reliability since single LAN defective node keeps outputting continuous stream garbage clog entire LAN By deciding forward forward bridges act like fire doors building preventing single node gone berserk bringing entire system To make benefits easily available ideally bridges completely transparent It possible go buy bridges plug LAN cables bridges everything work perfectly instantly There hardware changes required software changes required setting address switches downloading routing tables parameters nothing Just plug cables walk away Furthermore operation existing LANs affected bridges As far stations concerned observable difference whether part bridged LAN It easy move stations around bridged LAN move around single LAN Surprisingly enough actually possible create bridges transparent Two algorithms used backward learning algorithm stop traffic sent needed spanning tree algorithm break loops may formed switches cabled together willy nilly Let us take look algorithms turn learn magic accomplished 334 THE MEDIUM ACCESS CONTROL SUBLAYER 4 8 2 Learning Bridges The topology two LANs bridged together shown two cases On left hand side two multidrop LANs classic Ethernets joined special station bridge sits LANs On right hand side LANs point point cables including one hub joined together The bridges devices stations hub attached If LAN technology Ethernet bridges better known Ethernet switches D A Port B B1 E A B Port 2 B1 F D 4 B2 E H1 C Hub F G Bridge Bridge G C b Bridge connecting two multidrop LANs b Bridges hub connecting seven point point stations Bridges developed classic Ethernets use often shown topologies multidrop cables However topologies encountered today comprised point point cables switches The bridges work way settings All stations attached port bridge belong collision domain different collision domain ports If one station classic Ethernet hub half duplex link CSMA CD protocol used send frames There difference however bridged LANs built To bridge multidrop LANs bridge added new station multidrop LANs To bridge point point LANs hubs either connected bridge preferably replaced bridge increase performance In b bridges replaced one hub Different kinds cables also attached one bridge For example cable connecting bridge B1 bridge B2 b might long distance fiber optic link cable connecting bridges stations might short haul twisted pair line This arrangement useful bridging LANs different buildings Now let us consider happens inside bridges Each bridge operates promiscuous mode accepts every frame transmitted stations SEC 4 8 DATA LINK LAYER SWITCHING attached ports The bridge must decide whether forward discard frame former port output frame This decision made using destination address As example consider topology If station A sends frame station B bridge B1 receive frame port 1 This frame immediately discarded without ado already correct port However topology b suppose A sends frame D Bridge B1 receive frame port 1 output port 4 Bridge B2 receive frame port 4 output port 1 A simple way implement scheme big hash table inside bridge The table list possible destination output port belongs For example b table B1 would list D belonging port 4 since B1 know port put frames reach D That fact forwarding happen later frame hits B2 interest B1 When bridges first plugged hash tables empty None bridges know destinations use flooding algorithm every incoming frame unknown destination output ports bridge connected except one arrived As time goes bridges learn destinations Once destination known frames destined put proper port flooded The algorithm used bridges backward learning As mentioned bridges operate promiscuous mode see every frame sent ports By looking source addresses tell machines accessible ports For example bridge B1 b sees frame port 3 coming C knows C must reachable via port 3 makes entry hash table Any subsequent frame addressed C coming B1 port forwarded port 3 The topology change machines bridges powered moved around To handle dynamic topologies whenever hash table entry made arrival time frame noted entry Whenever frame whose source already table arrives entry updated current time Thus time associated every entry tells last time frame machine seen Periodically process bridge scans hash table purges entries minutes old In way computer unplugged LAN moved around building plugged somewhere else within minutes back normal operation without manual intervention This algorithm also means machine quiet minutes traffic sent flooded next sends frame The routing procedure incoming frame depends port arrives source port address destined destination address The procedure follows 336 THE MEDIUM ACCESS CONTROL SUBLAYER 1 If port destination address source port discard frame 2 If port destination address source port different forward frame destination port 3 If destination port unknown use flooding send frame ports except source port You might wonder whether first case occur point point links The answer occur hubs used connect group computers bridge An example shown b stations E F connected hub H 1 turn connected bridge B2 If E sends frame F hub relay B2 well F That hubs wire ports together frame input one port simply output ports The frame arrive B2 port 4 already right output port reach destination Bridge B2 need discard frame As frame arrives algorithm must applied usually implemented special purpose VLSI chips The chips lookup update table entry microseconds Because bridges look MAC addresses decide forward frames possible start forwarding soon destination header field come rest frame arrived provided output line available course This design reduces latency passing bridge well number frames bridge must able buffer It referred cut switching wormhole routing usually handled hardware We look operation bridge terms protocol stacks understand means link layer device Consider frame sent station A station D configuration LANs Ethernet The frame pass one bridge The protocol stack view processing shown The packet comes higher layer descends Ethernet MAC layer It acquires Ethernet header also trailer shown figure This unit passed physical layer goes cable picked bridge In bridge frame passed physical layer Ethernet MAC layer This layer extended processing compared Ethernet MAC layer station It passes frame relay still within MAC layer The bridge relay function uses Ethernet MAC header determine handle frame In case passes frame Ethernet MAC layer port used reach station D frame continues way In general case relays given layer rewrite headers layer VLANs provide example shortly In case bridge look inside frame learn carrying IP packet irrelevant SEC 4 8 DATA LINK LAYER SWITCHING Station A Station D Network Packet Ethernet MAC Eth Packet Eth Packet Physical Eth Packet Eth Packet Packet Bridge Relay Eth Packet Eth Packet Eth Packet Eth Packet Wire Wire Protocol processing bridge bridge processing would violate protocol layering Also note bridge k ports k instances MAC physical layers The value k 2 simple example 4 8 3 Spanning Tree Bridges To increase reliability redundant links used bridges In example two links parallel pair bridges This design ensures one link cut network partitioned two sets computers talk Frame F0 A F1 B1 Bridge F2 F3 B2 F4 Redundant links Bridges two parallel links However redundancy introduces additional problems creates loops topology An example problems seen looking frame sent A previously unobserved destination handled Each bridge follows normal rule handling unknown destinations flood frame Call frame A reaches bridge B1 frame F 0 The bridge sends copies frame ports We 338 THE MEDIUM ACCESS CONTROL SUBLAYER consider bridge ports connect B1 B2 though frame sent ports Since two links B1 B2 two copies frame reach B2 They shown F 1 F 2 Shortly thereafter bridge B2 receives frames However know copies frame rather two different frames sent one So bridge B2 takes F 1 sends copies ports also takes F 2 sends copies ports This produces frames F 3 F 4 sent along two links back B1 Bridge B1 sees two new frames unknown destinations copies This cycle goes forever The solution difficulty bridges communicate overlay actual topology spanning tree reaches every bridge In effect potential connections bridges ignored interest constructing fictitious loop free topology subset actual topology For example see five bridges interconnected also stations connected Each station connects one bridge There redundant connections bridges frames forwarded loops links used This topology thought graph bridges nodes point point links edges The graph reduced spanning tree cycles definition dropping links shown dashed lines Using spanning tree exactly one path every station every station Once bridges agreed spanning tree forwarding stations follows spanning tree Since unique path source destination loops impossible Station Root bridge B1 B3 B5 Bridge B2 B4 Link part spanning tree A spanning tree connecting five bridges The dashed lines links part spanning tree To build spanning tree bridges run distributed algorithm Each bridge periodically broadcasts configuration message ports SEC 4 8 DATA LINK LAYER SWITCHING neighbors processes messages receives bridges described next These messages forwarded since purpose build tree used forwarding The bridges must first choose one bridge root spanning tree To make choice include identifier based MAC address configuration message well identifier bridge believe root MAC addresses installed manufacturer guaranteed unique worldwide makes identifiers convenient unique The bridges choose bridge lowest identifier root After enough messages exchanged spread news bridges agree bridge root In bridge B1 lowest identifier becomes root Next tree shortest paths root every bridge constructed In bridges B2 B3 reached bridge B1 directly one hop shortest path Bridge B4 reached two hops via either B2 B3 To break tie path via bridge lowest identifier chosen B4 reached via B2 Bridge B5 reached two hops via B3 To find shortest paths bridges include distance root configuration messages Each bridge remembers shortest path finds root The bridges turn ports part shortest path Although tree spans bridges links even bridges necessarily present tree This happens turning ports prunes links network prevent loops Even spanning tree established algorithm continues run normal operation automatically detect topology changes update tree The algorithm constructing spanning tree invented Radia Perlman Her job solve problem joining LANs without loops She given week came idea spanning tree algorithm day Fortunately left enough time write poem Perlman 1985 I think I shall never see A graph lovely tree A tree whose crucial property Is loop free connectivity A tree must sure span So packets reach every LAN First Root must selected By ID elected Least cost paths Root traced In tree paths placed A mesh made folks like Then bridges find spanning tree 340 THE MEDIUM ACCESS CONTROL SUBLAYER The spanning tree algorithm standardized IEEE 802 1D used many years In 2001 revised rapidly find new spanning tree topology change For detailed treatment bridges see Perlman 2000 4 8 4 Repeaters Hubs Bridges Switches Routers Gateways So far book looked variety ways get frames packets one computer another We mentioned repeaters hubs bridges switches routers gateways All devices common use differ subtle subtle ways Since many probably worth taking look together see similarities differences The key understanding devices realize operate different layers illustrated The layer matters different devices use different pieces information decide switch In typical scenario user generates data sent remote machine Those data passed transport layer adds header example TCP header passes resulting unit network layer The network layer adds header form network layer packet e g IP packet In b see IP packet shaded gray Then packet goes data link layer adds header checksum CRC gives resulting frame physical layer transmission example LAN Application layer Application gateway Transport layer Transport gateway Network layer Router Data link layer Bridge switch Physical layer Repeater hub Packet supplied network layer Frame Packet TCP header header header User data CRC Frame built data link layer b Which device layer b Frames packets headers Now let us look switching devices see relate packets frames At bottom physical layer find repeaters These analog devices work signals cables connected A signal appearing one cable cleaned amplified put another cable Repeaters understand frames packets headers They understand symbols encode bits volts Classic Ethernet example SEC 4 8 DATA LINK LAYER SWITCHING designed allow four repeaters would boost signal extend maximum cable length 500 meters 2500 meters Next come hubs A hub number input lines joins electrically Frames arriving lines sent others If two frames arrive time collide coaxial cable All lines coming hub must operate speed Hubs differ repeaters usually amplify incoming signals designed multiple input lines differences slight Like repeaters hubs physical layer devices examine link layer addresses use way Now let us move data link layer find bridges switches We studied bridges length A bridge connects two LANs Like hub modern bridge multiple ports usually enough 4 48 input lines certain type Unlike hub port isolated collision domain port full duplex point point line CSMA CD algorithm needed When frame arrives bridge extracts destination address frame header looks table see send frame For Ethernet address 48 bit destination address shown The bridge outputs frame port needed forward multiple frames time Bridges offer much better performance hubs isolation bridge ports also means input lines may run different speeds possibly even different network types A common example bridge ports connect 10 100 1000 Mbps Ethernet Buffering within bridge needed accept frame one port transmit frame different port If frames come faster retransmitted bridge may run buffer space start discarding frames For example gigabit Ethernet pouring bits 10 Mbps Ethernet top speed bridge buffer hoping run memory This problem still exists even ports run speed one port may sending frames given destination port Bridges originally intended able join different kinds LANs example Ethernet Token Ring LAN However never worked well differences LANs Different frame formats require copying reformatting takes CPU time requires new checksum calculation introduces possibility undetected errors due bad bits bridge memory Different maximum frame lengths also serious problem good solution Basically frames large forwarded must discarded So much transparency Two areas LANs differ security quality service Some LANs link layer encryption example 802 11 example Ethernet Some LANs quality service features priorities example 802 11 example Ethernet Consequently 342 THE MEDIUM ACCESS CONTROL SUBLAYER frame must travel LANs security quality service expected sender may able provided For reasons modern bridges usually work one network type routers come soon used instead join networks different types Switches modern bridges another name The differences marketing technical issues points worth knowing Bridges developed classic Ethernet use tend join relatively LANs thus relatively ports The term switch popular nowadays Also modern installations use point point links twisted pair cables individual computers plug directly switch thus switch tend many ports Finally switch also used general term With bridge functionality clear On hand switch may refer Ethernet switch completely different kind device makes forwarding decisions telephone switch So far seen repeaters hubs actually quite similar well bridges switches even similar Now move routers different When packet comes router frame header trailer stripped packet located frame payload field shaded passed routing software This software uses packet header choose output line For IP packet packet header contain 32 bit IPv4 128 bit IPv6 address 48 bit IEEE 802 address The routing software see frame addresses even know whether packet came LAN point point line We study routers routing Chap 5 Up another layer find transport gateways These connect two computers use different connection oriented transport protocols For example suppose computer using connection oriented TCP IP protocol needs talk computer using different connection oriented transport protocol called SCTP The transport gateway copy packets one connection reformatting need Finally application gateways understand format contents data translate messages one format another An email gateway could translate Internet messages SMS messages mobile phones example Like switch gateway somewhat general term It refers forwarding process runs high layer 4 8 5 Virtual LANs In early days local area networking thick yellow cables snaked cable ducts many office buildings Every computer passed plugged No thought given computer belonged LAN All people adjacent offices put LAN whether belonged together Geography trumped corporate organization charts SEC 4 8 DATA LINK LAYER SWITCHING With advent twisted pair hubs 1990s changed Buildings rewired considerable expense rip yellow garden hoses install twisted pairs every office central wiring closets end corridor central machine room illustrated If Vice President Charge Wiring visionary Category 5 twisted pairs installed bean counter existing Category 3 telephone wiring used replaced years later fast Ethernet emerged Cable duct Hub Co rrid r Switch Hub Twisted pair hub Office A building centralized wiring using hubs switch Today cables changed hubs become switches wiring pattern still This pattern makes possible configure LANs logically rather physically For example company wants k LANs could buy k switches By carefully choosing connectors plug switches occupants LAN chosen way makes organizational sense without much regard geography Does matter LAN After nearly organizations LANs interconnected In short yes often matters Network administrators like group users LANs reflect organizational structure rather physical layout building variety reasons One issue security One LAN might host Web servers computers intended public use Another LAN might host computers containing records Human Resources department passed outside department In situation putting computers single LAN letting servers accessed LAN makes sense Management tends frown hearing arrangement impossible 344 THE MEDIUM ACCESS CONTROL SUBLAYER A second issue load Some LANs heavily used others may desirable separate For example folks research running kinds nifty experiments sometimes get hand saturate LAN folks management may enthusiastic donating capacity using videoconferencing help Then might impress management need install faster network A third issue broadcast traffic Bridges broadcast traffic location destination unknown upper layer protocols use broadcasting well For example user wants send packet IP address x know MAC address put frame We study question Chap 5 briefly summarized answer broadcasts frame containing question owns IP address x Then waits answer As number computers LAN grows number broadcasts Each broadcast consumes LAN capacity regular frame delivered every computer LAN By keeping LANs larger need impact broadcast traffic reduced Related broadcasts problem network interface break misconfigured begin generating endless stream broadcast frames If network really unlucky frames elicit responses lead ever traffic The result broadcast storm 1 entire LAN capacity occupied frames 2 machines interconnected LANs crippled processing discarding frames broadcast At first might appear broadcast storms could limited scope separating LANs bridges switches goal achieve transparency e machine moved different LAN across bridge without anyone noticing bridges forward broadcast frames Having seen companies might want multiple LANs restricted scopes let us get back problem decoupling logical topology physical topology Building physical topology reflect organizational structure add work cost even centralized wiring switches For example two people department work different buildings may easier wire different switches part different LANs Even case user might shifted within company one department another without changing offices might change offices without changing departments This might result user wrong LAN administrator changes user connector one switch another Furthermore number computers belong different departments may good match number ports switches departments may small others big require multiple switches This results wasted switch ports used In many companies organizational changes occur time meaning system administrators spend lot time pulling plugs pushing back SEC 4 8 DATA LINK LAYER SWITCHING somewhere else Also cases change made twisted pair user machine far correct switch e g wrong building available switch ports wrong LAN In response customer requests flexibility network vendors began working way rewire buildings entirely software The resulting concept called VLAN Virtual LAN It standardized IEEE 802 committee widely deployed many organizations Let us take look For additional information VLANs see Seifert Edwards 2008 VLANs based VLAN aware switches To set VLAN based network network administrator decides many VLANs computers VLAN VLANs called Often VLANs informally named colors since possible print color diagrams showing physical layout machines members red LAN red members green LAN green In way physical logical layouts visible single view As example consider bridged LAN nine machines belong G gray VLAN five belong W white VLAN Machines gray VLAN spread across two switches including two machines connect switch via hub Gray station G G Gray White port G Gray port GW Hub W G B1 Bridge W GW B2 White port G G G G W W White station Two VLANs gray white bridged LAN To make VLANs function correctly configuration tables set bridges These tables tell VLANs accessible via ports When frame comes say gray VLAN must forwarded ports marked G This holds ordinary e unicast traffic bridges learned location destination well multicast broadcast traffic Note port may labeled multiple VLAN colors As example suppose one gray stations plugged bridge B1 sends frame destination observed beforehand Bridge B1 receive frame see came machine gray 346 THE MEDIUM ACCESS CONTROL SUBLAYER VLAN flood frame ports labeled G except incoming port The frame sent five gray stations attached B1 well link B1 bridge B2 At bridge B2 frame similarly forwarded ports labeled G This sends frame one station hub transmit frame stations The hub labels connects machines VLANs The frame sent ports without G label bridge knows machines gray VLAN reached via ports In example frame sent bridge B1 bridge B2 machines gray VLAN connected B2 Looking white VLAN see bridge B2 port connects bridge B1 labeled W This means frame white VLAN forwarded bridge B2 bridge B1 This behavior correct stations white VLAN connected B1 The IEEE 802 1Q Standard To implement scheme bridges need know VLAN incoming frame belongs Without information example bridge B2 gets frame bridge B1 know whether forward frame gray white VLAN If designing new type LAN would easy enough add VLAN field header But Ethernet dominant LAN spare fields lying around VLAN identifier The IEEE 802 committee problem thrown lap 1995 After much discussion unthinkable changed Ethernet header The new format published IEEE standard 802 1Q issued 1998 The new format contains VLAN tag examine shortly Not surprisingly changing something well established Ethernet header entirely trivial A questions come mind 1 Need throw several hundred million existing Ethernet cards 2 If generates new fields 3 What happens frames already maximum size Of course 802 committee painfully aware problems come solutions The key solution realize VLAN fields actually used bridges switches user machines Thus Fig 447 really essential present lines going end stations long line bridges Also use VLANs bridges VLAN aware This fact makes design feasible SEC 4 8 DATA LINK LAYER SWITCHING As throwing existing Ethernet cards answer Remember 802 3 committee could even get people change Type field Length field You imagine reaction announcement existing Ethernet cards thrown However new Ethernet cards 802 1Q compliant correctly fill VLAN fields Because computers switches VLAN aware first VLAN aware bridge touch frame adds VLAN fields last one road removes An example mixed topology shown In figure VLAN aware computers generate tagged e 802 1Q frames directly switching uses tags The shaded symbols VLAN aware empty ones Legacy frame B3 Tagged frame B1 B5 B2 B4 B6 VLAN aware host bridge Legacy bridge host Bridged LAN partly VLAN aware The shaded symbols VLAN aware The empty ones With 802 1Q frames colored depending port received For method work machines port must belong VLAN reduces flexibility For example property holds ports individual computer connects bridge port hub connects bridge B2 Additionally bridge use higher layer protocol select color In way frames arriving port might placed different VLANs depending whether carry IP packets PPP frames Other methods possible supported 802 1Q As one example MAC address used select VLAN color This might useful frames coming nearby 802 11 LAN laptops send frames via different ports move One MAC address would mapped fixed VLAN regardless port entered LAN As problem frames longer 1518 bytes 802 1Q raised limit 1522 bytes Luckily VLAN aware computers switches must support longer frames Now let us take look 802 1Q frame format It shown The change addition pair 2 byte fields The first one 348 THE MEDIUM ACCESS CONTROL SUBLAYER VLAN protocol ID It always value 0x8100 Since number greater 1500 Ethernet cards interpret type rather length What legacy card frame moot since frames supposed sent legacy cards 802 3 802 1Q Destination Source Length address address Destination Source address address VLAN protocol ID 0x8100 Data Tag Length Pri C F VLAN Identifier I Pad Data Checksum Pad Checksum The 802 3 legacy 802 1Q Ethernet frame formats The second 2 byte field contains three subfields The main one VLAN identifier occupying low order 12 bits This whole thing color VLAN frame belongs The 3 bit Priority field nothing VLANs since changing Ethernet header decade event taking three years featuring hundred people put good things This field makes possible distinguish hard real time traffic soft real time traffic timeinsensitive traffic order provide better quality service Ethernet It needed voice Ethernet although fairness IP similar field quarter century nobody ever used The last field CFI Canonical format indicator called CEI Corporate ego indicator It originally intended indicate order bits MAC addresses little endian versus big endian use got lost controversies Its presence indicates payload contains freeze dried 802 5 frame hoping find another 802 5 LAN destination carried Ethernet This whole arrangement course nothing whatsoever VLANs But standards committee politics unlike regular politics vote bit I vote bit As mentioned tagged frame arrives VLAN aware switch switch uses VLAN identifier index table find ports send But table come If manually constructed back square zero manual configuration bridges The beauty transparent bridge plug play require manual configuration It would terrible shame lose property Fortunately VLAN aware bridges also autoconfigure based observing tags come If frame tagged VLAN 4 comes port SEC 4 8 DATA LINK LAYER SWITCHING 3 apparently machine port 3 VLAN 4 The 802 1Q standard explains build tables dynamically mostly referencing appropriate portions 802 1D standard Before leaving subject VLAN routing worth making one last observation Many people Internet Ethernet worlds fanatically favor connectionless networking violently opposed anything smacking connections data link network layers Yet VLANs introduce something surprisingly similar connection To use VLANs properly frame carries new special identifier used index table inside switch look frame supposed sent That precisely happens connection oriented networks In connectionless networks destination address used routing kind connection identifier We see creeping connectionism Chap 5 4 9 SUMMARY Some networks single channel used communication In networks key design issue allocation channel among competing stations wishing use FDM TDM simple efficient allocation schemes number stations small fixed traffic continuous Both widely used circumstances example dividing bandwidth telephone trunks However number stations large variable traffic fairly bursty common case computer networks FDM TDM poor choices Numerous dynamic channel allocation algorithms devised The ALOHA protocol without slotting used many derivatives real systems example cable modems RFID As improvement state channel sensed stations avoid starting transmission another station transmitting This technique carrier sensing led variety CSMA protocols LANs MANs It basis classic Ethernet 802 11 networks A class protocols eliminates contention altogether least reduces considerably well known The bitmap protocol topologies rings binary countdown protocol completely eliminate contention The tree walk protocol reduces dynamically dividing stations two disjoint groups different sizes allowing contention within one group ideally group chosen one station ready send permitted Wireless LANs added problems difficult sense colliding transmissions coverage regions stations may differ In dominant wireless LAN IEEE 802 11 stations use CSMA CA mitigate first problem leaving small gaps avoid collisions The stations also use RTS CTS protocol combat hidden terminals arise second 350 THE MEDIUM ACCESS CONTROL SUBLAYER problem IEEE 802 11 commonly used connect laptops devices wireless access points also used devices Any several physical layers used including multichannel FDM without multiple antennas spread spectrum Like 802 11 RFID readers tags use random access protocol communicate identifiers Other wireless PANs MANs different designs The Bluetooth system connects headsets many kinds peripherals computers without wires IEEE 802 16 provides wide area wireless Internet data service stationary mobile computers Both networks use centralized connection oriented design Bluetooth master WiMAX base station decide station may send receive data For 802 16 design supports different quality service real time traffic like telephone calls interactive traffic like Web browsing For Bluetooth placing complexity master leads inexpensive slave devices Ethernet dominant form wired LAN Classic Ethernet used CSMA CD channel allocation yellow cable size garden hose snaked machine machine The architecture changed speeds risen 10 Mbps 10 Gbps continue climb Now point point links twisted pair attached hubs switches With modern switches full duplex links contention links switch forward frames different ports parallel With buildings full LANs way needed interconnect Plugand play bridges used purpose The bridges built backward learning algorithm spanning tree algorithm Since functionality built modern switches terms bridge switch used interchangeably To help management bridged LANs VLANs let physical topology divided different logical topologies The VLAN standard IEEE 802 1Q introduces new format Ethernet frames PROBLEMS 1 For problem use formula chapter first state formula Frames arrive randomly 100 Mbps channel transmission If channel busy frame arrives waits turn queue Frame length exponentially distributed mean 10 000 bits frame For following frame arrival rates give delay experienced average frame including queueing time transmission time 90 frames sec b 900 frames sec c 9000 frames sec CHAP 4 PROBLEMS 2 A group N stations share 56 kbps pure ALOHA channel Each station outputs 1000 bit frame average every 100 sec even previous one yet sent e g stations buffer outgoing frames What maximum value N 3 Consider delay pure ALOHA versus slotted ALOHA low load Which one less Explain answer 4 A large population ALOHA users manages generate 50 requests sec including originals retransmissions Time slotted units 40 msec What chance success first attempt b What probability exactly k collisions success c What expected number transmission attempts needed 5 In infinite population slotted ALOHA system mean number slots station waits collision retransmission 4 Plot delay versus throughput curve system 6 What length contention slot CSMA CD 2 km twin lead cable signal propagation speed 82 signal propagation speed vacuum b 40 km multimode fiber optic cable signal propagation speed 65 signal propagation speed vacuum 7 How long station wait worst case start transmitting frame LAN uses basic bit map protocol 8 In binary countdown protocol explain lower numbered station may starved sending packet 9 Sixteen stations numbered 1 16 contending use shared channel using adaptive tree walk protocol If stations whose addresses prime numbers suddenly become ready many bit slots needed resolve contention 10 Consider five wireless stations A B C D E Station A communicate stations B communicate A C E C communicate A B D D communicate A C E E communicate A D B When A sending B communications possible b When B sending A communications possible c When B sending C communications possible 11 Six stations A F communicate using MACA protocol Is possible two transmissions take place simultaneously Explain answer 12 A seven story office building 15 adjacent offices per floor Each office contains wall socket terminal front wall sockets form rectangular grid vertical plane separation 4 sockets horizontally vertically Assuming feasible run straight cable pair sockets horizontally vertically diagonally many meters cable needed connect sockets using A star configuration single router middle b A classic 802 3 LAN 352 THE MEDIUM ACCESS CONTROL SUBLAYER 13 What baud rate classic 10 Mbps Ethernet 14 Sketch Manchester encoding classic Ethernet bit stream 0001110101 15 A 1 km long 10 Mbps CSMA CD LAN 802 3 propagation speed 200 sec Repeaters allowed system Data frames 256 bits long including 32 bits header checksum overhead The first bit slot successful transmission reserved receiver capture channel order send 32 bit acknowledgement frame What effective data rate excluding overhead assuming collisions 16 Two CSMA CD stations trying transmit long multiframe files After frame sent contend channel using binary exponential backoff algorithm What probability contention ends round k mean number rounds per contention period 17 An IP packet transmitted Ethernet 60 bytes long including headers If LLC use padding needed Ethernet frame many bytes 18 Ethernet frames must least 64 bytes long ensure transmitter still going event collision far end cable Fast Ethernet 64 byte minimum frame size get bits ten times faster How possible maintain minimum frame size 19 Some books quote maximum size Ethernet frame 1522 bytes instead 1500 bytes Are wrong Explain answer 20 How many frames per second gigabit Ethernet handle Think carefully take account relevant cases Hint fact gigabit Ethernet matters 21 Name two networks allow frames packed back back Why feature worth 22 In four stations A B C D shown Which last two stations think closest A 23 Give example show RTS CTS 802 11 protocol little different MACA protocol 24 A wireless LAN one AP 10 client stations Four stations data rates 6 Mbps four stations data rates 18 Mbps last two stations data rates 54 Mbps What data rate experienced station ten stations sending data together TXOP used b TXOP used 25 Suppose 11 Mbps 802 11b LAN transmitting 64 byte frames back back radio channel bit error rate 10 7 How many frames per second damaged average 26 An 802 16 network channel width 20 MHz How many bits sec sent subscriber station CHAP 4 PROBLEMS 27 Give two reasons networks might use error correcting code instead error detection retransmission 28 List two ways WiMAX similar 802 11 two ways different 802 11 29 From see Bluetooth device two piconets time Is reason one device master time 30 What maximum size data field 3 slot Bluetooth frame basic rate Explain answer 31 shows several physical layer protocols Which closest Bluetooth physical layer protocol What biggest difference two 32 It mentioned Section 4 6 6 efficiency 1 slot frame repetition encoding 13 basic data rate What efficiency 5 slot frame repetition encoding used basic data rate instead 33 Beacon frames frequency hopping spread spectrum variant 802 11 contain dwell time Do think analogous beacon frames Bluetooth also contain dwell time Discuss answer 34 Suppose 10 RFID tags around RFID reader What best value Q How likely one tag responds collision given slot 35 List security concerns RFID system 36 A switch designed use fast Ethernet backplane move 10 Gbps How many frames sec handle worst case 37 Briefly describe difference store forward cut switches 38 Consider extended LAN connected using bridges B1 B2 b Suppose hash tables two bridges empty List ports packet forwarded following sequence data transmissions A sends packet C b E sends packet F c F sends packet E G sends packet E e D sends packet A f B sends packet F 39 Store forward switches advantage cut switches respect damaged frames Explain 40 It mentioned Section 4 8 3 bridges may even present spanning tree Outline scenario bridge may present spanning tree 41 To make VLANs work configuration tables needed bridges What VLANs used hubs rather switches Do hubs need configuration tables Why 354 THE MEDIUM ACCESS CONTROL SUBLAYER 42 In switch legacy end domain right VLAN aware switch Would possible use legacy switch If would work If 43 Write program simulate behavior CSMA CD protocol Ethernet N stations ready transmit frame transmitted Your program report times station successfully starts sending frame Assume clock tick occurs every slot time 51 2 sec collision detection sending jamming sequence takes one slot time All frames maximum length allowed 5 THE NETWORK LAYER The network layer concerned getting packets source way destination Getting destination may require making many hops intermediate routers along way This function clearly contrasts data link layer modest goal moving frames one end wire Thus network layer lowest layer deals end end transmission To achieve goals network layer must know topology network e set routers links choose appropriate paths even large networks It must also take care choosing routes avoid overloading communication lines routers leaving others idle Finally source destination different networks new problems occur It network layer deal In chapter study issues illustrate primarily using Internet network layer protocol IP 5 1 NETWORK LAYER DESIGN ISSUES In following sections give introduction issues designers network layer must grapple These issues include service provided transport layer internal design network 356 THE NETWORK LAYER 5 1 1 Store Forward Packet Switching Before starting explain details network layer worth restating context network layer protocols operate This context seen The major components network ISP equipment routers connected transmission lines shown inside shaded oval customers equipment shown outside oval Host H1 directly connected one ISP routers A perhaps home computer plugged DSL modem In contrast H2 LAN might office Ethernet router F owned operated customer This router leased line ISP equipment We shown F outside oval belong ISP For purposes chapter however routers customer premises considered part ISP network run algorithms ISP routers main concern algorithms Router ISP equipment Process P1 P2 B D A E Host H1 F LAN H2 C Packet The environment network layer protocols This equipment used follows A host packet send transmits nearest router either LAN point point link ISP The packet stored fully arrived link finished processing verifying checksum Then forwarded next router along path reaches destination host delivered This mechanism store forward packet switching seen previous chapters 5 1 2 Services Provided Transport Layer The network layer provides services transport layer network layer transport layer interface An important question precisely kind services network layer provides transport layer The services need carefully designed following goals mind SEC 5 1 NETWORK LAYER DESIGN ISSUES 1 The services independent router technology 2 The transport layer shielded number type topology routers present 3 The network addresses made available transport layer use uniform numbering plan even across LANs WANs Given goals designers network layer lot freedom writing detailed specifications services offered transport layer This freedom often degenerates raging battle two warring factions The discussion centers whether network layer provide connectionoriented service connectionless service One camp represented Internet community argues routers job moving packets around nothing else In view based 40 years experience real computer network network inherently unreliable matter designed Therefore hosts accept fact error control e error detection correction flow control This viewpoint leads conclusion network service connectionless primitives SEND PACKET RECEIVE PACKET little else In particular packet ordering flow control done hosts going anyway usually little gained twice This reasoning example end end argument design principle influential shaping Internet Saltzer et al 1984 Furthermore packet must carry full destination address packet sent carried independently predecessors The camp represented telephone companies argues network provide reliable connection oriented service They claim 100 years successful experience worldwide telephone system excellent guide In view quality service dominant factor without connections network quality service difficult achieve especially real time traffic voice video Even several decades controversy still much alive Early widely used data networks X 25 1970s successor Frame Relay 1980s connection oriented However since days ARPANET early Internet connectionless network layers grown tremendously popularity The IP protocol ever present symbol success It undeterred connection oriented technology called ATM developed overthrow 1980s instead ATM found niche uses IP taking telephone networks Under covers however Internet evolving connection oriented features quality service becomes important Two examples connection oriented technologies MPLS MultiProtocol Label Switching describe chapter VLANs saw Chap 4 Both technologies widely used 358 THE NETWORK LAYER 5 1 3 Implementation Connectionless Service Having looked two classes service network layer provide users time see layer works inside Two different organizations possible depending type service offered If connectionless service offered packets injected network individually routed independently No advance setup needed In context packets frequently called datagrams analogy telegrams network called datagram network If connection oriented service used path source router way destination router must established data packets sent This connection called VC virtual circuit analogy physical circuits set telephone system network called virtual circuit network In section examine datagram networks next one examine virtual circuit networks Let us see datagram network works Suppose process P1 long message P2 It hands message transport layer instructions deliver process P2 host H2 The transport layer code runs H1 typically within operating system It prepends transport header front message hands result network layer probably another procedure within operating system ISP equipment Router Process P1 P2 B D A E F Host H1 LAN H2 C Packet A table initially A table later A B C D E F B C B C C A B C D E F B C B B B C table E table A B C D E F A B C D E F A A E E E C D C D F Dest Line Routing within datagram network Let us assume example message four times longer maximum packet size network layer break four packets 1 2 SEC 5 1 NETWORK LAYER DESIGN ISSUES 3 4 send turn router A using point point protocol example PPP At point ISP takes Every router internal table telling send packets possible destinations Each table entry pair consisting destination outgoing line use destination Only directly connected lines used For example A two outgoing lines B C every incoming packet must sent one routers even ultimate destination router A initial routing table shown figure label initially At A packets 1 2 3 stored briefly arrived incoming link checksums verified Then packet forwarded according A table onto outgoing link C within new frame Packet 1 forwarded E F When gets F sent within frame LAN H2 Packets 2 3 follow route However something different happens packet 4 When gets A sent router B even though also destined F For reason A decided send packet 4 via different route first three packets Perhaps learned traffic jam somewhere along ACE path updated routing table shown label later The algorithm manages tables makes routing decisions called routing algorithm Routing algorithms one main topics study chapter There several different kinds see IP Internet Protocol basis entire Internet dominant example connectionless network service Each packet carries destination IP address routers use individually forward packet The addresses 32 bits IPv4 packets 128 bits IPv6 packets We describe IP much detail later chapter 5 1 4 Implementation Connection Oriented Service For connection oriented service need virtual circuit network Let us see works The idea behind virtual circuits avoid choose new route every packet sent Instead connection established route source machine destination machine chosen part connection setup stored tables inside routers That route used traffic flowing connection exactly way telephone system works When connection released virtual circuit also terminated With connection oriented service packet carries identifier telling virtual circuit belongs As example consider situation shown Here host H1 established connection 1 host H2 This connection remembered first entry routing tables The first line A table says packet 360 THE NETWORK LAYER bearing connection identifier 1 comes H1 sent router C given connection identifier 1 Similarly first entry C routes packet E also connection identifier 1 P3 Router ISP equipment P2 B H3 D Process P1 A E F LAN H2 C Packet Host H1 A table H1 1 H3 1 In C C C table2 A A 2 E E E table2 C C 2 F F 2 Out Routing within virtual circuit network Now let us consider happens H3 also wants establish connection H2 It chooses connection identifier 1 initiating connection connection tells network establish virtual circuit This leads second row tables Note conflict although A easily distinguish connection 1 packets H1 connection 1 packets H3 C For reason A assigns different connection identifier outgoing traffic second connection Avoiding conflicts kind routers need ability replace connection identifiers outgoing packets In contexts process called label switching An example connection oriented network service MPLS MultiProtocol Label Switching It used within ISP networks Internet IP packets wrapped MPLS header 20 bit connection identifier label MPLS often hidden customers ISP establishing long term connections large amounts traffic increasingly used help quality service important also ISP traffic management tasks We say MPLS later chapter SEC 5 1 NETWORK LAYER DESIGN ISSUES 5 1 5 Comparison Virtual Circuit Datagram Networks Both virtual circuits datagrams supporters detractors We attempt summarize sets arguments The major issues listed although purists could probably find counterexample everything figure Issue Datagram network Virtual circuit network Circuit setup Not needed Required Addressing Each packet contains full source destination address Each packet contains short VC number State information Routers hold state information connections Each VC requires router table space per connection Routing Each packet routed independently Route chosen VC set packets follow Effect router failures None except packets lost crash All VCs passed failed router terminated Quality service Difficult Easy enough resources allocated advance VC Congestion control Difficult Easy enough resources allocated advance VC Comparison datagram virtual circuit networks Inside network several trade offs exist virtual circuits datagrams One trade setup time versus address parsing time Using virtual circuits requires setup phase takes time consumes resources However price paid figuring data packet virtual circuit network easy router uses circuit number index table find packet goes In datagram network setup needed complicated lookup procedure required locate entry destination A related issue destination addresses used datagram networks longer circuit numbers used virtual circuit networks global meaning If packets tend fairly short including full destination address every packet may represent significant amount overhead hence waste bandwidth Yet another issue amount table space required router memory A datagram network needs entry every possible destination whereas virtual circuit network needs entry virtual circuit However 362 THE NETWORK LAYER advantage somewhat illusory since connection setup packets routed use destination addresses datagrams Virtual circuits advantages guaranteeing quality service avoiding congestion within network resources e g buffers bandwidth CPU cycles reserved advance connection established Once packets start arriving necessary bandwidth router capacity With datagram network congestion avoidance difficult For transaction processing systems e g stores calling verify credit card purchases overhead required set clear virtual circuit may easily dwarf use circuit If majority traffic expected kind use virtual circuits inside network makes little sense On hand long running uses VPN traffic two corporate offices permanent virtual circuits set manually last months years may useful Virtual circuits also vulnerability problem If router crashes loses memory even comes back second later virtual circuits passing aborted In contrast datagram router goes users whose packets queued router time need suffer probably even since sender likely retransmit shortly The loss communication line fatal virtual circuits using easily compensated datagrams used Datagrams also allow routers balance traffic throughout network since routes changed partway long sequence packet transmissions 5 2 ROUTING ALGORITHMS The main function network layer routing packets source machine destination machine In networks packets require multiple hops make journey The notable exception broadcast networks even routing issue source destination network segment The algorithms choose routes data structures use major area network layer design The routing algorithm part network layer software responsible deciding output line incoming packet transmitted If network uses datagrams internally decision must made anew every arriving data packet since best route may changed since last time If network uses virtual circuits internally routing decisions made new virtual circuit set Thereafter data packets follow already established route The latter case sometimes called session routing route remains force entire session e g logged VPN SEC 5 2 ROUTING ALGORITHMS It sometimes useful make distinction routing making decision routes use forwarding happens packet arrives One think router two processes inside One handles packet arrives looking outgoing line use routing tables This process forwarding The process responsible filling updating routing tables That routing algorithm comes play Regardless whether routes chosen independently packet sent new connections established certain properties desirable routing algorithm correctness simplicity robustness stability fairness efficiency Correctness simplicity hardly require comment need robustness may less obvious first Once major network comes air may expected run continuously years without system wide failures During period hardware software failures kinds Hosts routers lines fail repeatedly topology change many times The routing algorithm able cope changes topology traffic without requiring jobs hosts aborted Imagine havoc network needed rebooted every time router crashed Stability also important goal routing algorithm There exist routing algorithms never converge fixed set paths matter long run A stable algorithm reaches equilibrium stays It converge quickly since communication may disrupted routing algorithm reached equilibrium Fairness efficiency may sound obvious surely reasonable person would oppose turns often contradictory goals As simple example conflict look Suppose enough traffic A A B B C C saturate horizontal links To maximize total flow X X traffic shut altogether Unfortunately X X may see way Evidently compromise global efficiency fairness individual connections needed Before even attempt find trade offs fairness efficiency must decide seek optimize Minimizing mean packet delay obvious candidate send traffic network effectively maximizing total network throughput Furthermore two goals also conflict since operating queueing system near capacity implies long queueing delay As compromise many networks attempt minimize distance packet must travel simply reduce number hops packet must make Either choice tends improve delay also reduce amount bandwidth consumed per packet tends improve overall network throughput well Routing algorithms grouped two major classes nonadaptive adaptive Nonadaptive algorithms base routing decisions 364 THE NETWORK LAYER A B C X X A B C Network conflict fairness efficiency measurements estimates current topology traffic Instead choice route use get I J I J computed advance offline downloaded routers network booted This procedure sometimes called static routing Because respond failures static routing mostly useful situations routing choice clear For example router F send packets headed network router E regardless ultimate destination Adaptive algorithms contrast change routing decisions reflect changes topology sometimes changes traffic well These dynamic routing algorithms differ get information e g locally adjacent routers routers change routes e g topology changes every T seconds load changes metric used optimization e g distance number hops estimated transit time In following sections discuss variety routing algorithms The algorithms cover delivery models besides sending packet source destination Sometimes goal send packet multiple one set destinations All routing algorithms describe make decisions based topology defer possibility decisions based traffic levels Sec 5 3 5 2 1 The Optimality Principle Before get specific algorithms may helpful note one make general statement optimal routes without regard network topology traffic This statement known optimality principle Bellman 1957 It states router J optimal path router I router K SEC 5 2 ROUTING ALGORITHMS optimal path J K also falls along route To see call part route I J r 1 rest route r 2 If route better r 2 existed J K could concatenated r 1 improve route I K contradicting statement r 1 r 2 optimal As direct consequence optimality principle see set optimal routes sources given destination form tree rooted destination Such tree called sink tree illustrated b distance metric number hops The goal routing algorithms discover use sink trees routers B B A G F J C A C E D G F J I H E D I H N N L L K K M O M O b A network b A sink tree router B Note sink tree necessarily unique trees path lengths may exist If allow possible paths chosen tree becomes general structure called DAG Directed Acyclic Graph DAGs loops We use sink trees convenient shorthand cases Both cases also depend technical assumption paths interfere example traffic jam one path cause another path divert Since sink tree indeed tree contain loops packet delivered within finite bounded number hops In practice life quite easy Links routers go come back operation different routers may different ideas current topology Also quietly finessed issue whether router individually acquire information base sink tree computation whether information collected means We come back issues shortly Nevertheless optimality principle sink tree provide benchmark routing algorithms measured 366 THE NETWORK LAYER 5 2 2 Shortest Path Algorithm Let us begin study routing algorithms simple technique computing optimal paths given complete picture network These paths ones want distributed routing algorithm find even though routers may know details network The idea build graph network node graph representing router edge graph representing communication line link To choose route given pair routers algorithm finds shortest path graph The concept shortest path deserves explanation One way measuring path length number hops Using metric paths ABC ABE equally long Another metric geographic distance kilometers case ABC clearly much longer ABE assuming figure drawn scale B2 A E D F A E G 6 A H B 2 A A G 6 A c B 2 A A b C 9 B E 4 B F B 2 A D A H H E 4 B F 6 E D 1 H E 4 B F 6 E H 9 G e D C 9 B G 5 E C 9 B G 5 E F G C B 2 A C B 2 A D A C 9 B E 4 B F 6 E G 5 E H 8 F f The first six steps used computing shortest path A D The arrows indicate working node D SEC 5 2 ROUTING ALGORITHMS However many metrics besides hops physical distance also possible For example edge could labeled mean delay standard test packet measured hourly runs With graph labeling shortest path fastest path rather path fewest edges kilometers In general case labels edges could computed function distance bandwidth average traffic communication cost measured delay factors By changing weighting function algorithm would compute shortest path measured according one number criteria combination criteria Several algorithms computing shortest path two nodes graph known This one due Dijkstra 1959 finds shortest paths source destinations network Each node labeled parentheses distance source node along best known path The distances must non negative based real quantities like bandwidth delay Initially paths known nodes labeled infinity As algorithm proceeds paths found labels may change reflecting better paths A label may either tentative permanent Initially labels tentative When discovered label represents shortest possible path source node made permanent never changed thereafter To illustrate labeling algorithm works look weighted undirected graph weights represent example distance We want find shortest path A D We start marking node A permanent indicated filled circle Then examine turn nodes adjacent A working node relabeling one distance A Whenever node relabeled also label node probe made reconstruct final path later If network one shortest path A D wanted find would need remember probe nodes could reach node distance Having examined nodes adjacent A examine tentatively labeled nodes whole graph make one smallest label permanent shown b This one becomes new working node We start B examine nodes adjacent If sum label B distance B node considered less label node shorter path node relabeled After nodes adjacent working node inspected tentative labels changed possible entire graph searched tentatively labeled node smallest value This node made permanent becomes working node next round shows first six steps algorithm To see algorithm works look c At point made E permanent Suppose shorter path ABE say 368 THE NETWORK LAYER AXYZE X Y There two possibilities either node Z already made permanent If E already probed round following one Z made permanent AXYZE path escaped attention thus shorter path Now consider case Z still tentatively labeled If label Z greater equal E AXYZE shorter path ABE If label less E Z E become permanent first allowing E probed Z This algorithm given The global variables n dist describe graph initialized shortest path called The difference program algorithm described compute shortest path starting terminal node rather source node Since shortest paths undirected graph shortest paths matter end begin The reason searching backward node labeled predecessor rather successor When final path copied output variable path path thus reversed The two reversal effects cancel answer produced correct order 5 2 3 Flooding When routing algorithm implemented router must make decisions based local knowledge complete picture network A simple local technique flooding every incoming packet sent every outgoing line except one arrived Flooding obviously generates vast numbers duplicate packets fact infinite number unless measures taken damp process One measure hop counter contained header packet decremented hop packet discarded counter reaches zero Ideally hop counter initialized length path source destination If sender know long path initialize counter worst case namely full diameter network Flooding hop count produce exponential number duplicate packets hop count grows routers duplicate packets seen A better technique damming flood routers keep track packets flooded avoid sending second time One way achieve goal source router put sequence number packet receives hosts Each router needs list per source router telling sequence numbers originating source already seen If incoming packet list flooded SEC 5 2 ROUTING ALGORITHMS define MAX NODES 1024 define INFINITY 1000000000 int n dist MAX NODES MAX NODES maximum number nodes number larger every maximum path dist j distance j void shortest path int int int path struct state int predecessor int length enum permanent tentative label state MAX NODES path worked previous node length source node label state int k min struct state p p state 0 p state n p initialize state p predecessor 1 p length INFINITY p label tentative state length 0 state label permanent k k initial working node Is better path k 0 n graph n nodes dist k 0 state label tentative state k length dist k state length state predecessor k state length state k length dist k Find tentatively labeled node smallest label k 0 min INFINITY 0 n state label tentative state length min min state length k state k label permanent k Copy path output array 0 k path k k state k predecessor k 0 Dijkstra algorithm compute shortest path graph To prevent list growing without bound list augmented counter k meaning sequence numbers k seen When packet comes easy check packet already 370 THE NETWORK LAYER flooded comparing sequence number k discarded Furthermore full list k needed since k effectively summarizes Flooding practical sending packets important uses First ensures packet delivered every node network This may wasteful single destination needs packet effective broadcasting information In wireless networks messages transmitted station received stations within radio range fact flooding algorithms utilize property Second flooding tremendously robust Even large numbers routers blown bits e g military network located war zone flooding find path one exists get packet destination Flooding also requires little way setup The routers need know neighbors This means flooding used building block routing algorithms efficient need way setup Flooding also used metric routing algorithms compared Flooding always chooses shortest path chooses every possible path parallel Consequently algorithm produce shorter delay ignore overhead generated flooding process 5 2 4 Distance Vector Routing Computer networks generally use dynamic routing algorithms complex flooding efficient find shortest paths current topology Two dynamic algorithms particular distance vector routing link state routing popular In section look former algorithm In following section study latter algorithm A distance vector routing algorithm operates router maintain table e vector giving best known distance destination link use get These tables updated exchanging information neighbors Eventually every router knows best link reach destination The distance vector routing algorithm sometimes called names commonly distributed Bellman Ford routing algorithm researchers developed Bellman 1957 Ford Fulkerson 1962 It original ARPANET routing algorithm also used Internet name RIP In distance vector routing router maintains routing table indexed containing one entry router network This entry two parts preferred outgoing line use destination estimate distance destination The distance might measured number hops using another metric discussed computing shortest paths The router assumed know distance neighbors If metric hops distance one hop If metric propagation delay SEC 5 2 ROUTING ALGORITHMS router measure directly special ECHO packets receiver timestamps sends back fast As example assume delay used metric router knows delay neighbors Once every T msec router sends neighbor list estimated delays destination It also receives similar list neighbor Imagine one tables come neighbor X Xi X estimate long takes get router If router knows delay X msec also knows reach router via X Xi msec By performing calculation neighbor router find estimate seems best use estimate corresponding link new routing table Note old routing table used calculation This updating process illustrated Part shows network The first four columns part b show delay vectors received neighbors router J A claims 12 msec delay B 25 msec delay C 40msec delay D etc Suppose J measured estimated delay neighbors A I H K 8 10 12 6 msec respectively Router A E I B C F G J K D H L New estimated delay J To A I H K Line A 0208 A B 123120 A C 251928 I820 H D 40 E 143017 I F 231930 I G 18618 H H 17012 H I 211410 I J 970 K 24226 K L 29915 K JA JI JH JK delay delay delay delay New routing table106 J Vectors received J four neighbors b A network b Input A I H K new routing table J Consider J computes new route router G It knows get A 8 msec furthermore A claims able get G 18 msec J knows count delay 26 msec G forwards packets bound G 372 THE NETWORK LAYER A Similarly computes delay G via I H K 41 31 10 18 6 12 37 31 6 msec respectively The best values 18 makes entry routing table delay G 18 msec route use via H The calculation performed destinations new routing table shown last column figure The Count Infinity Problem The settling routes best paths across network called convergence Distance vector routing useful simple technique routers collectively compute shortest paths serious drawback practice although converges correct answer may slowly In particular reacts rapidly good news leisurely bad news Consider router whose best route destination X long If next exchange neighbor A suddenly reports short delay X router switches using line A send traffic X In one vector exchange good news processed To see fast good news propagates consider five node linear network delay metric number hops Suppose A initially routers know In words recorded delay A infinity A B C D E 11 23 Initially After 1 exchange After 2 exchanges After 3 exchanges 4 After 4 exchanges A B C D E 357246357446 Initially After 1 exchange After 2 exchanges After 3 exchanges After 4 exchanges After 5 exchanges After 6 exchanges b The count infinity problem When A comes routers learn via vector exchanges For simplicity assume gigantic gong somewhere struck periodically initiate vector exchange routers simultaneously At time first exchange B learns left hand neighbor zero delay A B makes entry routing table indicating A one hop away left All routers still think A At point routing table entries A shown second row On next SEC 5 2 ROUTING ALGORITHMS exchange C learns B path length 1 A updates routing table indicate path length 2 D E hear good news later Clearly good news spreading rate one hop per exchange In network whose longest path length N hops within N exchanges everyone know newly revived links routers Now let us consider situation b links routers initially Routers B C D E distances A 1 2 3 4 hops respectively Suddenly either A goes link A B cut effectively thing B point view At first packet exchange B hear anything A Fortunately C says Do worry I path A length 2 Little B suspect C path runs B For B knows C might ten links separate paths A length 2 As result B thinks reach A via C path length 3 D E update entries A first exchange On second exchange C notices neighbors claims path A length 3 It picks one random makes new distance A 4 shown third row b Subsequent exchanges produce history shown rest b From figure clear bad news travels slowly router ever value one higher minimum neighbors Gradually routers work way infinity number exchanges required depends numerical value used infinity For reason wise set infinity longest path plus 1 Not entirely surprisingly problem known count infinity problem There many attempts solve example preventing routers advertising best paths back neighbors heard split horizon poisoned reverse rule discussed RFC 1058 However none heuristics work well practice despite colorful names The core problem X tells Y path somewhere Y way knowing whether path 5 2 5 Link State Routing Distance vector routing used ARPANET 1979 replaced link state routing The primary problem caused demise algorithm often took long converge network topology changed due count infinity problem Consequently replaced entirely new algorithm called link state routing Variants link state routing called IS IS OSPF routing algorithms widely used inside large networks Internet today The idea behind link state routing fairly simple stated five parts Each router must following things make work 374 THE NETWORK LAYER 1 Discover neighbors learn network addresses 2 Set distance cost metric neighbors 3 Construct packet telling learned 4 Send packet receive packets routers 5 Compute shortest path every router In effect complete topology distributed every router Then Dijkstra algorithm run router find shortest path every router Below consider five steps detail Learning Neighbors When router booted first task learn neighbors It accomplishes goal sending special HELLO packet point point line The router end expected send back reply giving name These names must globally unique distant router later hears three routers connected F essential determine whether three mean F When two routers connected broadcast link e g switch ring classic Ethernet situation slightly complicated illustrates broadcast LAN three routers A C F directly connected Each routers connected one additional routers shown H Router B D E G D I E G H F I B A C C F A LAN N b Nine routers broadcast LAN b A graph model The broadcast LAN provides connectivity pair attached routers However modeling LAN many point point links increases size SEC 5 2 ROUTING ALGORITHMS topology leads wasteful messages A better way model LAN consider node shown b Here introduced new artificial node N A C F connected One designated router LAN selected play role N routing protocol The fact possible go A C LAN represented path ANC Setting Link Costs The link state routing algorithm requires link distance cost metric finding shortest paths The cost reach neighbors set automatically configured network operator A common choice make cost inversely proportional bandwidth link For example 1 Gbps Ethernet may cost 1 100 Mbps Ethernet cost 10 This makes higher capacity paths better choices If network geographically spread delay links may factored cost paths shorter links better choices The direct way determine delay send line special ECHO packet side required send back immediately By measuring round trip time dividing two sending router get reasonable estimate delay Building Link State Packets Once information needed exchange collected next step router build packet containing data The packet starts identity sender followed sequence number age described later list neighbors The cost neighbor also given An example network presented costs shown labels lines The corresponding link state packets six routers shown Fig 512 b B A DE A Link B C D Packets E F Seq Age Seq Age Seq Age Seq Age Seq Age Seq Age B 4 E 5 A 4 C 2 B 2 D 3 C 3 F 7 A 5 C 1 B 6 D 7 F E 1 F E 8 C F State b A network b The link state packets network 376 THE NETWORK LAYER Building link state packets easy The hard part determining build One possibility build periodically regular intervals Another possibility build significant event occurs line neighbor going coming back changing properties appreciably Distributing Link State Packets The trickiest part algorithm distributing link state packets All routers must get link state packets quickly reliably If different routers using different versions topology routes compute inconsistencies loops unreachable machines problems First describe basic distribution algorithm After give refinements The fundamental idea use flooding distribute link state packets routers To keep flood check packet contains sequence number incremented new packet sent Routers keep track source router sequence pairs see When new link state packet comes checked list packets already seen If new forwarded lines except one arrived If duplicate discarded If packet sequence number lower highest one seen far ever arrives rejected obsolete router recent data This algorithm problems manageable First sequence numbers wrap around confusion reign The solution use 32 bit sequence number With one link state packet per second would take 137 years wrap around possibility ignored Second router ever crashes lose track sequence number If starts 0 next packet sends rejected duplicate Third sequence number ever corrupted 65 540 received instead 4 1 bit error packets 5 65 540 rejected obsolete since current sequence number thought 65 540 The solution problems include age packet sequence number decrement per second When age hits zero information router discarded Normally new packet comes say every 10 sec router information times router six consecutive packets lost unlikely event The Age field also decremented router initial flooding process make sure packet get lost live indefinite period time packet whose age zero discarded Some refinements algorithm make robust When link state packet comes router flooding queued transmission immediately Instead put holding area wait short case links coming going If another link state packet source comes first packet transmitted sequence numbers SEC 5 2 ROUTING ALGORITHMS compared If equal duplicate discarded If different older one thrown To guard errors links link state packets acknowledged The data structure used router B network shown depicted Each row corresponds recently arrived yet fully processed link state packet The table records packet originated sequence number age data In addition send acknowledgement flags B three links A C F respectively The send flags mean packet must sent indicated link The acknowledgement flags mean must acknowledged Send flags ACK flags Source Seq Age A C F A C F A F E C D Data The packet buffer router B In link state packet A arrives directly must sent C F acknowledged A indicated flag bits Similarly packet F forwarded A C acknowledged F However situation third packet E different It arrives twice via EAB via EFB Consequently sent C must acknowledged A F indicated bits If duplicate arrives original still buffer bits changed For example copy C state arrives F fourth entry table forwarded six bits changed 100011 indicate packet must acknowledged F sent Computing New Routes Once router accumulated full set link state packets construct entire network graph every link represented Every link fact represented twice direction The different directions may even different costs The shortest path computations may find different paths router A B router B A Now Dijkstra algorithm run locally construct shortest paths possible destinations The results algorithm tell router link 378 THE NETWORK LAYER use reach destination This information installed routing tables normal operation resumed Compared distance vector routing link state routing requires memory computation For network n routers k neighbors memory required store input data proportional kn least large routing table listing destinations Also computation time grows faster kn even efficient data structures issue large networks Nevertheless many practical situations link state routing works well suffer slow convergence problems Link state routing widely used actual networks words example protocols order Many ISPs use IS IS Intermediate System Intermediate System link state protocol Oran 1990 It designed early network called DECnet later adopted ISO use OSI protocols modified handle protocols well notably IP OSPF Open Shortest Path First main link state protocol It designed IETF several years IS IS adopted many innovations designed IS IS These innovations include self stabilizing method flooding link state updates concept designated router LAN method computing supporting path splitting multiple metrics As consequence little difference IS IS OSPF The important difference IS IS carry information multiple network layer protocols time e g IP IPX AppleTalk OSPF feature advantage large multiprotocol environments We go OSPF Sec 5 6 6 A general comment routing algorithms also order Link state distance vector algorithms rely processing routers compute routes Problems hardware software even small number routers wreak havoc across network For example router claims link forgets link network graph incorrect If router fails forward packets corrupts forwarding route work expected Finally runs memory routing calculation wrong bad things happen As network grows range tens hundreds thousands nodes probability router failing occasionally becomes nonnegligible The trick try arrange limit damage inevitable happens Perlman 1988 discusses problems possible solutions detail 5 2 6 Hierarchical Routing As networks grow size router routing tables grow proportionally Not router memory consumed ever increasing tables CPU time needed scan bandwidth needed send status reports At certain point network may grow point longer SEC 5 2 ROUTING ALGORITHMS feasible every router entry every router routing done hierarchically telephone network When hierarchical routing used routers divided call regions Each router knows details route packets destinations within region knows nothing internal structure regions When different networks interconnected natural regard one separate region free routers one network know topological structure ones For huge networks two level hierarchy may insufficient may necessary group regions clusters clusters zones zones groups run names aggregations As example multilevel hierarchy consider packet might routed Berkeley California Malindi Kenya The Berkeley router would know detailed topology within California would send state traffic Los Angeles router The Los Angeles router would able route traffic directly domestic routers would send foreign traffic New York The New York router would programmed direct traffic router destination country responsible handling foreign traffic say Nairobi Finally packet would work way tree Kenya got Malindi gives quantitative example routing two level hierarchy five regions The full routing table router 1A 17 entries shown b When routing done hierarchically c entries local routers regions condensed single router traffic region 2 goes via 1B 2A line rest remote traffic goes via 1C 3B line Hierarchical routing reduced table 17 7 entries As ratio number regions number routers per region grows savings table space increase Unfortunately gains space free There penalty paid increased path length For example best route 1A 5C via region 2 hierarchical routing traffic region 5 goes via region 3 better destinations region 5 When single network becomes large interesting question many levels hierarchy For example consider network 720 routers If hierarchy router needs 720 routing table entries If network partitioned 24 regions 30 routers router needs 30 local entries plus 23 remote entries total 53 entries If three level hierarchy chosen 8 clusters containing 9 regions 10 routers router needs 10 entries local routers 8 entries routing regions within cluster 7 entries distant clusters total 25 entries Kamoun Kleinrock 1979 discovered optimal number levels N router network ln N requiring total e ln N entries per router They also shown increase effective mean path length caused hierarchical routing sufficiently small usually acceptable 380 THE NETWORK LAYER Full table 1A Hierarchical table 1A Dest Region 1 Region 2 1B 2A 2B 1A 1C 2C 5B 4A 3A 3B Region 3 4B 2D 5C 5A 4C Region 4 5D 5E Region 5 1A Hops Dest 1A Line Hops 1B 1B 1B 1B 1C 2A 1C 1C 1B 2B 2C 1B 1B 3 1C3 1B 1C 2 2D 1B 1C 1C 4 3A 3B 4A 1C 1C 2 1C 1C 4 1C 1C 4 1C 1B 1C 5 4B 4C 5A 5B 5C 5D 5E Line 1C b c Hierarchical routing 5 2 7 Broadcast Routing In applications hosts need send messages many hosts For example service distributing weather reports stock market updates live radio programs might work best sending machines letting interested read data Sending packet destinations simultaneously called broadcasting Various methods proposed One broadcasting method requires special features network source simply send distinct packet destination Not method wasteful bandwidth slow also requires source complete list destinations This method desirable practice even though widely applicable An improvement multidestination routing packet contains either list destinations bit map indicating desired destinations When packet arrives router router checks destinations determine set output lines needed An output line needed best route least one destinations The router generates new copy packet output line used includes packet destinations use line In effect destination set partitioned among SEC 5 2 ROUTING ALGORITHMS output lines After sufficient number hops packet carry one destination like normal packet Multidestination routing like using separately addressed packets except several packets must follow route one pays full fare rest ride free The network bandwidth therefore used efficiently However scheme still requires source know destinations plus much work router determine send one multidestination packet multiple distinct packets We already seen better broadcast routing technique flooding When implemented sequence number per source flooding uses links efficiently decision rule routers relatively simple Although flooding illsuited ordinary point point communication rates serious consideration broadcasting However turns better still shortest path routes regular packets computed The idea reverse path forwarding elegant remarkably simple pointed Dalal Metcalfe 1978 When broadcast packet arrives router router checks see packet arrived link normally used sending packets toward source broadcast If excellent chance broadcast packet followed best route router therefore first copy arrive router This case router forwards copies onto links except one arrived If however broadcast packet arrived link preferred one reaching source packet discarded likely duplicate B C A F E J L O K M F F I G N I D E I H C B A D H G H E J K N A D G O M E C D N K H B L L B O J L N G O K H M b c Reverse path forwarding A network b A sink tree c The tree built reverse path forwarding An example reverse path forwarding shown Part shows network part b shows sink tree router I network part c shows reverse path algorithm works On first hop I sends packets F H J N indicated second row tree Each packets arrives preferred path I assuming preferred path falls along sink tree indicated circle around letter On second hop 382 THE NETWORK LAYER eight packets generated two routers received packet first hop As turns eight arrive previously unvisited routers five arrive along preferred line Of six packets generated third hop three arrive preferred path C E K others duplicates After five hops 24 packets broadcasting terminates compared four hops 14 packets sink tree followed exactly The principal advantage reverse path forwarding efficient easy implement It sends broadcast packet link direction flooding yet requires routers know reach destinations without needing remember sequence numbers use mechanisms stop flood list destinations packet Our last broadcast algorithm improves behavior reverse path forwarding It makes explicit use sink tree convenient spanning tree router initiating broadcast A spanning tree subset network includes routers contains loops Sink trees spanning trees If router knows lines belong spanning tree copy incoming broadcast packet onto spanning tree lines except one arrived This method makes excellent use bandwidth generating absolute minimum number packets necessary job In example sink tree part b used spanning tree broadcast packet sent minimum 14 packets The problem router must knowledge spanning tree method applicable Sometimes information available e g link state routing routers know complete topology compute spanning tree sometimes e g distance vector routing 5 2 8 Multicast Routing Some applications multiplayer game live video sports event streamed many viewing locations send packets multiple receivers Unless group small sending distinct packet receiver expensive On hand broadcasting packet wasteful group consists say 1000 machines million node network receivers interested message worse yet definitely interested supposed see Thus need way send messages well defined groups numerically large size small compared network whole Sending message group called multicasting routing algorithm used called multicast routing All multicasting schemes require way create destroy groups identify routers members group How tasks accomplished concern routing algorithm For assume group identified multicast address routers know groups belong We revisit group membership describe network layer Internet Sec 5 6 SEC 5 2 ROUTING ALGORITHMS Multicast routing schemes build broadcast routing schemes already studied sending packets along spanning trees deliver packets members group making efficient use bandwidth However best spanning tree use depends whether group dense receivers scattered network sparse much network belonging group In section consider cases If group dense broadcast good start efficiently gets packet parts network But broadcast reach routers members group wasteful The solution explored Deering Cheriton 1990 prune broadcast spanning tree removing links lead members The result efficient multicast spanning tree As example consider two groups 1 2 network shown Some routers attached hosts belong one groups indicated figure A spanning tree leftmost router shown b This tree used broadcast overkill multicast seen two pruned versions shown next In c links lead hosts members group 1 removed The result multicast spanning tree leftmost router send group 1 Packets forwarded along spanning tree efficient broadcast tree 7 links instead 10 shows multicast spanning tree pruning group 2 It efficient five links time It also shows different multicast groups different spanning trees Various ways pruning spanning tree possible The simplest one used link state routing used router aware complete topology including hosts belong groups Each router construct pruned spanning tree sender group question constructing sink tree sender usual removing links connect group members sink node MOSPF Multicast OSPF example link state protocol works way Moy 1994 With distance vector routing different pruning strategy followed The basic algorithm reverse path forwarding However whenever router hosts interested particular group connections routers receives multicast message group responds PRUNE message telling neighbor sent message send multicasts sender group When router group members among hosts received messages lines sends multicast respond PRUNE message In way spanning tree recursively pruned DVMRP Distance Vector Multicast Routing Protocol example multicast routing protocol works way Waitzman et al 1988 Pruning results efficient spanning trees use links actually needed reach members group One potential disadvantage lots work routers especially large networks Suppose network 384 THE NETWORK LAYER 1 2 1 2 1 2 1 2 2 b 21 1 c A network b A spanning tree leftmost router c A multicast tree group 1 A multicast tree group 2 n groups average nodes At router group pruned spanning trees must stored total mn trees For example c gives spanning tree leftmost router send group 1 The spanning tree rightmost router send group 1 shown look quite different packets head directly group members rather via left side graph This turn means routers must forward packets destined group 1 different directions depending node sending group When many large groups many senders exist considerable storage needed store trees An alternative design uses core based trees compute single spanning tree group Ballardie et al 1993 All routers agree root called core rendezvous point build tree sending packet member root The tree union paths traced packets shows core based tree group 1 To send group sender sends packet core When packet reaches core forwarded tree This shown b sender righthand side network As performance optimization packets destined group need reach core multicast As soon packet reaches SEC 5 2 ROUTING ALGORITHMS tree forwarded toward root well branches This case sender top b Sender Core Sender Core 1 b Core based tree group 1 b Sending group 1 Having shared tree optimal sources For example Fig 517 b packet sender righthand side reaches top right group member via core three hops instead directly The inefficiency depends core senders located often reasonable core middle senders When single sender video streamed group using sender core optimal Also note shared trees major savings storage costs messages sent computation Each router keep one tree per group instead trees Further routers part tree work support group For reason shared tree approaches like core based trees used multicasting sparse groups Internet part popular protocols PIM Protocol Independent Multicast Fenner et al 2006 5 2 9 Anycast Routing So far covered delivery models source sends single destination called unicast destinations called broadcast group destinations called multicast Another delivery model called anycast sometimes also useful In anycast packet delivered nearest member group Partridge et al 1993 Schemes find paths called anycast routing Why would want anycast Sometimes nodes provide service time day content distribution getting right information matters node contacted node For example anycast used Internet part DNS see Chap 7 Luckily devise new routing schemes anycast regular distance vector link state routing produce anycast routes Suppose 386 THE NETWORK LAYER want anycast members group 1 They given address 1 instead different addresses Distance vector routing distribute vectors usual nodes choose shortest path destination 1 This result nodes sending nearest instance destination 1 The routes shown This procedure works routing protocol realize multiple instances destination 1 That believes instances node 1 node topology shown b 1 b Anycast routes group 1 b Topology seen routing protocol This procedure works link state routing well although added consideration routing protocol must find seemingly short paths pass node 1 This would result jumps hyperspace since instances node 1 really nodes located different parts network However link state protocols already make distinction routers hosts We glossed fact earlier needed discussion 5 2 10 Routing Mobile Hosts Millions people use computers go truly mobile situations wireless devices moving cars nomadic situations laptop computers used series different locations We use term mobile hosts mean either category distinct stationary hosts never move Increasingly people want stay connected wherever world may easily home These mobile hosts introduce new complication route packet mobile host network first find The model world consider one hosts assumed permanent home location never changes Each hosts also permanent home address used determine home location analogous way telephone number 1 212 5551212 indicates United States country code 1 Manhattan 212 The routing goal systems SEC 5 2 ROUTING ALGORITHMS mobile hosts make possible send packets mobile hosts using fixed home addresses packets efficiently reach wherever may The trick course find Some discussion model order A different model would recompute routes mobile host moves topology changes We could simply use routing schemes described earlier section However growing number mobile hosts model would soon lead entire network endlessly computing new routes Using home addresses greatly reduces burden Another alternative would provide mobility network layer typically happens laptops today When moved new Internet locations laptops acquire new network addresses There association old new addresses network know belonged laptop In model laptop used browse Web hosts send packets example incoming call without building higher layer location service example signing Skype moving Moreover connections maintained host moving new connections must started instead Network layer mobility useful fix problems The basic idea used mobile routing Internet cellular networks mobile host tell host home location This host acts behalf mobile host called home agent Once knows mobile host currently located forward packets delivered shows mobile routing action A sender northwest city Seattle wants send packet host normally located across United States New York The case interest us mobile host home Instead temporarily San Diego The mobile host San Diego must acquire local network address use network This happens normal way hosts obtain network addresses cover works Internet later chapter The local address called care address Once mobile host address tell home agent It sending registration message home agent step 1 care address The message shown dashed line indicate control message data message Next sender sends data packet mobile host using permanent address step 2 This packet routed network host home location home address belongs In New York home agent intercepts packet mobile host away home It wraps encapsulates packet new header sends bundle care address step 3 This mechanism called tunneling It important Internet look detail later 388 THE NETWORK LAYER 2 Sen ho Sender 5 Tunnel care address ad dress 4 Reply sender ister 1 Reg ss f addre care care unnel ress add 3 T Home agent home address Mobile host care address Packet routing mobile hosts When encapsulated packet arrives care address mobile host unwraps retrieves packet sender The mobile host sends reply packet directly sender step 4 The overall route called triangle routing may circuitous remote location far home location As part step 4 sender may learn current care address Subsequent packets routed directly mobile host tunneling care address step 5 bypassing home location entirely If connectivity lost reason mobile moves home address always used reach mobile An important aspect omitted description security In general host router gets message form Starting right please send Stephany mail might couple questions talking whether good idea Security information included messages validity checked cryptographic protocols study Chap 8 There many variations mobile routing The scheme modeled IPv6 mobility form mobility used Internet Johnson et al 2004 part IP based cellular networks UMTS We showed sender stationary node simplicity designs let nodes mobile hosts Alternatively host may part mobile network example computer plane Extensions basic scheme support mobile networks work part hosts Devarapalli et al 2005 Some schemes make use foreign e remote agent similar home agent foreign location analogous VLR Visitor Location Register cellular networks However recent schemes foreign agent needed mobile hosts act foreign agents In either case knowledge temporary location mobile host limited small number SEC 5 2 ROUTING ALGORITHMS hosts e g mobile home agent senders many routers large network need recompute routes For information mobile routing see also Perkins 1998 2002 Snoeren Balakrishnan 2000 5 2 11 Routing Ad Hoc Networks We seen routing hosts mobile routers fixed An even extreme case one routers mobile Among possibilities emergency workers earthquake site military vehicles battlefield fleet ships sea gathering people laptop computers area lacking 802 11 In cases others node communicates wirelessly acts host router Networks nodes happen near called ad hoc networks MANETs Mobile Ad hoc NETworks Let us examine briefly More information found Perkins 2001 What makes ad hoc networks different wired networks topology suddenly tossed window Nodes come go appear new places drop bit With wired network router valid path destination path continues valid barring failures hopefully rare With ad hoc network topology may changing time desirability even validity paths change spontaneously without warning Needless say circumstances make routing ad hoc networks challenging routing fixed counterparts Many many routing algorithms ad hoc networks proposed However since ad hoc networks little used practice compared mobile networks unclear protocols useful As example look one popular routing algorithms AODV Ad hoc On demand Distance Vector Perkins Royer 1999 It relative distance vector algorithm adapted work mobile environment nodes often limited bandwidth battery lifetimes Let us see discovers maintains routes Route Discovery In AODV routes destination discovered demand somebody wants send packet destination This saves much work would otherwise wasted topology changes route used At instant topology ad hoc network described graph connected nodes Two nodes connected e arc graph communicate directly using radios A basic adequate model sufficient purposes node communicate nodes lie within coverage circle Real networks 390 THE NETWORK LAYER complicated buildings hills obstacles block communication nodes A connected B B connected A A powerful transmitter B However simplicity assume connections symmetric To describe algorithm consider newly formed ad hoc network Suppose process node A wants send packet node I The AODV algorithm maintains distance vector table node keyed destination giving information destination including neighbor send packets reach destination First A looks table find entry I It discover route I This property discovering routes needed makes algorithm demand Range A broadcast A B A B C D D E F F b B F H E F G I c C D G I H A C E G I B D E G H A C H I Range A broadcast b After B D receive c After C F G receive After E H I receive The shaded nodes new recipients The dashed lines show possible reverse routes The solid lines show discovered route To locate I A constructs ROUTE REQUEST packet broadcasts using flooding described Sec 5 2 3 The transmission A reaches B D illustrated Each node rebroadcasts request continues reach nodes F G C c nodes H E I A sequence number set source used weed duplicates flood For example D discards transmission B c already forwarded request Eventually request reaches node I constructs ROUTE REPLY packet This packet unicast sender along reverse path followed request For work intermediate node must remember node sent request The arrows b show reverse route information stored Each intermediate node also increments hop count forwards reply This tells nodes far destination The replies tell intermediate node neighbor use reach destination node sent reply Intermediate nodes G D put SEC 5 2 ROUTING ALGORITHMS best route hear routing tables process reply When reply reaches A new route ADGI created In large network algorithm generates many broadcasts even destinations close To reduce overhead scope broadcasts limited using IP packet Time live field This field initialized sender decremented hop If hits 0 packet discarded instead broadcast The route discovery process modified follows To locate destination sender broadcasts ROUTE REQUEST packet Time live set 1 If response comes back within reasonable time another one sent time Time live set 2 Subsequent attempts use 3 4 5 etc In way search first attempted locally increasingly wider rings Route Maintenance Because nodes move switched topology change spontaneously For example G switched A realize route using I ADGI longer valid The algorithm needs able deal Periodically node broadcasts Hello message Each neighbors expected respond If response forthcoming broadcaster knows neighbor moved range failed longer connected Similarly tries send packet neighbor respond learns neighbor longer available This information used purge routes longer work For possible destination node N keeps track active neighbors fed packet destination last T seconds When N neighbors becomes unreachable checks routing table see destinations routes using gone neighbor For routes active neighbors informed route via N invalid must purged routing tables In example D purges entries G I routing table notifies A purges entry I In general case active neighbors tell active neighbors recursively routes depending gone node purged routing tables At stage invalid routes purged network senders find new valid routes using discovery mechanism described However complication Recall distance vector protocols suffer slow convergence count infinity problems topology change confuse old invalid routes new valid routes To ensure rapid convergence routes include sequence number controlled destination The destination sequence number like logical clock The destination increments every time sends fresh ROUTE REPLY Senders ask fresh route including ROUTE REQUEST destination sequence number last route used either sequence number route purged 0 initial value The 392 THE NETWORK LAYER request broadcast route higher sequence number found Intermediate nodes store routes higher sequence number fewest hops current sequence number In spirit demand protocol intermediate nodes store routes use Other route information learned broadcasts timed short delay Discovering storing routes used helps save bandwidth battery life compared standard distance vector protocol periodically broadcasts updates So far considered single route A I To save resources route discovery maintenance shared routes overlap For instance B also wants send packets I perform route discovery However case request first reach D already route I Node D generate reply tell B route without additional work required There many ad hoc routing schemes Another well known demand scheme DSR Dynamic Source Routing Johnson et al 2001 A different strategy based geography explored GPSR Greedy Perimeter Stateless Routing Karp Kung 2000 If nodes know geographic positions forwarding destination proceed without route computation simply heading right direction circling back escape dead ends Which protocols win depend kinds ad hoc networks prove useful practice 5 3 CONGESTION CONTROL ALGORITHMS Too many packets present part network causes packet delay loss degrades performance This situation called congestion The network transport layers share responsibility handling congestion Since congestion occurs within network network layer directly experiences must ultimately determine excess packets However effective way control congestion reduce load transport layer placing network This requires network transport layers work together In chapter look network aspects congestion In Chap 6 complete topic covering transport aspects congestion depicts onset congestion When number packets hosts send network well within carrying capacity number delivered proportional number sent If twice many sent twice many delivered However offered load approaches carrying capacity bursts traffic occasionally fill buffers inside routers packets lost These lost packets consume capacity number delivered packets falls ideal curve The network congested SEC 5 3 CONGESTION CONTROL ALGORITHMS Goodput packets sec Ideal Capacity network Desirable response Onset congestion Congestion collapse Offered load packet sec With much traffic performance drops sharply Unless network well designed may experience congestion collapse performance plummets offered load increases beyond capacity This happen packets sufficiently delayed inside network longer useful leave network For example early Internet time packet spent waiting backlog packets ahead sent slow 56 kbps link could reach maximum time allowed remain network It thrown away A different failure mode occurs senders retransmit packets greatly delayed thinking lost In case copies packet delivered network wasting capacity To capture factors axis given goodput rate useful packets delivered network We would like design networks avoid congestion possible suffer congestion collapse become congested Unfortunately congestion wholly avoided If sudden streams packets begin arriving three four input lines need output line queue build If insufficient memory hold packets lost Adding memory may help point Nagle 1987 realized routers infinite amount memory congestion gets worse better This time packets get front queue already timed repeatedly duplicates sent This makes matters worse better leads congestion collapse Low bandwidth links routers process packets slowly line rate also become congested In case situation improved directing traffic away bottleneck parts network Eventually however regions network congested In situation alternative shed load build faster network It worth pointing difference congestion control flow control relationship subtle one Congestion control 394 THE NETWORK LAYER making sure network able carry offered traffic It global issue involving behavior hosts routers Flow control contrast relates traffic particular sender particular receiver Its job make sure fast sender continually transmit data faster receiver able absorb To see difference two concepts consider network made 100 Gbps fiber optic links supercomputer trying force feed large file personal computer capable handling 1 Gbps Although congestion network trouble flow control needed force supercomputer stop frequently give personal computer chance breathe At extreme consider network 1 Mbps lines 1000 large computers half trying transfer files 100 kbps half Here problem fast senders overpowering slow receivers total offered traffic exceeds network handle The reason congestion control flow control often confused best way handle problems get host slow Thus host get slow message either receiver handle load network handle We come back point Chap 6 We start study congestion control looking approaches used different time scales Then look approaches preventing congestion occurring first place followed approaches coping set 5 3 1 Approaches Congestion Control The presence congestion means load temporarily greater resources part network handle Two solutions come mind increase resources decrease load As shown solutions usually applied different time scales either prevent congestion react occurred Network provisioning Traffic aware routing Admission control Traffic throttling Load shedding Slower Preventative Faster Reactive Timescales approaches congestion control The basic way avoid congestion build network well matched traffic carries If low bandwidth link path along traffic directed congestion likely Sometimes resources SEC 5 3 CONGESTION CONTROL ALGORITHMS added dynamically serious congestion example turning spare routers enabling lines normally used backups make system fault tolerant purchasing bandwidth open market More often links routers regularly heavily utilized upgraded earliest opportunity This called provisioning happens time scale months driven long term traffic trends To make existing network capacity routes tailored traffic patterns change day network users wake sleep different time zones For example routes may changed shift traffic away heavily used paths changing shortest path weights Some local radio stations helicopters flying around cities report road congestion make possible mobile listeners route packets cars around hotspots This called traffic aware routing Splitting traffic across multiple paths also helpful However sometimes possible increase capacity The way beat back congestion decrease load In virtual circuit network new connections refused would cause network become congested This called admission control At finer granularity congestion imminent network deliver feedback sources whose traffic flows responsible problem The network request sources throttle traffic slow traffic Two difficulties approach identify onset congestion inform source needs slow To tackle first issue routers monitor average load queueing delay packet loss In cases rising numbers indicate growing congestion To tackle second issue routers must participate feedback loop sources For scheme work correctly time scale must adjusted carefully If every time two packets arrive row router yells STOP every time router idle 20 sec yells GO system oscillate wildly never converge On hand waits 30 minutes make sure saying anything congestion control mechanism react sluggishly use Delivering timely feedback nontrivial matter An added concern routers send messages network already congested Finally else fails network forced discard packets deliver The general name load shedding A good policy choosing packets discard help prevent congestion collapse 5 3 2 Traffic Aware Routing The first approach examine traffic aware routing The routing schemes looked Sec 5 2 used fixed link weights These schemes adapted changes topology changes load The goal taking load 396 THE NETWORK LAYER account computing routes shift traffic away hotspots first places network experience congestion The direct way set link weight function fixed link bandwidth propagation delay plus variable measured load average queuing delay Least weight paths favor paths lightly loaded else equal Traffic aware routing used early Internet according model Khanna Zinky 1989 However peril Consider network divided two parts East West connected two links CF EI Suppose traffic East West using link CF result link heavily loaded long delays Including queueing delay weight used shortest path calculation make EI attractive After new routing tables installed East West traffic go EI loading link Consequently next update CF appear shortest path As result routing tables may oscillate wildly leading erratic routing many potential problems West East G B C F H A E I D J A network East West parts connected two links If load ignored bandwidth propagation delay considered problem occur Attempts include load change weights within narrow range slow routing oscillations Two techniques contribute successful solution The first multipath routing multiple paths source destination In example means traffic spread across East West links The second one routing scheme shift traffic across routes slowly enough able converge scheme Gallagher 1977 Given difficulties Internet routing protocols generally adjust routes depending load Instead adjustments made outside routing protocol slowly changing inputs This called traffic engineering SEC 5 3 CONGESTION CONTROL ALGORITHMS 5 3 3 Admission Control One technique widely used virtual circuit networks keep congestion bay admission control The idea simple set new virtual circuit unless network carry added traffic without becoming congested Thus attempts set virtual circuit may fail This better alternative letting people network busy makes matters worse By analogy telephone system switch gets overloaded practices admission control giving dial tones The trick approach working new virtual circuit lead congestion The task straightforward telephone network fixed bandwidth calls 64 kbps uncompressed audio However virtual circuits computer networks come shapes sizes Thus circuit must come characterization traffic apply admission control Traffic often described terms rate shape The problem describe simple yet meaningful way difficult traffic typically bursty average rate half story For example traffic varies browsing Web difficult handle streaming movie long term throughput bursts Web traffic likely congest routers network A commonly used descriptor captures effect leaky bucket token bucket A leaky bucket two parameters bound average rate instantaneous burst size traffic Since leaky buckets widely used quality service go detail Sec 5 4 Armed traffic descriptions network decide whether admit new virtual circuit One possibility network reserve enough capacity along paths virtual circuits congestion occur In case traffic description service agreement network guarantee users We prevented congestion veered related topic quality service little early return next section Even without making guarantees network use traffic descriptions admission control The task estimate many circuits fit within carrying capacity network without congestion Suppose virtual circuits may blast traffic rates 10 Mbps pass 100Mbps physical link How many circuits admitted Clearly 10 circuits admitted without risking congestion wasteful normal case since may rarely happen 10 transmitting full blast time In real networks measurements past behavior capture statistics transmissions used estimate number circuits admit trade better performance acceptable risk Admission control also combined traffic aware routing considering routes around traffic hotspots part setup procedure For example 398 THE NETWORK LAYER consider network illustrated two routers congested indicated A Congestion A B B Virtual circuit Congestion b A congested network b The portion network congested A virtual circuit A B also shown Suppose host attached router A wants set connection host attached router B Normally connection would pass one congested routers To avoid situation redraw network shown b omitting congested routers lines The dashed line shows possible route virtual circuit avoids congested routers Shaikh et al 1999 give design kind load sensitive routing 5 3 4 Traffic Throttling In Internet many computer networks senders adjust transmissions send much traffic network readily deliver In setting network aims operate onset congestion When congestion imminent must tell senders throttle back transmissions slow This feedback business usual rather exceptional situation The term congestion avoidance sometimes used contrast operating point one network become overly congested Let us look approaches throttling traffic used datagram networks virtual circuit networks Each approach must solve two problems First routers must determine congestion approaching ideally arrived To router continuously monitor resources using Three possibilities utilization output links buffering queued packets inside router number packets lost due insufficient buffering Of possibilities second one useful Averages utilization directly account burstiness SEC 5 3 CONGESTION CONTROL ALGORITHMS traffic utilization 50 may low smooth traffic high highly variable traffic Counts packet losses come late Congestion already set time packets lost The queueing delay inside routers directly captures congestion experienced packets It low time jump burst traffic generates backlog To maintain good estimate queueing delay sample instantaneous queue length made periodically updated according new old 1 constant determines fast router forgets recent history This called EWMA Exponentially Weighted Moving Average It smoothes fluctuations equivalent low pass filter Whenever moves threshold router notes onset congestion The second problem routers must deliver timely feedback senders causing congestion Congestion experienced network relieving congestion requires action behalf senders using network To deliver feedback router must identify appropriate senders It must warn carefully without sending many packets already congested network Different schemes use different feedback mechanisms describe Choke Packets The direct way notify sender congestion tell directly In approach router selects congested packet sends choke packet back source host giving destination found packet The original packet may tagged header bit turned generate choke packets farther along path forwarded usual way To avoid increasing load network time congestion router may send choke packets low rate When source host gets choke packet required reduce traffic sent specified destination example 50 In datagram network simply picking packets random congestion likely cause choke packets sent fast senders packets queue The feedback implicit protocol help prevent congestion yet throttle sender unless causes trouble For reason likely multiple choke packets sent given host destination The host ignore additional chokes fixed time interval reduction traffic takes effect After period choke packets indicate network still congested An example choke packet used early Internet SOURCEQUENCH message Postel 1981 It never caught though partly 400 THE NETWORK LAYER circumstances generated effect clearly specified The modern Internet uses alternative notification design describe next Explicit Congestion Notification Instead generating additional packets warn congestion router tag packet forwards setting bit packet header signal experiencing congestion When network delivers packet destination note congestion inform sender sends reply packet The sender throttle transmissions This design called ECN Explicit Congestion Notification used Internet Ramakrishnan et al 2001 It refinement early congestion signaling protocols notably binary feedback scheme Ramakrishnan Jain 1988 used DECNET architecture Two bits IP packet header used record whether packet experienced congestion Packets unmarked sent illustrated If routers pass congested router mark packet experienced congestion forwarded The destination echo marks back sender explicit congestion signal next reply packet This shown dashed line figure indicate happens IP level e g TCP The sender must throttle transmissions case choke packets Packet Host Congested router Congestion signal Marked packet Host Explicit congestion notification Hop Hop Backpressure At high speeds long distances many new packets may transmitted congestion signaled delay signal takes effect Consider example host San Francisco router A sending traffic host New York router D OC 3 speed 155 Mbps If New York host begins run buffers take 40 msec choke packet get back San Francisco tell slow An ECN indication take even longer delivered via destination Choke packet propagation illustrated second third fourth steps SEC 5 3 CONGESTION CONTROL ALGORITHMS In 40 msec another 6 2 megabits sent Even host San Francisco completely shuts immediately 6 2 megabits pipe continue pour dealt Only seventh diagram New York router notice slower flow An alternative approach choke packet take effect every hop passes shown sequence b Here soon choke packet reaches F F required reduce flow D Doing require F devote buffers connection since source still sending away full blast gives D immediate relief like headache remedy television commercial In next step choke packet reaches E tells E reduce flow F This action puts greater demand E buffers gives F immediate relief Finally choke packet reaches A flow genuinely slows The net effect hop hop scheme provide quick relief point congestion price using buffers upstream In way congestion nipped bud without losing packets The idea discussed detail Mishra et al 1996 5 3 5 Load Shedding When none methods make congestion disappear routers bring heavy artillery load shedding Load shedding fancy way saying routers inundated packets handle throw away The term comes world electrical power generation refers practice utilities intentionally blacking certain areas save entire grid collapsing hot summer days demand electricity greatly exceeds supply The key question router drowning packets packets drop The preferred choice may depend type applications use network For file transfer old packet worth new one This dropping packet 6 keeping packets 7 10 example force receiver work buffer data yet use In contrast real time media new packet worth old one This packets become useless delayed miss time must played user The former policy old better new often called wine latter new better old often called milk people would rather drink new milk old wine alternative More intelligent load shedding requires cooperation senders An example packets carry routing information These packets important regular data packets establish routes lost network may lose connectivity Another example algorithms compressing video like MPEG periodically transmit entire frame send subsequent 402 THE NETWORK LAYER B C A B D C A D Heavy flow E F ok Ch Ch ok e F e E Choke Choke Reduced flow e ok Ch e ok Ch Reduced flow Flow still maximum rate Flow reduced b A choke packet affects source b A choke packet affects hop passes SEC 5 3 CONGESTION CONTROL ALGORITHMS frames differences last full frame In case dropping packet part difference preferable dropping one part full frame future packets depend full frame To implement intelligent discard policy applications must mark packets indicate network important Then packets discarded routers first drop packets least important class next important class Of course unless significant incentive avoid marking every packet VERY IMPORTANT NEVER EVER DISCARD nobody Often accounting money used discourage frivolous marking For example network might let senders send faster service purchased allows mark excess packets low priority Such strategy actually bad idea makes efficient use idle resources allowing hosts use long nobody else interested without establishing right times get tough Random Early Detection Dealing congestion first starts effective letting gum works trying deal This observation leads interesting twist load shedding discard packets buffer space really exhausted The motivation idea Internet hosts yet get congestion signals routers form ECN Instead reliable indication congestion hosts get network packet loss After difficult build router drop packets overloaded Transport protocols TCP thus hardwired react loss congestion slowing source response The reasoning behind logic TCP designed wired networks wired networks reliable lost packets mostly due buffer overruns rather transmission errors Wireless links must recover transmission errors link layer seen network layer work well TCP This situation exploited help reduce congestion By routers drop packets early situation become hopeless time source take action late A popular algorithm called RED Random Early Detection Floyd Jacobson 1993 To determine start discarding routers maintain running average queue lengths When average queue length link exceeds threshold link said congested small fraction packets dropped random Picking packets random makes likely fastest senders see packet drop best option since router tell source causing trouble datagram network The affected sender notice loss acknowledgement transport protocol 404 THE NETWORK LAYER slow The lost packet thus delivering message choke packet implicitly without router sending explicit signal RED routers improve performance compared routers drop packets buffers full though may require tuning work well For example ideal number packets drop depends many senders need notified congestion However ECN preferred option available It works exactly manner delivers congestion signal explicitly rather loss RED used hosts receive explicit signals 5 4 QUALITY OF SERVICE The techniques looked previous sections designed reduce congestion improve network performance However applications customers demand stronger performance guarantees network best could done circumstances Multimedia applications particular often need minimum throughput maximum latency work In section continue study network performance sharper focus ways provide quality service matched application needs This area Internet undergoing long term upgrade An easy solution provide good quality service build network enough capacity whatever traffic thrown The name solution overprovisioning The resulting network carry application traffic without significant loss assuming decent routing scheme deliver packets low latency Performance get better To extent telephone system overprovisioned rare pick telephone get dial tone instantly There simply much capacity available demand almost always met The trouble solution expensive It basically solving problem throwing money Quality service mechanisms let network less capacity meet application requirements well lower cost Moreover overprovisioning based expected traffic All bets traffic pattern changes much With quality service mechanisms network honor performance guarantees makes even traffic spikes cost turning requests Four issues must addressed ensure quality service 1 What applications need network 2 How regulate traffic enters network 3 How reserve resources routers guarantee performance 4 Whether network safely accept traffic SEC 5 4 QUALITY OF SERVICE No single technique deals efficiently issues Instead variety techniques developed use network transport layer Practical quality service solutions combine multiple techniques To end describe two versions quality service Internet called Integrated Services Differentiated Services 5 4 1 Application Requirements A stream packets source destination called flow Clark 1988 A flow might packets connection connection oriented network packets sent one process another process connectionless network The needs flow characterized four primary parameters bandwidth delay jitter loss Together determine QoS Quality Service flow requires Several common applications stringency network requirements listed Note network requirements less demanding application requirements cases application improve service provided network In particular networks need lossless reliable file transfer need deliver packets identical delays audio video playout Some amount loss repaired retransmissions amount jitter smoothed buffering packets receiver However nothing applications remedy situation network provides little bandwidth much delay Application Bandwidth Delay Jitter Loss Email Low Low Low Medium File sharing High Low Low Medium Web access Medium Medium Low Medium Remote login Low Medium Medium Medium Audio demand Low Low High Low Video demand High Low High Low Telephony Low High High Low Videoconferencing High High High Low Stringency applications quality service requirements The applications differ bandwidth needs email audio forms remote login needing much file sharing video forms needing great deal More interesting delay requirements File transfer applications including email video delay sensitive If packets delayed uniformly seconds harm done Interactive applications Web 406 THE NETWORK LAYER surfing remote login delay sensitive Real time applications telephony videoconferencing strict delay requirements If words telephone call delayed long users find connection unacceptable On hand playing audio video files server require low delay The variation e standard deviation delay packet arrival times called jitter The first three applications sensitive packets arriving irregular time intervals Remote login somewhat sensitive since updates screen appear little bursts connection suffers much jitter Video especially audio extremely sensitive jitter If user watching video network frames delayed exactly 2 000 seconds harm done But transmission time varies randomly 1 2 seconds result terrible unless application hides jitter For audio jitter even milliseconds clearly audible The first four applications stringent requirements loss audio video bits must delivered correctly This goal usually achieved retransmissions packets lost network transport layer This wasted work would better network refused packets likely lose first place Audio video applications tolerate lost packets without retransmission people notice short pauses occasional skipped frames To accommodate variety applications networks may support different categories QoS An influential example comes ATM networks part grand vision networking since become niche technology They support 1 Constant bit rate e g telephony 2 Real time variable bit rate e g compressed videoconferencing 3 Non real time variable bit rate e g watching movie demand 4 Available bit rate e g file transfer These categories also useful purposes networks Constant bit rate attempt simulate wire providing uniform bandwidth uniform delay Variable bit rate occurs video compressed frames compressing others Sending frame lot detail may require sending many bits whereas shot white wall may compress extremely well Movies demand actually real time seconds video easily buffered receiver playback starts jitter network merely causes amount stored played video vary Available bit rate applications email sensitive delay jitter take bandwidth get SEC 5 4 QUALITY OF SERVICE 5 4 2 Traffic Shaping Before network make QoS guarantees must know traffic guaranteed In telephone network characterization simple For example voice call uncompressed format needs 64 kbps consists one 8 bit sample every 125 sec However traffic data networks bursty It typically arrives nonuniform rates traffic rate varies e g videoconferencing compression users interact applications e g browsing new Web page computers switch tasks Bursts traffic difficult handle constant rate traffic fill buffers cause packets lost Traffic shaping technique regulating average rate burstiness flow data enters network The goal allow applications transmit wide variety traffic suits needs including bursts yet simple useful way describe possible traffic patterns network When flow set user network e customer provider agree certain traffic pattern e shape flow In effect customer says provider My transmission pattern look like handle Sometimes agreement called SLA Service Level Agreement especially made aggregate flows long periods time traffic given customer As long customer fulfills part bargain sends packets according agreed contract provider promises deliver timely fashion Traffic shaping reduces congestion thus helps network live promise However make work also issue provider tell customer following agreement customer Packets excess agreed pattern might dropped network might marked lower priority Monitoring traffic flow called traffic policing Shaping policing important peer peer transfers consume available bandwidth great importance real time data audio video connections stringent quality service requirements Leaky Token Buckets We already seen one way limit amount data application sends sliding window uses one parameter limit much data transit given time indirectly limits rate Now look general way characterize traffic leaky bucket token bucket algorithms The formulations slightly different give equivalent result 408 THE NETWORK LAYER Try imagine bucket small hole bottom illustrated b No matter rate water enters bucket outflow constant rate R water bucket zero bucket empty Also bucket full capacity B additional water entering spills sides lost Host Rate R Put water Packets B Check bucket Take water tokens B Rate R Network b c Shaping packets b A leaky bucket c A token bucket This bucket used shape police packets entering network shown Conceptually host connected network interface containing leaky bucket To send packet network must possible put water bucket If packet arrives bucket full packet must either queued enough water leaks hold discarded The former might happen host shaping traffic network part operating system The latter might happen hardware provider network interface policing traffic entering network This technique proposed Turner 1986 called leaky bucket algorithm A different equivalent formulation imagine network interface bucket filled shown c The tap running rate R bucket capacity B Now send packet must able take water tokens contents commonly called bucket rather putting water bucket No fixed number tokens B accumulate bucket bucket empty must wait tokens arrive send another packet This algorithm called token bucket algorithm Leaky token buckets limit long term rate flow allow shortterm bursts maximum regulated length pass unaltered without suffering artificial delays Large bursts smoothed leaky bucket traffic shaper reduce congestion network As example imagine computer produce data 1000 Mbps 125 million bytes sec first link network also runs speed The pattern traffic host generates shown This pattern bursty The average SEC 5 4 QUALITY OF SERVICE rate one second 200 Mbps even though host sends burst 16 000 KB top speed 1000 Mbps 1 8 second Rate Mbps 125 MB 125 msec 25 MB 250 msec Bucket KB With R 25 MB B 9600 KB Bucket empties traffic delayed b e With R 25 MB B 0 Bucket always empty Time msec c Time msec f Traffic host Output shaped token bucket rate 200 Mbps capacity b 9600 KB c 0 KB Token bucket level shaping rate 200 Mbps capacity 16 000 KB e 9600 KB f 0 KB Now suppose routers accept data top speed short intervals buffers fill The buffer size 9600 KB smaller traffic burst For long intervals routers work best rates exceeding 200 Mbps say bandwidth given customer The implication traffic sent pattern dropped network fit buffers routers To avoid packet loss shape traffic host token bucket If use rate R 200 Mbps capacity B 9600 KB traffic fall within network handle The output token bucket shown b The host send full throttle 1000 Mbps short drained bucket Then cut back 200 Mbps burst sent The effect spread burst time large handle The level token bucket shown Fig 529 e It starts full depleted initial burst When reaches zero new packets sent rate buffer filling bursts bucket recovered The bucket fills traffic sent stays flat traffic sent fill rate We also shape traffic less bursty c shows output token bucket R 200 Mbps capacity 0 This extreme case 410 THE NETWORK LAYER traffic completely smoothed No bursts allowed traffic enters network steady rate The corresponding bucket level shown f always empty Traffic queued host release network always packet waiting sent allowed Finally shows bucket level token bucket R 200 Mbps capacity B 16 000 KB This smallest token bucket traffic passes unaltered It might used router network police traffic host sends If host sending traffic conforms token bucket agreed network traffic fit token bucket run router edge network If host sends faster burstier rate token bucket run water If happens traffic policer know traffic described It either drop excess packets lower priority depending design network In example bucket empties momentarily end initial burst recovers enough next burst Leaky token buckets easy implement We describe operation token bucket Even though described water flowing continuously bucket real implementations must work discrete quantities A token bucket implemented counter level bucket The counter advanced R T units every clock tick T seconds This would 200 Kbit every 1 msec example Every time unit traffic sent network counter decremented traffic may sent counter reaches zero When packets size bucket level counted packets e g 200 Mbit 20 packets 1250 bytes However often variablesized packets used In case bucket level counted bytes If residual byte count low send large packet packet must wait next tick even longer fill rate small Calculating length maximum burst bucket empties slightly tricky It longer 9600 KB divided 125 MB sec burst output tokens arrive If call burst length S sec maximum output rate M bytes sec token bucket capacity B bytes token arrival rate R bytes sec see output burst contains maximum B RS bytes We also know number bytes maximumspeed burst length S seconds MS Hence B RS MS We solve equation get S B M R For parameters B 9600 KB M 125 MB sec R 25 MB sec get burst time 94 msec A potential problem token bucket algorithm reduces large bursts long term rate R It frequently desirable reduce peak rate without going long term rate also without raising SEC 5 4 QUALITY OF SERVICE long term rate allow traffic network One way get smoother traffic insert second token bucket first one The rate second bucket much higher first one Basically first bucket characterizes traffic fixing average rate allowing bursts The second bucket reduces peak rate bursts sent network For example rate second token bucket set 500 Mbps capacity set 0 initial burst enter network peak rate 500 Mbps lower 1000 Mbps rate previously Using buckets bit tricky When token buckets used traffic shaping hosts packets queued delayed buckets permit sent When token buckets used traffic policing routers network algorithm simulated make sure packets sent permitted Nevertheless tools provide ways shape network traffic manageable forms assist meeting quality service requirements 5 4 3 Packet Scheduling Being able regulate shape offered traffic good start However provide performance guarantee must reserve sufficient resources along route packets take network To assuming packets flow follow route Spraying routers random makes hard guarantee anything As consequence something similar virtual circuit set source destination packets belong flow must follow route Algorithms allocate router resources among packets flow competing flows called packet scheduling algorithms Three different kinds resources potentially reserved different flows 1 Bandwidth 2 Buffer space 3 CPU cycles The first one bandwidth obvious If flow requires 1 Mbps outgoing line capacity 2 Mbps trying direct three flows line going work Thus reserving bandwidth means oversubscribing output line A second resource often short supply buffer space When packet arrives buffered inside router transmitted chosen outgoing line The purpose buffer absorb small bursts traffic flows contend If buffer available packet discarded since place put For good quality service buffers might reserved specific flow flow compete 412 THE NETWORK LAYER buffers flows Up maximum value always buffer available flow needs one Finally CPU cycles may also scarce resource It takes router CPU time process packet router process certain number packets per second While modern routers able process packets quickly kinds packets require greater CPU processing ICMP packets describe Sec 5 6 Making sure CPU overloaded needed ensure timely processing packets Packet scheduling algorithms allocate bandwidth router resources determining buffered packets send output line next We already described straightforward scheduler explaining routers work Each router buffers packets queue output line sent sent order arrived This algorithm known FIFO First In First Out equivalently FCFS First Come First Serve FIFO routers usually drop newly arriving packets queue full Since newly arrived packet would placed end queue behavior called tail drop It intuitive may wondering alternatives exist In fact RED algorithm described Sec 5 3 5 chose newly arriving packet drop random average queue length grew large The scheduling algorithms describe also create opportunities deciding packet drop buffers full FIFO scheduling simple implement suited providing good quality service multiple flows one flow easily affect performance flows If first flow aggressive sends large bursts packets lodge queue Processing packets order arrival means aggressive sender hog capacity routers packets traverse starving flows reducing quality service To add insult injury packets flows get likely delayed sit queue behind many packets aggressive sender Many packet scheduling algorithms devised provide stronger isolation flows thwart attempts interference Bhatti Crowcroft 2000 One first ones fair queueing algorithm devised Nagle 1987 The essence algorithm routers separate queues one flow given output line When line becomes idle router scans queues round robin shown It takes first packet next queue In way n hosts competing output line host gets send one every n packets It fair sense flows get send packets rate Sending packets improve rate Although start algorithm flaw gives bandwidth hosts use large packets hosts use small packets Demers et al 1990 suggested improvement round robin done way SEC 5 4 QUALITY OF SERVICE Round robin service 2 1 2 1 Output lineInput queues Round robin fair queueing simulate byte byte round robin instead packet packet round robin The trick compute virtual time number round packet would finish sent Each round drains byte queues data send The packets sorted order finishing times sent order This algorithm example finish times packets arriving three flows illustrated If packet length L round finish simply L rounds start time The start time either finish time previous packet arrival time packet queue empty arrives Arrives late Arrives D goes first H G E F A D B C Fair queueing 2X Weight 2 Input queues Packet Arrival Length time A8 B6 C10 D9 E8 F6 G10 H8 Finish time11201628 Output order3758 b Weighted Fair Queueing b Finishing times packets From table b looking first two packets top two queues packets arrive order A B D F Packet A arrives round 0 8 bytes long finish time round 8 Similarly finish time packet B 11 Packet D arrives B sent Its finish time 9 byte rounds starts B finishes 20 Similarly finish time F 16 In absence new arrivals relative sending order A B F D even though F arrived D It possible another small packet arrive top flow obtain finish time D It jump ahead D 414 THE NETWORK LAYER transmission packet started Fair queueing preempt packets currently transmitted Because packets sent entirety fair queueing approximation ideal byte byte scheme But good approximation staying within one packet transmission ideal scheme times One shortcoming algorithm practice gives hosts priority In many situations desirable give example video servers bandwidth say file servers This easily possible giving video server two bytes per round This modified algorithm called WFQ Weighted Fair Queueing Letting number bytes per round weight flow W give formula computing finish time Fi max Ai Fi 1 Li W Ai arrival time Fi finish time Li length packet The bottom queue weight 2 packets sent quickly see finish times given b Another practical consideration implementation complexity WFQ requires packets inserted finish time sorted queue With N flows best O logN operation per packet difficult achieve many flows high speed routers Shreedhar Varghese 1995 describe approximation called deficit round robin implemented efficiently O 1 operations per packet WFQ widely used given approximation Other kinds scheduling algorithms exist A simple example priority scheduling packet marked priority High priority packets always sent low priority packets buffered Within priority packets sent FIFO order However priority scheduling disadvantage burst high priority packets starve low priority packets may wait indefinitely WFQ often provides better alternative By giving high priority queue large weight say 3 high priority packets often go short line relatively packets high priority yet fraction low priority packets continue sent even high priority traffic A high low priority system essentially two queue WFQ system high priority infinite weight As final example scheduler packets might carry timestamps sent timestamp order Clark et al 1992 describe design timestamp records far packet behind ahead schedule sent sequence routers path Packets queued behind packets router tend behind schedule packets serviced first tend ahead schedule Sending packets order timestamps beneficial effect speeding slow packets time slowing fast packets The result packets delivered network consistent delay SEC 5 4 QUALITY OF SERVICE 5 4 4 Admission Control We seen necessary elements QoS time put together actually provide QoS guarantees established process admission control We first saw admission control used control congestion performance guarantee albeit weak one The guarantees considering stronger model The user offers flow accompanying QoS requirement network The network decides whether accept reject flow based capacity commitments made flows If accepts network reserves capacity advance routers guarantee QoS traffic sent new flow The reservations must made routers along route packets take network Any routers path without reservations might become congested single congested router break QoS guarantee Many routing algorithms find single best path source destination send traffic best path This may cause flows rejected enough spare capacity along best path QoS guarantees new flows may still accommodated choosing different route flow excess capacity This called QoS routing Chen Nahrstedt 1998 give overview techniques It also possible split traffic destination multiple paths easily find excess capacity A simple method routers choose equal cost paths divide traffic equally proportion capacity outgoing links However sophisticated algorithms also available Nelakuditi Zhang 2002 Given path decision accept reject flow simple matter comparing resources bandwidth buffers cycles requested flow router excess capacity three dimensions It little complicated To start although applications may know bandwidth requirements know buffers CPU cycles minimum different way needed describe flows translate description router resources We get shortly Next applications far tolerant occasional missed deadline others The applications must choose type guarantees network make whether hard guarantees behavior hold time All else equal everyone would like hard guarantees difficulty expensive constrain worst case behavior Guarantees packets often sufficient applications flows guarantee supported fixed capacity Finally applications may willing haggle flow parameters others may For example movie viewer normally runs 30 frames sec may willing drop back 25 frames sec enough free bandwidth support 30 frames sec Similarly number pixels per frame audio bandwidth properties may adjustable 416 THE NETWORK LAYER Because many parties may involved flow negotiation sender receiver routers along path flows must described accurately terms specific parameters negotiated A set parameters called flow specification Typically sender e g video server produces flow specification proposing parameters would like use As specification propagates along route router examines modifies parameters need The modifications reduce flow increase e g lower data rate higher one When gets end parameters established As example flow specification consider example This based RFCs 2210 2211 Integrated Services QoS design cover next section It five parameters The first two parameters token bucket rate token bucket size use token bucket give maximum sustained rate sender may transmit averaged long time interval largest burst send short time interval Parameter Unit Token bucket rate Bytes sec Token bucket size Bytes Peak data rate Bytes sec Minimum packet size Bytes Maximum packet size Bytes An example flow specification The third parameter peak data rate maximum transmission rate tolerated even brief time intervals The sender must never exceed rate even short bursts The last two parameters specify minimum maximum packet sizes including transport network layer headers e g TCP IP The minimum size useful processing packet takes fixed time matter short A router may prepared handle 10 000 packets sec 1 KB prepared handle 100 000 packets sec 50 bytes even though represents lower data rate The maximum packet size important due internal network limitations may exceeded For example part path goes Ethernet maximum packet size restricted 1500 bytes matter rest network handle An interesting question router turns flow specification set specific resource reservations At first glance might appear router link runs say 1 Gbps average packet 1000 bits process 1 million packets sec This observation case though always idle periods link due statistical fluctuations load If SEC 5 4 QUALITY OF SERVICE link needs every bit capacity get work done idling even bits creates backlog never get rid Even load slightly theoretical capacity queues build delays occur Consider situation packets arrive random mean arrival rate packets sec The packets random lengths sent link mean service rate packets sec Under assumption arrival service distributions Poisson distributions called M M 1 queueing system M stands Markov e Poisson proven using queueing theory mean delay experienced packet T T 11 1 1 CPU utilization The first factor 1 service time would absence competition The second factor slowdown due competition flows For example 950 000 packets sec 1 000 000 packets sec 0 95 mean delay experienced packet 20 sec instead 1 sec This time accounts queueing time service time seen load low 0 If say 30 routers along flow route queueing delay alone account 600 sec delay One method relating flow specifications router resources correspond bandwidth delay performance guarantees given Parekh Gallagher 1993 1994 It based traffic sources shaped R B token buckets WFQ routers Each flow given WFQ weight W large enough drain token bucket rate R shown For example flow rate 1 Mbps router output link capacity 1 Gbps weight flow must greater 1 1000th total weights flows router output link This guarantees flow minimum bandwidth If given large enough rate flow admitted R wi W WxC weights Capacity C wi R B Traffic source Router Weighted fair queue Bandwidth delay guarantees token buckets WFQ The largest queueing delay flow see function burst size token bucket Consider two extreme cases If traffic smooth without 418 THE NETWORK LAYER bursts packets drained router quickly arrive There queueing delay ignoring packetization effects On hand traffic saved bursts maximum size burst B may arrive router In case maximum queueing delay D time taken drain burst guaranteed bandwidth B R ignoring packetization effects If delay large flow must request bandwidth network These guarantees hard The token buckets bound burstiness source fair queueing isolates bandwidth given different flows This means flow meet bandwidth delay guarantees regardless competing flows behave router Those flows break guarantee even saving traffic sending Moreover result holds path multiple routers network topology Each flow gets minimum bandwidth bandwidth guaranteed router The reason flow gets maximum delay subtle In worst case burst traffic hits first router competes traffic flows delayed maximum delay D However delay also smooth burst In turn means burst incur queueing delays later routers The overall queueing delay D 5 4 5 Integrated Services Between 1995 1997 IETF put lot effort devising architecture streaming multimedia This work resulted two dozen RFCs starting RFCs 2205 2212 The generic name work integrated services It aimed unicast multicast applications An example former single user streaming video clip news site An example latter collection digital television stations broadcasting programs streams IP packets many receivers various locations Below concentrate multicast since unicast special case multicast In many multicast applications groups change membership dynamically example people enter video conference get bored switch soap opera croquet channel Under conditions approach senders reserve bandwidth advance work well since would require sender track entries exits audience For system designed transmit television millions subscribers would work RSVP The Resource reSerVation Protocol The main part integrated services architecture visible users network RSVP It described RFCs 2205 2210 This protocol used making reservations protocols used sending data SEC 5 4 QUALITY OF SERVICE RSVP allows multiple senders transmit multiple groups receivers permits individual receivers switch channels freely optimizes bandwidth use time eliminating congestion In simplest form protocol uses multicast routing using spanning trees discussed earlier Each group assigned group address To send group sender puts group address packets The standard multicast routing algorithm builds spanning tree covering group members The routing algorithm part RSVP The difference normal multicasting little extra information multicast group periodically tell routers along tree maintain certain data structures memories As example consider network Hosts 1 2 multicast senders hosts 3 4 5 multicast receivers In example senders receivers disjoint general two sets may overlap The multicast trees hosts 1 2 shown b c respectively Senders B E H G K J C A F D I G L J E H K B B A D C A F D I G L J C F E H I K L Receivers b c A network b The multicast spanning tree host 1 c The multicast spanning tree host 2 To get better reception eliminate congestion receivers group send reservation message tree sender The message propagated using reverse path forwarding algorithm discussed earlier At 420 THE NETWORK LAYER hop router notes reservation reserves necessary bandwidth We saw previous section weighted fair queueing scheduler used make reservation If insufficient bandwidth available reports back failure By time message gets back source bandwidth reserved way sender receiver making reservation request along spanning tree An example reservation shown Here host 3 requested channel host 1 Once established packets flow 1 3 without congestion Now consider happens host 3 next reserves channel sender host 2 user watch two television programs A second path reserved illustrated b Note two separate channels needed host 3 router E two independent streams transmitted B E C A F D I G L J B B A D A C E C Bandwidth reserved source 2 F D E F H I G H I L J Bandwidth reserved source 1 H G K J K b K L c Host 3 requests channel host 1 b Host 3 requests second channel host 2 c Host 5 requests channel host 1 Finally c host 5 decides watch program transmitted host 1 also makes reservation First dedicated bandwidth reserved far router H However router sees already feed host 1 necessary bandwidth already reserved reserve Note hosts 3 5 might asked different amounts bandwidth e g host 3 playing small screen wants lowresolution information capacity reserved must large enough satisfy greediest receiver When making reservation receiver optionally specify one sources wants receive It also specify whether choices SEC 5 4 QUALITY OF SERVICE fixed duration reservation whether receiver wants keep open option changing sources later The routers use information optimize bandwidth planning In particular two receivers set share path agree change sources later The reason strategy fully dynamic case reserved bandwidth decoupled choice source Once receiver reserved bandwidth switch another source keep portion existing path valid new source If host 2 transmitting several video streams real time example TV broadcaster multiple channels host 3 may switch without changing reservation routers care program receiver watching 5 4 6 Differentiated Services Flow based algorithms potential offer good quality service one flows reserve whatever resources needed along route However also downside They require advance setup establish flow something scale well thousands millions flows Also maintain internal per flow state routers making vulnerable router crashes Finally changes required router code substantial involve complex router router exchanges setting flows As consequence work continues advance integrated services deployments anything like exist yet For reasons IETF also devised simpler approach quality service one largely implemented locally router without advance setup without whole path involved This approach known class based opposed flow based quality service IETF standardized architecture called differentiated services described RFCs 2474 2475 numerous others We describe Differentiated services offered set routers forming administrative domain e g ISP telco The administration defines set service classes corresponding forwarding rules If customer subscribes differentiated services customer packets entering domain marked class belong This information carried Differentiated services field IPv4 IPv6 packets described Sec 5 6 The classes defined per hop behaviors correspond treatment packet receive router guarantee across network Better service provided packets per hop behaviors e g premium service others e g regular service Traffic within class may required conform specific shape leaky bucket specified drain rate An operator nose business might charge extra premium packet transported might allow N premium packets per month fixed additional monthly fee Note scheme requires advance setup resource 422 THE NETWORK LAYER reservation time consuming end end negotiation flow integrated services This makes differentiated services relatively easy implement Class based service also occurs industries For example package delivery companies often offer overnight two day three day service Airlines offer first class business class cattle class service Long distance trains often multiple service classes Even Paris subway two different service classes For packets classes may differ terms delay jitter probability discarded event congestion among possibilities probably roomier Ethernet frames To make difference flow based quality service class based quality service clearer consider example Internet telephony With flowbased scheme telephone call gets resources guarantees With class based scheme telephone calls together get resources reserved class telephony These resources taken away packets Web browsing class classes telephone call gets private resources reserved alone Expedited Forwarding The choice service classes operator since packets often forwarded networks run different operators IETF defined network independent service classes The simplest class expedited forwarding let us start one It described RFC 3246 The idea behind expedited forwarding simple Two classes service available regular expedited The vast majority traffic expected regular limited fraction packets expedited The expedited packets able transit network though packets present In way get low loss low delay low jitter service needed VoIP A symbolic representation two tube system given Note still one physical line The two logical pipes shown figure represent way reserve bandwidth different classes service second physical line One way implement strategy follows Packets classified expedited regular marked accordingly This step might done sending host ingress first router The advantage classification sending host information available packets belong flows This task may performed networking software even operating system avoid change existing applications For example becoming common VoIP packets marked expedited service hosts If packets pass corporate network ISP supports expedited service receive preferential treatment If network support expedited service harm done SEC 5 4 QUALITY OF SERVICE Expedited packets Regular packets Expedited packets experience traffic free network Of course marking done host ingress router likely police traffic make sure customers sending expedited traffic paid Within network routers may two output queues outgoing line one expedited packets one regular packets When packet arrives queued accordingly The expedited queue given priority regular one example using priority scheduler In way expedited packets see unloaded network even fact heavy load regular traffic Assured Forwarding A somewhat elaborate scheme managing service classes called assured forwarding It described RFC 2597 Assured forwarding specifies shall four priority classes class resources The top three classes might called gold silver bronze In addition defines three discard classes packets experiencing congestion low medium high Taken together two factors define 12 service classes shows one way packets might processed assured forwarding The first step classify packets one four priority classes As step might done sending host shown figure ingress router rate higher priority packets may limited operator part service offering The next step determine discard class packet This done passing packets priority class traffic policer token bucket The policer lets traffic identifies packets fit within small bursts low discard packets exceed small bursts medium discard packets exceed large bursts high discard The combination priority discard class encoded packet Finally packets processed routers network packet scheduler distinguishes different classes A common choice use 424 THE NETWORK LAYER Packets DiffServ mark Gold Silver Policer Classifier Bronze Packet source Four priority classes Twelve priority drop classes Weighted fair queues Router A possible implementation assured forwarding weighted fair queueing four priority classes higher classes given higher weights In way higher classes get bandwidth lower classes starved bandwidth entirely For example weights double one class next higher class higher class get twice bandwidth Within priority class packets higher discard class preferentially dropped running algorithm RED Random Early Detection saw Sec 5 3 5 RED start drop packets congestion builds router run buffer space At stage still buffer space accept low discard packets dropping high discard packets 5 5 INTERNETWORKING Until implicitly assumed single homogeneous network machine using protocol layer Unfortunately assumption wildly optimistic Many different networks exist including PANs LANs MANs WANs We described Ethernet Internet cable fixed mobile telephone networks 802 11 802 16 Numerous protocols widespread use across networks every layer In following sections take careful look issues arise two networks connected form internetwork simply internet It would much simpler join networks together everyone used single networking technology often case dominant kind network Ethernet Some pundits speculate multiplicity technologies go away soon everyone realizes wonderful fill favorite network Do count History shows wishful thinking Different kinds networks grapple different problems example Ethernet satellite networks always likely differ Reusing existing systems running data networks top cable telephone network power SEC 5 5 INTERNETWORKING lines adds constraints cause features networks diverge Heterogeneity stay If always different networks would simpler need interconnect This also unlikely Bob Metcalfe postulated value network N nodes number connections may made nodes N 2 Gilder 1993 This means large networks much valuable small networks allow many connections always incentive combine smaller networks The Internet prime example interconnection We write Internet capital I distinguish internets connected networks The purpose joining networks allow users communicate users ones When pay ISP Internet service may charged depending bandwidth line really paying ability exchange packets host also connected Internet After Internet would popular could send packets hosts city Since networks often differ important ways getting packets one network another always easy We must address problems heterogeneity also problems scale resulting internet grows large We begin looking networks differ see Then shall see approach used successfully IP Internet Protocol network layer protocol Internet including techniques tunneling networks routing internetworks packet fragmentation 5 5 1 How Networks Differ Networks differ many ways Some differences different modulation techniques frame formats internal physical data link layers These differences concern us Instead list differences exposed network layer It papering differences makes internetworking difficult operating within single network When packets sent source one network must transit one foreign networks reaching destination network many problems occur interfaces networks To start source needs able address destination What source Ethernet network destination WiMAX network Assuming even specify WiMAX destination Ethernet network packets would cross connectionless network connection oriented one This may require new connection set short notice injects delay much overhead connection used many packets Many specific differences may accommodated well How multicast packet group members network 426 THE NETWORK LAYER Item Some Possibilities Service offered Connectionless versus connection oriented Addressing Different sizes flat hierarchical Broadcasting Present absent also multicast Packet size Every network maximum Ordering Ordered unordered delivery Quality service Present absent many different kinds Reliability Different levels loss Security Privacy rules encryption etc Parameters Different timeouts flow specifications etc Accounting By connect time packet byte Some many ways networks differ support multicast The differing max packet sizes used different networks major nuisance How pass 8000 byte packet network whose maximum size 1500 bytes If packets connection oriented network transit connectionless network may arrive different order sent That something sender likely expect might come unpleasant surprise receiver well These kinds differences papered effort For example gateway joining two networks might generate separate packets destination lieu better network support multicasting A large packet might broken sent pieces joined back together Receivers might buffer packets deliver order Networks also differ large respects difficult reconcile The clearest example quality service If one network strong QoS offers best effort service impossible make bandwidth delay guarantees real time traffic end end In fact likely made best effort network operated low utilization hardly used unlikely goal ISPs Security mechanisms problematic least encryption confidentiality data integrity layered top networks already include Finally differences accounting lead unwelcome bills normal usage suddenly becomes expensive roaming mobile phone users data plans discovered 5 5 2 How Networks Can Be Connected There two basic choices connecting different networks build devices translate convert packets kind network packets network like good computer scientists try solve SEC 5 5 INTERNETWORKING problem adding layer indirection building common layer top different networks In either case devices placed boundaries networks Early Cerf Kahn 1974 argued common layer hide differences existing networks This approach tremendously successful layer proposed eventually separated TCP IP protocols Almost four decades later IP foundation modern Internet For accomplishment Cerf Kahn awarded 2004 Turing Award informally known Nobel Prize computer science IP provides universal packet format routers recognize passed almost every network IP extended reach computer networks take telephone network It also runs sensor networks tiny devices presumed resource constrained support We discussed several different devices connect networks including repeaters hubs switches bridges routers gateways Repeaters hubs move bits one wire another They mostly analog devices understand anything higher layer protocols Bridges switches operate link layer They used build networks minor protocol translation process example 10 100 1000 Mbps Ethernet switches Our focus section interconnection devices operate network layer namely routers We leave gateways higherlayer interconnection devices later Let us first explore high level interconnection common network layer used interconnect dissimilar networks An internet comprised 802 11 MPLS Ethernet networks shown Suppose source machine 802 11 network wants send packet destination machine Ethernet network Since technologies different separated another kind network MPLS added processing needed boundaries networks Because different networks may general different forms addressing packet carries network layer address identify host across three networks The first boundary packet reaches transitions 802 11 network MPLS network 802 11 provides connectionless service MPLS provides connection oriented service This means virtual circuit must set cross network Once packet traveled along virtual circuit reach Ethernet network At boundary packet may large carried since 802 11 work larger frames Ethernet To handle problem packet divided fragments fragment sent separately When fragments reach destination reassembled Then packet completed journey The protocol processing journey shown b The source accepts data transport layer generates packet common network layer header IP example The network header contains 428 THE NETWORK LAYER Packet Virtual circuit Ethernet MPLS 802 11 Router Source Router Destination Data transport layer IP 802 11 IP 802 11 IP IP IP IP MPLS IP MPLS IP Eth IP Eth IP Physical b A packet crossing different networks b Network link layer protocol processing ultimate destination address used determine packet sent via first router So packet encapsulated 802 11 frame whose destination first router transmitted At router packet removed frame data field 802 11 frame header discarded The router examines IP address packet looks address routing table Based address decides send packet second router next For part path MPLS virtual circuit must established second router packet must encapsulated MPLS headers travel circuit At far end MPLS header discarded network address consulted find next network layer hop It destination Since packet long sent Ethernet split two portions Each portions put data field Ethernet frame sent Ethernet address destination At destination Ethernet header stripped frames contents reassembled The packet finally reached destination Observe essential difference routed case switched bridged case With router packet extracted frame network address packet used deciding send With switch bridge entire frame transported basis MAC address Switches understand network layer protocol used switch packets Routers Unfortunately internetworking easy made sound In fact bridges introduced intended would join different types networks least different types LANs They translating frames one LAN frames another LAN However SEC 5 5 INTERNETWORKING work well reason internetworking difficult differences features LANs different maximum packet sizes LANs without priority classes hard mask Today bridges predominantly used connect kind network link layer routers connect different networks network layer Internetworking successful building large networks works common network layer There fact many network protocols time Getting everybody agree single format difficult companies perceive commercial advantage proprietary format control Examples besides IP near universal network protocol IPX SNA AppleTalk None protocols still widespread use always protocols The relevant example probably IPv4 IPv6 While versions IP compatible would necessary create IPv6 A router handle multiple network protocols called multiprotocol router It must either translate protocols leave connection higher protocol layer Neither approach entirely satisfactory Connection higher layer say using TCP requires networks implement TCP may case Then limits usage across networks applications use TCP include many real time applications The alternative translate packets networks However unless packet formats close relatives information fields conversions always incomplete often doomed failure For example IPv6 addresses 128 bits long They fit 32 bit IPv4 address field matter hard router tries Getting IPv4 IPv6 run network proven major obstacle deployment IPv6 To fair getting customers understand want IPv6 first place Greater problems expected translating fundamentally different protocols connectionless connection oriented network protocols Given difficulties conversion rarely attempted Arguably even IP worked well serving kind lowest common denominator It requires little networks runs offers best effort service result 5 5 3 Tunneling Handling general case making two different networks interwork exceedingly difficult However common special case manageable even different network protocols This case source destination hosts type network different network As example think international bank IPv6 network 430 THE NETWORK LAYER Paris IPv6 network London connectivity offices via IPv4 Internet This situation shown IPv6 Paris IPv4 IPv6 Router Router London Tunnel IPv6 packet IPv4 IPv6 packet IPv6 packet Tunneling packet Paris London The solution problem technique called tunneling To send IP packet host London office host Paris office constructs packet containing IPv6 address London sends multiprotocol router connects Paris IPv6 network IPv4 Internet When router gets IPv6 packet encapsulates packet IPv4 header addressed IPv4 side multiprotocol router connects London IPv6 network That router puts IPv6 packet inside IPv4 packet When wrapped packet arrives London router removes original IPv6 packet sends onward destination host The path IPv4 Internet seen big tunnel extending one multiprotocol router The IPv6 packet travels one end tunnel snug nice box It worry dealing IPv4 Neither hosts Paris London Only multiprotocol routers understand IPv4 IPv6 packets In effect entire trip one multiprotocol router like hop single link An analogy may make tunneling clearer Consider person driving car Paris London Within France car moves power hits English Channel loaded onto high speed train transported England Chunnel cars permitted drive Chunnel Effectively car carried freight depicted At far end car let loose English roads continues move power Tunneling packets foreign network works way Tunneling widely used connect isolated hosts networks using networks The network results called overlay since effectively overlaid base network Deployment network protocol new feature common reason IPv6 IPv4 example shows The disadvantage tunneling none hosts network tunneled reached packets escape middle tunnel SEC 5 5 INTERNETWORKING Car English Channel Paris London Railroad carriage Railroad track Tunneling car France England However limitation tunnels turned advantage VPNs Virtual Private Networks A VPN simply overlay used provide measure security We explore VPNs get Chap 8 5 5 4 Internetwork Routing Routing internet poses basic problem routing within single network added complications To start networks may internally use different routing algorithms For example one network may use link state routing another distance vector routing Since link state algorithms need know topology distance vector algorithms difference alone would make unclear find shortest paths across internet Networks run different operators lead bigger problems First operators may different ideas good path network One operator may want route least delay another may want inexpensive route This lead operators use different quantities set shortest path costs e g milliseconds delay vs monetary cost The weights comparable across networks shortest paths internet well defined Worse yet one operator may want another operator even know details paths network perhaps weights paths may reflect sensitive information monetary cost represents competitive business advantage Finally internet may much larger networks comprise It may therefore require routing algorithms scale well using hierarchy even none individual networks need use hierarchy All considerations lead two level routing algorithm Within network intradomain interior gateway protocol used routing Gateway older term router It might link state protocol kind already described Across networks make internet interdomain exterior gateway protocol used The networks may use different intradomain protocols must use interdomain protocol 432 THE NETWORK LAYER In Internet interdomain routing protocol called BGP Border Gateway Protocol We describe next section There one important term introduce Since network operated independently others often referred AS Autonomous System A good mental model AS ISP network In fact ISP network may comprised one AS managed acquired multiple networks But difference usually significant The two levels usually strictly hierarchical highly suboptimal paths might result large international network small regional network abstracted single network However relatively little information routes within networks exposed find routes across internetwork This helps address complications It improves scaling lets operators freely select routes within networks using protocol choosing It also require weights compared across networks expose sensitive information outside networks However said little far routes across networks internet determined In Internet large determining factor business arrangements ISPs Each ISP may charge receive money ISPs carrying traffic Another factor internetwork routing requires crossing international boundaries various laws may suddenly come play Sweden strict privacy laws exporting personal data Swedish citizens Sweden All nontechnical factors wrapped concept routing policy governs way autonomous networks select routes use We return routing policies describe BGP 5 5 5 Packet Fragmentation Each network link imposes maximum size packets These limits various causes among 1 Hardware e g size Ethernet frame 2 Operating system e g buffers 512 bytes 3 Protocols e g number bits packet length field 4 Compliance inter national standard 5 Desire reduce error induced retransmissions level 6 Desire prevent one packet occupying channel long The result factors network designers free choose old maximum packet size wish Maximum payloads common SEC 5 5 INTERNETWORKING technologies 1500 bytes Ethernet 2272 bytes 802 11 IP generous allows packets big 65 515 bytes Hosts usually prefer transmit large packets reduces packet overheads bandwidth wasted header bytes An obvious internetworking problem appears large packet wants travel network whose maximum packet size small This nuisance persistent issue solutions evolved along much experience gained Internet One solution make sure problem occur first place However easier said done A source usually know path packet take network destination certainly know small packets must get This packet size called Path MTU Path Maximum Transmission Unit Even source know path MTU packets routed independently connectionless network Internet This routing means paths may suddenly change unexpectedly change path MTU The alternative solution problem allow routers break packets fragments sending fragment separate network layer packet However every parent small child knows converting large object small fragments considerably easier reverse process Physicists even given effect name second law thermodynamics Packet switching networks trouble putting fragments back together Two opposing strategies exist recombining fragments back original packet The first strategy make fragmentation caused smallpacket network transparent subsequent networks packet must pass way ultimate destination This option shown Fig 542 In approach oversized packet arrives G1 router breaks fragments Each fragment addressed exit router G2 pieces recombined In way passage small packet network made transparent Subsequent networks even aware fragmentation occurred Transparent fragmentation straightforward problems For one thing exit router must know received pieces either count field end packet bit must provided Also packets must exit via router reassembled routes constrained By allowing fragments follow one route ultimate destination fragments disjoint route performance may lost More significant amount work router may It may need buffer fragments arrive decide throw away fragments arrive Some work may wasteful packet may pass series small packet networks need repeatedly fragmented reassembled The fragmentation strategy refrain recombining fragments intermediate routers Once packet fragmented fragment 434 THE NETWORK LAYER Network 2 Network 1 Packet G1 G2 G1 fragments large packet G3 G2 reassembles fragments G4 G3 fragments G4 reassembles Packet G1 G1 fragments large packet G2 G3 G4 The fragments reassembled final destination host reached b Transparent fragmentation b Nontransparent fragmentation treated though original packet The routers pass fragments shown b reassembly performed destination host The main advantage nontransparent fragmentation requires routers less work IP works way A complete design requires fragments numbered way original data stream reconstructed The design used IP give every fragment packet number carried packets absolute byte offset within packet flag indicating whether end packet An example shown While simple design attractive properties Fragments placed buffer destination right place reassembly even arrive order Fragments also fragmented pass network yet smaller MTU This shown c Retransmissions packet fragments received fragmented different pieces Finally fragments arbitrary size single byte plus packet header In cases destination simply uses packet number fragment offset place data right position end packet flag determine complete packet Unfortunately design still problems The overhead higher transparent fragmentation fragment headers carried links may needed But real problem existence fragments first place Kent Mogul 1987 argued fragmentation detrimental performance well header overheads whole packet lost fragments lost fragmentation burden hosts originally realized SEC 5 5 INTERNETWORKING Number first elementary fragment packet Packet number End packet bit A B 1 byte C D E F F G H G H I J Header A B C D E Header I J Header b A B C D Header E F G H Header I J Header c Fragmentation elementary data size 1 byte Original packet containing 10 data bytes b Fragments passing network maximum packet size 8 payload bytes plus header c Fragments passing size 5 gateway This leads us back original solution getting rid fragmentation network strategy used modern Internet The process called path MTU discovery Mogul Deering 1990 It works follows Each IP packet sent header bits set indicate fragmentation allowed performed If router receives packet large generates error packet returns source drops packet This shown When source receives error packet uses information inside refragment packet pieces small enough router handle If router path even smaller MTU process repeated Packet length Source Try 1200 Try 900 Path MTU discovery Destination 436 THE NETWORK LAYER The advantage path MTU discovery source knows length packet send If routes path MTU change new error packets triggered source adapt new path However fragmentation still needed source destination unless higher layers learn path MTU pass right amount data IP TCP IP typically implemented together TCP IP able pass sort information Even done protocols fragmentation still moved network hosts The disadvantage path MTU discovery may added startup delays simply send packet More one round trip delay may needed probe path find MTU data delivered destination This begs question whether better designs The answer probably Yes Consider design router simply truncates packets exceed MTU This would ensure destination learns MTU rapidly possible amount data delivered receives data 5 6 THE NETWORK LAYER IN THE INTERNET It time discuss network layer Internet detail But getting specifics worth taking look principles drove design past made success today All often nowadays people seem forgotten These principles enumerated discussed RFC 1958 well worth reading mandatory protocol designers final exam end This RFC draws heavily ideas put forth Clark 1988 Saltzer et al 1984 We summarize consider top 10 principles important least important 1 Make sure works Do finalize design standard multiple prototypes successfully communicated All often designers first write 1000 page standard get approved discover deeply flawed work Then write version 1 1 standard This way go 2 Keep simple When doubt use simplest solution William Occam stated principle Occam razor 14th century Put modern terms fight features If feature absolutely essential leave especially effect achieved combining features 3 Make clear choices If several ways thing choose one Having two ways thing looking trouble Standards often multiple options modes SEC 5 6 THE NETWORK LAYER IN THE INTERNET parameters several powerful parties insist way best Designers strongly resist tendency Just say 4 Exploit modularity This principle leads directly idea protocol stacks whose layers independent ones In way circumstances require one module layer changed ones affected 5 Expect heterogeneity Different types hardware transmission facilities applications occur large network To handle network design must simple general flexible 6 Avoid static options parameters If parameters unavoidable e g maximum packet size best sender receiver negotiate value rather defining fixed choices 7 Look good design need perfect Often designers good design handle weird special case Rather messing design designers go good design put burden working around people strange requirements 8 Be strict sending tolerant receiving In words send packets rigorously comply standards expect incoming packets may fully conformant try deal 9 Think scalability If system handle millions hosts billions users effectively centralized databases kind tolerable load must spread evenly possible available resources 10 Consider performance cost If network poor performance outrageous costs nobody use Let us leave general principles start looking details Internet network layer In network layer Internet viewed collection networks ASes Autonomous Systems interconnected There real structure several major backbones exist These constructed high bandwidth lines fast routers The biggest backbones everyone else connects reach rest Internet called Tier 1 networks Attached backbones ISPs Internet Service Providers provide Internet access homes businesses data centers colocation facilities full server machines regional mid level networks The data centers serve much content sent Internet Attached 438 THE NETWORK LAYER regional networks ISPs LANs many universities companies edge networks A sketch quasihierarchical organization given Leased lines Asia A U S backbone Leased transatlantic lines A European backbone Mobile network Regional network National network WiMAX IP router Company network Cable Home network Ethernet The Internet interconnected collection many networks The glue holds whole Internet together network layer protocol IP Internet Protocol Unlike older network layer protocols IP designed beginning internetworking mind A good way think network layer job provide best effort e guaranteed way transport packets source destination without regard whether machines network whether networks Communication Internet works follows The transport layer takes data streams breaks may sent IP packets In theory packets 64 KB practice usually 1500 bytes fit one Ethernet frame IP routers forward packet Internet along path one router next destination reached At destination network layer hands data transport layer gives receiving process When pieces finally get destination machine reassembled network layer original datagram This datagram handed transport layer In example packet originating host home network traverse four networks large number IP routers even getting company network destination host located This SEC 5 6 THE NETWORK LAYER IN THE INTERNET unusual practice many longer paths There also much redundant connectivity Internet backbones ISPs connecting multiple locations This means many possible paths two hosts It job IP routing protocols decide paths use 5 6 1 The IP Version 4 Protocol An appropriate place start study network layer Internet format IP datagrams An IPv4 datagram consists header part body payload part The header 20 byte fixed part variable length optional part The header format shown The bits transmitted left right top bottom high order bit Version field going first This big endian network byte order On littleendian machines Intel x86 computers software conversion required transmission reception In retrospect little endian would better choice time IP designed one knew would come dominate computing 32 Bits Version IHL Differentiated services Identification Time live Total length D M F F Protocol Fragment offset Header checksum Source address Destination address Options 0 words The IPv4 Internet Protocol header The Version field keeps track version protocol datagram belongs Version 4 dominates Internet today started discussion By including version start datagram becomes possible transition versions long period time In fact IPv6 next version IP defined decade ago yet beginning deployed We describe later section Its use eventually forced China almost 231 people desktop PC laptop IP phone As aside numbering IPv5 experimental real time stream protocol never widely used 440 THE NETWORK LAYER Since header length constant field header IHL provided tell long header 32 bit words The minimum value 5 applies options present The maximum value 4 bit field 15 limits header 60 bytes thus Options field 40 bytes For options one records route packet taken 40 bytes far small making options useless The Differentiated services field one fields changed meaning slightly years Originally called Type service field It still intended distinguish different classes service Various combinations reliability speed possible For digitized voice fast delivery beats accurate delivery For file transfer error free transmission important fast transmission The Type service field provided 3 bits signal priority 3 bits signal whether host cared delay throughput reliability However one really knew bits routers left unused many years When differentiated services designed IETF threw towel reused field Now top 6 bits used mark packet service class described expedited assured services earlier chapter The bottom 2 bits used carry explicit congestion notification information whether packet experienced congestion described explicit congestion notification part congestion control earlier chapter The Total length includes everything datagram header data The maximum length 65 535 bytes At present upper limit tolerable future networks larger datagrams may needed The Identification field needed allow destination host determine packet newly arrived fragment belongs All fragments packet contain Identification value Next comes unused bit surprising available real estate IP header extremely scarce As April Fool joke Bellovin 2003 proposed using bit detect malicious traffic This would greatly simplify security packets evil bit set would known sent attackers could discarded Unfortunately network security simple Then come two 1 bit fields related fragmentation DF stands Don Fragment It order routers fragment packet Originally intended support hosts incapable putting pieces back together Now used part process discover path MTU largest packet travel along path without fragmented By marking datagram DF bit sender knows either arrive one piece error message returned sender MF stands More Fragments All fragments except last one bit set It needed know fragments datagram arrived The Fragment offset tells current packet fragment belongs All fragments except last one datagram must multiple 8 bytes SEC 5 6 THE NETWORK LAYER IN THE INTERNET elementary fragment unit Since 13 bits provided maximum 8192 fragments per datagram supporting maximum packet length limit Total length field Working together Identification MF Fragment offset fields used implement fragmentation described Sec 5 5 5 The TtL Time live field counter used limit packet lifetimes It originally supposed count time seconds allowing maximum lifetime 255 sec It must decremented hop supposed decremented multiple times packet queued long time router In practice counts hops When hits zero packet discarded warning packet sent back source host This feature prevents packets wandering around forever something otherwise might happen routing tables ever become corrupted When network layer assembled complete packet needs know The Protocol field tells transport process give packet TCP one possibility UDP others The numbering protocols global across entire Internet Protocols assigned numbers formerly listed RFC 1700 nowadays contained online database located www iana org Since header carries vital information addresses rates checksum protection Header checksum The algorithm add 16 bit halfwords header arrive using one complement arithmetic take one complement result For purposes algorithm Header checksum assumed zero upon arrival Such checksum useful detecting errors packet travels network Note must recomputed hop least one field always changes Time live field tricks used speed computation The Source address Destination address indicate IP address source destination network interfaces We discuss Internet addresses next section The Options field designed provide escape allow subsequent versions protocol include information present original design permit experimenters try new ideas avoid allocating header bits information rarely needed The options variable length Each begins 1 byte code identifying option Some options followed 1 byte option length field one data bytes The Options field padded multiple 4 bytes Originally five options listed defined The Security option tells secret information In theory military router might use field specify route packets certain countries military considers bad guys In practice routers ignore practical function help spies find good stuff easily The Strict source routing option gives complete path source destination sequence IP addresses The datagram required follow 442 THE NETWORK LAYER Option Description Security Specifies secret datagram Strict source routing Gives complete path followed Loose source routing Gives list routers missed Record route Makes router append IP address Timestamp Makes router append address timestamp Some IP options exact route It useful system managers need send emergency packets routing tables corrupted making timing measurements The Loose source routing option requires packet traverse list routers specified order specified allowed pass routers way Normally option provide routers force particular path For example force packet London Sydney go west instead east option might specify routers New York Los Angeles Honolulu This option useful political economic considerations dictate passing avoiding certain countries The Record route option tells router along path append IP address Options field This allows system managers track bugs routing algorithms Why packets Houston Dallas visiting Tokyo first When ARPANET first set packet ever passed nine routers 40 bytes options plenty As mentioned small Finally Timestamp option like Record route option except addition recording 32 bit IP address router also records 32 bit timestamp This option mostly useful network measurement Today IP options fallen favor Many routers ignore process efficiently shunting side uncommon case That partly supported rarely used 5 6 2 IP Addresses A defining feature IPv4 32 bit addresses Every host router Internet IP address used Source address Destination address fields IP packets It important note IP address actually refer host It really refers network interface host two networks must two IP addresses However practice hosts one network thus one IP address In contrast routers multiple interfaces thus multiple IP addresses SEC 5 6 THE NETWORK LAYER IN THE INTERNET Prefixes IP addresses hierarchical unlike Ethernet addresses Each 32 bit address comprised variable length network portion top bits host portion bottom bits The network portion value hosts single network Ethernet LAN This means network corresponds contiguous block IP address space This block called prefix IP addresses written dotted decimal notation In format 4 bytes written decimal 0 255 For example 32 bit hexadecimal address 80D00297 written 128 208 2 151 Prefixes written giving lowest IP address block size block The size determined number bits network portion remaining bits host portion vary This means size must power two By convention written prefix IP address slash followed length bits network portion In example prefix contains 28 addresses leaves 24 bits network portion written 128 208 0 0 24 Since prefix length inferred IP address alone routing protocols must carry prefixes routers Sometimes prefixes simply described length 16 pronounced slash 16 The length prefix corresponds binary mask 1s network portion When written way called subnet mask It ANDed IP address extract network portion For example subnet mask 255 255 255 0 shows prefix subnet mask 32 bits Prefix length L bits 32 L bits Network Host Subnet mask 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 An IP prefix subnet mask Hierarchical addresses significant advantages disadvantages The key advantage prefixes routers forward packets based network portion address long networks unique address block The host portion matter routers hosts network sent direction It packets reach network destined forwarded correct host This makes routing tables much smaller would otherwise Consider number hosts Internet approaching one billion That would large table every router keep However using hierarchy routers need keep routes around 300 000 prefixes 444 THE NETWORK LAYER While using hierarchy lets Internet routing scale two disadvantages First IP address host depends located network An Ethernet address used anywhere world every IP address belongs specific network routers able deliver packets destined address network Designs mobile IP needed support hosts move networks want keep IP addresses The second disadvantage hierarchy wasteful addresses unless carefully managed If addresses assigned networks large blocks many addresses allocated use This allocation would matter much plenty addresses go around However realized two decades ago tremendous growth Internet rapidly depleting free address space IPv6 solution shortage widely deployed great pressure allocate IP addresses used efficiently Subnets Network numbers managed nonprofit corporation called ICANN Internet Corporation Assigned Names Numbers avoid conflicts In turn ICANN delegated parts address space various regional authorities dole IP addresses ISPs companies This process company allocated block IP addresses However process start story IP address assignment ongoing companies grow We said routing prefix requires hosts network network number This property cause problems networks grow For example consider university started example 16 prefix use Computer Science Dept computers Ethernet A year later Electrical Engineering Dept wants get Internet The Art Dept soon follows suit What IP addresses departments use Getting blocks requires going outside university may expensive inconvenient Moreover 16 already allocated enough addresses 60 000 hosts It might intended allow significant growth happens wasteful allocate blocks IP addresses university A different organization required The solution allow block addresses split several parts internal use multiple networks still acting like single network outside world This called subnetting networks Ethernet LANs result dividing larger network called subnets As mentioned Chap 1 aware new usage term conflicts older usage subnet mean set routers communication lines network shows subnets help example The single 16 split pieces This split need even piece must SEC 5 6 THE NETWORK LAYER IN THE INTERNET aligned bits used lower host portion In case half block 17 allocated Computer Science Dept quarter allocated Electrical Engineering Dept 18 one eighth 19 Art Dept The remaining eighth unallocated A different way see block divided look resulting prefixes written binary notation Computer Science Electrical Eng Art 1000000011010000 1 xxxxxxx 00 xxxxxx 011 xxxxx xxxxxxxx xxxxxxxx xxxxxxxx Here vertical bar shows boundary subnet number host portion EE 128 208 0 0 18 CS 128 208 128 0 17 128 208 0 0 16 Internet Art 128 208 96 0 19 Splitting IP prefix separate networks subnetting When packet comes main router router know subnet give This details prefixes come One way would router table 65 536 entries telling outgoing line use host campus But would undermine main scaling benefit get using hierarchy Instead routers simply need know subnet masks networks campus When packet arrives router looks destination address packet checks subnet belongs The router ANDing destination address mask subnet checking see result corresponding prefix For example consider packet destined IP address 128 208 2 151 To see Computer Science Dept AND 255 255 128 0 take first 17 bits 128 208 0 0 see match prefix address 128 208 128 0 They match Checking first 18 bits Electrical Engineering Dept get 128 208 0 0 ANDing subnet mask This match prefix address packet forwarded onto interface leads Electrical Engineering network 446 THE NETWORK LAYER The subnet divisions changed later necessary updating subnet masks routers inside university Outside network subnetting visible allocating new subnet require contacting ICANN changing external databases CIDR Classless InterDomain Routing Even blocks IP addresses allocated addresses used efficiently still problem remains routing table explosion Routers organizations edge network university need entry subnets telling router line use get network For routes destinations outside organization use simple default rule sending packets line toward ISP connects organization rest Internet The destination addresses must somewhere Routers ISPs backbones middle Internet luxury They must know way go get every network simple default work These core routers said default free zone Internet No one really knows many networks connected Internet large number probably least million This make large table It may sound large computer standards realize routers must perform lookup table forward every packet routers large ISPs may forward millions packets per second Specialized hardware fast memory needed process packets rates generalpurpose computer In addition routing algorithms require router exchange information addresses reach routers The larger tables information needs communicated processed The processing grows least linearly table size Greater communication increases likelihood parts get lost least temporarily possibly leading routing instabilities The routing table problem could solved going deeper hierarchy like telephone network For example IP address contain country state province city network host field might work Then router would need know get country states provinces country cities state province networks city Unfortunately solution would require considerably 32 bits IP addresses would use addresses inefficiently Liechtenstein would many bits addresses United States Fortunately something reduce routing table sizes We apply insight subnetting routers different locations know given IP address belonging prefixes different sizes However instead splitting address block subnets combine multiple small SEC 5 6 THE NETWORK LAYER IN THE INTERNET prefixes single larger prefix This process called route aggregation The resulting larger prefix sometimes called supernet contrast subnets division blocks addresses With aggregation IP addresses contained prefixes varying sizes The IP address one router treats part 22 block containing 210 addresses may treated another router part larger 20 contains 212 addresses It router corresponding prefix information This design works subnetting called CIDR Classless InterDomain Routing pronounced cider drink The recent version specified RFC 4632 Fuller Li 2006 The name highlights contrast addresses encode hierarchy classes describe shortly To make CIDR easier understand let us consider example block 8192 IP addresses available starting 194 24 0 0 Suppose Cambridge University needs 2048 addresses assigned addresses 194 24 0 0 194 24 7 255 along mask 255 255 248 0 This 21 prefix Next Oxford University asks 4096 addresses Since block 4096 addresses must lie 4096 byte boundary Oxford given addresses starting 194 24 8 0 Instead gets 194 24 16 0 194 24 31 255 along subnet mask 255 255 240 0 Finally University Edinburgh asks 1024 addresses assigned addresses 194 24 8 0 194 24 11 255 mask 255 255 252 0 These assignments summarized University First address Last address How many Prefix Cambridge 194 24 0 0 194 24 7 255 194 24 0 0 21 Edinburgh 194 24 8 0 194 24 11 255 194 24 8 0 22 Available 194 24 12 0 194 24 15 255 194 24 12 0 22 Oxford 194 24 16 0 194 24 31 255 194 24 16 0 20 A set IP address assignments All routers default free zone told IP addresses three networks Routers close universities may need send different outgoing line prefixes need entry prefixes routing tables An example router London Now let us look three universities point view distant router New York All IP addresses three prefixes sent New York U S general London The routing process London notices combines three prefixes single aggregate entry prefix 194 24 0 0 19 passes New York router This prefix contains 8K addresses covers three universities otherwise unallocated 1024 addresses By using aggregation three prefixes reduced one reducing 448 THE NETWORK LAYER 192 24 0 0 21 Cambridge New York London 192 24 0 0 19 1 aggregate prefix 3 prefixes 192 24 16 0 20 Oxford 192 24 8 0 22 Edinburgh Aggregation IP prefixes prefixes New York router must told routing table entries New York router When aggregation turned automatic process It depends prefixes located Internet actions administrator assigning addresses networks Aggregation heavily used throughout Internet reduce size router tables around 200 000 prefixes As twist prefixes allowed overlap The rule packets sent direction specific route longest matching prefix fewest IP addresses Longest matching prefix routing provides useful degree flexibility seen behavior router New York This router still uses single aggregate prefix send traffic three universities London However previously available block addresses within prefix allocated network San Francisco One possibility New York router keep four prefixes sending packets three London packets fourth San Francisco Instead longest matching prefix routing handle forwarding two prefixes shown One overall prefix used direct traffic entire block London One specific prefix also used direct portion larger prefix San Francisco With longest matching prefix rule IP addresses within San Francisco network sent outgoing line San Francisco IP addresses larger prefix sent London Conceptually CIDR works follows When packet comes routing table scanned determine destination lies within prefix It possible multiple entries different prefix lengths match case entry longest prefix used Thus match 20 mask 24 mask 24 entry used look outgoing line packet However process would tedious table really scanned entry entry SEC 5 6 THE NETWORK LAYER IN THE INTERNET 192 24 0 0 21 San Francisco New York London 192 24 16 0 20 192 24 0 0 19 192 24 12 0 22 192 24 8 0 22 192 24 12 0 22 Longest matching prefix routing New York router Instead complex algorithms devised speed address matching process Ruiz Sanchez et al 2001 Commercial routers use custom VLSI chips algorithms embedded hardware Classful Special Addressing To help better appreciate CIDR useful briefly relate design predated Before 1993 IP addresses divided five categories listed This allocation come called classful addressing 32 Bits Range host addresses Class Network 1 0 0 0 127 255 255 255 A Host B C D Multicast address 224 0 0 0 239 255 255 255 E Reserved future use 240 0 0 0 255 255 255 255 Network 128 0 0 0 191 255 255 255 Host Network Host 192 0 0 0 223 255 255 255 IP address formats The class A B C formats allow 128 networks 16 million hosts 16 384 networks 65 536 hosts 2 million networks e g LANs 256 hosts although special Also supported multicast class D format datagram directed multiple hosts Addresses beginning 1111 reserved use future They would valuable use given depletion IPv4 address space 450 THE NETWORK LAYER Unfortunately many hosts accept addresses valid limits long hard teach old hosts new tricks This hierarchical design unlike CIDR sizes address blocks fixed Over 2 billion addresses exist organizing address space classes wastes millions In particular real villain class B network For organizations class A network 16 million addresses big class C network 256 addresses small A class B network 65 536 right In Internet folklore situation known three bears problem Goldilocks Three Bears Southey 1848 In reality though class B address far large organizations Studies shown half class B networks fewer 50 hosts A class C network would done job doubt every organization asked class B address thought one day would outgrow 8bit host field In retrospect might better class C networks use 10 bits instead 8 host number allowing 1022 hosts per network Had case organizations would probably settled class C network would half million versus 16 384 class B networks It hard fault Internet designers provided smaller class B addresses At time decision made create three classes Internet research network connecting major research universities U S plus small number companies military sites networking research No one perceived Internet becoming massmarket communication system rivaling telephone network At time someone doubt said The U S 2000 colleges universities Even connect Internet many universities countries join never going hit 16 000 since many universities whole world Furthermore host number integral number bytes speeds packet processing done entirely software Perhaps day people look back fault folks designed telephone number scheme say What idiots Why include planet number phone number But time seem necessary To handle problems subnets introduced flexibly assign blocks addresses within organization Later CIDR added reduce size global routing table Today bits indicate whether IP address belongs class A B C network longer used though references classes literature still common To see dropping classes made forwarding complicated consider simple old classful system When packet arrived router copy IP address shifted right 28 bits yield 4 bit class number A 16 way branch sorted packets A B C D E classes eight cases class A four cases class B two cases class C The code class masked 8 16 24 bit network SEC 5 6 THE NETWORK LAYER IN THE INTERNET number right aligned 32 bit word The network number looked A B C table usually indexing A B networks hashing C networks Once entry found outgoing line could looked packet forwarded This much simpler longest matching prefix operation longer use simple table lookup IP address may length prefix Class D addresses continue used Internet multicast Actually might accurate say starting used multicast since Internet multicast widely deployed past There also several addresses special meanings shown The IP address 0 0 0 0 lowest address used hosts booted It means network host IP addresses 0 network number refer current network These addresses allow machines refer network without knowing number know network mask know many 0s include The address consisting 1s 255 255 255 255 highest address used mean hosts indicated network It allows broadcasting local network typically LAN The addresses proper network number 1s host field allow machines send broadcast packets distant LANs anywhere Internet However many network administrators disable feature mostly security hazard Finally addresses form 127 xx yy zz reserved loopback testing Packets sent address put onto wire processed locally treated incoming packets This allows packets sent host without sender knowing number useful testing 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 A host network Host 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 Network Anything This host Broadcast local network Broadcast distant network Loopback Special IP addresses NAT Network Address Translation IP addresses scarce An ISP might 16 address giving 65 534 usable host numbers If customers problem 452 THE NETWORK LAYER This scarcity led techniques use IP addresses sparingly One approach dynamically assign IP address computer using network take IP address back host becomes inactive The IP address assigned another computer becomes active In way single 16 address handle 65 534 active users This strategy works well cases example dialup networking mobile computers may temporarily absent powered However work well business customers Many PCs businesses expected continuously Some employee machines backed night servers may serve remote request moment notice These businesses access line always provides connectivity rest Internet Increasingly situation also applies home users subscribing ADSL Internet cable since connection charge monthly flat rate charge Many users two computers home often one family member want online time The solution connect computers home network via LAN put wireless router The router connects ISP From ISP point view family small business handful computers Welcome Jones Inc With techniques seen far computer must IP address day long For ISP many thousands customers particularly business customers families like small businesses demand IP addresses quickly exceed block available The problem running IP addresses theoretical one might occur point distant future It happening right right The long term solution whole Internet migrate IPv6 128 bit addresses This transition slowly occurring years process complete To get meantime quick fix needed The quick fix widely used today came form NAT Network Address Translation described RFC 3022 summarize For additional information see Dutcher 2001 The basic idea behind NAT ISP assign home business single IP address small number Internet traffic Within customer network every computer gets unique IP address used routing intramural traffic However packet exits customer network goes ISP address translation unique internal IP address shared public IP address takes place This translation makes use three ranges IP addresses declared private Networks may use internally wish The rule packets containing addresses may appear Internet The three reserved ranges 10 0 0 0 10 255 255 255 8 172 16 0 0 172 31 255 255 12 192 168 0 0 192 168 255 255 16 16 777 216 hosts 1 048 576 hosts 65 536 hosts SEC 5 6 THE NETWORK LAYER IN THE INTERNET The first range provides 16 777 216 addresses except 0s 1s usual usual choice even network large The operation NAT shown Within customer premises every machine unique address form 10 x z However packet leaves customer premises passes NAT box converts internal IP source address 10 0 0 1 figure customer true IP address 198 60 42 12 example The NAT box often combined single device firewall provides security carefully controlling goes customer network comes We study firewalls Chap 8 It also possible integrate NAT box router ADSL modem Packet translation IP 10 0 0 1 port 5544 Customer router LAN Packet translation IP 198 60 42 12 port 3344 NAT box firewall Internet ISP router Boundary customer premises Placement operation NAT box So far glossed one tiny crucial detail reply comes back e g Web server naturally addressed 198 60 42 12 NAT box know internal address replace Herein lies problem NAT If spare field IP header field could used keep track real sender 1 bit still unused In principle new option could created hold true source address would require changing IP code machines entire Internet handle new option This promising alternative quick fix What actually happens follows The NAT designers observed IP packets carry either TCP UDP payloads When study TCP UDP Chap 6 see headers containing source port destination port Below discuss TCP ports exactly story holds UDP ports The ports 16 bit integers indicate TCP connection begins ends These ports provide field needed make NAT work When process wants establish TCP connection remote process attaches unused TCP port machine This called source port tells TCP code send incoming packets belonging connection The process also supplies destination port tell give 454 THE NETWORK LAYER packets remote side Ports 0 1023 reserved well known services For example port 80 port used Web servers remote clients locate Each outgoing TCP message contains source port destination port Together ports serve identify processes using connection ends An analogy may make use ports clearer Imagine company single main telephone number When people call main number reach operator asks extension want puts extension The main number analogous customer IP address extensions ends analogous ports Ports effectively extra 16 bits addressing identify process gets incoming packet Using Source port field solve mapping problem Whenever outgoing packet enters NAT box 10 x z source address replaced customer true IP address In addition TCP Source port field replaced index NAT box 65 536 entry translation table This table entry contains original IP address original source port Finally IP TCP header checksums recomputed inserted packet It necessary replace Source port connections machines 10 0 0 1 10 0 0 2 may happen use port 5000 example Source port alone enough identify sending process When packet arrives NAT box ISP Source port TCP header extracted used index NAT box mapping table From entry located internal IP address original TCP Source port extracted inserted packet Then IP TCP checksums recomputed inserted packet The packet passed customer router normal delivery using 10 x z address Although scheme sort solves problem networking purists IP community tendency regard abomination face theearth Briefly summarized objections First NAT violates architectural model IP states every IP address uniquely identifies single machine worldwide The whole software structure Internet built fact With NAT thousands machines may use address 10 0 0 1 Second NAT breaks end end connectivity model Internet says host send packet host time Since mapping NAT box set outgoing packets incoming packets accepted outgoing ones In practice means home user NAT make TCP IP connections remote Web server remote user make connections game server home network Special configuration NAT traversal techniques needed support kind situation Third NAT changes Internet connectionless network peculiar kind connection oriented network The problem NAT box must maintain information e mapping connection passing SEC 5 6 THE NETWORK LAYER IN THE INTERNET Having network maintain connection state property connection oriented networks connectionless ones If NAT box crashes mapping table lost TCP connections destroyed In absence NAT router crash restart long term effect TCP connections The sending process times within seconds retransmits unacknowledged packets With NAT Internet becomes vulnerable circuit switched network Fourth NAT violates fundamental rule protocol layering layer k may make assumptions layer k 1 put payload field This basic principle keep layers independent If TCP later upgraded TCP 2 different header layout e g 32 bit ports NAT fail The whole idea layered protocols ensure changes one layer require changes layers NAT destroys independence Fifth processes Internet required use TCP UDP If user machine A decides use new transport protocol talk user machine B example multimedia application introduction NAT box cause application fail NAT box able locate TCP Source port correctly A sixth related problem applications use multiple TCP IP connections UDP ports prescribed ways For example FTP standard File Transfer Protocol inserts IP addresses body packet receiver extract use Since NAT knows nothing arrangements rewrite IP addresses otherwise account This lack understanding means FTP applications H 323 Internet telephony protocol study Chap 7 fail presence NAT unless special precautions taken It often possible patch NAT cases patch code NAT box every time new application comes along good idea Finally since TCP Source port field 16 bits 65 536 machines mapped onto IP address Actually number slightly less first 4096 ports reserved special uses However multiple IP addresses available one handle 61 440 machines A view problems NAT given RFC 2993 Despite issues NAT widely used practice especially home small business networks expedient technique deal IP address shortage It become wrapped firewalls privacy blocks unsolicited incoming packets default For reason unlikely go away even IPv6 widely deployed 5 6 3 IP Version 6 IP heavy use decades It worked extremely well demonstrated exponential growth Internet Unfortunately IP become victim popularity close running addresses Even 456 THE NETWORK LAYER CIDR NAT using addresses sparingly last IPv4 addresses expected assigned ICANN end 2012 This looming disaster recognized almost two decades ago sparked great deal discussion controversy within Internet community In section describe problem several proposed solutions The long term solution move larger addresses IPv6 IP version 6 replacement design It uses 128 bit addresses shortage addresses likely time foreseeable future However IPv6 proved difficult deploy It different network layer protocol really interwork IPv4 despite many similarities Also companies users really sure want IPv6 case The result IPv6 deployed used tiny fraction Internet estimates 1 despite Internet Standard since 1998 The next several years interesting time remaining IPv4 addresses allocated Will people start auction IPv4 addresses eBay Will black market spring Who knows In addition address problems issues loom background In early years Internet largely used universities high tech industries U S Government especially Dept Defense With explosion interest Internet starting mid 1990s began used different group people often different requirements For one thing numerous people smart phones use keep contact home bases For another impending convergence computer communication entertainment industries may long every telephone television set world Internet node resulting billion machines used audio video demand Under circumstances became apparent IP evolve become flexible Seeing problems horizon 1990 IETF started work new version IP one would never run addresses would solve variety problems flexible efficient well Its major goals 1 Support billions hosts even inefficient address allocation 2 Reduce size routing tables 3 Simplify protocol allow routers process packets faster 4 Provide better security authentication privacy 5 Pay attention type service particularly real time data 6 Aid multicasting allowing scopes specified 7 Make possible host roam without changing address 8 Allow protocol evolve future 9 Permit old new protocols coexist years SEC 5 6 THE NETWORK LAYER IN THE INTERNET The design IPv6 presented major opportunity improve features IPv4 fall short wanted To develop protocol met requirements IETF issued call proposals discussion RFC 1550 Twenty one responses initially received By December 1992 seven serious proposals table They ranged making minor patches IP throwing altogether replacing completely different protocol One proposal run TCP CLNP network layer protocol designed OSI With 160 bit addresses CLNP would provided enough address space forever could give every molecule water oceans enough addresses roughly 25 set small network This choice would also unified two major network layer protocols However many people felt would admission something OSI world actually done right statement considered Politically Incorrect Internet circles CLNP patterned closely IP two really different In fact protocol ultimately chosen differs IP far CLNP Another strike CLNP poor support service types something required transmit multimedia efficiently Three better proposals published IEEE Network Deering 1993 Francis 1993 Katz Ford 1993 After much discussion revision jockeying position modified combined version Deering Francis proposals called SIPP Simple Internet Protocol Plus selected given designation IPv6 IPv6 meets IETF goals fairly well It maintains good features IP discards deemphasizes bad ones adds new ones needed In general IPv6 compatible IPv4 compatible auxiliary Internet protocols including TCP UDP ICMP IGMP OSPF BGP DNS small modifications required deal longer addresses The main features IPv6 discussed More information found RFCs 2460 2466 First foremost IPv6 longer addresses IPv4 They 128 bits long solves problem IPv6 set solve providing effectively unlimited supply Internet addresses We say addresses shortly The second major improvement IPv6 simplification header It contains seven fields versus 13 IPv4 This change allows routers process packets faster thus improves throughput delay We discuss header shortly The third major improvement better support options This change essential new header fields previously required optional used often In addition way options represented different making simple routers skip options intended This feature speeds packet processing time 458 THE NETWORK LAYER A fourth area IPv6 represents big advance security IETF fill newspaper stories precocious 12 year olds using personal computers break banks military bases Internet There strong feeling something done improve security Authentication privacy key features new IP These later retrofitted IPv4 however area security differences great Finally attention paid quality service Various halfhearted efforts improve QoS made past growth multimedia Internet sense urgency greater The Main IPv6 Header The IPv6 header shown The Version field always 6 IPv6 4 IPv4 During transition period IPv4 already taken decade routers able examine field tell kind packet As aside making test wastes instructions critical path given data link header usually indicates network protocol demultiplexing routers may skip check For example Ethernet Type field different values indicate IPv4 IPv6 payload The discussions Do right Make fast camps doubt lengthy vigorous 32 Bits Version Diff services Payload length Flow label Next header Hop limit Source address 16 bytes Destination address 16 bytes The IPv6 fixed header required The Differentiated services field originally called Traffic class used distinguish class service packets different real time delivery SEC 5 6 THE NETWORK LAYER IN THE INTERNET requirements It used differentiated service architecture quality service manner field name IPv4 packet Also low order 2 bits used signal explicit congestion indications way IPv4 The Flow label field provides way source destination mark groups packets requirements treated way network forming pseudoconnection For example stream packets one process certain source host process specific destination host might stringent delay requirements thus need reserved bandwidth The flow set advance given identifier When packet nonzero Flow label shows routers look internal tables see kind special treatment requires In effect flows attempt ways flexibility datagram network guarantees virtual circuit network Each flow quality service purposes designated source address destination address flow number This design means 220 flows may active time given pair IP addresses It also means even two flows coming different hosts flow label pass router router able tell apart using source destination addresses It expected flow labels chosen randomly rather assigned sequentially starting 1 routers expected hash The Payload length field tells many bytes follow 40 byte header The name changed IPv4 Total length field meaning changed slightly 40 header bytes longer counted part length used This change means payload 65 535 bytes instead mere 65 515 bytes The Next header field lets cat bag The reason header could simplified additional optional extension headers This field tells currently six extension headers follow one If header last IP header Next header field tells transport protocol handler e g TCP UDP pass packet The Hop limit field used keep packets living forever It practice Time live field IPv4 namely field decremented hop In theory IPv4 time seconds router used way name changed reflect way actually used Next come Source address Destination address fields Deering original proposal SIP used 8 byte addresses review process many people felt 8 byte addresses IPv6 would run addresses within decades whereas 16 byte addresses would never run Other people argued 16 bytes overkill whereas still others favored using 20 byte addresses compatible OSI datagram protocol Still another faction wanted variable sized addresses After much debate words 460 THE NETWORK LAYER unprintable academic textbook decided fixed length 16 byte addresses best compromise A new notation devised writing 16 byte addresses They written eight groups four hexadecimal digits colons groups like 8000 0000 0000 0000 0123 4567 89AB CDEF Since many addresses many zeros inside three optimizations authorized First leading zeros within group omitted 0123 written 123 Second one groups 16 zero bits replaced pair colons Thus address becomes 8000 123 4567 89AB CDEF Finally IPv4 addresses written pair colons old dotted decimal number example 192 31 20 46 Perhaps unnecessary explicit lot 16byte addresses Specifically 2128 approximately 3 1038 If entire earth land water covered computers IPv6 would allow 7 1023 IP addresses per square meter Students chemistry notice number larger Avogadro number While intention give every molecule surface earth IP address far In practice address space used efficiently telephone number address space area code Manhattan 212 nearly full Wyoming 307 nearly empty In RFC 3194 Durand Huitema calculated using allocation telephone numbers guide even pessimistic scenario still well 1000 IP addresses per square meter entire earth surface land water In likely scenario trillions per square meter In short seems unlikely run foreseeable future It instructive compare IPv4 header IPv6 header see left IPv6 The IHL field gone IPv6 header fixed length The Protocol field taken Next header field tells follows last IP header e g UDP TCP segment All fields relating fragmentation removed IPv6 takes different approach fragmentation To start IPv6 conformant hosts expected dynamically determine packet size use They using path MTU discovery procedure described Sec 5 5 5 In brief host sends IPv6 packet large instead fragmenting router unable forward drops packet sends error message back SEC 5 6 THE NETWORK LAYER IN THE INTERNET sending host This message tells host break future packets destination Having host send packets right size first place ultimately much efficient routers fragment fly Also minimum size packet routers must able forward raised 576 1280 bytes allow 1024 bytes data many headers Finally Checksum field gone calculating greatly reduces performance With reliable networks used combined fact data link layer transport layers normally checksums value yet another checksum deemed worth performance price extracted Removing features resulted lean mean network layer protocol Thus goal IPv6 fast yet flexible protocol plenty address space met design Extension Headers Some missing IPv4 fields occasionally still needed IPv6 introduces concept optional extension headers These headers supplied provide extra information encoded efficient way Six kinds extension headers defined present listed Each one optional one present must appear directly fixed header preferably order listed Extension header Description Hop hop options Miscellaneous information routers Destination options Additional information destination Routing Loose list routers visit Fragmentation Management datagram fragments Authentication Verification sender identity Encrypted security payload Information encrypted contents IPv6 extension headers Some headers fixed format others contain variable number variable length options For item encoded Type Length Value tuple The Type 1 byte field telling option The Type values chosen first 2 bits tell routers know process option The choices skip option discard packet discard packet send back ICMP packet discard packet send ICMP packets multicast addresses prevent one bad multicast packet generating millions ICMP reports The Length also 1 byte field It tells long value 0 255 bytes The Value information required 255 bytes 462 THE NETWORK LAYER The hop hop header used information routers along path must examine So far one option defined support datagrams exceeding 64 KB The format header shown When used Payload length field fixed header set 0 Next header Jumbo payload length The hop hop extension header large datagrams jumbograms As extension headers one starts byte telling kind header comes next This byte followed one telling long hop hop header bytes excluding first 8 bytes mandatory All extensions begin way The next 2 bytes indicate option defines datagram size code 194 size 4 byte number The last 4 bytes give size datagram Sizes less 65 536 bytes permitted result first router discarding packet sending back ICMP error message Datagrams using header extension called jumbograms The use jumbograms important supercomputer applications must transfer gigabytes data efficiently across Internet The destination options header intended fields need interpreted destination host In initial version IPv6 options defined null options padding header multiple 8 bytes initially used It included make sure new routing host software handle case someone thinks destination option day The routing header lists one routers must visited way destination It similar IPv4 loose source routing addresses listed must visited order routers listed may visited The format routing header shown Next header Header extension Routing type length Segments left Type specific data The extension header routing SEC 5 6 THE NETWORK LAYER IN THE INTERNET The first 4 bytes routing extension header contain four 1 byte integers The Next header Header extension length fields described The Routing type field gives format rest header Type 0 says reserved 32 bit word follows first word followed number IPv6 addresses Other types may invented future needed Finally Segments left field keeps track many addresses list yet visited It decremented every time one visited When hits 0 packet guidance route follow Usually point close destination best route obvious The fragment header deals fragmentation similarly way IPv4 The header holds datagram identifier fragment number bit telling whether fragments follow In IPv6 unlike IPv4 source host fragment packet Routers along way may This change major philosophical break original IP keeping current practice IPv4 Plus simplifies routers work makes routing go faster As mentioned router confronted packet big discards packet sends ICMP error packet back source This information allows source host fragment packet smaller pieces using header try The authentication header provides mechanism receiver packet sure sent The encrypted security payload makes possible encrypt contents packet intended recipient read These headers use cryptographic techniques describe Chap 8 accomplish missions Controversies Given open design process strongly held opinions many people involved come surprise many choices made IPv6 highly controversial say least We summarize briefly For gory details see RFCs We already mentioned argument address length The result compromise 16 byte fixed length addresses Another fight developed length Hop limit field One camp felt strongly limiting maximum number hops 255 implicit using 8 bit field gross mistake After paths 32 hops common 10 years much longer paths may common These people argued using huge address size farsighted using tiny hop count shortsighted In view greatest sin computer scientist commit provide bits somewhere The response arguments could made increase every field leading bloated header Also function Hop limit field keep packets wandering around long time 65 535 hops far far long 464 THE NETWORK LAYER Finally Internet grows long distance links built making possible get country country half dozen hops If takes 125 hops get source destination respective international gateways something wrong national backbones The 8 bitters one Another hot potato maximum packet size The supercomputer community wanted packets excess 64 KB When supercomputer gets started transferring really means business want interrupted every 64 KB The argument large packets 1 MB packet hits 1 5 Mbps T1 line packet tie line 5 seconds producing noticeable delay interactive users sharing line A compromise reached normal packets limited 64 KB hop hop extension header used permit jumbograms A third hot topic removing IPv4 checksum Some people likened move removing brakes car Doing makes car lighter go faster unexpected event happens problem The argument checksums application really cares data integrity transport layer checksum anyway another one IP addition data link layer checksum overkill Furthermore experience showed computing IP checksum major expense IPv4 The antichecksum camp one IPv6 checksum Mobile hosts also point contention If portable computer flies halfway around world continue operating IPv6 address use scheme home agents Some people wanted build explicit support mobile hosts IPv6 That effort failed consensus could found specific proposal Probably biggest battle security Everyone agreed essential The war put First The argument putting network layer becomes standard service applications use without advance planning The argument really secure applications generally want nothing less end end encryption source application encryption destination application undoes With anything less user mercy potentially buggy network layer implementations control The response argument applications refrain using IP security features job The rejoinder people trust network right want pay price slow bulky IP implementations capability even disabled Another aspect put security relates fact many countries stringent export laws concerning cryptography Some notably France Iraq also restrict use domestically people secrets government As result IP implementation used SEC 5 6 THE NETWORK LAYER IN THE INTERNET cryptographic system strong enough much value could exported United States many countries customers worldwide Having maintain two sets software one domestic use one export something computer vendors vigorously oppose One point controversy one expects IPv4 Internet turned Sunday evening come back IPv6 Internet Monday morning Instead isolated islands IPv6 converted initially communicating via tunnels showed Sec 5 5 3 As IPv6 islands grow merge bigger islands Eventually islands merge Internet fully converted At least plan Deployment proved Achilles heel IPv6 It remains little used even though major operating systems fully support Most deployments new situations network operator example mobile phone operator needs large number IP addresses Many strategies defined help ease transition Among ways automatically configure tunnels carry IPv6 IPv4 Internet ways hosts automatically find tunnel endpoints Dual stack hosts IPv4 IPv6 implementation select protocol use depending destination packet These strategies streamline substantial deployment seems inevitable IPv4 addresses exhausted For information IPv6 see Davies 2008 5 6 4 Internet Control Protocols In addition IP used data transfer Internet several companion control protocols used network layer They include ICMP ARP DHCP In section look turn describing versions correspond IPv4 protocols common use ICMP DHCP similar versions IPv6 equivalent ARP called NDP Neighbor Discovery Protocol IPv6 IMCP The Internet Control Message Protocol The operation Internet monitored closely routers When something unexpected occurs packet processing router event reported sender ICMP Internet Control Message Protocol ICMP also used test Internet About dozen types ICMP messages defined Each ICMP message type carried encapsulated IP packet The important ones listed The DESTINATION UNREACHABLE message used router locate destination packet DF bit delivered small packet network stands way 466 THE NETWORK LAYER Message type Description Destination unreachable Packet could delivered Time exceeded Time live field hit 0 Parameter problem Invalid header field Source quench Choke packet Redirect Teach router geography Echo echo reply Check machine alive Timestamp request reply Same Echo timestamp Router advertisement solicitation Find nearby router The principal ICMP message types The TIME EXCEEDED message sent packet dropped TtL Time live counter reached zero This event symptom packets looping counter values set low One clever use error message traceroute utility developed Van Jacobson 1987 Traceroute finds routers along path host destination IP address It finds information without kind privileged network support The method simply send sequence packets destination first TtL 1 TtL 2 3 The counters packets reach zero successive routers along path These routers obediently send TIME EXCEEDED message back host From messages host determine IP addresses routers along path well keep statistics timings parts path It TIME EXCEEDED message intended perhaps useful network debugging tool time The PARAMETER PROBLEM message indicates illegal value detected header field This problem indicates bug sending host IP software possibly software router transited The SOURCE QUENCH message long ago used throttle hosts sending many packets When host received message expected slow It rarely used anymore congestion occurs packets tend add fuel fire unclear respond Congestion control Internet done largely taking action transport layer using packet losses congestion signal study detail Chap 6 The REDIRECT message used router notices packet seems routed incorrectly It used router tell sending host update better route The ECHO ECHO REPLY messages sent hosts see given destination reachable currently alive Upon receiving ECHO message SEC 5 6 THE NETWORK LAYER IN THE INTERNET destination expected send back ECHO REPLY message These messages used ping utility checks host Internet The TIMESTAMP REQUEST TIMESTAMP REPLY messages similar except arrival time message departure time reply recorded reply This facility used measure network performance The ROUTER ADVERTISEMENT ROUTER SOLICITATION messages used let hosts find nearby routers A host needs learn IP address least one router able send packets local network In addition messages others defined The online list kept www iana org assignments icmp parameters ARP The Address Resolution Protocol Although every machine Internet one IP addresses addresses sufficient sending packets Data link layer NICs Network Interface Cards Ethernet cards understand Internet addresses In case Ethernet every NIC ever manufactured comes equipped unique 48 bit Ethernet address Manufacturers Ethernet NICs request block Ethernet addresses IEEE ensure two NICs address avoid conflicts two NICs ever appear LAN The NICs send receive frames based 48 bit Ethernet addresses They know nothing 32 bit IP addresses The question arises IP addresses get mapped onto data link layer addresses Ethernet To explain works let us use example small university two 24 networks illustrated One network CS switched Ethernet Computer Science Dept It prefix 192 32 65 0 24 The LAN EE also switched Ethernet Electrical Engineering prefix 192 32 63 0 24 The two LANs connected IP router Each machine Ethernet interface router unique Ethernet address labeled E1 E6 unique IP address CS EE network Let us start seeing user host 1 sends packet user host 2 CS network Let us assume sender knows name intended receiver possibly something like eagle cs uni edu The first step find IP address host 2 This lookup performed DNS study Chap 7 For moment assume DNS returns IP address host 2 192 32 65 5 The upper layer software host 1 builds packet 192 32 65 5 Destination address field gives IP software transmit The IP software look address see destination CS network e network However still needs way find destination Ethernet address send frame One solution configuration file somewhere system maps IP addresses onto Ethernet addresses While 468 THE NETWORK LAYER IP3 192 32 63 3 IP1 192 32 65 7 E5 Ethernet switch E1 Router Host 1 E3 192 32 65 1 Host 2 Host 4 192 32 63 1 CS Network 192 32 65 0 24 E2 Host 3 E4 EE Network 192 32 63 0 24 E6 IP4 192 32 63 8 IP2 192 32 65 5 Destination Destination Eth IP Frame Source IP Source Eth Host 1 2 CS net IP1 E1 IP2 E2 Host 1 4 CS net IP1 E1 IP4 E3 Host 1 4 EE net IP1 E4 IP4 E6 Two switched Ethernet LANs joined router solution certainly possible organizations thousands machines keeping files date error prone time consuming job A better solution host 1 output broadcast packet onto Ethernet asking owns IP address 192 32 65 5 The broadcast arrive every machine CS Ethernet one check IP address Host 2 alone respond Ethernet address E2 In way host 1 learns IP address 192 32 65 5 host Ethernet address E2 The protocol used asking question getting reply called ARP Address Resolution Protocol Almost every machine Internet runs ARP defined RFC 826 The advantage using ARP configuration files simplicity The system manager much except assign machine IP address decide subnet masks ARP rest At point IP software host 1 builds Ethernet frame addressed E2 puts IP packet addressed 192 32 65 5 payload field dumps onto Ethernet The IP Ethernet addresses packet given The Ethernet NIC host 2 detects frame recognizes frame scoops causes interrupt The Ethernet driver extracts IP packet payload passes IP software sees correctly addressed processes Various optimizations possible make ARP work efficiently To start machine run ARP caches result case needs contact machine shortly Next time find mapping cache thus eliminating need second broadcast In many cases host 2 SEC 5 6 THE NETWORK LAYER IN THE INTERNET need send back reply forcing run ARP determine sender Ethernet address This ARP broadcast avoided host 1 include IP Ethernet mapping ARP packet When ARP broadcast arrives host 2 pair 192 32 65 7 E1 entered host 2 ARP cache In fact machines Ethernet enter mapping ARP caches To allow mappings change example host configured use new IP address keeps old Ethernet address entries ARP cache time minutes A clever way help keep cached information current optimize performance every machine broadcast mapping configured This broadcast generally done form ARP looking IP address There response side effect broadcast make update entry everyone ARP cache This known gratuitous ARP If response unexpectedly arrive two machines assigned IP address The error must resolved network manager machines use network Now let us look time assume host 1 wants send packet host 4 192 32 63 8 EE network Host 1 see destination IP address CS network It knows send network traffic router also known default gateway By convention default gateway lowest address network 198 31 65 1 To send frame router host 1 must still know Ethernet address router interface CS network It discovers sending ARP broadcast 198 31 65 1 learns E3 It sends frame The lookup mechanisms used send packet one router next sequence routers Internet path When Ethernet NIC router gets frame gives packet IP software It knows network masks packet sent onto EE network reach host 4 If router know Ethernet address host 4 use ARP The table lists source destination Ethernet IP addresses present frames observed CS EE networks Observe Ethernet addresses change frame network IP addresses remain constant indicate endpoints across interconnected networks It also possible send packet host 1 host 4 without host 1 knowing host 4 different network The solution router answer ARPs CS network host 4 give Ethernet address E3 response It possible host 4 reply directly see ARP request routers forward Ethernet level broadcasts The router receive frames sent 192 32 63 8 forward onto EE network This solution called proxy ARP It used special cases host wants appear network even though actually resides another network A common situation example mobile computer wants node pick packets home network 470 THE NETWORK LAYER DHCP The Dynamic Host Configuration Protocol ARP well Internet protocols makes assumption hosts configured basic information IP addresses How hosts get information It possible manually configure computer tedious error prone There better way called DHCP Dynamic Host Configuration Protocol With DHCP every network must DHCP server responsible configuration When computer started built Ethernet link layer address embedded NIC IP address Much like ARP computer broadcasts request IP address network It using DHCP DISCOVER packet This packet must reach DHCP server If server directly attached network router configured receive DHCP broadcasts relay DHCP server wherever located When server receives request allocates free IP address sends host DHCP OFFER packet may relayed via router To able work even hosts IP addresses server identifies host using Ethernet address carried DHCP DISCOVER packet An issue arises automatic assignment IP addresses pool long IP address allocated If host leaves network return IP address DHCP server address permanently lost After period time many addresses may lost To prevent happening IP address assignment may fixed period time technique called leasing Just lease expires host must ask DHCP renewal If fails make request request denied host may longer use IP address given earlier DHCP described RFCs 2131 2132 It widely used Internet configure sorts parameters addition providing hosts IP addresses As well business home networks DHCP used ISPs set parameters devices Internet access link customers need phone ISPs get information Common examples information configured include network mask IP address default gateway IP addresses DNS time servers DHCP largely replaced earlier protocols called RARP BOOTP limited functionality 5 6 5 Label Switching MPLS So far tour network layer Internet focused exclusively packets datagrams forwarded IP routers There also another kind technology starting widely used especially ISPs order move Internet traffic across networks This technology SEC 5 6 THE NETWORK LAYER IN THE INTERNET called MPLS MultiProtocol Label Switching perilously close circuit switching Despite fact many people Internet community intense dislike connection oriented networking idea seems keep coming back As Yogi Berra put like deja vu However essential differences way Internet handles route construction way connection oriented networks technique certainly traditional circuit switching MPLS adds label front packet forwarding based label rather destination address Making label index internal table makes finding correct output line matter table lookup Using technique forwarding done quickly This advantage original motivation behind MPLS began proprietary technology known various names including tag switching Eventually IETF began standardize idea It described RFC 3031 many RFCs The main benefits time come routing flexible forwarding suited quality service well fast The first question ask label go Since IP packets designed virtual circuits field available virtual circuit numbers within IP header For reason new MPLS header added front IP header On router router line using PPP framing protocol frame format including PPP MPLS IP TCP headers shown Headers PPP Bits MPLS IP TCP User data 3 1 Label QoS S TtL CRC Transmitting TCP segment using IP MPLS PPP The generic MPLS header 4 bytes long four fields Most important Label field holds index The QoS field indicates class service The S field relates stacking multiple labels discussed The TtL field indicates many times packet may forwarded It decremented router hits 0 packet discarded This feature prevents infinite looping case routing instability MPLS falls IP network layer protocol PPP link layer protocol It really layer 3 protocol depends IP network 472 THE NETWORK LAYER layer addresses set label paths It really layer 2 protocol either forwards packets across multiple hops single link For reason MPLS sometimes described layer 2 5 protocol It illustration real protocols always fit neatly ideal layered protocol model On brighter side MPLS headers part network layer packet data link layer frame MPLS large extent independent layers Among things property means possible build MPLS switches forward IP packets non IP packets depending shows This feature multiprotocol name MPLS came MPLS also carry IP packets non IP networks When MPLS enhanced packet arrives LSR Label Switched Router label used index table determine outgoing line use also new label use This label swapping used virtual circuit networks Labels local significance two different routers feed unrelated packets label another router transmission outgoing line To distinguishable end labels remapped every hop We saw mechanism action MPLS uses technique As aside people distinguish forwarding switching Forwarding process finding best match destination address table decide send packets An example longest matching prefix algorithm used IP forwarding In contrast switching uses label taken packet index forwarding table It simpler faster These definitions far universal however Since hosts routers understand MPLS also ask labels attached packets This happens IP packet reaches edge MPLS network The LER Label Edge Router inspects destination IP address fields see MPLS path packet follow puts right label front packet Within MPLS network label used forward packet At edge MPLS network label served purpose removed revealing IP packet next network This process shown One difference traditional virtual circuits level aggregation It certainly possible flow set labels MPLS network However common routers group multiple flows end particular router LAN use single label The flows grouped together single label said belong FEC Forwarding Equivalence Class This class covers packets going also service class differentiated services sense packets treated way forwarding purposes With traditional virtual circuit routing possible group several distinct paths different endpoints onto virtual circuit identifier would way distinguish final destination With MPLS SEC 5 6 IP THE NETWORK LAYER IN THE INTERNET Add label Label Switching label Label Remove label IP Label IP next network Label edge router Label switch router Forwarding IP packet MPLS network packets still contain final destination address addition label At end labeled route label header removed forwarding continue usual way using network layer destination address Actually MPLS goes even It operate multiple levels adding one label front packet For example suppose many packets already different labels want treat packets differently somewhere network follow common path destination Instead setting many label switching paths one different labels set single path When already labeled packets reach start path another label added front This called stack labels The outermost label guides packets along path It removed end path labels revealed used forward packet The S bit allows router removing label know additional labels left It set 1 bottom label 0 labels The final question ask label forwarding tables set packets follow This one area major difference MPLS conventional virtual circuit designs In traditional virtual circuit networks user wants establish connection setup packet launched network create path make forwarding table entries MPLS involve users setup phase Requiring users anything send datagram would break much existing Internet software Instead forwarding information set protocols combination routing protocols connection setup protocols These control protocols cleanly separated label forwarding allows multiple different control protocols used One variants works like When router booted checks see routes final destination e g prefixes belong interfaces It creates one FECs allocates label one passes labels neighbors They turn enter labels forwarding tables send new labels neighbors routers acquired path Resources also reserved 474 THE NETWORK LAYER path constructed guarantee appropriate quality service Other variants set different paths traffic engineering paths take unused capacity account create paths demand support service offerings quality service Although basic ideas behind MPLS straightforward details complicated many variations use cases actively developed For information see Davie Farrel 2008 Davie Rekhter 2000 5 6 6 OSPF An Interior Gateway Routing Protocol We finished study packets forwarded Internet It time move next topic routing Internet As mentioned earlier Internet made large number independent networks ASes Autonomous Systems operated different organizations usually company university ISP Inside network organization use algorithm internal routing intradomain routing commonly known Nevertheless handful standard protocols popular In section study problem intradomain routing look OSPF protocol widely used practice An intradomain routing protocol also called interior gateway protocol In next section study problem routing independently operated networks interdomain routing For case networks must use interdomain routing protocol exterior gateway protocol The protocol used Internet BGP Border Gateway Protocol Early intradomain routing protocols used distance vector design based distributed Bellman Ford algorithm inherited ARPANET RIP Routing Information Protocol main example used day It works well small systems less well networks get larger It also suffers count infinity problem generally slow convergence The ARPANET switched link state protocol May 1979 problems 1988 IETF began work link state protocol intradomain routing That protocol called OSPF Open Shortest Path First became standard 1990 It drew protocol called IS IS Intermediate System Intermediate System became ISO standard Because shared heritage two protocols much alike different For complete story see RFC 2328 They dominant intradomain routing protocols router vendors support OSPF widely used company networks IS IS widely used ISP networks Of two give sketch OSPF works Given long experience routing protocols group designing OSPF long list requirements met First algorithm published open literature hence O OSPF A proprietary SEC 5 6 THE NETWORK LAYER IN THE INTERNET solution owned one company would Second new protocol support variety distance metrics including physical distance delay Third dynamic algorithm one adapted changes topology automatically quickly Fourth new OSPF support routing based type service The new protocol able route real time traffic one way traffic different way At time IP Type service field existing routing protocol used This field included OSPF still nobody used eventually removed Perhaps requirement ahead time preceded IETF work differentiated services rejuvenated classes service Fifth related OSPF load balancing splitting load multiple lines Most previous protocols sent packets single best route even two routes equally good The route used In many cases splitting load multiple routes gives better performance Sixth support hierarchical systems needed By 1988 networks grown large router could expected know entire topology OSPF designed router would Seventh modicum security required prevent fun loving students spoofing routers sending false routing information Finally provision needed dealing routers connected Internet via tunnel Previous protocols handle well OSPF supports point point links e g SONET broadcast networks e g LANs Actually able support networks multiple routers communicate directly others called multiaccess networks even broadcast capability Earlier protocols handle case well An example autonomous system network given Hosts omitted generally play role OSPF routers networks may contain hosts Most routers connected routers point point links networks reach hosts networks However routers R3 R4 R5 connected broadcast LAN switched Ethernet OSPF operates abstracting collection actual networks routers links directed graph arc assigned weight distance delay etc A point point connection two routers represented pair arcs one direction Their weights may different A broadcast network represented node network plus node router The arcs network node routers weight 0 They important nonetheless without path network Other networks hosts arc reaching one returning This structure gives routes hosts 476 THE NETWORK LAYER R1 LAN 1 R3 R5 LAN 4 LAN 3 LAN 2 R2 R4 LAN 1 R1 R3 4 LAN 4 R5 LAN 1 LAN 2 R4 R2 b An autonomous system b A graph representation b shows graph representation network What OSPF fundamentally represent actual network graph like use link state method every router compute shortest path nodes Multiple paths may found equally short In case OSPF remembers set shortest paths packet forwarding traffic split across This helps balance load It called ECMP Equal Cost MultiPath Many ASes Internet large nontrivial manage To work scale OSPF allows AS divided numbered areas area network set contiguous networks Areas overlap need exhaustive routers may belong area Routers lie wholly within area called internal routers An area generalization individual network Outside area destinations visible topology This characteristic helps routing scale Every AS backbone area called area 0 The routers area called backbone routers All areas connected backbone possibly tunnels possible go area AS area AS via backbone A tunnel represented graph another arc cost As areas topology backbone visible outside backbone Each router connected two areas called area border router It must also part backbone The job area border router summarize destinations one area inject summary SEC 5 6 THE NETWORK LAYER IN THE INTERNET areas connected This summary includes cost information details topology within area Passing cost information allows hosts areas find best area border router use enter area Not passing topology information reduces traffic simplifies shortest path computations routers areas However one border router area even summary need passed Routes destinations area always start instruction Go border router This kind area called stub area The last kind router AS boundary router It injects routes external destinations ASes area The external routes appear destinations reached via AS boundary router cost An external route injected one AS boundary routers The relationship ASes areas various kinds routers shown One router may play multiple roles example border router also backbone router Area border router Backbone router AS boundary router Internal router One autonomous system Area 2 stub Area 0 backbone Area 1 The relation ASes backbones areas OSPF During normal operation router within area link state database runs shortest path algorithm Its main job calculate shortest path every router network entire AS An area border router needs databases areas connected must run shortest path algorithm area separately For source destination area best intra area route lies wholly within area chosen For source destination different areas inter area route must go source backbone across backbone destination area destination This algorithm forces star configuration OSPF backbone hub areas spokes Because route lowest cost chosen routers different parts network may use different area border routers enter backbone destination area Packets routed source destination They encapsulated tunneled unless going area whose 478 THE NETWORK LAYER connection backbone tunnel Also routes external destinations may include external cost AS boundary router external path desired cost internal AS When router boots sends HELLO messages point point lines multicasts LANs group consisting routers From responses router learns neighbors Routers LAN neighbors OSPF works exchanging information adjacent routers neighboring routers In particular inefficient every router LAN talk every router LAN To avoid situation one router elected designated router It said adjacent routers LAN exchanges information In effect acting single node represents LAN Neighboring routers adjacent exchange information A backup designated router always kept date ease transition primary designated router crash need replaced immediately During normal operation router periodically floods LINK STATE UPDATE messages adjacent routers These messages gives state provide costs used topological database The flooding messages acknowledged make reliable Each message sequence number router see whether incoming LINK STATE UPDATE older newer currently Routers also send messages link goes cost changes DATABASE DESCRIPTION messages give sequence numbers link state entries currently held sender By comparing values sender receiver determine recent values These messages used link brought Either partner request link state information one using LINK STATE REQUEST messages The result algorithm pair adjacent routers checks see recent data new information spread throughout area way All messages sent directly IP packets The five kinds messages summarized Message type Hello Description Used discover neighbors Link state update Provides sender costs neighbors Link state ack Acknowledges link state update Database description Announces updates sender Link state request Requests information partner The five types OSPF messages SEC 5 6 THE NETWORK LAYER IN THE INTERNET Finally put pieces together Using flooding router informs routers area links routers networks cost links This information allows router construct graph area compute shortest paths The backbone area work In addition backbone routers accept information area border routers order compute best route backbone router every router This information propagated back area border routers advertise within areas Using information internal routers select best route destination outside area including best exit router backbone 5 6 7 BGP The Exterior Gateway Routing Protocol Within single AS OSPF IS IS protocols commonly used Between ASes different protocol called BGP Border Gateway Protocol used A different protocol needed goals intradomain protocol interdomain protocol All intradomain protocol move packets efficiently possible source destination It worry politics In contrast interdomain routing protocols worry politics great deal Metz 2001 For example corporate AS might want ability send packets Internet site receive packets Internet site However might unwilling carry transit packets originating foreign AS ending different foreign AS even AS shortest path two foreign ASes That problem On hand might willing carry transit traffic neighbors even specific ASes paid service Telephone companies example might happy act carriers customers others Exterior gateway protocols general BGP particular designed allow many kinds routing policies enforced interAS traffic Typical policies involve political security economic considerations A examples possible routing constraints 1 Do carry commercial traffic educational network 2 Never send traffic Pentagon route Iraq 3 Use TeliaSonera instead Verizon cheaper 4 Don use AT T Australia performance poor 5 Traffic starting ending Apple transit Google As might imagine list routing policies highly individual They often proprietary contain sensitive business information 480 THE NETWORK LAYER However describe patterns capture reasoning company often used starting point A routing policy implemented deciding traffic flow links ASes One common policy customer ISP pays another provider ISP deliver packets destination Internet receive packets sent destination The customer ISP said buy transit service provider ISP This like customer home buying Internet access service ISP To make work provider advertise routes destinations Internet customer link connects In way customer route use send packets anywhere Conversely customer advertise routes destinations network provider This let provider send traffic customer addresses customer want handle traffic intended destinations We see example transit service There four ASes connected The connection often made link IXPs Internet eXchange Points facilities many ISPs link purpose connecting ISPs AS2 AS3 AS4 customers AS1 They buy transit service Thus source A sends destination C packets travel AS2 AS1 finally AS4 The routing advertisements travel opposite direction packets AS4 advertises C destination transit provider AS1 let sources reach C via AS1 Later AS1 advertises route C customers including AS2 let customers know send traffic C via AS1 AS1 Path BGP routing advertisements dash CU TR TR AS4 AS3 PE PE A CU TR CU AS2 Path IP packets solid Routing policy TR Transit CU Customer PE Peer B C Routing policies four autonomous systems In ASes buy transit service AS1 This provides connectivity interact host Internet However pay privilege Suppose AS2 AS3 exchange lot traffic Given networks connected already want SEC 5 6 THE NETWORK LAYER IN THE INTERNET use different policy send traffic directly free This reduce amount traffic must AS1 deliver behalf hopefully reduce bills This policy called peering To implement peering two ASes send routing advertisements addresses reside networks Doing makes possible AS2 send AS3 packets A destined B vice versa However note peering transitive In AS3 AS4 also peer This peering allows traffic C destined B sent directly AS4 What happens C sends packet A AS3 advertising route B AS4 It advertising route A The consequence traffic pass AS4 AS3 AS2 even though physical path exists This restriction exactly AS3 wants It peers AS4 exchange traffic want carry traffic AS4 parts Internet since paid Instead AS4 gets transit service AS1 Thus AS1 carry packet C A Now know transit peering also see A B C transit arrangements For example A must buy Internet access AS2 A might single home computer company network many LANs However need run BGP stub network connected rest Internet one link So place send packets destined outside network link AS2 There nowhere else go This path arranged simply setting default route For reason shown A B C ASes participate interdomain routing On hand company networks connected multiple ISPs This technique used improve reliability since path one ISP fails company use path via ISP This technique called multihoming In case company network likely run interdomain routing protocol e g BGP tell ASes addresses reached via ISP links Many variations transit peering policies possible already illustrate business relationships control route advertisements go implement different kinds policies Now consider detail routers running BGP advertise routes select paths forward packets BGP form distance vector protocol quite unlike intradomain distance vector protocols RIP We already seen policy instead minimum distance used pick routes use Another large difference instead maintaining cost route destination BGP router keeps track path used This approach called path vector protocol The path consists next hop router may side ISP adjacent sequence ASes AS path route followed given reverse order Finally pairs BGP routers communicate 482 THE NETWORK LAYER establishing TCP connections Operating way provides reliable communication also hides details network passed An example BGP routes advertised shown There three ASes middle one providing transit left right ISPs A route advertisement prefix C starts AS3 When propagated across link R2c top figure AS path simply AS3 next hop router R3a At bottom AS path different next hop came across different link This advertisement continues propagate crosses boundary AS1 At router R1a top figure AS path AS2 AS3 next hop R2a AS path Next hop Prefix C AS2 AS3 R1a C AS2 AS3 R2a C AS3 R3a A C R1a C AS2 AS3 R1b R2c R2a C AS2 AS3 R2b R3a C AS3 R3b Path packets B R1b AS1 R2b R2d AS2 R3b AS3 Propagation BGP route advertisements Carrying complete path route makes easy receiving router detect break routing loops The rule router sends route outside AS prepends AS number route This list reverse order When router receives route checks see AS number already AS path If loop detected advertisement discarded However somewhat ironically realized late 1990s despite precaution BGP suffers version count infinity problem Labovitz et al 2001 There long lived loops routes sometimes slow converge transient loops Giving list ASes coarse way specify path An AS might small company international backbone network There way telling route BGP even try different ASes may use different intradomain protocols whose costs compared Even could compared AS may want reveal internal metrics This one ways interdomain routing protocols differ intradomain protocols SEC 5 6 THE NETWORK LAYER IN THE INTERNET So far seen route advertisement sent across link two ISPs We still need way propagate BGP routes one side ISP sent next ISP This task could handled intradomain protocol BGP good scaling large networks variant BGP often used It called iBGP internal BGP distinguish regular use BGP eBGP external BGP The rule propagating routes inside ISP every router boundary ISP learns routes seen boundary routers consistency If one boundary router ISP learns prefix IP 128 208 0 0 16 routers learn prefix The prefix reachable parts ISP matter packets enter ISP ASes We shown propagation avoid clutter example router R2b know reach C via either router R2c top router R2d bottom The next hop updated route crosses within ISP routers far side ISP know router use exit ISP side This seen leftmost routes next hop points router ISP router next ISP We describe key missing piece BGP routers choose route use destination Each BGP router may learn route given destination router connected next ISP boundary routers heard different routes routers connected ISPs Each router must decide route set routes best one use Ultimately answer ISP write policy pick preferred route However explanation general satisfying least describe common strategies The first strategy routes via peered networks chosen preference routes via transit providers The former free latter cost money A similar strategy customer routes given highest preference It good business send traffic directly paying customers A different kind strategy default rule shorter AS paths better This debatable given AS could network size path three small ASes could actually shorter path one big AS However shorter tends better average rule common tiebreaker The final strategy prefer route lowest cost within ISP This strategy implemented Packets sent A C exit AS1 top router R1a Packets sent B exit via bottom router R1b The reason A B taking lowest cost path quickest route AS1 Because located different parts ISP quickest exit one different The thing happens packets pass AS2 On last leg AS3 carry packet B network 484 THE NETWORK LAYER This strategy known early exit hot potato routing It curious side effect tending make routes asymmetric For example consider path taken C sends packet back B The packet exit AS3 quickly top router avoid wasting resources Similarly stay top AS2 passes AS1 quickly possible Then packet longer journey AS1 This mirror image path taken B C The discussion make clear BGP router chooses best route known possibilities It case might naively expected BGP chooses path follow AS level OSPF chooses paths within ASes BGP interior gateway protocol integrated much deeply This means example BGP find best exit point one ISP next point vary across ISP case hot potato policy It also means BGP routers different parts one AS may choose different AS paths reach destination Care must exercised ISP configure BGP routers make compatible choices given freedom done practice Amazingly scratched surface BGP For information see BGP version 4 specification RFC 4271 related RFCs However realize much complexity lies policies described specification BGP protocol 5 6 8 Internet Multicasting Normal IP communication one sender one receiver However applications useful process able send large number receivers simultaneously Examples streaming live sports event many viewers delivering program updates pool replicated servers handling digital conference e multiparty telephone calls IP supports one many communication multicasting using class D IP addresses Each class D address identifies group hosts Twenty eight bits available identifying groups 250 million groups exist time When process sends packet class D address best effort attempt made deliver members group addressed guarantees given Some members may get packet The range IP addresses 224 0 0 0 24 reserved multicast local network In case routing protocol needed The packets multicast simply broadcasting LAN multicast address All hosts LAN receive broadcasts hosts members group process packet Routers forward packet LAN Some examples local multicast addresses 224 0 0 1 All systems LAN 224 0 0 2 All routers LAN 224 0 0 5 All OSPF routers LAN 224 0 0 251 All DNS servers LAN SEC 5 6 THE NETWORK LAYER IN THE INTERNET Other multicast addresses may members different networks In case routing protocol needed But first multicast routers need know hosts members group A process asks host join specific group It also ask host leave group Each host keeps track groups processes currently belong When last process host leaves group host longer member group About minute multicast router sends query packet hosts LAN using local multicast address 224 0 0 1 course asking report back groups currently belong The multicast routers may may colocated standard routers Each host sends back responses class D addresses interested These query response packets use protocol called IGMP Internet Group Management Protocol It described RFC 3376 Any several multicast routing protocols may used build multicast spanning trees give paths senders members group The algorithms used ones described Sec 5 2 8 Within AS main protocol used PIM Protocol Independent Multicast PIM comes several flavors In Dense Mode PIM pruned reverse path forwarding tree created This suited situations members everywhere network distributing files many servers within data center network In Sparse Mode PIM spanning trees built similar core based trees This suited situations content provider multicasting TV subscribers IP network A variant design called Source Specific Multicast PIM optimized case one sender group Finally multicast extensions BGP tunnels need used create multicast routes group members one AS 5 6 9 Mobile IP Many users Internet mobile computers want stay connected away home even road Unfortunately IP addressing system makes working far home easier said done describe shortly When people began demanding ability anyway IETF set Working Group find solution The Working Group quickly formulated number goals considered desirable solution The major ones 1 Each mobile host must able use home IP address anywhere 2 Software changes fixed hosts permitted 3 Changes router software tables permitted 4 Most packets mobile hosts make detours way 5 No overhead incurred mobile host home 486 THE NETWORK LAYER The solution chosen one described Sec 5 2 10 In brief every site wants allow users roam create helper site called home agent When mobile host shows foreign site obtains new IP address called care address foreign site The mobile tells home agent giving care address When packet mobile arrives home site mobile elsewhere home agent grabs packet tunnels mobile current care address The mobile send reply packets directly whoever communicating still using home address source address This solution meets requirements stated except packets mobile hosts make detours Now covered network layer Internet go solution detail The need mobility support first place comes IP addressing scheme Every IP address contains network number host number For example consider machine IP address 160 80 40 20 16 The 160 80 gives network number 40 20 host number Routers world routing tables telling link use get network 160 80 Whenever packet comes destination IP address form 160 80 xxx yyy goes line If sudden machine address carted distant site packets continue routed home LAN router At stage two options unattractive The first could create route specific prefix That distant site advertises route 160 80 40 20 32 packets sent destination start arriving right place This option depends longest matching prefix algorithm used routers However added route IP prefix single IP address All ISPs world learn prefix If everyone changes global IP routes way move computer router would millions table entries astronomical cost Internet This option workable The second option change IP address mobile True packets sent home IP address longer delivered relevant people programs databases informed change But mobile still use Internet new location browse Web run applications This option handles mobility higher layer It typically happens user takes laptop coffee store uses Internet via local wireless network The disadvantage breaks applications keep connectivity mobile moves around As aside mobility also handled lower layer link layer This happens using laptop single 802 11 wireless network The IP address mobile change network path remains It wireless link providing mobility However degree mobility limited If laptop moves far connect Internet via another network different IP address SEC 5 6 THE NETWORK LAYER IN THE INTERNET The mobile IP solution IPv4 given RFC 3344 It works existing Internet routing allows hosts stay connected IP addresses move For work mobile must able discover moved This accomplished ICMP router advertisement solicitation messages Mobiles listen periodic router advertisements send solicitation discover nearest router If router usual address router mobile home must foreign network If router changed since last time mobile moved another foreign network This mechanism lets mobile hosts find home agents To get care IP address foreign network mobile simply use DHCP Alternatively IPv4 addresses short supply mobile send receive packets via foreign agent already IP address network The mobile host finds foreign agent using ICMP mechanism used find home agent After mobile obtains IP address finds foreign agent able use network send message home agent informing home agent current location The home agent needs way intercept packets sent mobile mobile home ARP provides convenient mechanism To send packet Ethernet IP host router needs know Ethernet address host The usual mechanism router send ARP query ask example Ethernet address 160 80 40 20 When mobile home answers ARP queries IP address Ethernet address When mobile away home agent responds query giving Ethernet address The router sends packets 160 80 40 20 home agent Recall called proxy ARP To quickly update ARP mappings back forth mobile leaves home arrives back home another ARP technique called gratuitous ARP used Basically mobile home agent send ARP query mobile IP address supplies right answer router notices updates mapping Tunneling send packet home agent mobile host care address done encapsulating packet another IP header destined care address When encapsulated packet arrives care address outer IP header removed reveal packet As many Internet protocols devil details often details compatibility protocols deployed There two complications First NAT boxes depend peeking past IP header look TCP UDP header The original form tunneling mobile IP use headers work NAT boxes The solution change encapsulation include UDP header The second complication ISPs check source IP addresses packets see match routing protocol believes source located This technique called ingress filtering security 488 THE NETWORK LAYER measure intended discard traffic seemingly incorrect addresses may malicious However packets sent mobile Internet hosts foreign network source IP address place discarded To get around problem mobile use care address source tunnel packets back home agent From sent Internet appears right location The cost route roundabout Another issue discussed security When home agent gets message asking please forward Roberta packets IP address better comply unless convinced Roberta source request somebody trying impersonate Cryptographic authentication protocols used purpose We study protocols Chap 8 Mobility protocols IPv6 build IPv4 foundation The scheme suffers triangle routing problem packets sent mobile take dogleg distant home agent In IPv6 route optimization used follow direct path mobile IP addresses initial packets followed long route Mobile IPv6 defined RFC 3775 There another kind mobility also defined Internet Some airplanes built wireless networking passengers use connect laptops Internet The plane router connects rest Internet via wireless link Did expect wired link So flying router means whole network mobile Network mobility designs support situation without laptops realizing plane mobile As far concerned another network Of course laptops may using mobile IP keep home addresses plane two levels mobility Network mobility defined IPv6 RFC 3963 5 7 SUMMARY The network layer provides services transport layer It based either datagrams virtual circuits In cases main job routing packets source destination In datagram networks routing decision made every packet In virtual circuit networks made virtual circuit set Many routing algorithms used computer networks Flooding simple algorithm send packet along paths Most algorithms find shortest path adapt changes network topology The main algorithms distance vector routing link state routing Most actual networks use one Other important routing topics use hierarchy large networks routing mobile hosts broadcast multicast anycast routing SEC 5 7 SUMMARY Networks easily become congested leading increased delay lost packets Network designers attempt avoid congestion designing network enough capacity choosing uncongested routes refusing accept traffic signaling sources slow shedding load The next step beyond dealing congestion actually try achieve promised quality service Some applications care throughput whereas others care delay jitter The methods used provide different qualities service include combination traffic shaping reserving resources routers admission control Approaches designed good quality service include IETF integrated services including RSVP differentiated services Networks differ various ways multiple networks interconnected problems occur When different networks different maximum packet sizes fragmentation may needed Different networks may run different routing protocols internally need run common protocol externally Sometimes problems finessed tunneling packet hostile network source destination networks different approach fails The Internet rich variety protocols related network layer These include datagram protocol IP associated control protocols ICMP ARP DHCP A connection oriented protocol called MPLS carries IP packets across networks One main routing protocols used within networks OSPF routing protocol used across networks BGP The Internet rapidly running IP addresses new version IP IPv6 developed ever slowly deployed PROBLEMS 1 Give two example computer applications connection oriented service appropriate Now give two examples connectionless service best 2 Datagram networks route packet separate unit independent others Virtual circuit networks since data packet follows predetermined route Does observation mean virtual circuit networks need capability route isolated packets arbitrary source arbitrary destination Explain answer 3 Give three examples protocol parameters might negotiated connection set 4 Assuming routers hosts working properly software free errors chance however small packet delivered wrong destination 490 THE NETWORK LAYER 5 Give simple heuristic finding two paths network given source given destination survive loss communication line assuming two paths exist The routers considered reliable enough necessary worry possibility router crashes 6 Consider network Distance vector routing used following vectors come router C B 5 0 8 12 6 2 D 16 12 6 0 9 10 E 7 6 3 9 0 4 The cost links C B D E 6 3 5 respectively What C new routing table Give outgoing line use cost 7 If costs recorded 8 bit numbers 50 router network distance vectors exchanged twice second much bandwidth per full duplex line chewed distributed routing algorithm Assume router three lines routers 8 In Boolean OR two sets ACF bits 111 every row Is accident hold networks circumstances 9 For hierarchical routing 4800 routers region cluster sizes chosen minimize size routing table three layer hierarchy A good starting place hypothesis solution k clusters k regions k routers close optimal means k cube root 4800 around 16 Use trial error check combinations three parameters general vicinity 16 10 In text stated mobile host home packets sent home LAN intercepted home agent LAN For IP network 802 3 LAN home agent accomplish interception 11 Looking network many packets generated broadcast B using reverse path forwarding b sink tree 12 Consider network Imagine one new line added F G sink tree b remains unchanged What changes occur c 13 Compute multicast spanning tree router C following network group members routers A B C D E F I K C B F A D E K G J H L I CHAP 5 PROBLEMS 14 Suppose node B rebooted routing information tables It suddenly needs route H It sends broadcasts TtL set 1 2 3 How many rounds take find route 15 As possible congestion control mechanism network using virtual circuits internally router could refrain acknowledging received packet 1 knows last transmission along virtual circuit received successfully 2 free buffer For simplicity assume routers use stop wait protocol virtual circuit one buffer dedicated direction traffic If takes T sec transmit packet data acknowledgement n routers path rate packets delivered destination host Assume transmission errors rare host router connection infinitely fast 16 A datagram network allows routers drop packets whenever need The probability router discarding packet p Consider case source host connected source router connected destination router destination host If either routers discards packet source host eventually times tries If host router router router lines counted hops mean number hops packet makes per transmission b transmissions packet makes c hops required per received packet 17 Describe two major differences ECN method RED method congestion avoidance 18 A token bucket scheme used traffic shaping A new token put bucket every 5 sec Each token good one short packet contains 48 bytes data What maximum sustainable data rate 19 A computer 6 Mbps network regulated token bucket The token bucket filled rate 1 Mbps It initially filled capacity 8 megabits How long computer transmit full 6 Mbps 20 The network uses RSVP multicast trees hosts 1 2 shown Suppose host 3 requests channel bandwidth 2 MB sec flow host 1 another channel bandwidth 1 MB sec flow host 2 At time host 4 requests channel bandwidth 2 MB sec flow host 1 host 5 requests channel bandwidth 1 MB sec flow host 2 How much total bandwidth reserved requests routers A B C E H J K L 21 A router process 2 million packets sec The load offered 1 5 million packets sec average If route source destination contains 10 routers much time spent queued serviced router 22 Consider user differentiated services expedited forwarding Is guarantee expedited packets experience shorter delay regular packets Why 492 THE NETWORK LAYER 23 Suppose host A connected router R 1 R 1 connected another router R 2 R 2 connected host B Suppose TCP message contains 900 bytes data 20 bytes TCP header passed IP code host A delivery B Show Total length Identification DF MF Fragment offset fields IP header packet transmitted three links Assume link A R1 support maximum frame size 1024 bytes including 14 byte frame header link R1 R2 support maximum frame size 512 bytes including 8 byte frame header link R2 B support maximum frame size 512 bytes including 12 byte frame header 24 A router blasting IP packets whose total length data plus header 1024 bytes Assuming packets live 10 sec maximum line speed router operate without danger cycling IP datagram ID number space 25 An IP datagram using Strict source routing option fragmented Do think option copied fragment sufficient put first fragment Explain answer 26 Suppose instead using 16 bits network part class B address originally 20 bits used How many class B networks would 27 Convert IP address whose hexadecimal representation C22F1582 dotted decimal notation 28 A network Internet subnet mask 255 255 240 0 What maximum number hosts handle 29 While IP addresses tried specific networks Ethernet addresses Can think good reason 30 A large number consecutive IP addresses available starting 198 16 0 0 Suppose four organizations A B C D request 4000 2000 4000 8000 addresses respectively order For give first IP address assigned last IP address assigned mask w x z notation 31 A router received following new IP addresses 57 6 96 0 21 57 6 104 0 21 57 6 112 0 21 57 6 120 0 21 If use outgoing line aggregated If If 32 The set IP addresses 29 18 0 0 19 18 128 255 aggregated 29 18 0 0 17 However gap 1024 unassigned addresses 29 18 60 0 29 18 63 255 suddenly assigned host using different outgoing line Is necessary split aggregate address constituent blocks add new block table see reaggregation possible If done instead 33 A router following CIDR entries routing table Address mask 135 46 56 0 22 135 46 60 0 22 192 53 40 0 23 default Next hop Interface 0 Interface 1 Router 1 Router 2 CHAP 5 PROBLEMS For following IP addresses router packet address arrives 135 46 63 10 b 135 46 57 14 c 135 46 52 2 192 53 40 7 e 192 53 56 7 34 Many companies policy two routers connecting company Internet provide redundancy case one goes Is policy still possible NAT Explain answer 35 You explained ARP protocol friend When done says I got ARP provides service network layer part data link layer What say 36 Describe way reassemble IP fragments destination 37 Most IP datagram reassembly algorithms timer avoid lost fragment tie reassembly buffers forever Suppose datagram fragmented four fragments The first three fragments arrive last one delayed Eventually timer goes three fragments receiver memory discarded A little later last fragment stumbles What done 38 In IP checksum covers header data Why suppose design chosen 39 A person lives Boston travels Minneapolis taking portable computer To surprise LAN destination Minneapolis wireless IP LAN plug Is still necessary go entire business home agents foreign agents make email traffic arrive correctly 40 IPv6 uses 16 byte addresses If block 1 million addresses allocated every picosecond long addresses last 41 The Protocol field used IPv4 header present fixed IPv6 header Why 42 When IPv6 protocol introduced ARP protocol changed If changes conceptual technical 43 Write program simulate routing using flooding Each packet contain counter decremented hop When counter gets zero packet discarded Time discrete line handling one packet per time interval Make three versions program lines flooded lines except input line flooded statically chosen best k lines flooded Compare flooding deterministic routing k 1 terms delay bandwidth used 44 Write program simulates computer network using discrete time The first packet router queue makes one hop per time interval Each router finite number buffers If packet arrives room discarded 494 THE NETWORK LAYER retransmitted Instead end end protocol complete timeouts acknowledgement packets eventually regenerates packet source router Plot throughput network function end end timeout interval parameterized error rate 45 Write function forwarding IP router The procedure one parameter IP address It also access global table consisting array triples Each triple contains three integers IP address subnet mask outline line use The function looks IP address table using CIDR returns line use value 46 Use traceroute UNIX tracert Windows programs trace route computer various universities continents Make list transoceanic links discovered Some sites try www berkeley edu California www mit edu Massachusetts www vu nl Amsterdam www ucl ac uk London www usyd edu au Sydney www u tokyo ac jp Tokyo www uct ac za Cape Town 6 THE TRANSPORT LAYER Together network layer transport layer heart protocol hierarchy The network layer provides end end packet delivery using datagrams virtual circuits The transport layer builds network layer provide data transport process source machine process destination machine desired level reliability independent physical networks currently use It provides abstractions applications need use network Without transport layer whole concept layered protocols would make little sense In chapter study transport layer detail including services choice API design tackle issues reliability connections congestion control protocols TCP UDP performance 6 1 THE TRANSPORT SERVICE In following sections provide introduction transport service We look kind service provided application layer To make issue transport service concrete examine two sets transport layer primitives First comes simple hypothetical one show basic ideas Then comes interface commonly used Internet 496 THE TRANSPORT LAYER 6 1 1 Services Provided Upper Layers The ultimate goal transport layer provide efficient reliable cost effective data transmission service users normally processes application layer To achieve transport layer makes use services provided network layer The software hardware within transport layer work called transport entity The transport entity located operating system kernel library package bound network applications separate user process even network interface card The first two options common Internet The logical relationship network transport application layers illustrated Host 1 Host 2 Application session layer Transport address Transport entity Network address Network layer Application session layer Application transport interface Segment Transport protocol Transport network interface Transport entity Network layer The network transport application layers Just two types network service connection oriented connectionless also two types transport service The connection oriented transport service similar connection oriented network service many ways In cases connections three phases establishment data transfer release Addressing flow control also similar layers Furthermore connectionless transport service also similar connectionless network service However note difficult provide connectionless transport service top connection oriented network service since inefficient set connection send single packet tear immediately afterwards The obvious question transport layer service similar network layer service two distinct layers Why one layer SEC 6 1 THE TRANSPORT SERVICE adequate The answer subtle crucial The transport code runs entirely users machines network layer mostly runs routers operated carrier least wide area network What happens network layer offers inadequate service What frequently loses packets What happens routers crash time time Problems occur The users real control network layer solve problem poor service using better routers putting error handling data link layer routers The possibility put top network layer another layer improves quality service If connectionless network packets lost mangled transport entity detect problem compensate using retransmissions If connection oriented network transport entity informed halfway long transmission network connection abruptly terminated indication happened data currently transit set new network connection remote transport entity Using new network connection send query peer asking data arrived knowing pick left In essence existence transport layer makes possible transport service reliable underlying network Furthermore transport primitives implemented calls library procedures make independent network primitives The network service calls may vary considerably one network another e g calls based connectionless Ethernet may quite different calls connection oriented WiMAX network Hiding network service behind set transport service primitives ensures changing network merely requires replacing one set library procedures another one thing different underlying service Thanks transport layer application programmers write code according standard set primitives programs work wide variety networks without worry dealing different network interfaces levels reliability If real networks flawless service primitives guaranteed never ever change transport layer might needed However real world fulfills key function isolating upper layers technology design imperfections network For reason many people made qualitative distinction layers 1 4 one hand layer 4 The bottom four layers seen transport service provider whereas upper layer transport service user This distinction provider versus user considerable impact design layers puts transport layer key position since forms major boundary provider user reliable data transmission service It level applications see 498 THE TRANSPORT LAYER 6 1 2 Transport Service Primitives To allow users access transport service transport layer must provide operations application programs transport service interface Each transport service interface In section first examine simple hypothetical transport service interface see bare essentials In following section look real example The transport service similar network service also important differences The main difference network service intended model service offered real networks warts Real networks lose packets network service generally unreliable The connection oriented transport service contrast reliable Of course real networks error free precisely purpose transport layer provide reliable service top unreliable network As example consider two processes single machine connected pipe UNIX interprocess communication facility They assume connection 100 perfect They want know acknowledgements lost packets congestion anything like What want 100 reliable connection Process A puts data one end pipe process B takes This connection oriented transport service hiding imperfections network service user processes assume existence error free bit stream even different machines As aside transport layer also provide unreliable datagram service However relatively little say besides datagrams mainly concentrate connection oriented transport service chapter Nevertheless applications client server computing streaming multimedia build connectionless transport service say little bit later A second difference network service transport service services intended The network service used transport entities Few users write transport entities thus users programs ever see bare network service In contrast many programs thus programmers see transport primitives Consequently transport service must convenient easy use To get idea transport service might like consider five primitives listed This transport interface truly bare bones gives essential flavor connection oriented transport interface It allows application programs establish use release connections sufficient many applications To see primitives might used consider application server number remote clients To start server executes LISTEN primitive typically calling library procedure makes system call SEC 6 1 THE TRANSPORT SERVICE Primitive Packet sent Meaning LISTEN none Block process tries connect CONNECT CONNECTION REQ Actively attempt establish connection SEND DATA Send information RECEIVE none Block DATA packet arrives DISCONNECT DISCONNECTION REQ Request release connection The primitives simple transport service blocks server client turns When client wants talk server executes CONNECT primitive The transport entity carries primitive blocking caller sending packet server Encapsulated payload packet transport layer message server transport entity A quick note terminology order For lack better term use term segment messages sent transport entity transport entity TCP UDP Internet protocols use term Some older protocols used ungainly name TPDU Transport Protocol Data Unit That term used much may see older papers books Thus segments exchanged transport layer contained packets exchanged network layer In turn packets contained frames exchanged data link layer When frame arrives data link layer processes frame header destination address matches local delivery passes contents frame payload field network entity The network entity similarly processes packet header passes contents packet payload transport entity This nesting illustrated Frame header Packet header Segment header Segment payload Packet payload Frame payload Nesting segments packets frames Getting back client server example client CONNECT call causes CONNECTION REQUEST segment sent server When arrives 500 THE TRANSPORT LAYER transport entity checks see server blocked LISTEN e interested handling requests If unblocks server sends CONNECTION ACCEPTED segment back client When segment arrives client unblocked connection established Data exchanged using SEND RECEIVE primitives In simplest form either party blocking RECEIVE wait party SEND When segment arrives receiver unblocked It process segment send reply As long sides keep track whose turn send scheme works fine Note transport layer even simple unidirectional data exchange complicated network layer Every data packet sent also acknowledged eventually The packets bearing control segments also acknowledged implicitly explicitly These acknowledgements managed transport entities using network layer protocol visible transport users Similarly transport entities need worry timers retransmissions None machinery visible transport users To transport users connection reliable bit pipe one user stuffs bits magically appear order end This ability hide complexity reason layered protocols powerful tool When connection longer needed must released free table space within two transport entities Disconnection two variants asymmetric symmetric In asymmetric variant either transport user issue DISCONNECT primitive results DISCONNECT segment sent remote transport entity Upon arrival connection released In symmetric variant direction closed separately independently one When one side DISCONNECT means data send still willing accept data partner In model connection released sides done DISCONNECT A state diagram connection establishment release simple primitives given Each transition triggered event either primitive executed local transport user incoming packet For simplicity assume segment separately acknowledged We also assume symmetric disconnection model used client going first Please note model quite unsophisticated We look realistic models later describe TCP works 6 1 3 Berkeley Sockets Let us briefly inspect another set transport primitives socket primitives used TCP Sockets first released part Berkeley UNIX 4 2BSD software distribution 1983 They quickly became popular The primitives widely used Internet programming many operating SEC 6 1 THE TRANSPORT SERVICE Connection request segment received Connect primitive executed IDLE PASSIVE ESTABLISHMENT PENDING ACTIVE ESTABLISHMENT PENDING Connect primitive executed PASSIVE DISCONNECT PENDING ESTABLISHED Disconnection request segment received Disconnect primitive executed Connection accepted segment received Disconnect primitive executed IDLE ACTIVE DISCONNECT PENDING Disconnection request segment received A state diagram simple connection management scheme Transitions labeled italics caused packet arrivals The solid lines show client state sequence The dashed lines show server state sequence systems especially UNIX based systems socket style API Windows called winsock The primitives listed Roughly speaking follow model first example offer features flexibility We look corresponding segments That discussion come later Primitive Meaning SOCKET Create new communication endpoint BIND Associate local address socket LISTEN Announce willingness accept connections give queue size ACCEPT Passively establish incoming connection CONNECT Actively attempt establish connection SEND Send data connection RECEIVE Receive data connection CLOSE Release connection The socket primitives TCP 502 THE TRANSPORT LAYER The first four primitives list executed order servers The SOCKET primitive creates new endpoint allocates table space within transport entity The parameters call specify addressing format used type service desired e g reliable byte stream protocol A successful SOCKET call returns ordinary file descriptor use succeeding calls way OPEN call file Newly created sockets network addresses These assigned using BIND primitive Once server bound address socket remote clients connect The reason SOCKET call create address directly processes care addresses e g using address years everyone knows address whereas others Next comes LISTEN call allocates space queue incoming calls case several clients try connect time In contrast LISTEN first example socket model LISTEN blocking call To block waiting incoming connection server executes ACCEPT primitive When segment asking connection arrives transport entity creates new socket properties original one returns file descriptor The server fork process thread handle connection new socket go back waiting next connection original socket ACCEPT returns file descriptor used reading writing standard way files Now let us look client side Here socket must first created using SOCKET primitive BIND required since address used matter server The CONNECT primitive blocks caller actively starts connection process When completes e appropriate segment received server client process unblocked connection established Both sides use SEND RECEIVE transmit receive data full duplex connection The standard UNIX READ WRITE system calls also used none special options SEND RECEIVE required Connection release sockets symmetric When sides executed CLOSE primitive connection released Sockets proved tremendously popular de facto standard abstracting transport services applications The socket API often used TCP protocol provide connection oriented service called reliable byte stream simply reliable bit pipe described However protocols could used implement service using API It transport service users A strength socket API used application transport services For instance sockets used connectionless transport service In case CONNECT sets address remote transport peer SEND RECEIVE send receive datagrams remote peer SEC 6 1 THE TRANSPORT SERVICE It also common use expanded set calls example SENDTO RECEIVEFROM emphasize messages limit application single transport peer Sockets also used transport protocols provide message stream rather byte stream congestion control For example DCCP Datagram Congestion Controlled Protocol version UDP congestion control Kohler et al 2006 It transport users understand service getting However sockets likely final word transport interfaces For example applications often work group related streams Web browser requests several objects server With sockets natural fit application programs use one stream per object This structure means congestion control applied separately stream across group suboptimal It punts application burden managing set Newer protocols interfaces devised support groups related streams effectively simply application Two examples SCTP Stream Control Transmission Protocol defined RFC 4960 SST Structured Stream Transport Ford 2007 These protocols must change socket API slightly get benefits groups related streams also support features mix connection oriented connectionless traffic even multiple network paths Time tell successful 6 1 4 An Example Socket Programming An Internet File Server As example nitty gritty real socket calls made consider client server code Here primitive Internet file server along example client uses The code many limitations discussed principle server code compiled run UNIX system connected Internet The client code compiled run UNIX machine Internet anywhere world The client code executed appropriate parameters fetch file server access machine The file written standard output course redirected file pipe Let us look server code first It starts including standard headers last three contain main Internet related definitions data structures Next comes definition SERVER PORT 12345 This number chosen arbitrarily Any number 1024 65535 work well long use process ports 1023 reserved privileged users The next two lines server define two constants needed The first one determines chunk size bytes used file transfer The second one determines many pending connections held additional ones discarded upon arrival 504 THE TRANSPORT LAYER This page contains client program request file server program next page The server responds sending whole file include sys types h include sys socket h include netinet h include netdb h define SERVER PORT 12345 define BUF SIZE 4096 arbitrary client server must agree block transfer size int main int argc char argv int c bytes char buf BUF SIZE struct hostent h struct sockaddr channel buffer incoming file info server holds IP address argc 3 fatal Usage client server name file name h gethostbyname argv 1 look host IP address h fatal gethostbyname failed socket PF INET SOCK STREAM IPPROTO TCP 0 fatal socket memset channel 0 sizeof channel channel sin family AF INET memcpy channel sin addr addr h h addr h h length channel sin port htons SERVER PORT c connect struct sockaddr channel sizeof channel c 0 fatal connect failed Connection established Send file name including 0 byte end write argv 2 strlen argv 2 1 Go get file write standard output 1 read socket bytes read buf BUF SIZE bytes 0 exit 0 check end file write 1 buf bytes write standard output fatal char string printf n string exit 1 Client code using sockets The server code next page SEC 6 1 THE TRANSPORT SERVICE include sys types h include sys fcntl h include sys socket h include netinet h include netdb h This server code define SERVER PORT 12345 define BUF SIZE 4096 define QUEUE SIZE 10 arbitrary client server must agree block transfer size int main int argc char argv int b l fd sa bytes 1 char buf BUF SIZE struct sockaddr channel buffer outgoing file holds IP address Build address structure bind socket memset channel 0 sizeof channel zero channel channel sin family AF INET channel sin addr addr htonl INADDR ANY channel sin port htons SERVER PORT Passive open Wait connection socket AF INET SOCK STREAM IPPROTO TCP create socket 0 fatal socket failed setsockopt SOL SOCKET SO REUSEADDR char sizeof b bind struct sockaddr channel sizeof channel b 0 fatal bind failed l listen QUEUE SIZE l 0 fatal listen failed specify queue size Socket set bound Wait connection process 1 sa accept 0 0 block connection request sa 0 fatal accept failed read sa buf BUF SIZE read file name socket Get return file fd open buf O RDONLY fd 0 fatal open failed open file sent back 1 bytes read fd buf BUF SIZE read file bytes 0 break check end file write sa buf bytes write bytes socket close fd close file close sa close connection 506 THE TRANSPORT LAYER After declarations local variables server code begins It starts initializing data structure hold server IP address This data structure soon bound server socket The call memset sets data structure 0s The three assignments following fill three fields The last contains server port The functions htonl htons converting values standard format code runs correctly little endian machines e g Intel x86 big endian machines e g SPARC Their exact semantics relevant Next server creates socket checks errors indicated 0 In production version code error message could trifle explanatory The call setsockopt needed allow port reused server run indefinitely fielding request request Now IP address bound socket check made see call bind succeeded The final step initialization call listen announce server willingness accept incoming calls tell system hold QUEUE SIZE case new requests arrive server still processing current one If queue full additional requests arrive quietly discarded At point server enters main loop never leaves The way stop kill outside The call accept blocks server client tries establish connection If accept call succeeds returns socket descriptor used reading writing analogous file descriptors used read write pipes However unlike pipes unidirectional sockets bidirectional sa accepted socket used reading connection also writing A pipe file descriptor reading writing After connection established server reads file name If name yet available server blocks waiting After getting file name server opens file enters loop alternately reads blocks file writes socket entire file copied Then server closes file connection waits next connection show It repeats loop forever Now let us look client code To understand works necessary understand invoked Assuming called client typical call client flits cs vu nl usr tom filename f This call works server already running flits cs vu nl file usr tom filename exists server read access If call successful file transferred Internet written f client program exits Since server continues transfer client started get files The client code starts includes declarations Execution begins checking see called right number arguments argc 3 means program name plus two arguments Note argv 1 contains SEC 6 1 THE TRANSPORT SERVICE name server e g flits cs vu nl converted IP address gethostbyname This function uses DNS look name We study DNS Chap 7 Next socket created initialized After client attempts establish TCP connection server using connect If server running named machine attached SERVER PORT either idle room listen queue connection eventually established Using connection client sends name file writing socket The number bytes sent one larger name proper since 0 byte terminating name must also sent tell server name ends Now client enters loop reading file block block socket copying standard output When done exits The procedure fatal prints error message exits The server needs procedure omitted due lack space page Since client server compiled separately normally run different computers share code fatal These two programs well material related book fetched book Web site http www pearsonhighered com tanenbaum Just record server last word serverdom Its error checking meager error reporting mediocre Since handles requests strictly sequentially single thread performance poor It clearly never heard security using bare UNIX system calls way gain platform independence It also makes assumptions technically illegal assuming file name fits buffer transmitted atomically These shortcomings notwithstanding working Internet file server In exercises reader invited improve For information programming sockets see Donahoo Calvert 2008 2009 6 2 ELEMENTS OF TRANSPORT PROTOCOLS The transport service implemented transport protocol used two transport entities In ways transport protocols resemble data link protocols studied detail Chap 3 Both deal error control sequencing flow control among issues However significant differences two also exist These differences due major dissimilarities environments two protocols operate shown At data link layer two routers 508 THE TRANSPORT LAYER communicate directly via physical channel whether wired wireless whereas transport layer physical channel replaced entire network This difference many important implications protocols Router Router Physical communication channel Network Host b Environment data link layer b Environment transport layer For one thing point point links wires optical fiber usually necessary router specify router wants talk outgoing line leads directly particular router In transport layer explicit addressing destinations required For another thing process establishing connection wire simple end always unless crashed case Either way much Even wireless links process much different Just sending message sufficient reach destinations If message acknowledged due error resent In transport layer initial connection establishment complicated see Another exceedingly annoying difference data link layer transport layer potential existence storage capacity network When router sends packet link may arrive lost bounce around go hiding far corner world suddenly emerge packets sent much later If network uses datagrams independently routed inside nonnegligible probability packet may take scenic route arrive late expected order even duplicates packet arrive The consequences network ability delay duplicate packets sometimes disastrous require use special protocols correctly transport information A final difference data link transport layers one degree rather kind Buffering flow control needed layers presence transport layer large varying number connections bandwidth fluctuates connections compete may require different approach used data link layer Some protocols discussed Chap 3 allocate fixed number buffers line frame arrives buffer always available In transport layer larger number connections must managed variations bandwidth SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS connection may receive make idea dedicating many buffers one less attractive In following sections examine important issues others 6 2 1 Addressing When application e g user process wishes set connection remote application process must specify one connect Connectionless transport problem message sent The method normally used define transport addresses processes listen connection requests In Internet endpoints called ports We use generic term TSAP Transport Service Access Point mean specific endpoint transport layer The analogous endpoints network layer e network layer addresses surprisingly called NSAPs Network Service Access Points IP addresses examples NSAPs illustrates relationship NSAPs TSAPs transport connection Application processes clients servers attach local TSAP establish connection remote TSAP These connections run NSAPs host shown The purpose TSAPs networks computer single NSAP way needed distinguish multiple transport endpoints share NSAP Host 1 Application process Host 2 Server 1 Server 2 TSAP 1208 Application layer Transport connection NSAP Transport TSAP 1522 layer TSAP1836 Network layer NSAP Data link layer Physical layer TSAPs NSAPs transport connections 510 THE TRANSPORT LAYER A possible scenario transport connection follows 1 A mail server process attaches TSAP 1522 host 2 wait incoming call How process attaches TSAP outside networking model depends entirely local operating system A call LISTEN might used example 2 An application process host 1 wants send email message attaches TSAP 1208 issues CONNECT request The request specifies TSAP 1208 host 1 source TSAP 1522 host 2 destination This action ultimately results transport connection established application process server 3 The application process sends mail message 4 The mail server responds say deliver message 5 The transport connection released Note may well servers host 2 attached TSAPs waiting incoming connections arrive NSAP The picture painted fine except swept one little problem rug user process host 1 know mail server attached TSAP 1522 One possibility mail server attaching TSAP 1522 years gradually network users learned In model services stable TSAP addresses listed files well known places For example etc services file UNIX systems lists servers permanently attached ports including fact mail server found TCP port 25 While stable TSAP addresses work small number key services never change e g Web server user processes general often want talk user processes TSAP addresses known advance may exist short time To handle situation alternative scheme used In scheme exists special process called portmapper To find TSAP address corresponding given service name BitTorrent user sets connection portmapper listens well known TSAP The user sends message specifying service name portmapper sends back TSAP address Then user releases connection portmapper establishes new one desired service In model new service created must register portmapper giving service name typically ASCII string TSAP The portmapper records information internal database queries come later know answers SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS The function portmapper analogous directory assistance operator telephone system provides mapping names onto numbers Just telephone system essential address well known TSAP used portmapper indeed well known If know number information operator call information operator find If think number dial information obvious try foreign country sometime Many server processes exist machine used rarely It wasteful active listening stable TSAP address day long An alternative scheme shown simplified form It known initial connection protocol Instead every conceivable server listening well known TSAP machine wishes offer services remote users special process server acts proxy less heavily used servers This server called inetd UNIX systems It listens set ports time waiting connection request Potential users service begin CONNECT request specifying TSAP address service want If server waiting get connection process server shown Host 1 Host 2 Host 1 Host 2 Mail server Layer Process server User Process server User TSAP b How user process host 1 establishes connection mail server host 2 via process server After gets incoming request process server spawns requested server allowing inherit existing connection user The new server 512 THE TRANSPORT LAYER requested work process server goes back listening new requests shown b This method applicable servers created demand 6 2 2 Connection Establishment Establishing connection sounds easy actually surprisingly tricky At first glance would seem sufficient one transport entity send CONNECTION REQUEST segment destination wait CONNECTION ACCEPTED reply The problem occurs network lose delay corrupt duplicate packets This behavior causes serious complications Imagine network congested acknowledgements hardly ever get back time packet times retransmitted two three times Suppose network uses datagrams inside every packet follows different route Some packets might get stuck traffic jam inside network take long time arrive That may delayed network pop much later sender thought lost The worst possible nightmare follows A user establishes connection bank sends messages telling bank transfer large amount money account entirely trustworthy person Unfortunately packets decide take scenic route destination go exploring remote corner network The sender times sends This time packets take shortest route delivered quickly sender releases connection Unfortunately eventually initial batch packets finally come hiding arrive destination order asking bank establish new connection transfer money The bank way telling duplicates It must assume second independent transaction transfers money This scenario may sound unlikely even implausible point protocols must designed correct cases Only common cases need implemented efficiently obtain good network performance protocol must able cope uncommon cases without breaking If built fair weather network fail without warning conditions get tough For remainder section study problem delayed duplicates emphasis algorithms establishing connections reliable way nightmares like one happen The crux problem delayed duplicates thought new packets We prevent packets duplicated delayed But happens packets must rejected duplicates processed fresh packets The problem attacked various ways none satisfactory One way use throwaway transport addresses In approach time SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS transport address needed new one generated When connection released address discarded never used Delayed duplicate packets never find way transport process damage However approach makes difficult connect process first place Another possibility give connection unique identifier e sequence number incremented connection established chosen initiating party put segment including one requesting connection After connection released transport entity update table listing obsolete connections peer transport entity connection identifier pairs Whenever connection request comes checked table see belongs previously released connection Unfortunately scheme basic flaw requires transport entity maintain certain amount history information indefinitely This history must persist source destination machines Otherwise machine crashes loses memory longer know connection identifiers already used peers Instead need take different tack simplify problem Rather allowing packets live forever within network devise mechanism kill aged packets still hobbling With restriction problem becomes somewhat manageable Packet lifetime restricted known maximum using one following techniques 1 Restricted network design 2 Putting hop counter packet 3 Timestamping packet The first technique includes method prevents packets looping combined way bounding delay including congestion known longest possible path It difficult given internets may range single city international scope The second method consists hop count initialized appropriate value decremented time packet forwarded The network protocol simply discards packet whose hop counter becomes zero The third method requires packet bear time created routers agreeing discard packet older agreed upon time This latter method requires router clocks synchronized nontrivial task practice hop counter close enough approximation age In practice need guarantee packet dead also acknowledgements dead introduce period T small multiple true maximum packet lifetime The maximum packet lifetime conservative constant network Internet somewhat arbitrarily taken 120 seconds The multiple protocol dependent 514 THE TRANSPORT LAYER simply effect making T longer If wait time T secs packet sent sure traces gone neither acknowledgements suddenly appear blue complicate matters With packet lifetimes bounded possible devise practical foolproof way reject delayed duplicate segments The method described due Tomlinson 1975 refined Sunshine Dalal 1978 Variants widely used practice including TCP The heart method source label segments sequence numbers reused within T secs The period T rate packets per second determine size sequence numbers In way one packet given sequence number may outstanding given time Duplicates packet may still occur must discarded destination However longer case delayed duplicate old packet may beat new packet sequence number accepted destination stead To get around problem machine losing memory crash one possibility require transport entities idle T secs recovery The idle period let old segments die sender start sequence number However complex internetwork T may large strategy unattractive Instead Tomlinson proposed equipping host time day clock The clocks different hosts need synchronized Each clock assumed take form binary counter increments uniform intervals Furthermore number bits counter must equal exceed number bits sequence numbers Last important clock assumed continue running even host goes When connection set low order k bits clock used k bit initial sequence number Thus unlike protocols Chap 3 connection starts numbering segments different initial sequence number The sequence space large time sequence numbers wrap around old segments sequence number long gone This linear relation time initial sequence numbers shown The forbidden region shows times segment sequence numbers illegal leading use If segment sent sequence number region could delayed impersonate different packet sequence number issued slightly later For example host crashes restarts time 70 seconds use initial sequence numbers based clock pick left host start lower sequence number forbidden region Once transport entities agreed initial sequence number sliding window protocol used data flow control This window protocol correctly find discard duplicates packets already SEC 6 2 2k 1 70 Restart crash 70 Sequence numbers T F orb gi idd e n Sequence numbers T 0 ELEMENTS OF TRANSPORT PROTOCOLS Actual sequence numbers used 90 120 150 180 Time Time b Segments may enter forbidden region b The resynchronization problem accepted In reality initial sequence number curve shown heavy line linear staircase since clock advances discrete steps For simplicity ignore detail To keep packet sequence numbers forbidden region need take care two respects We get trouble two distinct ways If host sends much data fast newly opened connection actual sequence number versus time curve may rise steeply initial sequence number versus time curve causing sequence number enter forbidden region To prevent happening maximum data rate connection one segment per clock tick This also means transport entity must wait clock ticks opening new connection crash restart lest number used twice Both points argue favor short clock tick 1 sec less But clock tick fast relative sequence number For clock rate C sequence number space size S must S C T sequence numbers wrap around quickly Entering forbidden region underneath sending fast way get trouble From b see data rate less clock rate curve actual sequence numbers used versus time eventually run forbidden region left sequence numbers wrap around The greater slope actual sequence numbers longer event delayed Avoiding situation limits slowly sequence numbers advance connection long connections may last The clock based method solves problem able distinguish delayed duplicate segments new segments However practical snag using establishing connections Since normally remember sequence numbers across connections destination still way 516 THE TRANSPORT LAYER knowing CONNECTION REQUEST segment containing initial sequence number duplicate recent connection This snag exist connection sliding window protocol remember current sequence number To solve specific problem Tomlinson 1975 introduced three way handshake This establishment protocol involves one peer checking connection request indeed current The normal setup procedure host 1 initiates shown Host 1 chooses sequence number x sends CONNECTION REQUEST segment containing host 2 Host 2 replies ACK segment acknowledging x announcing initial sequence number Finally host 1 acknowledges host 2 choice initial sequence number first data segment sends Now let us see three way handshake works presence delayed duplicate control segments In b first segment delayed duplicate CONNECTION REQUEST old connection This segment arrives host 2 without host 1 knowledge Host 2 reacts segment sending host 1 ACK segment effect asking verification host 1 indeed trying set new connection When host 1 rejects host 2 attempt establish connection host 2 realizes tricked delayed duplicate abandons connection In way delayed duplicate damage The worst case delayed CONNECTION REQUEST ACK floating around subnet This case shown c As previous example host 2 gets delayed CONNECTION REQUEST replies At point crucial realize host 2 proposed using initial sequence number host 2 host 1 traffic knowing full well segments containing sequence number acknowledgements still existence When second delayed segment arrives host 2 fact z acknowledged rather tells host 2 old duplicate The important thing realize combination old segments cause protocol fail connection set accident one wants TCP uses three way handshake establish connections Within connection timestamp used extend 32 bit sequence number wrap within maximum packet lifetime even gigabit per second connections This mechanism fix TCP needed used faster faster links It described RFC 1323 called PAWS Protection Against Wrapped Sequence numbers Across connections initial sequence numbers PAWS come play TCP originally used clock based scheme described However turned security vulnerability The clock made easy attacker predict next initial sequence number send packets tricked three way handshake established forged connection To close hole pseudorandom initial sequence numbers used connections practice However remains important SEC 6 2 Host 1 Host 2 CR eq x K DAT Host 2 x seq AC A eq x ACK seq AC REJEC x AC K K Time seq ACK Host 1 Old duplicate CR Time ELEMENTS OF TRANSPORT PROTOCOLS x T AC K b Host 1 Host 2 CR seq Old duplicate K Time q K AC x x C A se DAT Old duplicate REJ ECT A ACK eq x z ACK c Three protocol scenarios establishing connection using three way handshake CR denotes CONNECTION REQUEST Normal operation b Old duplicate CONNECTION REQUEST appearing nowhere c Duplicate CONNECTION REQUEST duplicate ACK initial sequence numbers repeat interval even though appear random observer Otherwise delayed duplicates wreak havoc 6 2 3 Connection Release Releasing connection easier establishing one Nevertheless pitfalls one might expect As mentioned earlier two styles terminating connection asymmetric release symmetric release 518 THE TRANSPORT LAYER Asymmetric release way telephone system works one party hangs connection broken Symmetric release treats connection two separate unidirectional connections requires one released separately Asymmetric release abrupt may result data loss Consider scenario After connection established host 1 sends segment arrives properly host 2 Then host 1 sends another segment Unfortunately host 2 issues DISCONNECT second segment arrives The result connection released data lost Host 1 Host 2 CR ACK Time DATA DATA DR No data delivered disconnect request Abrupt disconnection loss data Clearly sophisticated release protocol needed avoid data loss One way use symmetric release direction released independently one Here host continue receive data even sent DISCONNECT segment Symmetric release job process fixed amount data send clearly knows sent In situations determining work done connection terminated obvious One envision protocol host 1 says I done Are done If host 2 responds I done Goodbye connection safely released Unfortunately protocol always work There famous problem illustrates issue It called two army problem Imagine white army encamped valley shown On surrounding hillsides blue armies The white army larger either blue armies alone together blue armies larger white army If either blue army attacks defeated two blue armies attack simultaneously victorious The blue armies want synchronize attacks However communication medium send messengers foot valley SEC 6 2 B ELEMENTS OF TRANSPORT PROTOCOLS Blue army 1 B Blue army 2 White army W The two army problem might captured message lost e use unreliable communication channel The question protocol exist allows blue armies win Suppose commander blue army 1 sends message reading I propose attack dawn March 29 How Now suppose message arrives commander blue army 2 agrees reply gets safely back blue army 1 Will attack happen Probably commander 2 know reply got If blue army 1 attack would foolish charge battle Now let us improve protocol making three way handshake The initiator original proposal must acknowledge response Assuming messages lost blue army 2 get acknowledgement commander blue army 1 hesitate After know acknowledgement got knows blue army 2 attack We could make four way handshake protocol help either In fact proven protocol exists works Suppose protocol exist Either last message protocol essential If remove unessential messages left protocol every message essential What happens final message get We said essential lost attack take place Since sender final message never sure arrival risk attacking Worse yet blue army knows attack either To see relevance two army problem releasing connections rather military affairs substitute disconnect attack If neither side 520 THE TRANSPORT LAYER prepared disconnect convinced side prepared disconnect disconnection never happen In practice avoid quandary foregoing need agreement pushing problem transport user letting side independently decide done This easier problem solve illustrates four scenarios releasing using three way handshake While protocol infallible usually adequate In see normal case one users sends DR DISCONNECTION REQUEST segment initiate connection release When arrives recipient sends back DR segment starts timer case DR lost When DR arrives original sender sends back ACK segment releases connection Finally ACK segment arrives receiver also releases connection Releasing connection means transport entity removes information connection table currently open connections signals connection owner transport user somehow This action different transport user issuing DISCONNECT primitive If final ACK segment lost shown b situation saved timer When timer expires connection released anyway Now consider case second DR lost The user initiating disconnection receive expected response time start In c see works assuming second time segments lost segments delivered correctly time Our last scenario c except assume repeated attempts retransmit DR also fail due lost segments After N retries sender gives releases connection Meanwhile receiver times also exits While protocol usually suffices theory fail initial DR N retransmissions lost The sender give release connection side knows nothing attempts disconnect still fully active This situation results half open connection We could avoided problem allowing sender give N retries forcing go forever gets response However side allowed time sender indeed go forever response ever forthcoming If allow receiving side time protocol hangs One way kill half open connections rule saying segments arrived certain number seconds connection automatically disconnected That way one side ever disconnects side detect lack activity also disconnect This rule also takes care case connection broken network longer deliver packets hosts without either end disconnecting first Of course rule introduced necessary transport entity timer stopped restarted whenever segment sent If timer expires SEC 6 2 Host 1 Host 2 DR Send DR start timer Host 1 Host 2 DR Send DR start timer Send DR start timer DR Send DR start timer DR Release connection Release connection ACK Send ACK Release connection Send ACK ACK Lost Host 2 DR Send DR start timer Timeout release connection b Host 1 DR Send DR start timer Host 1 Host 2 DR Send DR start timer Lost Timeout send DR start timer ELEMENTS OF TRANSPORT PROTOCOLS Send DR start timer Lost DR DR Send DR start timer Timeout send DR start timer Release connection N Timeouts release connection Lost Release connection Send ACK ACK c Timeout release connection Four protocol scenarios releasing connection Normal case three way handshake b Final ACK lost c Response lost Response lost subsequent DRs lost dummy segment transmitted keep side disconnecting On hand automatic disconnect rule used many dummy segments row lost otherwise idle connection first one side automatically disconnect We belabor point clear releasing connection without data loss nearly simple first appears The lesson transport user must involved deciding 522 THE TRANSPORT LAYER disconnect problem cleanly solved transport entities To see importance application consider TCP normally symmetric close side independently closing half connection FIN packet sent data many Web servers send client RST packet causes abrupt close connection like asymmetric close This works Web server knows pattern data exchange First receives request client data client send sends response client When Web server finished response data sent either direction The server send client warning abruptly shut connection If client gets warning release connection state If client get warning eventually realize server longer talking release connection state The data successfully transferred either case 6 2 4 Error Control Flow Control Having examined connection establishment release detail let us look connections managed use The key issues error control flow control Error control ensuring data delivered desired level reliability usually data delivered without errors Flow control keeping fast transmitter overrunning slow receiver Both issues come studied data link layer The solutions used transport layer mechanisms studied Chap 3 As brief recap 1 A frame carries error detecting code e g CRC checksum used check information correctly received 2 A frame carries sequence number identify retransmitted sender receives acknowledgement successful receipt receiver This called ARQ Automatic Repeat reQuest 3 There maximum number frames sender allow outstanding time pausing receiver acknowledging frames quickly enough If maximum one packet protocol called stop wait Larger windows enable pipelining improve performance long fast links 4 The sliding window protocol combines features also used support bidirectional data transfer Given mechanisms used frames link layer natural wonder would used segments transport layer well SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS However little duplication link transport layers practice Even though mechanisms used differences function degree For difference function consider error detection The link layer checksum protects frame crosses single link The transport layer checksum protects segment crosses entire network path It end end check check every link Saltzer et al 1984 describe situation packets corrupted inside router The link layer checksums protected packets traveled across link inside router Thus packets delivered incorrectly even though correct according checks every link This examples led Saltzer et al articulate end end argument According argument transport layer check runs end end essential correctness link layer checks essential nonetheless valuable improving performance since without corrupted packet sent along entire path unnecessarily As difference degree consider retransmissions sliding window protocol Most wireless links satellite links single frame outstanding sender time That bandwidth delay product link small enough even whole frame stored inside link In case small window size sufficient good performance For example 802 11 uses stop wait protocol transmitting retransmitting frame waiting acknowledged moving next frame Having window size larger one frame would add complexity without improving performance For wired optical fiber links switched Ethernet ISP backbones error rate low enough link layer retransmissions omitted end end retransmissions repair residual frame loss On hand many TCP connections bandwidth delay product much larger single segment Consider connection sending data across U S 1 Mbps round trip time 100 msec Even slow connection 200 Kbit data stored receiver time takes send segment receive acknowledgement For situations large sliding window must used Stop wait cripple performance In example would limit performance one segment every 200 msec 5 segments sec matter fast network really Given transport protocols generally use larger sliding windows look issue buffering data carefully Since host may many connections treated separately may need substantial amount buffering sliding windows The buffers needed sender receiver Certainly needed sender hold transmitted yet unacknowledged segments They needed segments may lost need retransmitted 524 THE TRANSPORT LAYER However since sender buffering receiver may may dedicate specific buffers specific connections sees fit The receiver may example maintain single buffer pool shared connections When segment comes attempt made dynamically acquire new buffer If one available segment accepted otherwise discarded Since sender prepared retransmit segments lost network permanent harm done receiver drop segments although resources wasted The sender keeps trying gets acknowledgement The best trade source buffering destination buffering depends type traffic carried connection For low bandwidth bursty traffic produced interactive terminal reasonable dedicate buffers rather acquire dynamically ends relying buffering sender segments must occasionally discarded On hand file transfer high bandwidth traffic better receiver dedicate full window buffers allow data flow maximum speed This strategy TCP uses There still remains question organize buffer pool If segments nearly size natural organize buffers pool identically sized buffers one segment per buffer However wide variation segment size short requests Web pages large packets peer peer file transfers pool fixed sized buffers presents problems If buffer size chosen equal largest possible segment space wasted whenever short segment arrives If buffer size chosen less maximum segment size multiple buffers needed long segments attendant complexity Another approach buffer size problem use variable sized buffers b The advantage better memory utilization price complicated buffer management A third possibility dedicate single large circular buffer per connection c This system simple elegant depend segment sizes makes good use memory connections heavily loaded As connections opened closed traffic pattern changes sender receiver need dynamically adjust buffer allocations Consequently transport protocol allow sending host request buffer space end Buffers could allocated per connection collectively connections running two hosts Alternatively receiver knowing buffer situation knowing offered traffic could tell sender I reserved X buffers If number open connections increase may necessary allocation reduced protocol provide possibility A reasonably general way manage dynamic buffer allocation decouple buffering acknowledgements contrast sliding window protocols Chap 3 Dynamic buffer management means effect variable sized SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS Segment 1 Segment 2 Segment 3 b Segment 4 Unused space c Chained fixed size buffers b Chained variable sized buffers c One large circular buffer per connection window Initially sender requests certain number buffers based expected needs The receiver grants many afford Every time sender transmits segment must decrement allocation stopping altogether allocation reaches zero The receiver separately piggybacks acknowledgements buffer allocations onto reverse traffic TCP uses scheme carrying buffer allocations header field called Window size shows example dynamic window management might work datagram network 4 bit sequence numbers In example data flows segments host A host B acknowledgements buffer allocations flow segments reverse direction Initially A wants eight buffers granted four It sends three segments third lost Segment 6 acknowledges receipt segments including sequence number 1 thus allowing A release buffers furthermore informs A permission send three segments starting beyond 1 e segments 2 3 4 A knows already sent number 2 thinks may send segments 3 4 proceeds At point blocked must wait buffer allocation Timeout induced retransmissions line 9 however may occur blocked since use buffers already allocated In line 10 B acknowledges receipt segments including 4 refuses let A continue Such situation impossible fixed window protocols Chap 3 The next segment B A allocates 526 THE TRANSPORT LAYER another buffer allows A continue This happen B buffer space likely transport user accepted segment data A Message B Comments request 8 buffers A wants 8 buffers 3 ack 15 buf 4 seq 0 data m0 B grants messages 0 3 A 3 buffers left 5 seq 1 data m1 seq 2 data m2 A 2 buffers left Message lost A thinks 1 left ack 1 buf 3 B acknowledges 0 1 permits 2 4 8 seq 3 data m3 seq 4 data m4 A 1 buffer left A 0 buffers left must stop 10 seq 2 data m2 ack 4 buf 0 A times retransmits Everything acknowledged A still blocked 121416 ack 4 buf 1 ack 4 buf 2 seq 5 data m5 seq 6 data m6 ack 6 buf 0 ack 6 buf 4 A may send 5 B found new buffer somewhere A 1 buffer left A blocked A still blocked Potential deadlock Dynamic buffer allocation The arrows show direction transmission An ellipsis indicates lost segment Problems buffer allocation schemes kind arise datagram networks control segments get lost certainly Look line 16 B allocated buffers A allocation segment lost Oops Since control segments sequenced timed A deadlocked To prevent situation host periodically send control segments giving acknowledgement buffer status connection That way deadlock broken sooner later Until tacitly assumed limit imposed sender data rate amount buffer space available receiver This often case Memory expensive prices fallen dramatically Hosts may equipped sufficient memory lack buffers rarely ever problem even wide area connections Of course depends buffer size set large enough always case TCP Zhang et al 2002 When buffer space longer limits maximum flow another bottleneck appear carrying capacity network If adjacent routers exchange x packets sec k disjoint paths pair hosts way hosts exchange kx segments sec matter much buffer space available end If sender pushes hard SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS e sends kx segments sec network become congested unable deliver segments fast coming What needed mechanism limits transmissions sender based network carrying capacity rather receiver buffering capacity Belsnes 1975 proposed using sliding window flow control scheme sender dynamically adjusts window size match network carrying capacity This means dynamic sliding window implement flow control congestion control If network handle c segments sec round trip time including transmission propagation queueing processing receiver return acknowledgement r sender window cr With window size sender normally operates pipeline full Any small decrease network performance cause block Since network capacity available given flow varies time window size adjusted frequently track changes carrying capacity As see later TCP uses similar scheme 6 2 5 Multiplexing Multiplexing sharing several conversations connections virtual circuits physical links plays role several layers network architecture In transport layer need multiplexing arise number ways For example one network address available host transport connections machine use When segment comes way needed tell process give This situation called multiplexing shown In figure four distinct transport connections use network connection e g IP address remote host Multiplexing also useful transport layer another reason Suppose example host multiple network paths use If user needs bandwidth reliability one network paths provide way connection distributes traffic among multiple network paths round robin basis indicated b This modus operandi called inverse multiplexing With k network connections open effective bandwidth might increased factor k An example inverse multiplexing SCTP Stream Control Transmission Protocol run connection using multiple network interfaces In contrast TCP uses single network endpoint Inverse multiplexing also found link layer several low rate links used parallel one high rate link 6 2 6 Crash Recovery If hosts routers subject crashes connections long lived e g large software media downloads recovery crashes becomes issue If transport entity entirely within hosts recovery network 528 THE TRANSPORT LAYER Transport address Layer Network address Router lines To router b Multiplexing b Inverse multiplexing router crashes straightforward The transport entities expect lost segments time know cope using retransmissions A troublesome problem recover host crashes In particular may desirable clients able continue working servers crash quickly reboot To illustrate difficulty let us assume one host client sending long file another host file server using simple stop wait protocol The transport layer server passes incoming segments transport user one one Partway transmission server crashes When comes back tables reinitialized longer knows precisely In attempt recover previous status server might send broadcast segment hosts announcing crashed requesting clients inform status open connections Each client one two states one segment outstanding S1 segments outstanding S0 Based state information client must decide whether retransmit recent segment At first glance would seem obvious client retransmit unacknowledged segment outstanding e state S1 learns crash However closer inspection reveals difficulties naive approach Consider example situation server transport entity first sends acknowledgement acknowledgement sent writes application process Writing segment onto output stream sending acknowledgement two distinct events done simultaneously If crash occurs acknowledgement sent write fully completed client receive SEC 6 2 ELEMENTS OF TRANSPORT PROTOCOLS acknowledgement thus state S0 crash recovery announcement arrives The client therefore retransmit incorrectly thinking segment arrived This decision client leads missing segment At point may thinking That problem solved easily All reprogram transport entity first write send acknowledgement Try Imagine write done crash occurs acknowledgement sent The client state S1 thus retransmit leading undetected duplicate segment output stream server application process No matter client server programmed always situations protocol fails recover properly The server programmed one two ways acknowledge first write first The client programmed one four ways always retransmit last segment never retransmit last segment retransmit state S0 retransmit state S1 This gives eight combinations shall see combination set events makes protocol fail Three events possible server sending acknowledgement A writing output process W crashing C The three events occur six different orderings AC W AWC C AW C WA WAC WC A parentheses used indicate neither A W follow C e crashed crashed shows eight combinations client server strategies valid event sequences one Notice strategy sequence events causes protocol fail For example client always retransmits AWC event generate undetected duplicate even though two events work properly Strategy used receiving host First ACK write First write ACK Strategy used sending host AC W AWC C AW C WA W AC WC A Always retransmit OK DUP OK OK DUP DUP Never retransmit LOST OK LOST LOST OK OK Retransmit S0 OK DUP LOST LOST DUP OK Retransmit S1 LOST OK OK OK OK DUP OK Protocol functions correctly DUP Protocol generates duplicate message LOST Protocol loses message Different combinations client server strategies 530 THE TRANSPORT LAYER Making protocol elaborate help Even client server exchange several segments server attempts write client knows exactly happen client way knowing whether crash occurred write The conclusion inescapable ground rules simultaneous events separate events happen one another time host crash recovery made transparent higher layers Put general terms result restated recovery layer N crash done layer N 1 higher layer retains enough status information reconstruct problem occurred This consistent case mentioned transport layer recover failures network layer provided end connection keeps track This problem gets us issue called end end acknowledgement really means In principle transport protocol end end chained like lower layers Now consider case user entering requests transactions remote database Suppose remote transport entity programmed first pass segments next layer acknowledge Even case receipt acknowledgement back user machine necessarily mean remote host stayed long enough actually update database A truly end end acknowledgement whose receipt means work actually done lack thereof means probably impossible achieve This point discussed detail Saltzer et al 1984 6 3 CONGESTION CONTROL If transport entities many machines send many packets network quickly network become congested performance degraded packets delayed lost Controlling congestion avoid problem combined responsibility network transport layers Congestion occurs routers detected network layer However congestion ultimately caused traffic sent network transport layer The effective way control congestion transport protocols send packets network slowly In Chap 5 studied congestion control mechanisms network layer In section study half problem congestion control mechanisms transport layer After describing goals congestion control describe hosts regulate rate send packets network The Internet relies heavily transport layer congestion control specific algorithms built TCP protocols SEC 6 3 CONGESTION CONTROL 6 3 1 Desirable Bandwidth Allocation Before describe regulate traffic must understand trying achieve running congestion control algorithm That must specify state good congestion control algorithm operate network The goal simply avoid congestion It find good allocation bandwidth transport entities using network A good allocation deliver good performance uses available bandwidth avoids congestion fair across competing transport entities quickly track changes traffic demands We make criteria precise turn Efficiency Power Capacity Desired response Congestion collapse Delay seconds Goodput packets sec An efficient allocation bandwidth across transport entities use network capacity available However quite right think 100 Mbps link five transport entities get 20 Mbps They usually get less 20 Mbps good performance The reason traffic often bursty Recall Sec 5 3 described goodput rate useful packets arriving receiver function offered load This curve matching curve delay function offered load given Onset congestion Offered load packets sec Offered load packets sec b Goodput b delay function offered load As load increases goodput initially increases rate load approaches capacity goodput rises gradually This falloff bursts traffic occasionally mount cause losses buffers inside network If transport protocol poorly designed retransmits packets delayed lost network enter congestion collapse In state senders furiously sending packets increasingly little useful work accomplished 532 THE TRANSPORT LAYER The corresponding delay given b Initially delay fixed representing propagation delay across network As load approaches capacity delay rises slowly first much rapidly This bursts traffic tend mound high load The delay really go infinity except model routers infinite buffers Instead packets lost experiencing maximum buffering delay For goodput delay performance begins degrade onset congestion Intuitively obtain best performance network allocate bandwidth delay starts climb rapidly This point capacity To identify Kleinrock 1979 proposed metric power power load delay Power initially rise offered load delay remains small roughly constant reach maximum fall delay grows rapidly The load highest power represents efficient load transport entity place network Max Min Fairness In preceding discussion talk divide bandwidth different transport senders This sounds like simple question answer give senders equal fraction bandwidth involves several considerations Perhaps first consideration ask problem congestion control After network gives sender amount bandwidth use sender use much bandwidth However often case networks strict bandwidth reservation flow connection They may flows quality service supported many connections seek use whatever bandwidth available lumped together network common allocation For example IETF differentiated services separates traffic two classes connections compete bandwidth within class IP routers often connections competing bandwidth In situation congestion control mechanism allocating bandwidth competing connections A second consideration fair portion means flows network It simple enough N flows use single link case 1 N bandwidth although efficiency dictate use slightly less traffic bursty But happens flows different overlapping network paths For example one flow may cross three links flows may cross one link The three link flow consumes network resources It might fairer sense give less bandwidth one link flows It SEC 6 3 CONGESTION CONTROL certainly possible support one link flows reducing bandwidth three link flow This point demonstrates inherent tension fairness efficiency However adopt notion fairness depend length network path Even simple model giving connections equal fraction bandwidth bit complicated different connections take different paths network paths different capacities In case possible flow bottlenecked downstream link take smaller portion upstream link flows reducing bandwidth flows would slow would help bottlenecked flow The form fairness often desired network usage max min fairness An allocation max min fair bandwidth given one flow increased without decreasing bandwidth given another flow allocation larger That increasing bandwidth flow make situation worse flows less well Let us see example A max min fair allocation shown network four flows A B C D Each links routers capacity taken 1 unit though general case links different capacities Three flows compete bottom left link routers R4 R5 Each flows therefore gets 1 3 link The remaining flow A competes B link R2 R3 Since B allocation 1 3 A gets remaining 2 3 link Notice links spare capacity However capacity given flows without decreasing capacity another lower flow For example bandwidth link R2 R3 given flow B less flow A This reasonable flow A already bandwidth However capacity flow C D must decreased give bandwidth B flows less bandwidth B Thus allocation max min fair A 2 3 2 3 A R1 1 3 R2 R3 B 1 3 B 1 3 1 3 D R4 1 3 C 1 3 C R5 1 3 R6 D Max min bandwidth allocation four flows Max min allocations computed given global knowledge network An intuitive way think imagine rate 534 THE TRANSPORT LAYER flows starts zero slowly increased When rate reaches bottleneck flow flow stops increasing The flows continue increase sharing equally available capacity reach respective bottlenecks A third consideration level consider fairness A network could fair level connections connections pair hosts connections per host We examined issue discussing WFQ Weighted Fair Queueing Sec 5 4 concluded definitions problems For example defining fairness per host means busy server fare better mobile phone defining fairness per connection encourages hosts open connections Given clear answer fairness often considered per connection precise fairness usually concern It important practice connection starved bandwidth connections get precisely amount bandwidth In fact TCP possible open multiple connections compete bandwidth aggressively This tactic used bandwidth hungry applications BitTorrent peer peer file sharing Convergence A final criterion congestion control algorithm converge quickly fair efficient allocation bandwidth The discussion desirable operating point assumes static network environment However connections always coming going network bandwidth needed given connection vary time example user browses Web pages occasionally downloads large videos Because variation demand ideal operating point network varies time A good congestion control algorithm rapidly converge ideal operating point track point changes time If convergence slow algorithm never close changing operating point If algorithm stable may fail converge right point cases even oscillate around right point An example bandwidth allocation changes time converges quickly shown Initially flow 1 bandwidth One second later flow 2 starts It needs bandwidth well The allocation quickly changes give flows half bandwidth At 4 seconds third flow joins However flow uses 20 bandwidth less fair share third Flows 1 2 quickly adjust dividing available bandwidth 40 bandwidth At 9 seconds second flow leaves third flow remains unchanged The first flow quickly captures 80 bandwidth At times total allocated bandwidth approximately 100 network fully used competing flows get equal treatment use bandwidth need Bandwidth allocation CONGESTION CONTROL Flow 1 0 5 Flow 2 starts Flow 2 stops Flow 3Time secs Changing bandwidth allocation time 6 3 2 Regulating Sending Rate Now time main course How regulate sending rates obtain desirable bandwidth allocation The sending rate may limited two factors The first flow control case insufficient buffering receiver The second congestion case insufficient capacity network In see problem illustrated hydraulically In see thick pipe leading small capacity receiver This flow control limited situation As long sender send water bucket contain water lost In b limiting factor bucket capacity internal carrying capacity network If much water comes fast back lost case overflowing funnel These cases may appear similar sender transmitting fast causes packets lost However different causes call different solutions We already talked flow control solution variable sized window Now consider congestion control solution Since either problems occur transport protocol general need run solutions slow either problem occurs The way transport protocol regulate sending rate depends form feedback returned network Different network layers may return different kinds feedback The feedback may explicit implicit may precise imprecise An example explicit precise design routers tell sources rate may send Designs literature XCP eXplicit Congestion Protocol operate manner Katabi et al 2002 An explicit imprecise design use ECN Explicit Congestion Notification TCP In design routers set bits packets experience congestion warn senders slow tell much slow 536 THE TRANSPORT LAYER Transmission rate adjustment Transmission network Small capacity receiver Internal congestion Large capacity receiver b A fast network feeding low capacity receiver b A slow network feeding high capacity receiver In designs explicit signal FAST TCP measures roundtrip delay uses metric signal avoid congestion Wei et al 2006 Finally form congestion control prevalent Internet today TCP drop tail RED routers packet loss inferred used signal network become congested There many variants form TCP including CUBIC TCP used Linux Ha et al 2008 Combinations also possible For example Windows includes Compound TCP uses packet loss delay feedback signals Tan et al 2006 These designs summarized If explicit precise signal given transport entity use signal adjust rate new operating point For example XCP tells senders rate use senders may simply use rate In cases however guesswork involved In absence congestion signal senders decrease rates When congestion signal given senders decrease rates The way rates increased decreased given control law These laws major effect performance SEC 6 3 CONGESTION CONTROL Protocol Signal Explicit Precise XCP Rate use Yes Yes TCP ECN Congestion warning Yes No FAST TCP End end delay No Yes Compound TCP Packet loss end end delay No Yes CUBIC TCP Packet loss No No TCP Packet loss No No Signals congestion control protocols Chiu Jain 1989 studied case binary congestion feedback concluded AIMD Additive Increase Multiplicative Decrease appropriate control law arrive efficient fair operating point To argue case constructed graphical argument simple case two connections competing bandwidth single link The graph shows bandwidth allocated user 1 x axis user 2 axis When allocation fair users receive amount bandwidth This shown dotted fairness line When allocations sum 100 capacity link allocation efficient This shown dotted efficiency line A congestion signal given network users sum allocations crosses line The intersection lines desired operating point users bandwidth network bandwidth used User 2 bandwidth 100 Additive increase decrease Fairness line Optimal point Multiplicative increase decrease Efficiency line 100 User 1 bandwidth Additive multiplicative bandwidth adjustments Consider happens starting allocation user 1 user 2 additively increase respective bandwidths time For example users may increase sending rate 1 Mbps every second Eventually 538 THE TRANSPORT LAYER operating point crosses efficiency line users receive congestion signal network At stage must reduce allocations However additive decrease would simply cause oscillate along additive line This situation shown The behavior keep operating point close efficient necessarily fair Similarly consider case users multiplicatively increase bandwidth time receive congestion signal For example users may increase sending rate 10 every second If multiplicatively decrease sending rates operating point users simply oscillate along multiplicative line This behavior also shown The multiplicative line different slope additive line It points origin additive line angle 45 degrees But otherwise better In neither case users converge optimal sending rates fair efficient Now consider case users additively increase bandwidth allocations multiplicatively decrease congestion signaled This behavior AIMD control law shown It seen path traced behavior converge optimal point fair efficient This convergence happens matter starting point making AIMD broadly useful By argument combination multiplicative increase additive decrease would diverge optimal point Start 100 User 2 bandwidth Legend Fairness line Optimal point Additive increase 45 Multiplicative decrease line points origin Efficiency line 0 User 1 bandwidth 100 Additive Increase Multiplicative Decrease AIMD control law AIMD control law used TCP based argument another stability argument easy drive network congestion difficult recover increase policy gentle decrease policy aggressive It quite fair since TCP connections adjust window size given amount every round trip time Different connections different round trip times This leads bias connections closer hosts receive bandwidth connections distant hosts else equal SEC 6 3 CONGESTION CONTROL In Sec 6 5 describe detail TCP implements AIMD control law adjust sending rate provide congestion control This task difficult sounds rates measured interval traffic bursty Instead adjusting rate directly strategy often used practice adjust size sliding window TCP uses strategy If window size W round trip time RTT equivalent rate W RTT This strategy easy combine flow control already uses window advantage sender paces packets using acknowledgements hence slows one RTT stops receiving reports packets leaving network As final issue may many different transport protocols send traffic network What happen different protocols compete different control laws avoid congestion Unequal bandwidth allocations Since TCP dominant form congestion control Internet significant community pressure new transport protocols designed compete fairly The early streaming media protocols caused problems excessively reducing TCP throughput compete fairly This led notion TCP friendly congestion control TCP non TCP transport protocols freely mixed ill effects Floyd et al 2000 6 3 3 Wireless Issues Transport protocols TCP implement congestion control independent underlying network link layer technologies That good theory practice issues wireless networks The main issue packet loss often used congestion signal including TCP discussed Wireless networks lose packets time due transmission errors With AIMD control law high throughput requires small levels packet loss Analyses Padhye et al 1998 show throughput goes inverse square root packet loss rate What means practice loss rate fast TCP connections small 1 moderate loss rate time loss rate reaches 10 connection effectively stopped working However wireless networks 802 11 LANs frame loss rates least 10 common This difference means absent protective measures congestion control schemes use packet loss signal unnecessarily throttle connections run wireless links low rates To function well packet losses congestion control algorithm observe losses due insufficient bandwidth losses due transmission errors One solution problem mask wireless losses using retransmissions wireless link For example 802 11 uses stopand wait protocol deliver frame retrying transmissions multiple times 540 THE TRANSPORT LAYER need reporting packet loss higher layer In normal case packet delivered despite transient transmission errors visible higher layers shows path wired wireless link masking strategy used There two aspects note First sender necessarily know path includes wireless link since sees wired link attached Internet paths heterogeneous general method sender tell kind links comprise path This complicates congestion control problem easy way use one protocol wireless links another protocol wired links Transport end end congestion control loss congestion Wired link Wireless link Sender Receiver Link layer retransmission loss transmission error Congestion control path wireless link The second aspect puzzle The figure shows two mechanisms driven loss link layer frame retransmissions transport layer congestion control The puzzle two mechanisms co exist without getting confused After loss cause one mechanism take action either transmission error congestion signal It If mechanisms take action retransmitting frame slowing sending rate back original problem transports run far slowly wireless links Consider puzzle moment see solve The solution two mechanisms act different timescales Link layer retransmissions happen order microseconds milliseconds wireless links 802 11 Loss timers transport protocols fire order milliseconds seconds The difference three orders magnitude This allows wireless links detect frame losses retransmit frames repair transmission errors long packet loss inferred transport entity The masking strategy sufficient let transport protocols run well across wireless links However always fitting solution Some wireless links long round trip times satellites For links techniques must used mask loss FEC Forward Error Correction transport protocol must use non loss signal congestion control SEC 6 3 CONGESTION CONTROL A second issue congestion control wireless links variable capacity That capacity wireless link changes time sometimes abruptly nodes move signal noise ratio varies changing channel conditions This unlike wired links whose capacity fixed The transport protocol must adapt changing capacity wireless links otherwise either congest network fail use available capacity One possible solution problem simply worry This strategy feasible congestion control algorithms must already handle case new users entering network existing users changing sending rates Even though capacity wired links fixed changing behavior users presents variability bandwidth available given user Thus possible simply run TCP path 802 11 wireless link obtain reasonable performance However much wireless variability transport protocols designed wired links may trouble keeping deliver poor performance The solution case transport protocol designed wireless links A particularly challenging setting wireless mesh network multiple interfering wireless links must crossed routes change due mobility lots loss Research area ongoing See Li et al 2009 example wireless transport protocol design 6 4 THE INTERNET TRANSPORT PROTOCOLS UDP The Internet two main protocols transport layer connectionless protocol connection oriented one The protocols complement The connectionless protocol UDP It almost nothing beyond sending packets applications letting applications build protocols top needed The connection oriented protocol TCP It almost everything It makes connections adds reliability retransmissions along flow control congestion control behalf applications use In following sections study UDP TCP We start UDP simplest We also look two uses UDP Since UDP transport layer protocol typically runs operating system protocols use UDP typically run user space uses might considered applications However techniques use useful many applications better considered belong transport service cover 6 4 1 Introduction UDP The Internet protocol suite supports connectionless transport protocol called UDP User Datagram Protocol UDP provides way applications send encapsulated IP datagrams without establish connection UDP described RFC 768 542 THE TRANSPORT LAYER UDP transmits segments consisting 8 byte header followed payload The header shown The two ports serve identify endpoints within source destination machines When UDP packet arrives payload handed process attached destination port This attachment occurs BIND primitive something similar used saw TCP binding process UDP Think ports mailboxes applications rent receive packets We say describe TCP also uses ports In fact main value UDP using raw IP addition source destination ports Without port fields transport layer would know incoming packet With delivers embedded segment correct application 32 Bits Source port Destination port UDP length UDP checksum The UDP header The source port primarily needed reply must sent back source By copying Source port field incoming segment Destination port field outgoing segment process sending reply specify process sending machine get The UDP length field includes 8 byte header data The minimum length 8 bytes cover header The maximum length 65 515 bytes lower largest number fit 16 bits size limit IP packets An optional Checksum also provided extra reliability It checksums header data conceptual IP pseudoheader When performing computation Checksum field set zero data field padded additional zero byte length odd number The checksum algorithm simply add 16 bit words one complement take one complement sum As consequence receiver performs calculation entire segment including Checksum field result 0 If checksum computed stored 0 since happy coincidence one complement arithmetic true computed 0 stored 1s However turning foolish unless quality data matter e g digitized speech The pseudoheader case IPv4 shown It contains 32 bit IPv4 addresses source destination machines protocol number UDP 17 byte count UDP segment including header It SEC 6 4 THE INTERNET TRANSPORT PROTOCOLS UDP different analogous IPv6 Including pseudoheader UDP checksum computation helps detect misdelivered packets including also violates protocol hierarchy since IP addresses belong IP layer UDP layer TCP uses pseudoheader checksum 32 Bits Source address Destination address Protocol 17 UDP length The IPv4 pseudoheader included UDP checksum It probably worth mentioning explicitly things UDP It flow control congestion control retransmission upon receipt bad segment All user processes What provide interface IP protocol added feature demultiplexing multiple processes using ports optional end end error detection That For applications need precise control packet flow error control timing UDP provides doctor ordered One area especially useful client server situations Often client sends short request server expects short reply back If either request reply lost client time try Not code simple fewer messages required one direction protocol requiring initial setup like TCP An application uses UDP way DNS Domain Name System study Chap 7 In brief program needs look IP address host name example www cs berkeley edu send UDP packet containing host name DNS server The server replies UDP packet containing host IP address No setup needed advance release needed afterward Just two messages go network 6 4 2 Remote Procedure Call In certain sense sending message remote host getting reply back lot like making function call programming language In cases start one parameters get back result This observation led people try arrange request reply interactions networks cast 544 THE TRANSPORT LAYER form procedure calls Such arrangement makes network applications much easier program familiar deal For example imagine procedure named get IP address host name works sending UDP packet DNS server waiting reply timing trying one forthcoming quickly enough In way details networking hidden programmer The key work area done Birrell Nelson 1984 In nutshell Birrell Nelson suggested allowing programs call procedures located remote hosts When process machine 1 calls procedure machine 2 calling process 1 suspended execution called procedure takes place 2 Information transported caller callee parameters come back procedure result No message passing visible application programmer This technique known RPC Remote Procedure Call become basis many networking applications Traditionally calling procedure known client called procedure known server use names The idea behind RPC make remote procedure call look much possible like local one In simplest form call remote procedure client program must bound small library procedure called client stub represents server procedure client address space Similarly server bound procedure called server stub These procedures hide fact procedure call client server local The actual steps making RPC shown Step 1 client calling client stub This call local procedure call parameters pushed onto stack normal way Step 2 client stub packing parameters message making system call send message Packing parameters called marshaling Step 3 operating system sending message client machine server machine Step 4 operating system passing incoming packet server stub Finally step 5 server stub calling server procedure unmarshaled parameters The reply traces path direction The key item note client procedure written user makes normal e local procedure call client stub name server procedure Since client procedure client stub address space parameters passed usual way Similarly server procedure called procedure address space parameters expects To server procedure nothing unusual In way instead I O done sockets network communication done faking normal procedure call Despite conceptual elegance RPC snakes hiding grass A big one use pointer parameters Normally passing pointer procedure problem The called procedure use pointer way caller procedures live virtual address SEC 6 4 THE INTERNET TRANSPORT PROTOCOLS UDP Client CPU Server CPU Server stub Client stub Client Server Operating system Operating system Network Steps making remote procedure call The stubs shaded space With RPC passing pointers impossible client server different address spaces In cases tricks used make possible pass pointers Suppose first parameter pointer integer k The client stub marshal k send along server The server stub creates pointer k passes server procedure expects When server procedure returns control server stub latter sends k back client new k copied old one case server changed In effect standard calling sequence call reference replaced call bycopy restore Unfortunately trick always work example pointer points graph complex data structure For reason restrictions must placed parameters procedures called remotely shall see A second problem weakly typed languages like C perfectly legal write procedure computes inner product two vectors arrays without specifying large either one Each could terminated special value known calling called procedures Under circumstances essentially impossible client stub marshal parameters way determining large A third problem always possible deduce types parameters even formal specification code An example printf may number parameters least one parameters arbitrary mixture integers shorts longs characters strings floating point numbers various lengths types Trying call printf remote procedure would practically impossible C permissive However rule saying RPC used provided program C C would popular lot programmers 546 THE TRANSPORT LAYER A fourth problem relates use global variables Normally calling called procedure communicate using global variables addition communicating via parameters But called procedure moved remote machine code fail global variables longer shared These problems meant suggest RPC hopeless In fact widely used restrictions needed make work well practice In terms transport layer protocols UDP good base implement RPC Both requests replies may sent single UDP packet simplest case operation fast However implementation must include machinery well Because request reply may lost client must keep timer retransmit request Note reply serves implicit acknowledgement request request need separately acknowledged Sometimes parameters results may larger maximum UDP packet size case protocol needed deliver large messages If multiple requests replies overlap case concurrent programming identifier needed match request reply A higher level concern operation may idempotent e safe repeat The simple case idempotent operations DNS requests replies The client safely retransmit requests replies forthcoming It matter whether server never received request reply lost The answer finally arrives assuming DNS database updated meantime However operations idempotent example important side effects incrementing counter RPC operations requires stronger semantics programmer calls procedure executed multiple times In case may necessary set TCP connection send request rather using UDP 6 4 3 Real Time Transport Protocols Client server RPC one area UDP widely used Another one real time multimedia applications In particular Internet radio Internet telephony music demand videoconferencing video demand multimedia applications became commonplace people discovered application reinventing less real time transport protocol It gradually became clear generic real time transport protocol multiple applications would good idea Thus RTP Real time Transport Protocol born It described RFC 3550 widespread use multimedia applications We describe two aspects real time transport The first RTP protocol transporting audio video data packets The second processing takes place mostly receiver play audio video right time These functions fit protocol stack shown SEC 6 4 User space THE INTERNET TRANSPORT PROTOCOLS UDP Multimedia application Ethernet header IP UDP RTP header header header RTP RTP payload Socket interface UDP OS Kernel UDP payload IP Ethernet IP payload Ethernet payload b The position RTP protocol stack b Packet nesting RTP normally runs user space UDP operating system It operates follows The multimedia application consists multiple audio video text possibly streams These fed RTP library user space along application This library multiplexes streams encodes RTP packets stuffs socket On operating system side socket UDP packets generated wrap RTP packets handed IP transmission link Ethernet The reverse process happens receiver The multimedia application eventually receives multimedia data RTP library It responsible playing media The protocol stack situation shown The packet nesting shown b As consequence design little hard say layer RTP Since runs user space linked application program certainly looks like application protocol On hand generic applicationindependent protocol provides transport facilities also looks like transport protocol Probably best description transport protocol happens implemented application layer covering chapter RTP The Real time Transport Protocol The basic function RTP multiplex several real time data streams onto single stream UDP packets The UDP stream sent single destination unicasting multiple destinations multicasting Because RTP uses normal UDP packets treated specially routers unless normal IP quality service features enabled In particular special guarantees delivery packets may lost delayed corrupted etc The RTP format contains several features help receivers work multimedia information Each packet sent RTP stream given number one 548 THE TRANSPORT LAYER higher predecessor This numbering allows destination determine packets missing If packet missing best action destination take application It may skip video frame packets carrying video data approximate missing value interpolation packets carrying audio data Retransmission practical option since retransmitted packet would probably arrive late useful As consequence RTP acknowledgements mechanism request retransmissions Each RTP payload may contain multiple samples may coded way application wants To allow interworking RTP defines several profiles e g single audio stream profile multiple encoding formats may allowed For example single audio stream may encoded 8bit PCM samples 8 kHz using delta encoding predictive encoding GSM encoding MP3 encoding RTP provides header field source specify encoding otherwise involved encoding done Another facility many real time applications need timestamping The idea allow source associate timestamp first sample packet The timestamps relative start stream differences timestamps significant The absolute values meaning As describe shortly mechanism allows destination small amount buffering play sample right number milliseconds start stream independently packet containing sample arrived Not timestamping reduce effects variation network delay also allows multiple streams synchronized For example digital television program might video stream two audio streams The two audio streams could stereo broadcasts handling films original language soundtrack soundtrack dubbed local language giving viewer choice Each stream comes different physical device timestamped single counter played back synchronously even streams transmitted received somewhat erratically The RTP header illustrated It consists three 32 bit words potentially extensions The first word contains Version field already 2 Let us hope version close ultimate version since one code point left although 3 could defined meaning real version extension word The P bit indicates packet padded multiple 4 bytes The last padding byte tells many bytes added The X bit indicates extension header present The format meaning extension header defined The thing defined first word extension gives length This escape hatch unforeseen requirements SEC 6 4 THE INTERNET TRANSPORT PROTOCOLS UDP 32 bits Ver P X CC M Payload type Sequence number Timestamp Synchronization source identifier Contributing source identifier The RTP header The CC field tells many contributing sources present 0 15 see The M bit application specific marker bit It used mark start video frame start word audio channel something else application understands The Payload type field tells encoding algorithm used e g uncompressed 8 bit audio MP3 etc Since every packet carries field encoding change transmission The Sequence number counter incremented RTP packet sent It used detect lost packets The Timestamp produced stream source note first sample packet made This value help reduce timing variability called jitter receiver decoupling playback packet arrival time The Synchronization source identifier tells stream packet belongs It method used multiplex demultiplex multiple data streams onto single stream UDP packets Finally Contributing source identifiers used mixers present studio In case mixer synchronizing source streams mixed listed RTCP The Real time Transport Control Protocol RTP little sister protocol little sibling protocol called RTCP Realtime Transport Control Protocol It defined along RTP RFC 3550 handles feedback synchronization user interface It transport media samples The first function used provide feedback delay variation delay jitter bandwidth congestion network properties sources This information used encoding process increase data rate give better quality network functioning well cut back data 550 THE TRANSPORT LAYER rate trouble network By providing continuous feedback encoding algorithms continuously adapted provide best quality possible current circumstances For example bandwidth increases decreases transmission encoding may switch MP3 8 bit PCM delta encoding required The Payload type field used tell destination encoding algorithm used current packet making possible vary demand An issue providing feedback RTCP reports sent participants For multicast application large group bandwidth used RTCP would quickly grow large To prevent happening RTCP senders scale rate reports collectively consume say 5 media bandwidth To participant needs know media bandwidth learns sender number participants estimates listening RTCP reports RTCP also handles interstream synchronization The problem different streams may use different clocks different granularities different drift rates RTCP used keep sync Finally RTCP provides way naming various sources e g ASCII text This information displayed receiver screen indicate talking moment More information RTP found Perkins 2003 Playout Buffering Jitter Control Once media information reaches receiver must played right time In general time RTP packet arrived receiver packets take slightly different amounts time transit network Even packets injected exactly right intervals sender reach receiver different relative times This variation delay called jitter Even small amount packet jitter cause distracting media artifacts jerky video frames unintelligible audio media simply played arrives The solution problem buffer packets receiver played reduce jitter As example see stream packets delivered substantial amount jitter Packet 1 sent server 0 sec arrives client 1 sec Packet 2 undergoes delay takes 2 sec arrive As packets arrive buffered client machine At 10 sec playback begins At time packets 1 6 buffered removed buffer uniform intervals smooth play In general case necessary use uniform intervals RTP timestamps tell media played SEC 6 4 THE INTERNET TRANSPORT PROTOCOLS UDP Packet departs source 1 2 3 4 5 6 7 8 Packet arrives buffer 3 4 5 Time buffer Packet removed buffer 1 2 3 4 5 6 7 Gap playback Time sec Smoothing output stream buffering packets Unfortunately see packet 8 delayed much available play slot comes There two options Packet 8 skipped player move subsequent packets Alternatively playback stop packet 8 arrives creating annoying gap music movie In live media application like voice IP call packet typically skipped Live applications work well hold In streaming media application player might pause This problem alleviated delaying starting time even using larger buffer For streaming audio video player buffers 10 seconds often used ensure player receives packets dropped network time For live applications like videoconferencing short buffers needed responsiveness A key consideration smooth playout playback point long wait receiver media playing Deciding long wait depends jitter The difference low jitter high jitter connection shown The average delay may differ greatly two high jitter playback point may need much capture 99 packets low jitter To pick good playback point application measure jitter looking difference RTP timestamps arrival time Each difference gives sample delay plus arbitrary fixed offset However delay change time due competing traffic changing routes To accommodate change applications adapt playback point running However done well changing playback point produce observable glitch user One way avoid problem audio adapt playback point talkspurts gaps conversation No one notice difference short slightly longer silence RTP lets applications set M marker bit indicate start new talkspurt purpose If absolute delay media played long live applications suffer Nothing done reduce propagation delay direct path 552 High jitter Fraction packets Fraction packets THE TRANSPORT LAYER Low jitter Delay Minimum delay due speed light Delay b High jitter b Low jitter already used The playback point pulled simply accepting larger fraction packets arrive late played If acceptable way pull playback point reduce jitter using better quality service example expedited forwarding differentiated service That better network needed 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP UDP simple protocol important uses clientserver interactions multimedia Internet applications reliable sequenced delivery needed UDP provide another protocol required It called TCP main workhorse Internet Let us study detail 6 5 1 Introduction TCP TCP Transmission Control Protocol specifically designed provide reliable end end byte stream unreliable internetwork An internetwork differs single network different parts may wildly different topologies bandwidths delays packet sizes parameters TCP designed dynamically adapt properties internetwork robust face many kinds failures TCP formally defined RFC 793 September 1981 As time went many improvements made various errors inconsistencies fixed To give sense extent TCP important RFCs SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP RFC 793 plus clarifications bug fixes RFC 1122 extensions high performance RFC 1323 selective acknowledgements RFC 2018 congestion control RFC 2581 repurposing header fields quality service RFC 2873 improved retransmission timers RFC 2988 explicit congestion notification RFC 3168 The full collection even larger led guide many RFCs published course another RFC document RFC 4614 Each machine supporting TCP TCP transport entity either library procedure user process commonly part kernel In cases manages TCP streams interfaces IP layer A TCP entity accepts user data streams local processes breaks pieces exceeding 64 KB practice often 1460 data bytes order fit single Ethernet frame IP TCP headers sends piece separate IP datagram When datagrams containing TCP data arrive machine given TCP entity reconstructs original byte streams For simplicity sometimes use TCP mean TCP transport entity piece software TCP protocol set rules From context clear meant For example The user gives TCP data TCP transport entity clearly intended The IP layer gives guarantee datagrams delivered properly indication fast datagrams may sent It TCP send datagrams fast enough make use capacity cause congestion time retransmit datagrams delivered Datagrams arrive may well wrong order also TCP reassemble messages proper sequence In short TCP must furnish good performance reliability applications want IP provide 6 5 2 The TCP Service Model TCP service obtained sender receiver creating end points called sockets discussed Sec 6 1 3 Each socket socket number address consisting IP address host 16 bit number local host called port A port TCP name TSAP For TCP service obtained connection must explicitly established socket one machine socket another machine The socket calls listed A socket may used multiple connections time In words two connections may terminate socket Connections identified socket identifiers ends socket1 socket2 No virtual circuit numbers identifiers used Port numbers 1024 reserved standard services usually started privileged users e g root UNIX systems They called well known ports For example process wishing remotely retrieve mail host connect destination host port 143 contact IMAP 554 THE TRANSPORT LAYER daemon The list well known ports given www iana org Over 700 assigned A better known ones listed Port Protocol Use 20 21 FTP File transfer SSH Remote login replacement Telnet SMTP Email HTTP World Wide Web POP 3 Remote email access IMAP Remote email access HTTPS Secure Web HTTP SSL TLS RTSP Media player control IPP Printer sharing Some assigned ports Other ports 1024 49151 registered IANA use unprivileged users applications choose ports For example BitTorrent peer peer file sharing application unofficially uses ports 6881 6887 may run ports well It would certainly possible FTP daemon attach port 21 boot time SSH daemon attach port 22 boot time However would clutter memory daemons idle time Instead commonly done single daemon called inetd Internet daemon UNIX attach multiple ports wait first incoming connection When occurs inetd forks new process executes appropriate daemon letting daemon handle request In way daemons inetd active work Inetd learns ports use configuration file Consequently system administrator set system permanent daemons busiest ports e g port 80 inetd rest All TCP connections full duplex point point Full duplex means traffic go directions time Point point means connection exactly two end points TCP support multicasting broadcasting A TCP connection byte stream message stream Message boundaries preserved end end For example sending process four 512 byte writes TCP stream data may delivered receiving process four 512 byte chunks two 1024 byte chunks one 2048 byte chunk see way There way receiver detect unit data written matter hard tries SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP IP header TCP header A B C D A B C D b Four 512 byte segments sent separate IP datagrams b The 2048 bytes data delivered application single READ call Files UNIX property The reader file tell whether file written block time byte time one blow As UNIX file TCP software idea bytes mean interest finding A byte byte When application passes data TCP TCP may send immediately buffer order collect larger amount send discretion However sometimes application really wants data sent immediately For example suppose user interactive game wants send stream updates It essential updates sent immediately buffered collection To force data TCP notion PUSH flag carried packets The original intent let applications tell TCP implementations via PUSH flag delay transmission However applications literally set PUSH flag send data Instead different operating systems evolved different options expedite transmission e g TCP NODELAY Windows Linux For Internet archaeologists also mention one interesting feature TCP service remains protocol rarely used urgent data When application high priority data processed immediately example interactive user hits CTRL C key break remote computation already begun sending application put control information data stream give TCP along URGENT flag This event causes TCP stop accumulating data transmit everything connection immediately When urgent data received destination receiving application interrupted e g given signal UNIX terms stop whatever read data stream find urgent data The end urgent data marked application knows The start urgent data marked It application figure This scheme provides crude signaling mechanism leaves everything else application However urgent data potentially useful found compelling application early fell disuse Its use discouraged implementation differences leaving applications handle signaling Perhaps future transport protocols provide better signaling 556 THE TRANSPORT LAYER 6 5 3 The TCP Protocol In section give general overview TCP protocol In next one go protocol header field field A key feature TCP one dominates protocol design every byte TCP connection 32 bit sequence number When Internet began lines routers mostly 56 kbps leased lines host blasting away full speed took 1 week cycle sequence numbers At modern network speeds sequence numbers consumed alarming rate see later Separate 32 bit sequence numbers carried packets sliding window position one direction acknowledgements reverse direction discussed The sending receiving TCP entities exchange data form segments A TCP segment consists fixed 20 byte header plus optional part followed zero data bytes The TCP software decides big segments It accumulate data several writes one segment split data one write multiple segments Two limits restrict segment size First segment including TCP header must fit 65 515byte IP payload Second link MTU Maximum Transfer Unit Each segment must fit MTU sender receiver sent received single unfragmented packet In practice MTU generally 1500 bytes Ethernet payload size thus defines upper bound segment size However still possible IP packets carrying TCP segments fragmented passing network path link small MTU If happens degrades performance causes problems Kent Mogul 1987 Instead modern TCP implementations perform path MTU discovery using technique outlined RFC 1191 described Sec 5 5 5 This technique uses ICMP error messages find smallest MTU link path TCP adjusts segment size downwards avoid fragmentation The basic protocol used TCP entities sliding window protocol dynamic window size When sender transmits segment also starts timer When segment arrives destination receiving TCP entity sends back segment data exist otherwise without bearing acknowledgement number equal next sequence number expects receive remaining window size If sender timer goes acknowledgement received sender transmits segment Although protocol sounds simple many sometimes subtle ins outs cover Segments arrive order bytes 3072 4095 arrive acknowledged bytes 2048 3071 turned yet Segments also delayed long transit sender times retransmits The retransmissions may include different byte SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP ranges original transmission requiring careful administration keep track bytes correctly received far However since byte stream unique offset done TCP must prepared deal problems solve efficient way A considerable amount effort gone optimizing performance TCP streams even face network problems A number algorithms used many TCP implementations discussed 6 5 4 The TCP Segment Header shows layout TCP segment Every segment begins fixed format 20 byte header The fixed header may followed header options After options 65 535 20 20 65 495 data bytes may follow first 20 refer IP header second TCP header Segments without data legal commonly used acknowledgements control messages 32 Bits Source port Destination port Sequence number Acknowledgement number TCP header length C E U A P R S F WC R C S S Y I R E G K H T N N Checksum Window size Urgent pointer Options 0 32 bit words Data optional The TCP header Let us dissect TCP header field field The Source port Destination port fields identify local end points connection A TCP port plus host IP address forms 48 bit unique end point The source destination end points together identify connection This connection identifier called 5 tuple consists five pieces information protocol TCP source IP source port destination IP destination port 558 THE TRANSPORT LAYER The Sequence number Acknowledgement number fields perform usual functions Note latter specifies next order byte expected last byte correctly received It cumulative acknowledgement summarizes received data single number It go beyond lost data Both 32 bits every byte data numbered TCP stream The TCP header length tells many 32 bit words contained TCP header This information needed Options field variable length header Technically field really indicates start data within segment measured 32 bit words number header length words effect Next comes 4 bit field used The fact bits remained unused 30 years 2 original reserved 6 bits reclaimed testimony well thought TCP Lesser protocols would needed bits fix bugs original design Now come eight 1 bit flags CWR ECE used signal congestion ECN Explicit Congestion Notification used specified RFC 3168 ECE set signal ECN Echo TCP sender tell slow TCP receiver gets congestion indication network CWR set signal Congestion Window Reduced TCP sender TCP receiver knows sender slowed stop sending ECN Echo We discuss role ECN TCP congestion control Sec 6 5 10 URG set 1 Urgent pointer use The Urgent pointer used indicate byte offset current sequence number urgent data found This facility lieu interrupt messages As mentioned facility bare bones way allowing sender signal receiver without getting TCP involved reason interrupt seldom used The ACK bit set 1 indicate Acknowledgement number valid This case nearly packets If ACK 0 segment contain acknowledgement Acknowledgement number field ignored The PSH bit indicates PUSHed data The receiver hereby kindly requested deliver data application upon arrival buffer full buffer received might otherwise efficiency The RST bit used abruptly reset connection become confused due host crash reason It also used reject invalid segment refuse attempt open connection In general get segment RST bit problem hands The SYN bit used establish connections The connection request SYN 1 ACK 0 indicate piggyback acknowledgement field use The connection reply bear acknowledgement however SYN 1 ACK 1 In essence SYN bit used denote CONNECTION REQUEST CONNECTION ACCEPTED ACK bit used distinguish two possibilities SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP The FIN bit used release connection It specifies sender data transmit However closing connection closing process may continue receive data indefinitely Both SYN FIN segments sequence numbers thus guaranteed processed correct order Flow control TCP handled using variable sized sliding window The Window size field tells many bytes may sent starting byte acknowledged A Window size field 0 legal says bytes including Acknowledgement number 1 received receiver chance consume data would like data moment thank The receiver later grant permission send transmitting segment Acknowledgement number nonzero Window size field In protocols Chap 3 acknowledgements frames received permission send new frames tied together This consequence fixed window size protocol In TCP acknowledgements permission send additional data completely decoupled In effect receiver say I received bytes k I want thank This decoupling fact variable sized window gives additional flexibility We study detail A Checksum also provided extra reliability It checksums header data conceptual pseudoheader exactly way UDP except pseudoheader protocol number TCP 6 checksum mandatory Please see Sec 6 4 1 details The Options field provides way add extra facilities covered regular header Many options defined several commonly used The options variable length fill multiple 32 bits using padding zeros may extend 40 bytes accommodate longest TCP header specified Some options carried connection established negotiate inform side capabilities Other options carried packets lifetime connection Each option Type Length Value encoding A widely used option one allows host specify MSS Maximum Segment Size willing accept Using large segments efficient using small ones 20 byte header amortized data small hosts may able handle big segments During connection setup side announce maximum see partner If host use option defaults 536 byte payload All Internet hosts required accept TCP segments 536 20 556 bytes The maximum segment size two directions need For lines high bandwidth high delay 64 KB window corresponding 16 bit field problem For example OC 12 line roughly 600 Mbps takes less 1 msec output full 64 KB window If round trip propagation delay 50 msec typical transcontinental 560 THE TRANSPORT LAYER fiber sender idle 98 time waiting acknowledgements A larger window size would allow sender keep pumping data The window scale option allows sender receiver negotiate window scale factor start connection Both sides use scale factor shift Window size field 14 bits left thus allowing windows 230 bytes Most TCP implementations support option The timestamp option carries timestamp sent sender echoed receiver It included every packet use established connection setup used compute round trip time samples used estimate packet lost It also used logical extension 32bit sequence number On fast connection sequence number may wrap around quickly leading possible confusion old new data The PAWS Protection Against Wrapped Sequence numbers scheme discards arriving segments old timestamps prevent problem Finally SACK Selective ACKnowledgement option lets receiver tell sender ranges sequence numbers received It supplements Acknowledgement number used packet lost subsequent duplicate data arrived The new data reflected Acknowledgement number field header field gives next order byte expected With SACK sender explicitly aware data receiver hence determine data retransmitted SACK defined RFC 2108 RFC 2883 increasingly used We describe use SACK along congestion control Sec 6 5 10 6 5 5 TCP Connection Establishment Connections established TCP means three way handshake discussed Sec 6 2 2 To establish connection one side say server passively waits incoming connection executing LISTEN ACCEPT primitives order either specifying specific source nobody particular The side say client executes CONNECT primitive specifying IP address port wants connect maximum TCP segment size willing accept optionally user data e g password The CONNECT primitive sends TCP segment SYN bit ACK bit waits response When segment arrives destination TCP entity checks see process done LISTEN port given Destination port field If sends reply RST bit reject connection If process listening port process given incoming TCP segment It either accept reject connection If accepts acknowledgement segment sent back The sequence TCP segments sent normal case shown Note SYN segment consumes 1 byte sequence space acknowledged unambiguously SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP Host 1 Host 2 SYN SEQ Host 1 Host 2 SYN SE Q x x EQ Time SYN S N SEQ ACK x 1 SY CK SYN SYN A EQ S SE Q x A CK SEQ x 1 ACK x 1 1 1 b TCP connection establishment normal case b Simultaneous connection establishment sides In event two hosts simultaneously attempt establish connection two sockets sequence events illustrated Fig 637 b The result events one connection established two connections identified end points If first setup results connection identified x second one one table entry made namely x Recall initial sequence number chosen host cycle slowly rather constant 0 This rule protect delayed duplicate packets discussed Sec 6 2 2 Originally accomplished clock based scheme clock ticked every 4 sec However vulnerability implementing three way handshake listening process must remember sequence number soon responds SYN segment This means malicious sender tie resources host sending stream SYN segments never following complete connection This attack called SYN flood crippled many Web servers 1990s One way defend attack use SYN cookies Instead remembering sequence number host chooses cryptographically generated sequence number puts outgoing segment forgets If three way handshake completes sequence number plus 1 returned host It regenerate correct sequence number running cryptographic function long inputs function known example host IP address port local secret This procedure allows host check acknowledged sequence number correct without 562 THE TRANSPORT LAYER remember sequence number separately There caveats inability handle TCP options SYN cookies may used host subject SYN flood However interesting twist connection establishment For information see RFC 4987 Lemon 2002 6 5 6 TCP Connection Release Although TCP connections full duplex understand connections released best think pair simplex connections Each simplex connection released independently sibling To release connection either party send TCP segment FIN bit set means data transmit When FIN acknowledged direction shut new data Data may continue flow indefinitely direction however When directions shut connection released Normally four TCP segments needed release connection one FIN one ACK direction However possible first ACK second FIN contained segment reducing total count three Just telephone calls people say goodbye hang phone simultaneously ends TCP connection may send FIN segments time These acknowledged usual way connection shut There fact essential difference two hosts releasing sequentially simultaneously To avoid two army problem discussed Sec 6 2 3 timers used If response FIN forthcoming within two maximum packet lifetimes sender FIN releases connection The side eventually notice nobody seems listening anymore time well While solution perfect given fact perfect solution theoretically impossible In practice problems rarely arise 6 5 7 TCP Connection Management Modeling The steps required establish release connections represented finite state machine 11 states listed In state certain events legal When legal event happens action may taken If event happens error reported Each connection starts CLOSED state It leaves state either passive open LISTEN active open CONNECT If side opposite one connection established state becomes ESTABLISHED Connection release initiated either side When complete state returns CLOSED The finite state machine shown The common case client actively connecting passive server shown heavy lines solid client dotted server The lightface lines unusual event sequences SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP State Description CLOSED No connection active pending LISTEN The server waiting incoming call SYN RCVD A connection request arrived wait ACK SYN SENT The application started open connection ESTABLISHED The normal data transfer state FIN WAIT 1 The application said finished FIN WAIT 2 The side agreed release TIME WAIT Wait packets die CLOSING Both sides tried close simultaneously CLOSE WAIT The side initiated release LAST ACK Wait packets die The states used TCP connection management finite state machine Each line marked event action pair The event either user initiated system call CONNECT LISTEN SEND CLOSE segment arrival SYN FIN ACK RST one case timeout twice maximum packet lifetime The action sending control segment SYN FIN RST nothing indicated Comments shown parentheses One best understand diagram first following path client heavy solid line later following path server heavy dashed line When application program client machine issues CONNECT request local TCP entity creates connection record marks SYN SENT state shoots SYN segment Note many connections may open opened time behalf multiple applications state per connection recorded connection record When SYN ACK arrives TCP sends final ACK three way handshake switches ESTABLISHED state Data sent received When application finished executes CLOSE primitive causes local TCP entity send FIN segment wait corresponding ACK dashed box marked active close When ACK arrives transition made state FIN WAIT 2 one direction connection closed When side closes FIN comes acknowledged Now sides closed TCP waits time equal twice maximum packet lifetime guarantee packets connection died case acknowledgement lost When timer goes TCP deletes connection record Now let us examine connection management server viewpoint The server LISTEN settles see turns When SYN 564 THE TRANSPORT LAYER Start CONNECT SYN Step 1 3 way handshake CLOSED CLOSE LISTEN CLOSE SYN SYN ACK Step 2 LISTEN 3 way handshake SYN RCVD RST SEND SYN SYN SYN ACK simultaneous open SYN SENT Data transfer state ACK ESTABLISHED SYN ACK ACK Step 3 3 way handshake CLOSE FIN CLOSE FIN FIN ACK Active close Passive close FIN ACK FIN WAIT 1 CLOSE WAIT CLOSING ACK ACK CLOSE FIN FIN ACK ACK FIN WAIT 2 FIN ACK LAST ACK TIME WAIT Timeout CLOSED ACK Go back start TCP connection management finite state machine The heavy solid line normal path client The heavy dashed line normal path server The light lines unusual events Each transition labeled event causing action resulting separated slash comes acknowledged server goes SYN RCVD state When server SYN acknowledged three way handshake complete server goes ESTABLISHED state Data transfer occur When client done transmitting data CLOSE causes FIN arrive server dashed box marked passive close The server signaled When CLOSE FIN sent client When SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP client acknowledgement shows server releases connection deletes connection record 6 5 8 TCP Sliding Window As mentioned earlier window management TCP decouples issues acknowledgement correct receipt segments receiver buffer allocation For example suppose receiver 4096 byte buffer shown If sender transmits 2048 byte segment correctly received receiver acknowledge segment However since 2048 bytes buffer space application removes data buffer advertise window 2048 starting next byte expected Sender Receiver Application 2 KB write Receiver buffer4 KB Empty 2 KB SEQ 2 KB ACK 2048 WIN 2048 Application 2 KB write 2 KB SEQ 2048 Full Sender blocked ACK Application reads 2 KB IN 0 4096 W IN 2 096 W ACK 2 KB Sender may send 2 KB 1 KB SEQ 1 KB 2 KB Window management TCP Now sender transmits another 2048 bytes acknowledged advertised window size 0 The sender must stop application 566 THE TRANSPORT LAYER process receiving host removed data buffer time TCP advertise larger window data sent When window 0 sender may normally send segments two exceptions First urgent data may sent example allow user kill process running remote machine Second sender may send 1 byte segment force receiver reannounce next byte expected window size This packet called window probe The TCP standard explicitly provides option prevent deadlock window update ever gets lost Senders required transmit data soon come application Neither receivers required send acknowledgements soon possible For example first 2 KB data came TCP knowing 4 KB window would completely correct buffering data another 2 KB came able transmit segment 4 KB payload This freedom used improve performance Consider connection remote terminal example using SSH telnet reacts every keystroke In worst case whenever character arrives sending TCP entity TCP creates 21 byte TCP segment gives IP send 41 byte IP datagram At receiving side TCP immediately sends 40 byte acknowledgement 20 bytes TCP header 20 bytes IP header Later remote terminal read byte TCP sends window update moving window 1 byte right This packet also 40 bytes Finally remote terminal processed character echoes character local display using 41 byte packet In 162 bytes bandwidth used four segments sent character typed When bandwidth scarce method business desirable One approach many TCP implementations use optimize situation called delayed acknowledgements The idea delay acknowledgements window updates 500 msec hope acquiring data hitch free ride Assuming terminal echoes within 500 msec one 41 byte packet need sent back remote side cutting packet count bandwidth usage half Although delayed acknowledgements reduce load placed network receiver sender sends multiple short packets e g 41 byte packets containing 1 byte data still operating inefficiently A way reduce usage known Nagle algorithm Nagle 1984 What Nagle suggested simple data come sender small pieces send first piece buffer rest first piece acknowledged Then send buffered data one TCP segment start buffering next segment acknowledged That one short packet outstanding time If many pieces data sent application one round trip time Nagle algorithm put many pieces one segment greatly reducing bandwidth used The algorithm additionally says new segment sent enough data trickled fill maximum segment SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP Nagle algorithm widely used TCP implementations times better disable In particular interactive games run Internet players typically want rapid stream short update packets Gathering updates send bursts makes game respond erratically makes unhappy users A subtle problem Nagle algorithm sometimes interact delayed acknowledgements cause temporary deadlock receiver waits data piggyback acknowledgement sender waits acknowledgement send data This interaction delay downloads Web pages Because problems Nagle algorithm disabled called TCP NODELAY option Mogul Minshall 2001 discuss solutions Another problem degrade TCP performance silly window syndrome Clark 1982 This problem occurs data passed sending TCP entity large blocks interactive application receiving side reads data 1 byte time To see problem look Initially TCP buffer receiving side full e window size 0 sender knows Then interactive application reads one character TCP stream This action makes receiving TCP happy sends window update sender saying right send 1 byte The sender obliges sends 1 byte The buffer full receiver acknowledges 1 byte segment sets window 0 This behavior go forever Clark solution prevent receiver sending window update 1 byte Instead forced wait decent amount space available advertise instead Specifically receiver send window update handle maximum segment size advertised connection established buffer half empty whichever smaller Furthermore sender also help sending tiny segments Instead wait send full segment least one containing half receiver buffer size Nagle algorithm Clark solution silly window syndrome complementary Nagle trying solve problem caused sending application delivering data TCP byte time Clark trying solve problem receiving application sucking data TCP byte time Both solutions valid work together The goal sender send small segments receiver ask The receiving TCP go improving performance window updates large units Like sending TCP also buffer data block READ request application large chunk data Doing reduces number calls TCP overhead It also increases response time noninteractive applications like file transfer efficiency may important response time individual requests Another issue receiver must handle segments may arrive order The receiver buffer data passed application 568 THE TRANSPORT LAYER Receiver buffer full Application reads 1 byte Room one byte Header Header 1 Byte Window update segment sent New byte arrives Receiver buffer full Silly window syndrome order Actually nothing bad would happen order segments discarded since would eventually retransmitted sender would wasteful Acknowledgements sent data byte acknowledged received This called cumulative acknowledgement If receiver gets segments 0 1 2 4 5 6 7 acknowledge everything including last byte segment 2 When sender times retransmits segment 3 As receiver buffered segments 4 7 upon receipt segment 3 acknowledge bytes end segment 7 6 5 9 TCP Timer Management TCP uses multiple timers least conceptually work The important RTO Retransmission TimeOut When segment sent retransmission timer started If segment acknowledged timer expires timer stopped If hand timer goes acknowledgement comes segment retransmitted timer os started The question arises long timeout This problem much difficult transport layer data link protocols 802 11 In latter case expected delay measured SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP microseconds highly predictable e low variance timer set go slightly acknowledgement expected shown Since acknowledgements rarely delayed data link layer due lack congestion absence acknowledgement expected time generally means either frame acknowledgement lost 0 3 T 0 3 T1 T2 0 2 Probability Probability 0 2 0 1 0 1 Round trip time microseconds Round trip time milliseconds b Probability density acknowledgement arrival times data link layer b Probability density acknowledgement arrival times TCP TCP faced radically different environment The probability density function time takes TCP acknowledgement come back looks like b It larger variable Determining round trip time destination tricky Even known deciding timeout interval also difficult If timeout set short say T 1 b unnecessary retransmissions occur clogging Internet useless packets If set long e g T 2 performance suffer due long retransmission delay whenever packet lost Furthermore mean variance acknowledgement arrival distribution change rapidly within seconds congestion builds resolved The solution use dynamic algorithm constantly adapts timeout interval based continuous measurements network performance The algorithm generally used TCP due Jacobson 1988 works follows For connection TCP maintains variable SRTT Smoothed Round Trip Time best current estimate round trip time destination question When segment sent timer started see long acknowledgement takes also trigger retransmission takes long If 570 THE TRANSPORT LAYER acknowledgement gets back timer expires TCP measures long acknowledgement took say R It updates SRTT according formula SRTT SRTT 1 R smoothing factor determines quickly old values forgotten Typically 7 8 This kind formula EWMA Exponentially Weighted Moving Average low pass filter discards noise samples Even given good value SRTT choosing suitable retransmission timeout nontrivial matter Initial implementations TCP used 2xRTT experience showed constant value inflexible failed respond variance went In particular queueing models random e Poisson traffic predict load approaches capacity delay becomes large highly variable This lead retransmission timer firing copy packet retransmitted although original packet still transiting network It likely happen conditions high load worst time send additional packets network To fix problem Jacobson proposed making timeout value sensitive variance round trip times well smoothed round trip time This change requires keeping track another smoothed variable RTTVAR RoundTrip Time VARiation updated using formula RTTVAR RTTVAR 1 SRTT R This EWMA typically 3 4 The retransmission timeout RTO set RTO SRTT 4 RTTVAR The choice factor 4 somewhat arbitrary multiplication 4 done single shift less 1 packets come four standard deviations late Note RTTVAR exactly standard deviation really mean deviation close enough practice Jacobson paper full clever tricks compute timeouts using integer adds subtracts shifts This economy needed modern hosts become part culture allows TCP run manner devices supercomputers tiny devices So far nobody put RFID chip someday Who knows More details compute timeout including initial settings variables given RFC 2988 The retransmission timer also held minimum 1 second regardless estimates This conservative value chosen prevent spurious retransmissions based measurements Allman Paxson 1999 One problem occurs gathering samples R round trip time segment times sent When acknowledgement comes unclear whether acknowledgement refers first SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP transmission later one Guessing wrong seriously contaminate retransmission timeout Phil Karn discovered problem hard way Karn amateur radio enthusiast interested transmitting TCP IP packets ham radio notoriously unreliable medium He made simple proposal update estimates segments retransmitted Additionally timeout doubled successive retransmission segments get first time This fix called Karn algorithm Karn Partridge 1987 Most TCP implementations use The retransmission timer timer TCP uses A second timer persistence timer It designed prevent following deadlock The receiver sends acknowledgement window size 0 telling sender wait Later receiver updates window packet update lost Now sender receiver waiting something When persistence timer goes sender transmits probe receiver The response probe gives window size If still 0 persistence timer set cycle repeats If nonzero data sent A third timer implementations use keepalive timer When connection idle long time keepalive timer may go cause one side check whether side still If fails respond connection terminated This feature controversial adds overhead may terminate otherwise healthy connection due transient network partition The last timer used TCP connection one used TIME WAIT state closing It runs twice maximum packet lifetime make sure connection closed packets created died 6 5 10 TCP Congestion Control We saved one key functions TCP last congestion control When load offered network handle congestion builds The Internet exception The network layer detects congestion queues grow large routers tries manage dropping packets It transport layer receive congestion feedback network layer slow rate traffic sending network In Internet TCP plays main role controlling congestion well main role reliable transport That special protocol We covered general situation congestion control Sec 6 3 One key takeaway transport protocol using AIMD Additive Increase Multiplicative Decrease control law response binary congestion signals network would converge fair efficient bandwidth allocation TCP congestion control based implementing approach using window packet loss binary signal To TCP maintains congestion window 572 THE TRANSPORT LAYER whose size number bytes sender may network time The corresponding rate window size divided round trip time connection TCP adjusts size window according AIMD rule Recall congestion window maintained addition flow control window specifies number bytes receiver buffer Both windows tracked parallel number bytes may sent smaller two windows Thus effective window smaller sender thinks right receiver thinks right It takes two tango TCP stop sending data either congestion flow control window temporarily full If receiver says send 64 KB sender knows bursts 32 KB clog network send 32 KB On hand receiver says send 64 KB sender knows bursts 128 KB get effortlessly send full 64 KB requested The flow control window described earlier follows describe congestion window Modern congestion control added TCP largely efforts Van Jacobson 1988 It fascinating story Starting 1986 growing popularity early Internet led first occurrence became known congestion collapse prolonged period goodput dropped precipitously e factor 100 due congestion network Jacobson many others set understand happening remedy situation The high level fix Jacobson implemented approximate AIMD congestion window The interesting part much complexity TCP congestion control added existing implementation without changing message formats made instantly deployable To start observed packet loss suitable signal congestion This signal comes little late network already congested quite dependable After difficult build router drop packets overloaded This fact unlikely change Even terabyte memories appear buffer vast numbers packets probably terabit sec networks fill memories However using packet loss congestion signal depends transmission errors relatively rare This normally case wireless links 802 11 include retransmission mechanism link layer Because wireless retransmissions network layer packet loss due transmission errors normally masked wireless networks It also rare links wires optical fibers typically low bit error rates All Internet TCP algorithms assume lost packets caused congestion monitor timeouts look signs trouble way miners watch canaries A good retransmission timer needed detect packet loss signals accurately timely manner We already discussed TCP retransmission timer includes estimates mean variation round trip SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP times Fixing timer including variation factor important step Jacobson work Given good retransmission timeout TCP sender track outstanding number bytes loading network It simply looks difference sequence numbers transmitted acknowledged Now seems task easy All need track congestion window using sequence acknowledgement numbers adjust congestion window using AIMD rule As might expected complicated A first consideration way packets sent network even short periods time must matched network path Otherwise traffic cause congestion For example consider host congestion window 64 KB attached 1 Gbps switched Ethernet If host sends entire window burst traffic may travel slow 1 Mbps ADSL line along path The burst took half millisecond 1 Gbps line clog 1 Mbps line half second completely disrupting protocols voice IP This behavior might good idea protocol designed cause congestion protocol control However turns use small bursts packets advantage shows happens sender fast network 1 Gbps link sends small burst four packets receiver slow network 1Mbps link bottleneck slowest part path Initially four packets travel link quickly sent sender At router queued sent takes longer send packet slow link receive next packet fast link But queue large small number packets sent Note increased length packets slow link The packet 1 KB say longer takes time send slow link fast one 1 Burst packets sent fast link Fast link Sender 4 Acks preserve slow link timing sender 2 Burst queues router drains onto slow link Ack clock Slow link bottleneck 3 Receive acks packets slow link rate Receiver A burst packets sender returning ack clock Eventually packets get receiver acknowledged The times acknowledgements reflect times packets arrived receiver crossing slow link They spread compared original packets fast link As acknowledgements travel network back sender preserve timing 574 THE TRANSPORT LAYER The key observation acknowledgements return sender rate packets sent slowest link path This precisely rate sender wants use If injects new packets network rate sent fast slow link permits queue congest router along path This timing known ack clock It essential part TCP By using ack clock TCP smoothes traffic avoids unnecessary queues routers A second consideration AIMD rule take long time reach good operating point fast networks congestion window started small size Consider modest network path support 10 Mbps RTT 100 msec The appropriate congestion window bandwidth delay product 1 Mbit 100 packets 1250 bytes If congestion window starts 1 packet increases 1 packet every RTT 100 RTTs 10 seconds connection running right rate That long time wait get right speed transfer We could reduce startup time starting larger initial window say 50 packets But window would far large slow short links It would cause congestion used described Instead solution Jacobson chose handle considerations mix linear multiplicative increase When connection established sender initializes congestion window small initial value four segments details described RFC 3390 use four segments increase earlier initial value one segment based experience The sender sends initial window The packets take round trip time acknowledged For segment acknowledged retransmission timer goes sender adds one segment worth bytes congestion window Plus segment acknowledged one less segment network The upshot every acknowledged segment allows two segments sent The congestion window doubling every roundtrip time This algorithm called slow start slow exponential growth except comparison previous algorithm let entire flow control window sent Slow start shown In first round trip time sender injects one packet network receiver receives one packet Two packets sent next round trip time four packets third round trip time Slow start works well range link speeds round trip times uses ack clock match rate sender transmissions network path Take look way acknowledgements return sender receiver When sender gets acknowledgement increases congestion window one immediately sends two packets network One packet increase one packet replacement packet acknowledged left network At times number SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP TCP sender cwnd 1 Acknowledgement cwnd 2 cwnd 3 cwnd 4 cwnd 5 cwnd 6 cwnd 7 cwnd 8 TCP receiver Data 1 RTT 1 packet 1 RTT 2 packets 1 RTT 4 packets 1 RTT 4 packets pipe full Slow start initial congestion window one segment unacknowledged packets given congestion window However two packets necessarily arrive receiver closely spaced sent For example suppose sender 100 Mbps Ethernet Each packet 1250 bytes takes 100 sec send So delay packets small 100 sec The situation changes packets go across 1Mbps ADSL link anywhere along path It takes 10 msec send packet This means minimum spacing two packets grown factor 100 Unless packets wait together queue later link spacing remain large In effect shown enforcing minimum spacing data packets arriving receiver The spacing kept receiver sends acknowledgements thus sender receives acknowledgements If network path slow acknowledgements come slowly delay RTT If network path fast acknowledgements come quickly RTT All sender follow timing ack clock injects new packets slow start Because slow start causes exponential growth eventually sooner rather later send many packets network quickly When happens queues build network When queues full one packets lost After happens TCP sender time acknowledgement fails arrive time There evidence slow start growing fast After three RTTs four packets network These four packets take entire RTT arrive receiver That congestion window four packets right size connection However packets acknowledged slow start continues grow congestion window reaching eight packets another RTT Only four packets reach receiver one RTT matter many sent That network pipe full Additional packets placed network sender build 576 THE TRANSPORT LAYER router queues since delivered receiver quickly enough Congestion packet loss occur soon To keep slow start control sender keeps threshold connection called slow start threshold Initially value set arbitrarily high size flow control window limit connection TCP keeps increasing congestion window slow start timeout occurs congestion window exceeds threshold receiver window filled Whenever packet loss detected example timeout slow start threshold set half congestion window entire process restarted The idea current window large caused congestion previously detected timeout Half window used successfully earlier time probably better estimate congestion window close path capacity cause loss In example growing congestion window eight packets may cause loss congestion window four packets previous RTT right value The congestion window reset small initial value slow start resumes Whenever slow start threshold crossed TCP switches slow start additive increase In mode congestion window increased one segment every round trip time Like slow start usually implemented increase every segment acknowledged rather increase per RTT Call congestion window cwnd maximum segment size MSS A common approximation increase cwnd MSS MSS cwnd cwnd MSS packets may acknowledged This increase need fast The whole idea TCP connection spend lot time congestion window close optimum value small throughput low large congestion occur Additive increase shown situation slow start At end every RTT sender congestion window grown enough inject additional packet network Compared slow start linear rate growth much slower It makes little difference small congestion windows case large difference time taken grow congestion window 100 segments example There something else improve performance The defect scheme far waiting timeout Timeouts relatively long must conservative After packet lost receiver acknowledge past acknowledgement number stay fixed sender able send new packets network congestion window remains full This condition continue relatively long period timer fires lost packet retransmitted At stage TCP slow starts There quick way sender recognize one packets lost As packets beyond lost packet arrive receiver trigger SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP TCP sender cwnd 1 Acknowledgement cwnd 2 cwnd 3 TCP receiver Data 1 RTT 1 packet 1 RTT 2 packets 1 RTT 3 packets cwnd 4 1 RTT 4 packets cwnd 5 1 RTT 4 packets pipe full Additive increase initial congestion window one segment acknowledgements return sender These acknowledgements bear acknowledgement number They called duplicate acknowledgements Each time sender receives duplicate acknowledgement likely another packet arrived receiver lost packet still shown Because packets take different paths network arrive order This trigger duplicate acknowledgements even though packets lost However uncommon Internet much time When reordering across multiple paths received packets usually reordered much Thus TCP somewhat arbitrarily assumes three duplicate acknowledgements imply packet lost The identity lost packet inferred acknowledgement number well It next packet sequence This packet retransmitted right away retransmission timeout fires This heuristic called fast retransmission After fires slow start threshold still set half current congestion window timeout Slow start restarted setting congestion window one packet With window size new packet sent one round trip time takes acknowledge retransmitted packet along data sent loss detected An illustration congestion algorithm built far shown This version TCP called TCP Tahoe 4 2BSD Tahoe release 1988 included The maximum segment size 1 KB Initially congestion window 64 KB timeout occurred threshold set 32 KB congestion window 1 KB transmission 0 The congestion window grows exponentially hits threshold 32 KB The 578 THE TRANSPORT LAYER window increased every time new acknowledgement arrives rather continuously leads discrete staircase pattern After threshold passed window grows linearly It increased one segment every RTT Congestion window KB packets Slow start Additive increase 35 Threshold 32KB Packet loss 25 Threshold 20KB 1551216 Transmission round RTTs Slow start followed additive increase TCP Tahoe The transmissions round 13 unlucky known one lost network This detected three duplicate acknowledgements arrive At time lost packet retransmitted threshold set half current window 40 KB half 20 KB slow start initiated Restarting congestion window one packet takes one round trip time previously transmitted data leave network acknowledged including retransmitted packet The congestion window grows slow start previously reaches new threshold 20 KB At time growth becomes linear It continue fashion another packet loss detected via duplicate acknowledgements timeout receiver window becomes limit TCP Tahoe included good retransmission timers provided working congestion control algorithm solved problem congestion collapse Jacobson realized possible even better At time fast retransmission connection running congestion window large still running working ack clock Every time another duplicate acknowledgement arrives likely another packet left network Using duplicate acknowledgements count packets network makes possible let packets exit network continue send new packet additional duplicate acknowledgement Fast recovery heuristic implements behavior It temporary mode aims maintain ack clock running congestion window new threshold half value congestion window time SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP fast retransmission To duplicate acknowledgements counted including three triggered fast retransmission number packets network fallen new threshold This takes half round trip time From new packet sent duplicate acknowledgement received One round trip time fast retransmission lost packet acknowledged At time stream duplicate acknowledgements cease fast recovery mode exited The congestion window set new slow start threshold grows linear increase The upshot heuristic TCP avoids slow start except connection first started timeout occurs The latter still happen one packet lost fast retransmission recover adequately Instead repeated slow starts congestion window running connection follows sawtooth pattern additive increase one segment every RTT multiplicative decrease half one RTT This exactly AIMD rule sought implement This sawtooth behavior shown It produced TCP Reno named 4 3BSD Reno release 1990 included TCP Reno essentially TCP Tahoe plus fast recovery After initial slow start congestion window climbs linearly packet loss detected duplicate acknowledgements The lost packet retransmitted fast recovery used keep ack clock running retransmission acknowledged At time congestion window resumed new slow start threshold rather 1 This behavior continues indefinitely connection spends time congestion window close optimum value bandwidth delay product Congestion window KB packets Slow start Additive increase Packet loss Thresh Multiplicative decrease Fast recovery 20 Threshold Threshold 100 Transmission round RTTs Fast recovery sawtooth pattern TCP Reno TCP Reno mechanisms adjusting congestion window formed basis TCP congestion control two decades Most 580 THE TRANSPORT LAYER changes intervening years adjusted mechanisms minor ways example changing choices initial window removing various ambiguities Some improvements made recovering two losses window packets For example TCP NewReno version uses partial advance acknowledgement number retransmission find repair another loss Hoe 1996 described RFC 3782 Since mid 1990s several variations emerged follow principles described use slightly different control laws For example Linux uses variant called CUBIC TCP Ha et al 2008 Windows includes variant called Compound TCP Tan et al 2006 Two larger changes also affected TCP implementations First much complexity TCP comes inferring stream duplicate acknowledgements packets arrived packets lost The cumulative acknowledgement number provide information A simple fix use SACK Selective ACKnowledgements lists three ranges bytes received With information sender directly decide packets retransmit track packets flight implement congestion window When sender receiver set connection send SACK permitted TCP option signal understand selective acknowledgements Once SACK enabled connection works shown A receiver uses TCP Acknowledgement number field normal manner cumulative acknowledgement highest order byte received When receives packet 3 order packet 2 lost sends SACK option received data along duplicate cumulative acknowledgement packet 1 The SACK option gives byte ranges received number given cumulative acknowledgement The first range packet triggered duplicate acknowledgement The next ranges present older blocks Up three ranges commonly used By time packet 6 received two SACK byte ranges used indicate packet 6 packets 3 4 received addition packets packet 1 From information SACK option receives sender decide packets retransmit In case retransmitting packets 2 5 would good idea SACK strictly advisory information The actual detection loss using duplicate acknowledgements adjustments congestion window proceed However SACK TCP recover easily situations multiple packets lost roughly time since TCP sender knows packets received SACK widely deployed It described RFC 2883 TCP congestion control using SACK described RFC 3517 The second change use ECN Explicit Congestion Notification addition packet loss congestion signal ECN IP layer mechanism SEC 6 5 THE INTERNET TRANSPORT PROTOCOLS TCP Retransmit 2 5 Lost packets Sender ACK 1 ACK 1 SACK 3 Receiver ACK 1 ACK 1 SACK 3 4 SACK 6 3 4 Selective acknowledgements notify hosts congestion described Sec 5 3 4 With TCP receiver receive congestion signals IP The use ECN enabled TCP connection sender receiver indicate capable using ECN setting ECE CWR bits connection establishment If ECN used packet carries TCP segment flagged IP header show carry ECN signal Routers support ECN set congestion signal packets carry ECN flags congestion approaching instead dropping packets congestion occurred The TCP receiver informed packet arrives carries ECN congestion signal The receiver uses ECE ECN Echo flag signal TCP sender packets experienced congestion The sender tells receiver heard signal using CWR Congestion Window Reduced flag The TCP sender reacts congestion notifications exactly way packet loss detected via duplicate acknowledgements However situation strictly better Congestion detected packet harmed way ECN described RFC 3168 It requires host router support yet widely used Internet For information complete set congestion control behaviors implemented TCP see RFC 5681 6 5 11 The Future TCP As workhorse Internet TCP used many applications extended time give good performance wide range networks Many versions deployed slightly different implementations classic algorithms described especially congestion control robustness attacks It likely TCP continue evolve Internet We mention two particular issues The first one TCP provide transport semantics applications want For example applications want send messages records whose boundaries need preserved Other applications work group 582 THE TRANSPORT LAYER related conversations Web browser transfers several objects server Still applications want better control network paths use TCP standard sockets interface meet needs well Essentially application burden dealing problem solved TCP This led proposals new protocols would provide slightly different interface Two examples SCTP Stream Control Transmission Protocol defined RFC 4960 SST Structured Stream Transport Ford 2007 However whenever someone proposes changing something worked well long always huge battle Users demanding features If broke fix camps The second issue congestion control You may expected solved problem deliberations mechanisms developed time Not The form TCP congestion control described widely used based packet losses signal congestion When Padhye et al 1998 modeled TCP throughput based sawtooth pattern found packet loss rate must drop rapidly increasing speed To reach throughput 1 Gbps round trip time 100 ms 1500 byte packets one packet lost approximately every 10 minutes That packet loss rate 2 10 8 incredibly small It infrequent serve good congestion signal source loss e g packet transmission error rates 10 7 easily dominate limiting throughput This relationship problem past networks getting faster faster leading many people revisit congestion control One possibility use alternate congestion control signal packet loss We gave several examples Sec 6 2 The signal might round trip time grows network becomes congested used FAST TCP Wei et al 2006 Other approaches possible time tell best 6 6 PERFORMANCE ISSUES Performance issues important computer networks When hundreds thousands computers interconnected complex interactions unforeseen consequences common Frequently complexity leads poor performance one knows In following sections examine many issues related network performance see kinds problems exist done Unfortunately understanding network performance art science There little underlying theory actually use practice The best give rules thumb gained hard experience present examples taken real world We delayed discussion studied transport layer performance applications receive SEC 6 6 PERFORMANCE ISSUES depends combined performance transport network link layers able use TCP example various places In next sections look six aspects network performance 1 Performance problems 2 Measuring network performance 3 Host design fast networks 4 Fast segment processing 5 Header compression 6 Protocols long fat networks These aspects consider network performance host across network networks increased speed size 6 6 1 Performance Problems Computer Networks Some performance problems congestion caused temporary resource overloads If traffic suddenly arrives router router handle congestion build performance suffer We studied congestion detail previous chapter Performance also degrades structural resource imbalance For example gigabit communication line attached low end PC poor host able process incoming packets fast enough lost These packets eventually retransmitted adding delay wasting bandwidth generally reducing performance Overloads also synchronously triggered As example segment contains bad parameter e g port destined many cases receiver thoughtfully send back error notification Now consider could happen bad segment broadcast 1000 machines one might send back error message The resulting broadcast storm could cripple network UDP suffered problem ICMP protocol changed cause hosts refrain responding errors UDP segments sent broadcast addresses Wireless networks must particularly careful avoid unchecked broadcast responses broadcast occurs naturally wireless bandwidth limited A second example synchronous overload happens electrical power failure When power comes back machines simultaneously start rebooting A typical reboot sequence might require first going DHCP server learn one true identity file server get copy operating system If hundreds machines data center server probably collapse load 584 THE TRANSPORT LAYER Even absence synchronous overloads presence sufficient resources poor performance occur due lack system tuning For example machine plenty CPU power memory enough memory allocated buffer space flow control slow segment reception limit performance This problem many TCP connections Internet became faster default size flow control window stayed fixed 64 KB Another tuning issue setting timeouts When segment sent timer set guard loss segment If timeout set short unnecessary retransmissions occur clogging wires If timeout set long unnecessary delays occur segment lost Other tunable parameters include long wait data piggyback sending separate acknowledgement many retransmissions make giving Another performance problem occurs real time applications like audio video jitter Having enough bandwidth average sufficient good performance Short transmission delays also required Consistently achieving short delays demands careful engineering load network quality service support link network layers 6 6 2 Network Performance Measurement When network performs poorly users often complain folks running demanding improvements To improve performance operators must first determine exactly going To find really happening operators must make measurements In section look network performance measurements Much discussion based seminal work Mogul 1993 Measurements made different ways many locations protocol stack physically The basic kind measurement start timer beginning activity see long activity takes For example knowing long takes segment acknowledged key measurement Other measurements made counters record often event happened e g number lost segments Finally one often interested knowing amount something number bytes processed certain time interval Measuring network performance parameters many potential pitfalls We list Any systematic attempt measure network performance careful avoid Make Sure That Sample Size Is Large Enough Do measure time send one segment repeat measurement say one million times take average Startup effects 802 16 NIC cable modem getting bandwidth reservation idle period SEC 6 6 PERFORMANCE ISSUES slow first segment queueing introduces variability Having large sample reduce uncertainty measured mean standard deviation This uncertainty computed using standard statistical formulas Make Sure That Samples Are Representative Ideally whole sequence one million measurements repeated different times day week see effect different network conditions measured quantity Measurements congestion example little use made moment congestion Sometimes results may counterintuitive first heavy congestion 11 A M 1 P M congestion noon users lunch With wireless networks location important variable signal propagation Even measurement node placed close wireless client may observe packets client due differences antennas It best take measurements wireless client study see sees Failing possible use techniques combine wireless measurements taken different vantage points gain complete picture going Mahajan et al 2006 Caching Can Wreak Havoc Measurements Repeating measurement many times return unexpectedly fast answer protocols use caching mechanisms For instance fetching Web page looking DNS name find IP address may involve network exchange first time return answer local cache without sending packets network The results measurement essentially worthless unless want measure cache performance Buffering similar effect TCP IP performance tests known report UDP achieve performance substantially higher network allows How occur A call UDP normally returns control soon message accepted kernel added transmission queue If sufficient buffer space timing 1000 UDP calls mean data sent Most may still kernel performance test program thinks transmitted Caution advised absolutely sure understand data cached buffered part network operation Be Sure That Nothing Unexpected Is Going On Your Tests Making measurements time user decided run video conference network often give different results video conference It best run tests idle network create 586 THE TRANSPORT LAYER entire workload Even approach pitfalls though While might think nobody using network 3 A M might automatic backup program begins copying disks tape Or might heavy traffic wonderful Web pages distant time zones Wireless networks challenging respect often possible separate sources interference Even wireless networks sending traffic nearby someone may microwave popcorn inadvertently cause interference degrades 802 11 performance For reasons good practice monitor overall network activity least realize something unexpected happen Be Careful When Using Coarse Grained Clock Computer clocks function incrementing counter regular intervals For example millisecond timer adds 1 counter every 1 msec Using timer measure event takes less 1 msec possible requires care Some computers accurate clocks course always shorter events measure Note clocks always accurate precision time returned read To measure time make TCP connection example clock say milliseconds read transport layer code entered exited If true connection setup time 300 sec difference two readings either 0 1 wrong However measurement repeated one million times total measurements added divided one million mean time accurate better 1 sec Be Careful Extrapolating Results Suppose make measurements simulated network loads running 0 idle 0 4 40 capacity For example response time send voice IP packet 802 11 network might shown data points solid line It may tempting extrapolate linearly shown dotted line However many queueing results involve factor 1 1 load true values may look like dashed line rises much faster linearly load gets high That beware contention effects become much pronounced high load 6 6 3 Host Design Fast Networks Measuring tinkering improve performance considerably substitute good design first place A poorly designed network improved much Beyond redesigned scratch SEC 6 6 PERFORMANCE ISSUES Response time 0 1 0 2 0 3 0 4 0 5 Load 0 6 0 7 0 8 0 9 1 0 Response function load In section present rules thumb software implementation network protocols hosts Surprisingly experience shows often performance bottleneck otherwise fast networks two reasons First NICs Network Interface Cards routers already engineered hardware support run wire speed This means process packets quickly packets possibly arrive link Second relevant performance applications obtain It link capacity throughput delay network transport processing Reducing software overheads improves performance increasing throughput decreasing delay It also reduce energy spent networking important consideration mobile computers Most ideas common knowledge network designers years They first stated explicitly Mogul 1993 treatment largely follows Another relevant source Metcalfe 1993 Host Speed Is More Important Than Network Speed Long experience shown nearly fast networks operating system protocol overhead dominate actual time wire For example theory minimum RPC time 1 Gbps Ethernet 1 sec corresponding minimum 512 byte request followed minimum 512 byte reply In practice overcoming software overhead getting RPC time anywhere near substantial achievement It rarely happens practice 588 THE TRANSPORT LAYER Similarly biggest problem running 1 Gbps often getting bits user buffer onto network fast enough receiving host process fast come If double host CPU memory speed often come close doubling throughput Doubling network capacity effect bottleneck hosts Reduce Packet Count Reduce Overhead Each segment certain amount overhead e g header well data e g payload Bandwidth required components Processing also required components e g header processing checksum When 1 million bytes sent data cost matter segment size However using 128 byte segments means 32 times much per segment overhead using 4 KB segments The bandwidth processing overheads add fast reduce throughput Per packet overhead lower layers amplifies effect Each arriving packet causes fresh interrupt host keeping On modern pipelined processor interrupt breaks CPU pipeline interferes cache requires change memory management context voids branch prediction table forces substantial number CPU registers saved An n fold reduction segments sent thus reduces interrupt packet overhead factor n You might say people computers poor multitasking This observation underlies desire send MTU packets large pass along network path without fragmentation Mechanisms Nagle algorithm Clark solution also attempts avoid sending small packets Minimize Data Touching The straightforward way implement layered protocol stack one module layer Unfortunately leads copying least accessing data multiple passes layer work For example packet received NIC typically copied kernel buffer From copied network layer buffer network layer processing transport layer buffer transport layer processing finally receiving application process It unusual incoming packet copied three four times segment enclosed delivered All copying greatly degrade performance memory operations order magnitude slower register register instructions For example 20 instructions actually go memory e cache misses likely touching incoming packets average instruction execution time slowed factor 2 8 0 8 1 0 2 10 Hardware assistance help The problem much copying operating system SEC 6 6 PERFORMANCE ISSUES A clever operating system minimize copying combining processing multiple layers For example TCP IP usually implemented together TCP IP necessary copy payload packet processing switches network transport layer Another common trick perform multiple operations within layer single pass data For example checksums often computed copying data copied newly computed checksum appended end Minimize Context Switches A related rule context switches e g kernel mode user mode deadly They bad properties interrupts copying combined This cost transport protocols often implemented kernel Like reducing packet count context switches reduced library procedure sends data internal buffering substantial amount Similarly receiving side small incoming segments collected together passed user one fell swoop instead individually minimize context switches In best case incoming packet causes context switch current user kernel switch receiving process give newly arrived data Unfortunately operating systems additional context switches happen For example network manager runs special process user space packet arrival likely cause context switch current user kernel another one kernel network manager followed another one back kernel finally one kernel receiving process This sequence shown All context switches packet wasteful CPU time devastating effect network performance User process running time packet arrival Network manager Receiving process User space Kernel space Four context switches handle one packet user space network manager 590 THE TRANSPORT LAYER Avoiding Congestion Is Better Than Recovering It The old maxim ounce prevention worth pound cure certainly holds network congestion When network congested packets lost bandwidth wasted useless delays introduced All costs unnecessary recovering congestion takes time patience Not occur first place better Congestion avoidance like getting DTP vaccination hurts little time get prevents something would hurt lot future Avoid Timeouts Timers necessary networks used sparingly timeouts minimized When timer goes action generally repeated If truly necessary repeat action repeating unnecessarily wasteful The way avoid extra work careful timers set little bit conservative side A timer takes long expire adds small amount extra delay one connection unlikely event segment lost A timer goes uses host resources wastes bandwidth puts extra load perhaps dozens routers good reason 6 6 4 Fast Segment Processing Now covered general rules look specific methods speeding segment processing For information see Clark et al 1989 Chase et al 2001 Segment processing overhead two components overhead per segment overhead per byte Both must attacked The key fast segment processing separate normal successful case one way data transfer handle specially Many protocols tend emphasize something goes wrong e g packet getting lost make protocols run fast designer aim minimize processing time everything goes right Minimizing processing time error occurs secondary Although sequence special segments needed get ESTABLISHED state segment processing straightforward one side starts close connection Let us begin examining sending side ESTABLISHED state data transmitted For sake clarity assume transport entity kernel although ideas apply user space process library inside sending process In sending process traps kernel SEND The first thing transport entity test see normal case state ESTABLISHED neither side trying close connection regular e SEC 6 6 PERFORMANCE ISSUES band full segment sent enough window space available receiver If conditions met tests needed fast path sending transport entity taken Typically path taken time S Receiving process Sending process Segment passed receiving process S Trap kernel send segment Test Test Network The fast path sender receiver shown heavy line The processing steps path shaded In usual case headers consecutive data segments almost To take advantage fact prototype header stored within transport entity At start fast path copied fast possible scratch buffer word word Those fields change segment segment overwritten buffer Frequently fields easily derived state variables next sequence number A pointer full segment header plus pointer user data passed network layer Here strategy followed shown Finally network layer gives resulting packet data link layer transmission As example principle works practice let us consider TCP IP shows TCP header The fields consecutive segments one way flow shaded All sending transport entity copy five words prototype header output buffer fill next sequence number copying word memory compute checksum increment sequence number memory It hand header data special IP procedure sending regular maximum segment IP copies five word prototype header see b buffer fills Identification field computes checksum The packet ready transmission Now let us look fast path processing receiving side Step 1 locating connection record incoming segment For TCP Diff Serv THE TRANSPORT LAYER Source port Destination port Sequence number Acknowledgement number Len VER IHL Diff Serv Identification TTL Total length Fragment offset Header checksum Protocol Unused Window size Source address Checksum Urgent pointer Destination address b TCP header b IP header In cases taken prototype without change connection record stored hash table simple function two IP addresses two ports key Once connection record located addresses ports must compared verify correct record found An optimization often speeds connection record lookup even maintain pointer last one used try one first Clark et al 1989 tried observed hit rate exceeding 90 The segment checked see normal one state ESTABLISHED neither side trying close connection segment full one special flags set sequence number one expected These tests take handful instructions If conditions met special fast path TCP procedure called The fast path updates connection record copies data user While copying also computes checksum eliminating extra pass data If checksum correct connection record updated acknowledgement sent back The general scheme first making quick check see header expected special procedure handle case called header prediction Many TCP implementations use When optimization ones discussed chapter used together possible get TCP run 90 speed local memory memory copy assuming network fast enough Two areas major performance gains possible buffer management timer management The issue buffer management avoiding unnecessary copying mentioned Timer management important nearly timers set expire They set guard segment loss segments acknowledgements arrive correctly Hence important optimize timer management case timers rarely expiring A common scheme use linked list timer events sorted expiration time The head entry contains counter telling many ticks away expiry Each successive entry contains counter telling many ticks SEC 6 6 PERFORMANCE ISSUES previous entry Thus timers expire 3 10 12 ticks respectively three counters 3 7 2 respectively At every clock tick counter head entry decremented When hits zero event processed next item list becomes head Its counter changed This way inserting deleting timers expensive operations execution times proportional length list A much efficient approach used maximum timer interval bounded known advance Here array called timing wheel used shown Each slot corresponds one clock tick The current time shown T 4 Timers scheduled expire 3 10 12 ticks If new timer suddenly set expire seven ticks entry made slot 11 Similarly timer set T 10 canceled list starting slot 14 searched required entry removed Note array accommodate timers beyond T 15 Slot13579111315 Pointer list timers T 12000 Current time T Pointer list timers T 3000 Pointer list timers T 10 A timing wheel When clock ticks current time pointer advanced one slot circularly If entry pointed nonzero timers processed Many variations basic idea discussed Varghese Lauck 1987 6 6 5 Header Compression We looking fast networks long There Let us consider performance wireless networks bandwidth limited Reducing software overhead help mobile computers run 594 THE TRANSPORT LAYER efficiently nothing improve performance network links bottleneck To use bandwidth well protocol headers payloads carried minimum bits For payloads means using compact encodings information images JPEG format rather bitmap document formats PDF include compression It also means application level caching mechanisms Web caches reduce transfers first place What protocol headers At link layer headers wireless networks typically compact designed scarce bandwidth mind For example 802 16 headers short connection identifiers instead longer addresses However higher layer protocols IP TCP UDP come one version link layers designed compact headers In fact streamlined processing reduce software overhead often leads headers compact could otherwise e g IPv6 loosely packed headers IPv4 The higher layer headers significant performance hit Consider example voice IP data carried combination IP UDP RTP These protocols require 40 bytes header 20 IPv4 8 UDP 12 RTP With IPv6 situation even worse 60 bytes including 40 byte IPv6 header The headers wind majority transmitted data consume half bandwidth Header compression used reduce bandwidth taken links higher layer protocol headers Specially designed schemes used instead general purpose methods This headers short compress well individually decompression requires prior data received This case packet lost Header compression obtains large gains using knowledge protocol format One first schemes designed Van Jacobson 1990 compressing TCP IP headers slow serial links It able compress typical TCP IP header 40 bytes average 3 bytes The trick method hinted Many header fields change packet packet There need example send IP TTL TCP port numbers every packet They omitted sending side link filled receiving side Similarly fields change predictable manner For example barring loss TCP sequence number advances data In cases receiver predict likely value The actual number needs carried differs expected Even may carried small change previous value acknowledgement number increases new data received reverse direction With header compression possible simple headers higher layer protocols compact encodings low bandwidth links ROHC RObust Header Compression modern version header compression defined SEC 6 6 PERFORMANCE ISSUES framework RFC 5795 It designed tolerate loss occur wireless links There profile set protocols compressed IP UDP RTP Compressed headers carried referring context essentially connection header fields may easily predicted packets connection packets different connections In typical operation ROHC reduces IP UDP RTP headers 40 bytes 1 3 bytes While header compression mainly targeted reducing bandwidth needs also useful reducing delay Delay comprised propagation delay fixed given network path transmission delay depends bandwidth amount data sent For example 1 Mbps link sends 1 bit 1 sec In case media wireless networks network relatively slow transmission delay may important factor overall delay consistently low delay important quality service Header compression help reducing amount data sent hence reducing transmission delay The effect achieved sending smaller packets This trade increased software overhead decreased transmission delay Note another potential source delay queueing delay access wireless link This also significant wireless links often heavily used limited resource network In case wireless link must quality service mechanisms give low delay real time packets Header compression alone sufficient 6 6 6 Protocols Long Fat Networks Since 1990s gigabit networks transmit data large distances Because combination fast network fat pipe long delay networks called long fat networks When networks arose people first reaction use existing protocols various problems quickly arose In section discuss problems scaling speed delay network protocols The first problem many protocols use 32 bit sequence numbers When Internet began lines routers mostly 56 kbps leased lines host blasting away full speed took 1 week cycle sequence numbers To TCP designers 232 pretty decent approximation infinity little danger old packets still around week transmitted With 10 Mbps Ethernet wrap time became 57 minutes much shorter still manageable With 1 Gbps Ethernet pouring data onto Internet wrap time 34 seconds well 120 sec maximum packet lifetime Internet All sudden 232 nearly good approximation infinity since fast sender cycle sequence space old packets still exist The problem many protocol designers simply assumed without stating time required use entire sequence space would greatly exceed 596 THE TRANSPORT LAYER maximum packet lifetime Consequently need even worry problem old duplicates still existing sequence numbers wrapped around At gigabit speeds unstated assumption fails Fortunately proved possible extend effective sequence number treating timestamp carried option TCP header packet high order bits This mechanism called PAWS Protection Against Wrapped Sequence numbers described RFC 1323 A second problem size flow control window must greatly increased Consider example sending 64 KB burst data San Diego Boston order fill receiver 64 KB buffer Suppose link 1 Gbps one way speed light fiber delay 20 msec Initially 0 pipe empty illustrated Only 500 sec later Fig 654 b segments fiber The lead segment somewhere vicinity Brawley still deep Southern California However transmitter must stop gets window update Data b c ment ledge ow Ackn The state transmitting 1 Mbit San Diego Boston At 0 b After 500 sec c After 20 msec After 40 msec After 20 msec lead segment hits Boston shown c acknowledged Finally 40 msec starting first acknowledgement gets SEC 6 6 PERFORMANCE ISSUES back sender second burst transmitted Since transmission line used 1 25 msec 100 efficiency 1 25 This situation typical older protocols running gigabit lines A useful quantity keep mind analyzing network performance bandwidth delay product It obtained multiplying bandwidth bits sec round trip delay time sec The product capacity pipe sender receiver back bits For example bandwidth delay product 40 million bits In words sender would transmit burst 40 million bits able keep going full speed first acknowledgement came back It takes many bits fill pipe directions This burst half million bits achieves 1 25 efficiency 1 25 pipe capacity The conclusion drawn good performance receiver window must least large bandwidth delay product preferably somewhat larger since receiver may respond instantly For transcontinental gigabit line least 5 MB required A third related problem simple retransmission schemes go back n protocol perform poorly lines large bandwidth delay product Consider 1 Gbps transcontinental link round trip transmission time 40 msec A sender transmit 5 MB one round trip If error detected 40 msec sender told If go back n used sender retransmit bad packet also 5 MB worth packets came afterward Clearly massive waste resources More complex protocols selective repeat needed A fourth problem gigabit lines fundamentally different megabit lines long gigabit lines delay limited rather bandwidth limited In show time takes transfer 1 Mbit file 4000 km various transmission speeds At speeds 1 Mbps transmission time dominated rate bits sent By 1 Gbps 40 msec round trip delay dominates 1 msec takes put bits fiber Further increases bandwidth hardly effect unfortunate implications network protocols It says stop wait protocols RPC inherent upper bound performance This limit dictated speed light No amount technological progress optics ever improve matters new laws physics would help though Unless use found gigabit line host waiting reply gigabit line better megabit line expensive A fifth problem communication speeds improved faster computing speeds Note computer engineers go beat communication engineers We counting In 1970s ARPANET ran 56 kbps computers ran 1 MIPS Compare numbers 598 THE TRANSPORT LAYER 1000 sec File transfer time 100 sec 10 sec 1 sec 100 msec 10 msec 1 msec 107Data rate bps Time transfer acknowledge 1 Mbit file 4000 km line 1000 MIPS computers exchanging packets 1 Gbps line The number instructions per byte decreased factor 10 The exact numbers debatable depending dates scenarios conclusion less time available protocol processing used protocols must become simpler Let us turn problems ways dealing The basic principle high speed network designers learn heart Design speed bandwidth optimization Old protocols often designed minimize number bits wire frequently using small fields packing together bytes words This concern still valid wireless networks gigabit networks Protocol processing problem protocols designed minimize The IPv6 designers clearly understood principle A tempting way go fast build fast network interfaces hardware The difficulty strategy unless protocol exceedingly simple hardware means plug board second CPU program To make sure network coprocessor cheaper main CPU often slower chip The consequence design much time main fast CPU idle waiting second slow CPU critical work It myth think main CPU work waiting Furthermore two general purpose CPUs communicate race conditions occur elaborate protocols needed two processors synchronize SEC 6 6 PERFORMANCE ISSUES correctly avoid races Usually best approach make protocols simple main CPU work Packet layout important consideration gigabit networks The header contain fields possible reduce processing time fields big enough job word aligned fast processing In context big enough means problems sequence numbers wrapping around old packets still exist receivers unable advertise enough window space window field small etc occur The maximum data size large reduce software overhead permit efficient operation 1500 bytes small high speed networks gigabit Ethernet supports jumbo frames 9 KB IPv6 supports jumbogram packets excess 64 KB Let us look issue feedback high speed protocols Due relatively long delay loop feedback avoided takes long receiver signal sender One example feedback governing transmission rate using sliding window protocol Future protocols may switch rate based protocols avoid long delays inherent receiver sending window updates sender In protocol sender send wants provided send faster rate sender receiver agreed upon advance A second example feedback Jacobson slow start algorithm This algorithm makes multiple probes see much network handle With high speed networks making half dozen small probes see network responds wastes huge amount bandwidth A efficient scheme sender receiver network reserve necessary resources connection setup time Reserving resources advance also advantage making easier reduce jitter In short going high speeds inexorably pushes design toward connection oriented operation something fairly close Another valuable feature ability send normal amount data along connection request In way one round trip time saved 6 7 DELAY TOLERANT NETWORKING We finish chapter describing new kind transport may one day important component Internet TCP transport protocols based assumption sender receiver continuously connected working path else protocol fails data delivered In networks often end end path An example space network LEO Low Earth Orbit satellites pass range ground stations A given satellite may able communicate ground station particular times two satellites may never able communicate time even via ground station one satellites 600 THE TRANSPORT LAYER may always range Other example networks involve submarines buses mobile phones devices computers intermittent connectivity due mobility extreme conditions In occasionally connected networks data still communicated storing nodes forwarding later working link This technique called message switching Eventually data relayed destination A network whose architecture based approach called DTN Delay Tolerant Network Disruption Tolerant Network Work DTNs started 2002 IETF set research group topic The inspiration DTNs came unlikely source efforts send packets space Space networks must deal intermittent communication long delays Kevin Fall observed ideas Interplanetary Internets could applied networks Earth intermittent connectivity norm Fall 2003 This model gives useful generalization Internet storage delays occur communication Data delivery akin delivery postal system electronic mail rather packet switching routers Since 2002 DTN architecture refined applications DTN model grown As mainstream application consider large datasets many terabytes produced scientific experiments media events Web based services need copied datacenters different locations around world Operators would like send bulk traffic peak times make use bandwidth already paid used willing tolerate delay It like backups night applications making heavy use network The problem global services peak times different locations around world There may little overlap times datacenters Boston Perth peak network bandwidth night one city day However DTN models allow storage delays transfer With model becomes possible send dataset Boston Amsterdam using peak bandwidth cities time zones 6 hours apart The dataset stored Amsterdam peak bandwidth Amsterdam Perth It sent Perth complete transfer Laoutaris et al 2009 studied model find provide substantial capacity little cost use DTN model often doubles capacity compared traditional end end model In follows describe IETF DTN architecture protocols 6 7 1 DTN Architecture The main assumption Internet DTNs seek relax endto end path source destination exists entire duration communication session When case normal Internet protocols SEC 6 7 DELAY TOLERANT NETWORKING fail DTNs get around lack end end connectivity architecture based message switching shown It also intended tolerate links low reliability large delays The architecture specified RFC 4838 Contact working link Sent bundle DTN node Storage Intermittent link working Stored bundle Destination Source Delay tolerant networking architecture In DTN terminology message called bundle DTN nodes equipped storage typically persistent storage disk flash memory They store bundles links become available forward bundles The links work intermittently shows five intermittent links currently working two links working A working link called contact also shows bundles stored two DTN nodes awaiting contacts send bundles onward In way bundles relayed via contacts source destination The storing forwarding bundles DTN nodes sounds similar queueing forwarding packets routers qualitative differences In routers Internet queueing occurs milliseconds seconds At DTN nodes bundles may stored hours bus arrives town airplane completes flight sensor node harvests enough solar energy run sleeping computer wakes forth These examples also point second difference nodes may move bus plane hold stored data movement may even key part data delivery Routers Internet allowed move The whole process moving bundles might better known store carry forward As example consider scenario shown first use DTN protocols space Wood et al 2008 The source bundles LEO satellite recording Earth images part Disaster Monitoring Constellation satellites The images must returned collection point However satellite intermittent contact three ground stations orbits Earth It comes contact ground station turn Each satellite ground stations collection point act DTN node At contact 602 THE TRANSPORT LAYER bundle portion bundle sent ground station The bundles sent backhaul terrestrial network collection point complete transfer Satellite Bundle Contact working link Intermittent link working Storage DTN nodes Ground station Collection point Use DTN space The primary advantage DTN architecture example naturally fits situation satellite needing store images connectivity time image taken There two advantages First may single contact long enough send images However spread across contacts three ground stations Second use link satellite ground station decoupled link backhaul network This means satellite download limited slow terrestrial link It proceed full speed bundle stored ground station relayed collection point An important issue specified architecture find good routes via DTN nodes A route path use Good routes depend nature architecture describes send data also contacts Some contacts known ahead time A good example motion heavenly bodies space example For space experiment known ahead time contacts would occur contact intervals ranged 5 14 minutes per pass ground station downlink capacity 8 134 Mbps Given knowledge transport bundle images planned ahead time In cases contacts predicted less certainty Examples include buses make contact mostly regular ways due timetable yet variation times amount peak bandwidth ISP networks predicted past data At extreme contacts occasional random One example carrying data user SEC 6 7 DELAY TOLERANT NETWORKING user mobile phones depending users make contact day When unpredictability contacts one routing strategy send copies bundle along different paths hope one copies delivered destination lifetime reached 6 7 2 The Bundle Protocol To take closer look operation DTNs look IETF protocols DTNs emerging kind network experimental DTNs used different protocols requirement IETF protocols used However least good place start highlight many key issues The DTN protocol stack shown The key protocol Bundle protocol specified RFC 5050 It responsible accepting messages application sending one bundles via storecarry forward operations destination DTN node It also apparent Bundle protocol runs level TCP IP In words TCP IP may used contact move bundles DTN nodes This positioning raises issue whether Bundle protocol transport layer protocol application layer protocol Just RTP take position despite running transport protocol Bundle protocol providing transport service many different applications cover DTNs chapter Upper layers Application Bundle Protocol DTN layer Convergence layer TCP IP Internet Convergence layer Other internet Lower layers Delay tolerant networking protocol stack In see Bundle protocol may run kinds protocols UDP even kinds internets For example space network links may long delays The round trip time Earth Mars easily 20 minutes depending relative position planets Imagine well TCP acknowledgements retransmissions work link especially relatively short messages Not well Instead 604 THE TRANSPORT LAYER another protocol uses error correcting codes might used Or sensor networks resource constrained lightweight protocol TCP may used Since Bundle protocol fixed yet intended run variety transports must gap functionality protocols That gap reason inclusion convergence layer The convergence layer glue layer matches interfaces protocols joins By definition different convergence layer different lower layer transport Convergence layers commonly found standards join new existing protocols The format Bundle protocol messages shown The different fields messages tell us key issues handled Bundle protocol Primary block Bits Bits Optional blocks variable Ver Flags Payload block Dest Source Report Custodian Creation Lifetime Dictionary Status report Class service General variable Type Flags Length Data Bundle protocol message format Each message consists primary block thought header payload block data optionally blocks example carry security parameters The primary block begins Version field currently 6 followed Flags field Among functions flags encode class service let source mark bundles higher lower priority handling requests whether destination acknowledge bundle Then come addresses highlight three interesting parts design As well Destination Source identifier field Custodian identifier The custodian party responsible seeing bundle delivered In Internet source node usually custodian node retransmits data ultimately delivered destination However DTN source node may always connected may way knowing whether data delivered DTNs deal problem using notion custody transfer another node closer destination assume responsibility seeing data safely delivered For example bundle stored airplane forwarding later time location airplane may become custodian bundle SEC 6 7 DELAY TOLERANT NETWORKING The second interesting aspect identifiers IP addresses Because Bundle protocol intended work across variety transports internets defines identifiers These identifiers really like high level names Web page URLs low level addresses IP addresses They give DTNs aspect application level routing email delivery distribution software updates The third interesting aspect way identifiers encoded There also Report identifier diagnostic messages All identifiers encoded references variable length Dictionary field This provides compression custodian report nodes source destination In fact much message format designed extensibility efficiency mind using compact representation variable length fields The compact representation important wireless links resourceconstrained nodes sensor network Next comes Creation field carrying time bundle created along sequence number source ordering plus Lifetime field tells time bundle data longer useful These fields exist data may stored long period DTN nodes must way remove stale data network Unlike Internet require DTN nodes loosely synchronized clocks The primary block completed Dictionary field Then comes payload block This block starts short Type field identifies payload followed small set Flags describe processing options Then comes Data field preceded Length field Finally may optional blocks block carries security parameters Many aspects DTNs explored research community Good strategies routing depend nature contacts mentioned Storing data inside network raises issues Now congestion control must consider storage nodes another kind resource depleted The lack end end communication also exacerbates security problems Before DTN node takes custody bundle may want know sender authorized use network bundle probably wanted destination Solutions problems depend kind DTN space networks different sensor networks 6 8 SUMMARY The transport layer key understanding layered protocols It provides various services important end end reliable connection oriented byte stream sender receiver It accessed service primitives permit establishment use release connections A common transport layer interface one provided Berkeley sockets 606 THE TRANSPORT LAYER Transport protocols must able connection management unreliable networks Connection establishment complicated existence delayed duplicate packets reappear inopportune moments To deal three way handshakes needed establish connections Releasing connection easier establishing one still far trivial due two army problem Even network layer completely reliable transport layer plenty work It must handle service primitives manage connections timers allocate bandwidth congestion control run variablesized sliding window flow control Congestion control allocate available bandwidth competing flows fairly track changes usage network The AIMD control law converges fair efficient allocation The Internet two main transport protocols UDP TCP UDP connectionless protocol mainly wrapper IP packets additional feature multiplexing demultiplexing multiple processes using single IP address UDP used client server interactions example using RPC It also used building real time protocols RTP The main Internet transport protocol TCP It provides reliable bidirectional congestion controlled byte stream 20 byte header segments A great deal work gone optimizing TCP performance using algorithms Nagle Clark Jacobson Karn others Network performance typically dominated protocol segment processing overhead situation gets worse higher speeds Protocols designed minimize number segments work large bandwidthdelay paths For gigabit networks simple protocols streamlined processing called Delay tolerant networking provides delivery service across networks occasional connectivity long delays across links Intermediate nodes store carry forward bundles information eventually delivered even working path sender receiver time PROBLEMS 1 In example transport primitives LISTEN blocking call Is strictly necessary If explain nonblocking primitive could used What advantage would scheme described text 2 Primitives transport service assume asymmetry two end points connection establishment one end server executes LISTEN end client executes CONNECT However peer peer applications file sharing CHAP 6 PROBLEMS systems e g BitTorrent end points peers There server client functionality How transport service primitives may used build peer peer applications 3 In underlying model assumed packets may lost network layer thus must individually acknowledged Suppose network layer 100 percent reliable never loses packets What changes needed 4 In parts comment value SERVER PORT must client server Why important 5 In Internet File Server example connect system call client fail reason listen queue full server Assume network perfect 6 One criteria deciding whether server active time start demand using process server frequently service provided used Can think criteria making decision 7 Suppose clock driven scheme generating initial sequence numbers used 15 bit wide clock counter The clock ticks every 100 msec maximum packet lifetime 60 sec How often need resynchronization take place worst case b data consumes 240 sequence numbers min 8 Why maximum packet lifetime T large enough ensure packet also acknowledgements vanished 9 Imagine two way handshake rather three way handshake used set connections In words third message required Are deadlocks possible Give example show none exist 10 Imagine generalized n army problem agreement two blue armies sufficient victory Does protocol exist allows blue win 11 Consider problem recovering host crashes e If interval writing sending acknowledgement vice versa made relatively small two best sender receiver strategies minimizing chance protocol failure 12 In suppose new flow E added takes path R1 R2 R6 How max min bandwidth allocation change five flows 13 Discuss advantages disadvantages credits versus sliding window protocols 14 Some policies fairness congestion control Additive Increase Additive Decrease AIAD Multiplicative Increase Additive Decrease MIAD Multiplicative Increase Multiplicative Decrease MIMD Discuss three policies terms convergence stability 15 Why UDP exist Would enough let user processes send raw IP packets 608 THE TRANSPORT LAYER 16 Consider simple application level protocol built top UDP allows client retrieve file remote server residing well known address The client first sends request file name server responds sequence data packets containing different parts requested file To ensure reliability sequenced delivery client server use stop wait protocol Ignoring obvious performance issue see problem protocol Think carefully possibility processes crashing 17 A client sends 128 byte request server located 100 km away 1 gigabit optical fiber What efficiency line remote procedure call 18 Consider situation previous problem Compute minimum possible response time given 1 Gbps line 1 Mbps line What conclusion draw 19 Both UDP TCP use port numbers identify destination entity delivering message Give two reasons protocols invented new abstract ID port numbers instead using process IDs already existed protocols designed 20 Several RPC implementations provide option client use RPC implemented UDP RPC implemented TCP Under conditions client prefer use RPC UDP conditions prefer use RPC TCP 21 Consider two networks N 1 N 2 average delay source A destination D In N 1 delay experienced different packets unformly distributed maximum delay 10 seconds N 2 99 packets experience less one second delay limit maximum delay Discuss RTP may used two cases transmit live audio video stream 22 What total size minimum TCP MTU including TCP IP overhead including data link layer overhead 23 Datagram fragmentation reassembly handled IP invisible TCP Does mean TCP worry data arriving wrong order 24 RTP used transmit CD quality audio makes pair 16 bit samples 44 100 times sec one sample stereo channels How many packets per second must RTP transmit 25 Would possible place RTP code operating system kernel along UDP code Explain answer 26 A process host 1 assigned port p process host 2 assigned port q Is possible two TCP connections two ports time 27 In saw addition 32 bit acknowledgement field ACK bit fourth word Does really add anything Why 28 The maximum payload TCP segment 65 495 bytes Why strange number chosen CHAP 6 PROBLEMS 29 Describe two ways get SYN RCVD state 30 Consider effect using slow start line 10 msec round trip time congestion The receive window 24 KB maximum segment size 2 KB How long take first full window sent 31 Suppose TCP congestion window set 18 KB timeout occurs How big window next four transmission bursts successful Assume maximum segment size 1 KB 32 If TCP round trip time RTT currently 30 msec following acknowledgements come 26 32 24 msec respectively new RTT estimate using Jacobson algorithm Use 0 9 33 A TCP machine sending full windows 65 535 bytes 1 Gbps channel 10 msec one way delay What maximum throughput achievable What line efficiency 34 What fastest line speed host blast 1500 byte TCP payloads 120 sec maximum packet lifetime without sequence numbers wrap around Take TCP IP Ethernet overhead consideration Assume Ethernet frames may sent continuously 35 To address limitations IP version 4 major effort undertaken via IETF resulted design IP version 6 still significant reluctance adoption new version However major effort needed address limitations TCP Explain case 36 In network whose max segment 128 bytes max segment lifetime 30 sec 8 bit sequence numbers maximum data rate per connection 37 Suppose measuring time receive segment When interrupt occurs read system clock milliseconds When segment fully processed read clock You measure 0 msec 270 000 times 1 msec 730 000 times How long take receive segment 38 A CPU executes instructions rate 1000 MIPS Data copied 64 bits time word copied costing 10 instructions If coming packet copied four times system handle 1 Gbps line For simplicity assume instructions even instructions read write memory run full 1000 MIPS rate 39 To get around problem sequence numbers wrapping around old packets still exist one could use 64 bit sequence numbers However theoretically optical fiber run 75 Tbps What maximum packet lifetime required make sure future 75 Tbps networks wraparound problems even 64 bit sequence numbers Assume byte sequence number TCP 40 In Sec 6 6 5 calculated gigabit line dumps 80 000 packets sec host giving 6250 instructions process leaving half CPU time applications This calculation assumed 1500 byte packet Redo calculation ARPANET sized packet 128 bytes In cases assume packet sizes given include overhead 610 THE TRANSPORT LAYER 41 For 1 Gbps network operating 4000 km delay limiting factor bandwidth Consider MAN average source destination 20 km apart At data rate round trip delay due speed light equal transmission delay 1 KB packet 42 Calculate bandwidth delay product following networks 1 T1 1 5 Mbps 2 Ethernet 10 Mbps 3 T3 45 Mbps 4 STS 3 155 Mbps Assume RTT 100 msec Recall TCP header 16 bits reserved Window Size What implications light calculations 43 What bandwidth delay product 50 Mbps channel geostationary satellite If packets 1500 bytes including overhead big window packets 44 The file server far perfect could use improvements Make following modifications Give client third argument specifies byte range b Add client flag w allows file written server 45 One common function network protocols need manipulate messages Recall protocols manipulate messages adding striping headers Some protocols may break single message multiple fragments later join multiple fragments back single message To end design implement message management library provides support creating new message attaching header message stripping header message breaking message two messages combining two messages single message saving copy message Your implementation must minimize data copying one buffer another much possible It critical operations manipulate messages touch data message rather manipulate pointers 46 Design implement chat system allows multiple groups users chat A chat coordinator resides well known network address uses UDP communication chat clients sets chat servers chat session maintains chat session directory There one chat server per chat session A chat server uses TCP communication clients A chat client allows users start join leave chat session Design implement coordinator server client code 7 THE APPLICATION LAYER Having finished preliminaries come layer applications found The layers application layer provide transport services real work users In chapter study real network applications However even application layer need support protocols allow applications function Accordingly look important one starting applications The item question DNS handles naming within Internet After examine three real applications electronic mail World Wide Web multimedia We finish chapter saying content distribution including peer peer networks 7 1 DNS THE DOMAIN NAME SYSTEM Although programs theoretically could refer Web pages mailboxes resources using network e g IP addresses computers stored addresses hard people remember Also browsing company Web pages 128 111 24 41 means company moves Web server different machine different IP address everyone needs told new IP address Consequently high level readable names introduced order decouple machine names machine addresses In 612 THE APPLICATION LAYER way company Web server might known www cs washington edu regardless IP address Nevertheless since network understands numerical addresses mechanism required convert names network addresses In following sections study mapping accomplished Internet Way back ARPANET days simply file hosts txt listed computer names IP addresses Every night hosts would fetch site maintained For network hundred large timesharing machines approach worked reasonably well However well many millions PCs connected Internet everyone involved realized approach could continue work forever For one thing size file would become large However even importantly host name conflicts would occur constantly unless names centrally managed something unthinkable huge international network due load latency To solve problems DNS Domain Name System invented 1983 It key part Internet ever since The essence DNS invention hierarchical domain based naming scheme distributed database system implementing naming scheme It primarily used mapping host names IP addresses also used purposes DNS defined RFCs 1034 1035 2181 elaborated many others Very briefly way DNS used follows To map name onto IP address application program calls library procedure called resolver passing name parameter We saw example resolver gethostbyname The resolver sends query containing name local DNS server looks name returns response containing IP address resolver returns caller The query response messages sent UDP packets Armed IP address program establish TCP connection host send UDP packets 7 1 1 The DNS Name Space Managing large constantly changing set names nontrivial problem In postal system name management done requiring letters specify implicitly explicitly country state province city street address name addressee Using kind hierarchical addressing ensures confusion Marvin Anderson Main St White Plains N Y Marvin Anderson Main St Austin Texas DNS works way For Internet top naming hierarchy managed organization called ICANN Internet Corporation Assigned Names Numbers ICANN created purpose 1998 part maturing Internet worldwide economic concern Conceptually Internet divided SEC 7 1 DNS THE DOMAIN NAME SYSTEM 250 top level domains domain covers many hosts Each domain partitioned subdomains partitioned All domains represented tree shown The leaves tree represent domains subdomains contain machines course A leaf domain may contain single host may represent company contain thousands hosts Generic aero com edu cisco washington eng cs eng robot gov Countries museum org acm ieee jack jill net au edu jp uk ac co uwa keio nec cs csl us nl vu cs filts oce law fluit A portion Internet domain name space The top level domains come two flavors generic countries The generic domains listed include original domains 1980s domains introduced via applications ICANN Other generic top level domains added future The country domains include one entry every country defined ISO 3166 Internationalized country domain names use non Latin alphabets introduced 2010 These domains let people name hosts Arabic Cyrillic Chinese languages Getting second level domain name company com easy The top level domains run registrars appointed ICANN Getting name merely requires going corresponding registrar com case check desired name available somebody else trademark If problems requester pays registrar small annual fee gets name However Internet become commercial international also become contentious especially matters related naming This controversy includes ICANN For example creation xxx domain took several years court cases resolve Is voluntarily placing adult content domain good bad thing Some people want adult content available Internet others wanted put one domain nanny filters could easily find block children Some domains self organize others restrictions obtain name noted But restrictions appropriate Take pro domain 614 THE APPLICATION LAYER Domain Intended use Start date Restricted com Commercial No edu Educational institutions Yes gov Government Yes int International organizations Yes mil Military Yes net Network providers No org Non profit organizations No aero Air transport Yes biz Businesses No coop Cooperatives Yes info Informational No museum Museums Yes name People No pro Professionals Yes cat Catalan Yes jobs Employment Yes mobi Mobile devices Yes tel Contact details Yes travel Travel industry Yes xxx Sex industry No Generic top level domains example It qualified professionals But professional Doctors lawyers clearly professionals But freelance photographers piano teachers magicians plumbers barbers exterminators tattoo artists mercenaries prostitutes Are occupations eligible According There also money names Tuvalu country sold lease tv domain 50 million country code well suited advertising television sites Virtually every common English word taken com domain along common misspellings Try household articles animals plants body parts etc The practice registering domain turn around sell interested party much higher price even name It called cybersquatting Many companies slow mark Internet era began found obvious domain names already taken tried acquire In general long trademarks violated fraud involved first come first served names Nevertheless policies resolve naming disputes still refined SEC 7 1 DNS THE DOMAIN NAME SYSTEM Each domain named path upward unnamed root The components separated periods pronounced dot Thus engineering department Cisco might eng cisco com rather UNIX style name com cisco eng Notice hierarchical naming means eng cisco com conflict potential use eng eng washington edu might used English department University Washington Domain names either absolute relative An absolute domain name always ends period e g eng cisco com whereas relative one Relative names interpreted context uniquely determine true meaning In cases named domain refers specific node tree nodes Domain names case insensitive edu Edu EDU mean thing Component names 63 characters long full path names must exceed 255 characters In principle domains inserted tree either generic country domains For example cs washington edu could equally well listed us country domain cs washington wa us In practice however organizations United States generic domains outside United States domain country There rule registering multiple top level domains Large companies often e g sony com sony net sony nl Each domain controls allocates domains For example Japan domains ac jp co jp mirror edu com The Netherlands make distinction puts organizations directly nl Thus three following university computer science departments 1 cs washington edu University Washington U S 2 cs vu nl Vrije Universiteit The Netherlands 3 cs keio ac jp Keio University Japan To create new domain permission required domain included For example VLSI group started University Washington wants known vlsi cs washington edu get permission whoever manages cs washington edu Similarly new university chartered say University Northern South Dakota must ask manager edu domain assign unsd edu still available In way name conflicts avoided domain keep track subdomains Once new domain created registered create subdomains cs unsd edu without getting permission anybody higher tree Naming follows organizational boundaries physical networks For example computer science electrical engineering departments located building share LAN nevertheless distinct 616 THE APPLICATION LAYER domains Similarly even computer science split Babbage Hall Turing Hall hosts buildings normally belong domain 7 1 2 Domain Resource Records Every domain whether single host top level domain set resource records associated These records DNS database For single host common resource record IP address many kinds resource records also exist When resolver gives domain name DNS gets back resource records associated name Thus primary function DNS map domain names onto resource records A resource record five tuple Although encoded binary efficiency expositions resource records presented ASCII text one line per resource record The format use follows Domain name Time live Class Type Value The Domain name tells domain record applies Normally many records exist domain copy database holds information multiple domains This field thus primary search key used satisfy queries The order records database significant The Time live field gives indication stable record Information highly stable assigned large value 86400 number seconds 1 day Information highly volatile assigned small value 60 1 minute We come back point later discussed caching The third field every resource record Class For Internet information always IN For non Internet information codes used practice rarely seen The Type field tells kind record There many kinds DNS records The important types listed An SOA record provides name primary source information name server zone described email address administrator unique serial number various flags timeouts The important record type A Address record It holds 32 bit IPv4 address interface host The corresponding AAAA quad A record holds 128 bit IPv6 address Every Internet host must least one IP address machines communicate Some hosts two network interfaces case two type A AAAA resource records Consequently DNS return multiple addresses single name A common record type MX record It specifies name host prepared accept email specified domain It used every SEC 7 1 DNS THE DOMAIN NAME SYSTEM Type Meaning Value SOA Start authority Parameters zone A IPv4 address host 32 Bit integer AAAA IPv6 address host 128 Bit integer MX Mail exchange Priority domain willing accept email NS Name server Name server domain CNAME Canonical name Domain name PTR Pointer Alias IP address SPF Sender policy framework Text encoding mail sending policy SRV Service Host provides TXT Text Descriptive ASCII text The principal DNS resource record types machine prepared accept email If someone wants send email example bill microsoft com sending host needs find mail server located microsoft com willing accept email The MX record provide information Another important record type NS record It specifies name server domain subdomain This host copy database domain It used part process look names describe shortly CNAME records allow aliases created For example person familiar Internet naming general wanting send message user paul computer science department M I T might guess paul cs mit edu work Actually address work domain M I T computer science department csail mit edu However service people know M I T could create CNAME entry point people programs right direction An entry like one might job cs mit edu IN CNAME csail mit edu Like CNAME PTR points another name However unlike CNAME really macro definition e mechanism replace one string another PTR regular DNS data type whose interpretation depends context found In practice nearly always used associate name IP address allow lookups IP address return name corresponding machine These called reverse lookups SRV newer type record allows host identified given service domain For example Web server cs washington edu could identified cockatoo cs washington edu This record generalizes MX record performs task mail servers 618 THE APPLICATION LAYER SPF also newer type record It lets domain encode information machines domain send mail rest Internet This helps receiving machines check mail valid If mail received machine calls dodgy domain records say mail sent domain machine called smtp chances mail forged junk mail Last list TXT records originally provided allow domains identify arbitrary ways Nowadays usually encode machinereadable information typically SPF information Finally Value field This field number domain name ASCII string The semantics depend record type A short description Value fields principal record types given For example kind information one might find DNS database domain see This figure depicts part hypothetical database cs vu nl domain shown The database contains seven types resource records Authoritative data cs vu nl cs vu nl 86400 IN cs vu nl 86400 IN cs vu nl 86400 IN cs vu nl 86400 IN SOA MX MX NS star boss 9527 7200 7200 241920 86400 1 zephyr 2 top star star zephyr top www ftp 8640086400 IN IN IN IN IN A A A CNAME CNAME 130 37 56 205 130 37 20 10 130 37 20 11 star cs vu nl zephyr cs vu nl flits flits flits flits flits 8640086400 IN IN IN IN IN A A MX MX MX 130 37 16 112 192 31 231 165 1 flits 2 zephyr 3 top rowboat IN A IN MX IN MX 130 37 56 201 1 rowboat 2 zephyr little sister IN A 130 37 62 23 laserjet IN A 192 31 231 216 A portion possible DNS database cs vu nl The first noncomment line gives basic information domain concern us Then come two entries giving first SEC 7 1 DNS THE DOMAIN NAME SYSTEM second places try deliver email sent person cs vu nl The zephyr specific machine tried first If fails top tried next choice The next line identifies name server domain star After blank line added readability come lines giving IP addresses star zephyr top These followed alias www cs vu nl address used without designating specific machine Creating alias allows cs vu nl change World Wide Web server without invalidating address people use get A similar argument holds ftp cs vu nl The section machine flits lists two IP addresses three choices given handling email sent flits cs vu nl First choice naturally flits zephyr top second third choices The next three lines contain typical entry computer case rowboat cs vu nl The information provided contains IP address primary secondary mail drops Then comes entry computer capable receiving mail followed entry likely printer connected Internet 7 1 3 Name Servers In theory least single name server could contain entire DNS database respond queries In practice server would overloaded useless Furthermore ever went entire Internet would crippled To avoid problems associated single source information DNS name space divided nonoverlapping zones One possible way divide name space shown Each circled zone contains part tree Generic aero com edu cisco washington eng cs robot eng gov Countries museum org acm ieee jack jill net au edu jp uk ac co uwa keio nec cs csl us nl vu cs flits oce law fluit Part DNS name space divided zones circled 620 THE APPLICATION LAYER Where zone boundaries placed within zone zone administrator This decision made large part based many name servers desired For example University Washington zone washington edu handles eng washington edu handle cs washington edu That separate zone name servers Such decision might made department English wish run name server department Computer Science Each zone also associated one name servers These hosts hold database zone Normally zone one primary name server gets information file disk one secondary name servers get information primary name server To improve reliability name servers located outside zone The process looking name finding address called name resolution When resolver query domain name passes query local name server If domain sought falls jurisdiction name server top cs vu nl falling cs vu nl returns authoritative resource records An authoritative record one comes authority manages record thus always correct Authoritative records contrast cached records may date What happens domain remote flits cs vu nl wants find IP address robot cs washington edu UW University Washington In case cached information domain available locally name server begins remote query This query follows process shown Step 1 shows query sent local name server The query contains domain name sought type A class IN Root name server root servers net 2 1 query 10 robot cs washington edu filts cs vu nl Originator ery qu u ed 3 ery u q du ton e shing 5 wa 6 query Local 7 cs wa shington cs vu nl edu name server 8 rob qu ot ery cs w hin gto n e du Edu name server edu servers net UW name server UWCS name server Example resolver looking remote name 10 steps The next step start top name hierarchy asking one root name servers These name servers information top level SEC 7 1 DNS THE DOMAIN NAME SYSTEM domain This shown step 2 To contact root server name server must information one root name servers This information normally present system configuration file loaded DNS cache DNS server started It simply list NS records root corresponding A records There 13 root DNS servers unimaginatively called root servers net root servers net Each root server could logically single computer However since entire Internet depends root servers powerful heavily replicated computers Most servers present multiple geographical locations reached using anycast routing packet delivered nearest instance destination address described anycast Chap 5 The replication improves reliability performance The root name server unlikely know address machine UW probably know name server UW either But must know name server edu domain cs washington edu located It returns name IP address part answer step 3 The local name server continues quest It sends entire query edu name server edu servers net That name server returns name server UW This shown steps 4 5 Closer local name server sends query UW name server step 6 If domain name sought English department answer would found UW zone includes English department But Computer Science department chosen run name server The query returns name IP address UW Computer Science name server step 7 Finally local name server queries UW Computer Science name server step 8 This server authoritative domain cs washington edu must answer It returns final answer step 9 local name server forwards response flits cs vu nl step 10 The name resolved You explore process using standard tools dig program installed UNIX systems For example typing dig edu servers net robot cs washington edu send query robot cs washington edu edu servers net name server print result This show information obtained step 4 example learn name IP address UW name servers There three technical points discuss long scenario First two different query mechanisms work When host flits cs vu nl sends query local name server name server handles resolution behalf flits desired answer return It return partial answers They might helpful query seeking This mechanism called recursive query 622 THE APPLICATION LAYER On hand root name server subsequent name server recursively continue query local name server It returns partial answer moves next query The local name server responsible continuing resolution issuing queries This mechanism called iterative query One name resolution involve mechanisms example showed A recursive query may always seem preferable many name servers especially root handle They busy Iterative queries put burden originator The rationale local name server supporting recursive query providing service hosts domain Those hosts configured run full name server reach local one The second point caching All answers including partial answers returned cached In way another cs vu nl host queries robot cs washington edu answer already known Even better host queries different host domain say galah cs washington edu query sent directly authoritative name server Similarly queries domains washington edu start directly washington edu name server Using cached answers greatly reduces steps query improves performance The original scenario sketched fact worst case occurs useful information cached However cached answers authoritative since changes made cs washington edu propagated caches world may know For reason cache entries live long This reason Time live field included resource record It tells remote name servers long cache records If certain machine IP address years may safe cache information 1 day For volatile information might safer purge records seconds minute The third issue transport protocol used queries responses It UDP DNS messages sent UDP packets simple format queries answers name servers used continue resolution We go details format If response arrives within short time DNS client repeats query trying another server domain small number retries This process designed handle case server well query response packet getting lost A 16 bit identifier included query copied response name server match answers corresponding query even multiple queries outstanding time Even though purpose simple clear DNS large complex distributed system comprised millions name servers work together It forms key link human readable domain names IP addresses machines It includes replication caching performance reliability designed highly robust SEC 7 1 DNS THE DOMAIN NAME SYSTEM We covered security might imagine ability change name address mapping devastating consequences done maliciously For reason security extensions called DNSSEC developed DNS We describe Chap 8 There also application demand use names flexible ways example naming content resolving IP address nearby host content This fits model searching downloading movie It movie matters computer copy wanted IP address nearby computer copy movie Content distribution networks one way accomplish mapping We describe build DNS later chapter Sec 7 5 7 2 ELECTRONIC MAIL Electronic mail commonly email around three decades Faster cheaper paper mail email popular application since early days Internet Before 1990 mostly used academia During 1990s became known public large grew exponentially point number emails sent per day vastly number snail mail e paper letters Other forms network communication instant messaging voice IP calls expanded greatly use past decade email remains workhorse Internet communication It widely used within industry intracompany communication example allow far flung employees world cooperate complex projects Unfortunately like paper mail majority email 9 10 messages junk mail spam McAfee 2010 Email like forms communication developed conventions styles It informal low threshold use People would never dream calling even writing letter Very Important Person hesitate second send sloppily written email By eliminating cues associated rank age gender email debates often focus content status With email brilliant idea summer student impact dumb one executive vice president Email full jargon BTW By The Way ROTFL Rolling On The Floor Laughing IMHO In My Humble Opinion Many people also use little ASCII symbols called smileys starting ubiquitous Rotate book 90 degrees clockwise symbol unfamiliar This symbol emoticons help convey tone message They spread terse forms communication instant messaging The email protocols evolved period use The first email systems simply consisted file transfer protocols convention first line message e file contained recipient address As time 624 THE APPLICATION LAYER went email diverged file transfer many features added ability send one message list recipients Multimedia capabilities became important 1990s send messages images non text material Programs reading email became much sophisticated shifting text based graphical user interfaces adding ability users access mail laptops wherever happen Finally prevalence spam mail readers mail transfer protocols must pay attention finding removing unwanted email In description email focus way mail messages moved users rather look feel mail reader programs Nevertheless describing overall architecture begin user facing part email system familiar readers 7 2 1 Architecture Services In section provide overview email systems organized The architecture email system shown It consists two kinds subsystems user agents allow people read send email message transfer agents move messages source destination We also refer message transfer agents informally mail servers Mailbox Email Sender User Agent 1 Mail submission Message Transfer Agent SMTP 2 Message transfer Message Transfer Agent Receiver User Agent 3 Final delivery Architecture email system The user agent program provides graphical interface sometimes text command based interface lets users interact email system It includes means compose messages replies messages display incoming messages organize messages filing searching discarding The act sending new messages mail system delivery called mail submission Some user agent processing may done automatically anticipating user wants For example incoming mail may filtered extract SEC 7 2 ELECTRONIC MAIL deprioritize messages likely spam Some user agents include advanced features arranging automatic email responses I wonderful vacation I get back A user agent runs computer user reads mail It another program may run time The message transfer agents typically system processes They run background mail server machines intended always available Their job automatically move email system originator recipient SMTP Simple Mail Transfer Protocol This message transfer step SMTP originally specified RFC 821 revised become current RFC 5321 It sends mail connections reports back delivery status errors Numerous applications exist confirmation delivery important may even legal significance Well Your Honor email system reliable I guess electronic subpoena got lost somewhere Message transfer agents also implement mailing lists identical copy message delivered everyone list email addresses Other advanced features carbon copies blind carbon copies high priority email secret e encrypted email alternative recipients primary one currently available ability assistants read answer bosses email Linking user agents message transfer agents concepts mailboxes standard format email messages Mailboxes store email received user They maintained mail servers User agents simply present users view contents mailboxes To user agents send mail servers commands manipulate mailboxes inspecting contents deleting messages The retrieval mail final delivery step 3 With architecture one user may use different user agents multiple computers access one mailbox Mail sent message transfer agents standard format The original format RFC 822 revised current RFC 5322 extended support multimedia content international text This scheme called MIME discussed later People still refer Internet email RFC 822 though A key idea message format distinction envelope contents The envelope encapsulates message It contains information needed transporting message destination address priority security level distinct message The message transport agents use envelope routing post office The message inside envelope consists two separate parts header body The header contains control information user agents The body entirely human recipient None agents care much Envelopes messages illustrated 626 THE APPLICATION LAYER United Gizmo 180 Main St Boston MA 02120 Sept 1 2010 Header Mr Daniel Dumkopf 18 Willow Lane White Plains NY 10604 Envelope 44 Name Mr Daniel Dumkopf Street 18 Willow Lane City White Plains State NY Zip code 10604 Priority Urgent Encryption None Envelope From United Gizmo Address 180 Main St Location Boston MA 02120 Date Sept 1 2010 Subject Invoice 1081 Dear Mr Dumkopf Our computer records show still paid invoice 0 00 Please send us check 0 00 promptly Body Subject Invoice 1081 Dear Mr Dumkopf Our computer records show still paid invoice 0 00 Please send us check 0 00 promptly Yours truly United Gizmo Yours truly United Gizmo b Message Envelopes messages Paper mail b Electronic mail We examine pieces architecture detail looking steps involved sending email one user another This journey starts user agent 7 2 2 The User Agent A user agent program sometimes called email reader accepts variety commands composing receiving replying messages well manipulating mailboxes There many popular user agents including Google gmail Microsoft Outlook Mozilla Thunderbird Apple Mail They vary greatly appearance Most user agents menu icondriven graphical interface requires mouse touch interface smaller mobile devices Older user agents Elm mh Pine provide text based interfaces expect one character commands keyboard Functionally least text messages The typical elements user agent interface shown Your mail reader likely much flashier probably equivalent functions SEC 7 2 ELECTRONIC MAIL When user agent started usually present summary messages user mailbox Often summary one line message sorted order It highlights key fields message extracted message envelope header Message summary Message folders Mail Folders All items Inbox Networks Travel Junk Mail From Subject trudy Andy djw Amy N Wong guido lazowska lazowska Not Trudys nasty Material RFID privacy Have seen Request information Re Paper acceptance More New report Search A Student Graduate studies Mar 1 Dear Professor I recently completed undergraduate studies distinction excellent university I visiting Mailbox search Received Today Today Mar 4 Mar 3 Mar 3 Mar 2 Mar 2 Message Typical elements user agent interface Seven summary lines shown example The lines use From Subject Received fields order display sent message received All information formatted user friendly way rather displaying literal contents message fields based message fields Thus people fail include Subject field often discover responses emails tend get highest priority Many fields indications possible The icons next message subjects might indicate example unread mail envelope attached material paperclip important mail least judged sender exclamation point Many sorting orders also possible The common order messages based time received recent first indication whether message new already read user The fields summary sort order customized user according preferences User agents must also able display incoming messages needed people read email Often short preview message provided help users decide read Previews may use small icons images describe contents message Other presentation processing 628 THE APPLICATION LAYER includes reformatting messages fit display translating converting contents convenient formats e g digitized speech recognized text After message read user decide This called message disposition Options include deleting message sending reply forwarding message another user keeping message later reference Most user agents manage one mailbox incoming mail multiple folders saved mail The folders allow user save message according sender topic category Filing done automatically user agent well user reads messages A common example fields contents messages inspected used along feedback user previous messages determine message likely spam Many ISPs companies run software labels mail important spam user agent file corresponding mailbox The ISP company advantage seeing mail many users may lists known spammers If hundreds users received similar message probably spam By presorting incoming mail probably legitimate probably spam user agent save users fair amount work separating good stuff junk And popular spam It generated collections compromised computers called botnets content depends live Fake diplomas topical Asia cheap drugs dubious product offers topical U S Unclaimed Nigerian bank accounts still abound Pills enlarging various body parts common everywhere Other filing rules constructed users Each rule specifies condition action For example rule could say message received boss goes one folder immediate reading message particular mailing list goes another folder later reading Several folders shown The important folders Inbox incoming mail filed elsewhere Junk Mail messages thought spam As well explicit constructs like folders user agents provide rich capabilities search mailbox This feature also shown Search capabilities let users find messages quickly message buy Vegemite someone sent last month Email come long way days file transfer Providers routinely support mailboxes 1 GB stored mail details user interactions long period time The sophisticated mail handling user agents search automatic forms processing makes possible manage large volumes email For people send receive thousands messages year tools invaluable Another useful feature ability automatically respond messages way One response forward incoming email different address example computer operated commercial paging service pages user SEC 7 2 ELECTRONIC MAIL using radio satellite displays Subject line pager These autoresponders must run mail server user agent may run time may occasionally retrieve email Because factors user agent provide true automatic response However interface automatic responses usually presented user agent A different example automatic response vacation agent This program examines incoming message sends sender insipid reply Hi I vacation I back 24th August Talk Such replies also specify handle urgent matters interim people contact specific problems etc Most vacation agents keep track sent canned replies refrain sending person second reply There pitfalls agents however For example advisable send canned reply large mailing list Let us turn scenario one user sending message another user One basic features user agents support yet discussed mail composition It involves creating messages answers messages sending messages rest mail system delivery Although text editor used create body message editors usually integrated user agent provide assistance addressing numerous header fields attached message For example answering message email system extract originator address incoming email automatically insert proper place reply Other common features appending signature block bottom message correcting spelling computing digital signatures show message valid Messages sent mail system standard format must created information supplied user agent The important part message transfer envelope important part envelope destination address This address must format message transfer agents deal The expected form address user dns address Since studied DNS earlier chapter repeat material However worth noting forms addressing exist In particular X 400 addresses look radically different DNS addresses X 400 ISO standard message handling systems one time competitor SMTP SMTP handily though X 400 systems still used mostly outside U S X 400 addresses composed attribute value pairs separated slashes example C US ST MASSACHUSETTS L CAMBRIDGE PA 360 MEMORIAL DR CN KEN SMITH This address specifies country state locality personal address common name Ken Smith Many attributes possible send email 630 THE APPLICATION LAYER someone whose exact email address know provided know enough attributes e g company job title Although X 400 names considerably less convenient DNS names issue moot user agents user friendly aliases sometimes called nicknames allow users enter select person name get correct email address Consequently usually necessary actually type strange strings A final point touch sending mail mailing lists let users send message list people single command There two choices mailing list maintained It might maintained locally user agent In case user agent send separate message intended recipient Alternatively list may maintained remotely message transfer agent Messages expanded message transfer system effect allowing multiple users send list For example group bird watchers mailing list called birders installed transfer agent meadowlark arizona edu message sent birders meadowlark arizona edu routed University Arizona expanded individual messages mailing list members wherever world may Users mailing list tell mailing list It could well personal mailbox Prof Gabriel O Birders 7 2 3 Message Formats Now turn user interface format email messages Messages sent user agent must placed standard format handled message transfer agents First look basic ASCII email using RFC 5322 latest revision original Internet message format described RFC 822 After look multimedia extensions basic format RFC 5322 The Internet Message Format Messages consist primitive envelope described part SMTP RFC 5321 number header fields blank line message body Each header field logically consists single line ASCII text containing field name colon fields value The original RFC 822 designed decades ago clearly distinguish envelope fields header fields Although revised RFC 5322 completely redoing possible due widespread usage In normal usage user agent builds message passes message transfer agent uses header fields construct actual envelope somewhat oldfashioned mixing message envelope SEC 7 2 ELECTRONIC MAIL The principal header fields related message transport listed The To field gives DNS address primary recipient Having multiple recipients also allowed The Cc field gives addresses secondary recipients In terms delivery distinction primary secondary recipients It entirely psychological difference may important people involved important mail system The term Cc Carbon copy bit dated since computers use carbon paper well established The Bcc Blind carbon copy field like Cc field except line deleted copies sent primary secondary recipients This feature allows people send copies third parties without primary secondary recipients knowing Header Meaning To Email address es primary recipient Cc Email address es secondary recipient Bcc Email address es blind carbon copies From Person people created message Sender Email address actual sender Received Line added transfer agent along route Return Path Can used identify path back sender RFC 5322 header fields related message transport The next two fields From Sender tell wrote sent message respectively These need For example business executive may write message assistant may one actually transmits In case executive would listed From field assistant Sender field The From field required Sender field may omitted From field These fields needed case message undeliverable must returned sender A line containing Received added message transfer agent along way The line contains agent identity date time message received information used debugging routing system The Return Path field added final message transfer agent intended tell get back sender In theory information gathered Received headers except name sender mailbox rarely filled typically contains sender address In addition fields RFC 5322 messages may also contain variety header fields used user agents human recipients The common ones listed Most self explanatory go much detail 632 THE APPLICATION LAYER Header Meaning Date The date time message sent Reply To Email address replies sent Message Id Unique number referencing message later In Reply To Message Id message reply References Other relevant Message Ids Keywords User chosen keywords Subject Short summary message one line display Some fields used RFC 5322 message header The Reply To field sometimes used neither person composing message person sending message wants see reply For example marketing manager may write email message telling customers new product The message sent assistant Reply To field lists head sales department answer questions take orders This field also useful sender two email accounts wants reply go one The Message Id automatically generated number used link messages together e g used In Reply To field prevent duplicate delivery The RFC 5322 document explicitly says users allowed invent optional headers private use By convention since RFC 822 headers start string X It guaranteed future headers use names starting X avoid conflicts official private headers Sometimes wiseguy undergraduates make fields like X Fruit Day X Disease Week legal although always illuminating After headers comes message body Users put whatever want Some people terminate messages elaborate signatures including quotations greater lesser authorities political statements disclaimers kinds e g The XYZ Corporation responsible opinions fact even comprehend MIME The Multipurpose Internet Mail Extensions In early days ARPANET email consisted exclusively text messages written English expressed ASCII For environment early RFC 822 format job completely specified headers left content entirely users In 1990s worldwide use Internet demand send richer content mail system meant approach longer adequate The problems included sending receiving messages SEC 7 2 ELECTRONIC MAIL languages accents e g French German non Latin alphabets e g Hebrew Russian alphabets e g Chinese Japanese well sending messages containing text e g audio images binary documents programs The solution development MIME Multipurpose Internet Mail Extensions It widely used mail messages sent across Internet well describe content applications Web browsing MIME described RFCs 2045 2047 4288 4289 2049 The basic idea MIME continue use RFC 822 format precursor RFC 5322 time MIME proposed add structure message body define encoding rules transfer non ASCII messages Not deviating RFC 822 allowed MIME messages sent using existing mail transfer agents protocols based RFC 821 RFC 5321 All changed sending receiving programs users could MIME defines five new message headers shown The first simply tells user agent receiving message dealing MIME message version MIME uses Any message containing MIME Version header assumed English plaintext message least one using ASCII characters processed Header Meaning MIME Version Identifies MIME version Content Description Human readable string telling message Content Id Unique identifier Content Transfer Encoding How body wrapped transmission Content Type Type format content Message headers added MIME The Content Description header ASCII string telling message This header needed recipient know whether worth decoding reading message If string says Photo Barbara hamster person getting message big hamster fan message probably discarded rather decoded high resolution color photograph The Content Id header identifies content It uses format standard Message Id header The Content Transfer Encoding tells body wrapped transmission network A key problem time MIME developed mail transfer SMTP protocols expected ASCII messages line exceeded 1000 characters ASCII characters use 7 bits 8 bit byte Binary data executable programs images use 8 bits byte 634 THE APPLICATION LAYER extended character sets There guarantee data would transferred safely Hence method carrying binary data made look like regular ASCII mail message needed Extensions SMTP since development MIME allow 8 bit binary data transferred though even today binary data may always go mail system correctly unencoded MIME provides five transfer encoding schemes plus escape new schemes case The simplest scheme ASCII text messages ASCII characters use 7 bits carried directly email protocol provided line exceeds 1000 characters The next simplest scheme thing using 8 bit characters values 0 including 255 allowed Messages using 8 bit encoding must still adhere standard maximum line length Then messages use true binary encoding These arbitrary binary files use 8 bits also adhere 1000 character line limit Executable programs fall category Nowadays mail servers negotiate send data binary 8 bit encoding falling back ASCII ends support extension The ASCII encoding binary data called base64 encoding In scheme groups 24 bits broken four 6 bit units unit sent legal ASCII character The coding A 0 B 1 followed 26 lowercase letters 10 digits finally 62 63 respectively The sequences indicate last group contained 8 16 bits respectively Carriage returns line feeds ignored inserted encoded character stream keep lines short enough Arbitrary binary text sent safely using scheme albeit inefficiently This encoding popular binary capable mail servers widely deployed It still commonly seen For messages almost entirely ASCII non ASCII characters base64 encoding somewhat inefficient Instead encoding known quoted printable encoding used This 7 bit ASCII characters 127 encoded equals sign followed character value two hexadecimal digits Control characters punctuation marks math symbols well trailing spaces also encoded Finally valid reasons use one schemes possible specify user defined encoding Content Transfer Encoding header The last header shown really interesting one It specifies nature message body impact well beyond email For instance content downloaded Web labeled MIME types browser knows present So content sent streaming media real time transports voice IP Initially seven MIME types defined RFC 1521 Each type one available subtypes The type subtype separated slash SEC 7 2 ELECTRONIC MAIL Content Type video mpeg Since hundreds subtypes added along another type Additional entries added time new types content developed The list assigned types subtypes maintained online IANA www iana org assignments media types The types along examples commonly used subtypes given Let us briefly go starting text The text plain combination ordinary messages displayed received encoding processing This option allows ordinary messages transported MIME extra headers The text html subtype added Web became popular RFC 2854 allow Web pages sent RFC 822 email A subtype eXtensible Markup Language text xml defined RFC 3023 XML documents proliferated development Web We study HTML XML Sec 7 3 Type Example subtypes Description text plain html xml css Text various formats image gif jpeg tiff Pictures audio basic mpeg mp4 Sounds video mpeg mp4 quicktime Movies model vrml 3D model application octet stream pdf javascript zip Data produced applications message http rfc822 Encapsulated message multipart mixed alternative parallel digest Combination multiple types MIME content types example subtypes The next MIME type image used transmit still pictures Many formats widely used storing transmitting images nowadays without compression Several including GIF JPEG TIFF built nearly browsers Many formats corresponding subtypes exist well The audio video types sound moving pictures respectively Please note video may include visual information sound If movie sound transmitted video audio portions may transmitted separately depending encoding system used The first video format defined one devised modestly named Moving Picture Experts Group MPEG others added since In addition audio basic new audio type audio mpeg added RFC 3003 allow people email MP3 audio files The video mp4 audio mp4 types signal video audio data stored newer MPEG 4 format The model type added content types It intended describing 3D model data However widely used date 636 THE APPLICATION LAYER The application type catchall formats covered one types require application interpret data We listed subtypes pdf javascript zip examples PDF documents JavaScript programs Zip archives respectively User agents receive content use third party library external program display content display may may appear integrated user agent By using MIME types user agents gain extensibility handle new types application content developed This significant benefit On hand many new forms content executed interpreted applications presents dangers Obviously running arbitrary executable program arrived via mail system friends poses security hazard The program may sorts nasty damage parts computer access especially read write files use network Less obviously document formats pose hazards This formats PDF full blown programming languages disguise While interpreted restricted scope bugs interpreter often allow devious documents escape restrictions Besides examples many application subtypes many applications As fallback used subtype known fitting octet stream subtype denotes sequence uninterpreted bytes Upon receiving stream likely user agent display suggesting user copied file Subsequent processing user presumably knows kind content The last two types useful composing manipulating messages The message type allows one message fully encapsulated inside another This scheme useful forwarding email example When complete RFC 822 message encapsulated inside outer message rfc822 subtype used Similarly common HTML documents encapsulated And partial subtype makes possible break encapsulated message pieces send separately example encapsulated message long Parameters make possible reassemble parts destination correct order Finally multipart type allows message contain one part beginning end part clearly delimited The mixed subtype allows part different type additional structure imposed Many email programs allow user provide one attachments text message These attachments sent using multipart type In contrast mixed alternative subtype allows message included multiple times expressed two different media For example message could sent plain ASCII HMTL PDF A properly designed user agent getting message would display according user preferences Likely PDF would first choice possible The second choice would HTML If neither possible flat ASCII SEC 7 2 ELECTRONIC MAIL text would displayed The parts ordered simplest complex help recipients pre MIME user agents make sense message e g even pre MIME user read flat ASCII text The alternative subtype also used multiple languages In context Rosetta Stone thought early multipart alternative message Of two example subtypes parallel subtype used parts must viewed simultaneously For example movies often audio channel video channel Movies effective two channels played back parallel instead consecutively The digest subtype used multiple messages packed together composite message For example discussion groups Internet collect messages subscribers send group periodically single multipart digest message As example MIME types may used email messages multimedia message shown Here birthday greeting transmitted alternative forms HTML audio file Assuming receiver audio capability user agent play sound file In example sound carried reference message external body subtype first user agent must fetch sound file birthday snd using FTP If user agent audio capability lyrics displayed screen stony silence The two parts delimited two hyphens followed software generated string specified boundary parameter Note Content Type header occurs three positions within example At top level indicates message multiple parts Within part gives type subtype part Finally within body second part required tell user agent kind external file fetch To indicate slight difference usage used lowercase letters although headers case insensitive The Content Transfer Encoding similarly required external body encoded 7 bit ASCII 7 2 4 Message Transfer Now described user agents mail messages ready look message transfer agents relay messages originator recipient The mail transfer done SMTP protocol The simplest way move messages establish transport connection source machine destination machine transfer message This SMTP originally worked Over years however two different uses SMTP differentiated The first use mail submission step 1 email architecture This means user agents send messages mail system delivery The second use transfer messages message transfer agents step 2 This 638 THE APPLICATION LAYER From alice cs washington edu To bob ee uwa edu au MIME Version 1 0 Message Id 0704760941 AA00747 cs washington edu Content Type multipart alternative boundary qwertyuiopasdfghjklzxcvbnm Subject Earth orbits sun integral number times This preamble The user agent ignores Have nice day qwertyuiopasdfghjklzxcvbnm Content Type text html p Happy birthday br Happy birthday br Happy birthday dear b Bob b br Happy birthday p qwertyuiopasdfghjklzxcvbnm Content Type message external body access type anon ftp site bicycle cs washington edu directory pub name birthday snd content type audio basic content transfer encoding base64 qwertyuiopasdfghjklzxcvbnm A multipart message containing HTML audio alternatives sequence delivers mail way sending receiving message transfer agent one hop Final delivery accomplished different protocols describe next section In section describe basics SMTP protocol extension mechanism Then discuss used differently mail submission message transfer SMTP Simple Mail Transfer Protocol Extensions Within Internet email delivered sending computer establish TCP connection port 25 receiving computer Listening port mail server speaks SMTP Simple Mail Transfer Protocol This server accepts incoming connections subject security checks accepts messages delivery If message delivered error report containing first part undeliverable message returned sender SMTP simple ASCII protocol This weakness feature Using ASCII text makes protocols easy develop test debug They SEC 7 2 ELECTRONIC MAIL tested sending commands manually records messages easy read Most application level Internet protocols work way e g HTTP We walk simple message transfer mail servers delivers message After establishing TCP connection port 25 sending machine operating client waits receiving machine operating server talk first The server starts sending line text giving identity telling whether prepared receive mail If client releases connection tries later If server willing accept email client announces email coming going If recipient exists destination server gives client go ahead send message Then client sends message server acknowledges No checksums needed TCP provides reliable byte stream If email sent When email exchanged directions connection released A sample dialog sending message including numerical codes used SMTP shown The lines sent client e sender marked C Those sent server e receiver marked S The first command client indeed meant HELO Of various four character abbreviations HELLO one numerous advantages biggest competitor Why commands four characters lost mists time In message sent one recipient one RCPT command used Such commands allowed send single message multiple receivers Each one individually acknowledged rejected Even recipients rejected exist destination message sent ones Finally although syntax four character commands client rigidly specified syntax replies less rigid Only numerical code really counts Each implementation put whatever string wants code The basic SMTP works well limited several respects It include authentication This means FROM command example could give sender address pleases This quite useful sending spam Another limitation SMTP transfers ASCII messages binary data This base64 MIME content transfer encoding needed However encoding mail transmission uses bandwidth inefficiently issue large messages A third limitation SMTP sends messages clear It encryption provide measure privacy prying eyes To allow many problems related message processing addressed SMTP revised extension mechanism This mechanism mandatory part RFC 5321 standard The use SMTP extensions called ESMTP Extended SMTP 640 THE APPLICATION LAYER S 220 ee uwa edu au SMTP service ready C HELO abcd com S 250 cs washington edu says hello ee uwa edu au C MAIL FROM alice cs washington edu S 250 sender ok C RCPT TO bob ee uwa edu au S 250 recipient ok C DATA S 354 Send mail end line C From alice cs washington edu C To bob ee uwa edu au C MIME Version 1 0 C Message Id 0704760941 AA00747 ee uwa edu au C Content Type multipart alternative boundary qwertyuiopasdfghjklzxcvbnm C Subject Earth orbits sun integral number times C C This preamble The user agent ignores Have nice day C C qwertyuiopasdfghjklzxcvbnm C Content Type text html C C p Happy birthday C Happy birthday C Happy birthday dear bold Bob bold C Happy birthday C C qwertyuiopasdfghjklzxcvbnm C Content Type message external body C access type anon ftp C site bicycle cs washington edu C directory pub C name birthday snd C C content type audio basic C content transfer encoding base64 C qwertyuiopasdfghjklzxcvbnm C S 250 message accepted C QUIT S 221 ee uwa edu au closing connection Sending message alice cs washington edu bob ee uwa edu au Clients wanting use extension send EHLO message instead HELO initially If rejected server regular SMTP server client proceed usual way If EHLO accepted server replies extensions supports The client may use extensions Several common extensions shown The figure gives keyword SEC 7 2 ELECTRONIC MAIL used extension mechanism along description new functionality We go extensions detail Keyword Description AUTH Client authentication BINARYMIME Server accepts binary messages CHUNKING Server accepts large messages chunks SIZE Check message size trying send STARTTLS Switch secure transport TLS see Chap 8 UTF8SMTP Internationalized addresses Some SMTP extensions To get better feel SMTP protocols described chapter work try In cases first go machine connected Internet On UNIX Linux system shell type telnet mail isp com 25 substituting DNS name ISP mail server mail isp com On Windows XP system click Start Run type command dialog box On Vista Windows 7 machine may first install telnet program equivalent start This command establish telnet e TCP connection port 25 machine Port 25 SMTP port see ports common protocols You probably get response something like Trying 192 30 200 66 Connected mail isp com Escape character 220 mail isp com Smail 74 ready Thu 25 Sept 2002 13 26 0200 The first three lines telnet telling The last line SMTP server remote machine announcing willingness talk accept email To find commands accepts type HELP From point command sequence one possible server willing accept mail Mail Submission Originally user agents ran computer sending message transfer agent In setting required send message user agent talk local mail server using dialog described However setting longer usual case 642 THE APPLICATION LAYER User agents often run laptops home PCs mobile phones They always connected Internet Mail transfer agents run ISP company servers They always connected Internet This difference means user agent Boston may need contact regular mail server Seattle send mail message user traveling By remote communication poses problem It exactly TCP IP protocols designed support However ISP company usually want remote user able submit messages mail server delivered elsewhere The ISP company running server public service In addition kind open mail relay attracts spammers This provides way launder original sender thus make message difficult identify spam Given considerations SMTP normally used mail submission AUTH extension This extension lets server check credentials username password client confirm server providing mail service There several differences way SMTP used mail submission For example port 587 used preference port 25 SMTP server check correct format messages sent user agent For information restricted use SMTP mail submission please see RFC 4409 Message Transfer Once sending mail transfer agent receives message user agent deliver receiving mail transfer agent using SMTP To sender uses destination address Consider message addressed bob ee uwa edu au To mail server message delivered To determine correct mail server contact DNS consulted In previous section described DNS contains multiple types records including MX mail exchanger record In case DNS query made MX records domain ee uwa edu au This query returns ordered list names IP addresses one mail servers The sending mail transfer agent makes TCP connection port 25 IP address mail server reach receiving mail transfer agent uses SMTP relay message The receiving mail transfer agent place mail user bob correct mailbox Bob read later time This local delivery step may involve moving message among computers large mail infrastructure With delivery process mail travels initial final mail transfer agent single hop There intermediate servers message transfer stage It possible however delivery process occur multiple times One example described already message transfer agent SEC 7 2 ELECTRONIC MAIL implements mailing list In case message received list It expanded message member list sent individual member addresses As another example relaying Bob may graduated M I T also reachable via address bob alum mit edu Rather reading mail multiple accounts Bob arrange mail sent address forwarded bob ee uwa edu In case mail sent bob alum mit edu undergo two deliveries First sent mail server alum mit edu Then sent mail server ee uwa edu au Each legs complete separate delivery far mail transfer agents concerned Another consideration nowadays spam Nine ten messages sent today spam McAfee 2010 Few people want spam hard avoid masquerades regular mail Before accepting message additional checks may made reduce opportunities spam The message Bob sent alice cs washington edu The receiving mail transfer agent look sending mail transfer agent DNS This lets check IP address end TCP connection matches DNS name More generally receiving agent may look sending domain DNS see mail sending policy This information often given TXT SPF records It may indicate checks made For example mail sent cs washington edu may always sent host june cs washington edu If sending mail transfer agent june problem If checks fail mail probably forged fake sending address In case discarded However passing checks imply mail spam The checks merely ensure mail seems coming region network purports come The idea spammers forced use correct sending address send mail This makes spam easier recognize delete unwanted 7 2 5 Final Delivery Our mail message almost delivered It arrived Bob mailbox All remains transfer copy message Bob user agent display This step 3 architecture This task straightforward early Internet user agent mail transfer agent ran machine different processes The mail transfer agent simply wrote new messages end mailbox file user agent simply checked mailbox file new mail Nowadays user agent PC laptop mobile likely different machine ISP company mail server Users want able access mail remotely wherever They want access email work home PCs laptops business trips cybercafes called vacation They also want able work offline 644 THE APPLICATION LAYER reconnect receive incoming mail send outgoing mail Moreover user may run several user agents depending computer convenient use moment Several user agents may even running time In setting job user agent present view contents mailbox allow mailbox remotely manipulated Several different protocols used purpose SMTP one SMTP push based protocol It takes message connects remote server transfer message Final delivery achieved manner mailbox must continue stored mail transfer agent user agent may connected Internet moment SMTP attempts relay messages IMAP The Internet Message Access Protocol One main protocols used final delivery IMAP Internet Message Access Protocol Version 4 protocol defined RFC 3501 To use IMAP mail server runs IMAP server listens port 143 The user agent runs IMAP client The client connects server begins issue commands listed First client start secure transport one used order keep messages commands confidential log otherwise authenticate server Once logged many commands list folders messages fetch messages even parts messages mark messages flags later deletion organize messages folders To avoid confusion please note use term folder consistent rest material section user single mailbox made multiple folders However IMAP specification term mailbox used instead One user thus many IMAP mailboxes typically presented user folder IMAP many features It ability address mail message number using attributes e g give first message Alice Searches performed server find messages satisfy certain criteria messages fetched client IMAP improvement earlier final delivery protocol POP3 Post Office Protocol version 3 specified RFC 1939 POP3 simpler protocol supports fewer features less secure typical usage Mail usually downloaded user agent computer instead remaining mail server This makes life easier server harder user It easy read mail multiple computers plus user agent computer breaks email may lost permanently Nonetheless still find POP3 use Proprietary protocols also used protocol runs mail server user agent supplied company Microsoft Exchange mail system proprietary protocol SEC 7 2 ELECTRONIC MAIL Command Description CAPABILITY List server capabilities STARTTLS Start secure transport TLS see Chap 8 LOGIN Log server AUTHENTICATE Log method SELECT Select folder EXAMINE Select read folder CREATE Create folder DELETE Delete folder RENAME Rename folder SUBSCRIBE Add folder active set UNSUBSCRIBE Remove folder active set LIST List available folders LSUB List active folders STATUS Get status folder APPEND Add message folder CHECK Get checkpoint folder FETCH Get messages folder SEARCH Find messages folder STORE Alter message flags COPY Make copy message folder EXPUNGE Remove messages flagged deletion UID Issue commands using unique identifiers NOOP Do nothing CLOSE Remove flagged messages close folder LOGOUT Log close connection IMAP version 4 commands Webmail An increasingly popular alternative IMAP SMTP providing email service use Web interface sending receiving mail Widely used Webmail systems include Google Gmail Microsoft Hotmail Yahoo Mail Webmail one example software case mail user agent provided service using Web In architecture provider runs mail servers usual accept messages users SMTP port 25 However user agent different Instead 646 THE APPLICATION LAYER standalone program user interface provided via Web pages This means users use browser like access mail send new messages We yet studied Web brief description might come back follows When user goes email Web page provider form presented user asked login name password The login name password sent server validates If login successful server finds user mailbox builds Web page listing contents mailbox fly The Web page sent browser display Many items page showing mailbox clickable messages read deleted To make interface responsive Web pages often include JavaScript programs These programs run locally client response local events e g mouse clicks also download upload messages background prepare next message display new message submission In model mail submission happens using normal Web protocols posting data URL The Web server takes care injecting messages traditional mail delivery system described For security standard Web protocols used well These protocols concern encrypting Web pages whether content Web page mail message 7 3 THE WORLD WIDE WEB The Web World Wide Web popularly known architectural framework accessing linked content spread millions machines Internet In 10 years went way coordinate design high energy physics experiments Switzerland application millions people think The Internet Its enormous popularity stems fact easy beginners use provides access rich graphical interface enormous wealth information almost every conceivable subject aardvarks Zulus The Web began 1989 CERN European Center Nuclear Research The initial idea help large teams often members half dozen countries time zones collaborate using constantly changing collection reports blueprints drawings photos documents produced experiments particle physics The proposal web linked documents came CERN physicist Tim Berners Lee The first text based prototype operational 18 months later A public demonstration given Hypertext 91 conference caught attention researchers led Marc Andreessen University Illinois develop first graphical browser It called Mosaic released February 1993 SEC 7 3 THE WORLD WIDE WEB The rest say history Mosaic popular year later Andreessen left form company Netscape Communications Corp whose goal develop Web software For next three years Netscape Navigator Microsoft Internet Explorer engaged browser war one trying capture larger share new market frantically adding features thus bugs one Through 1990s 2000s Web sites Web pages Web content called grew exponentially millions sites billions pages A small number sites became tremendously popular Those sites companies behind largely define Web people experience today Examples include bookstore Amazon started 1994 market capitalization 50 billion flea market eBay 1995 30B search Google 1998 150B social networking Facebook 2004 private company valued 15B The period 2000 many Web companies became worth hundreds millions dollars overnight go bust practically next day turned hype even name It called dot com era New ideas still striking rich Web Many come students For example Mark Zuckerberg Harvard student started Facebook Sergey Brin Larry Page students Stanford started Google Perhaps come next big thing In 1994 CERN M I T signed agreement setting W3C World Wide Web Consortium organization devoted developing Web standardizing protocols encouraging interoperability sites BernersLee became director Since several hundred universities companies joined consortium Although books Web shake stick best place get date information Web naturally Web The consortium home page www w3 org Interested readers referred links pages covering consortium numerous documents activities 7 3 1 Architectural Overview From users point view Web consists vast worldwide collection content form Web pages often called pages short Each page may contain links pages anywhere world Users follow link clicking takes page pointed This process repeated indefinitely The idea one page point another called hypertext invented visionary M I T professor electrical engineering Vannevar Bush 1945 Bush 1945 This long Internet invented In fact commercial computers existed although several universities produced crude prototypes filled large rooms less power modern pocket calculator 648 THE APPLICATION LAYER Pages generally viewed program called browser Firefox Internet Explorer Chrome examples popular browsers The browser fetches page requested interprets content displays page properly formatted screen The content may mix text images formatting commands manner traditional document forms content video programs produce graphical interface users interact A picture page shown top left side It page Computer Science Engineering department University Washington This page shows text graphical elements mostly small read Some parts page associated links pages A piece text icon image associated another page called hyperlink To follow link user places mouse cursor linked portion page area causes cursor change shape clicks Following link simply way telling browser fetch another page In early days Web links highlighted underlining colored text would stand Nowadays creators Web pages ways control look linked regions link might appear icon change appearance mouse passes It creators page make links visually distinct provide usable interface Document Program Database youtube com HTTP Request Hyperlink HTTP Response Web page Web browser Web server www cs washington edu google analytics com Architecture Web SEC 7 3 THE WORLD WIDE WEB Students department learn following link page information especially This link accessed clicking circled area The browser fetches new page displays partially shown bottom left Dozens pages linked first page besides example Every page comprised content machine first page machines halfway around globe The user tell Page fetching done browser without help user Thus moving machines viewing content seamless The basic model behind display pages also shown The browser displaying Web page client machine Each page fetched sending request one servers respond contents page The request response protocol fetching pages simple text based protocol runs TCP case SMTP It called HTTP HyperText Transfer Protocol The content may simply document read disk result database query program execution The page static page document every time displayed In contrast generated demand program contains program dynamic page A dynamic page may present differently time displayed For example front page electronic store may different visitor If bookstore customer bought mystery novels past upon visiting store main page customer likely see new thrillers prominently displayed whereas culinary minded customer might greeted new cookbooks How Web site keeps track likes story told shortly But briefly answer involves cookies even culinarily challenged visitors In figure browser contacts three servers fetch two pages cs washington edu youtube com google analytics com The content different servers integrated display browser Display entails range processing depends kind content Besides rendering text graphics may involve playing video running script presents user interface part page In case cs washington edu server supplies main page youtube com server supplies embedded video google analytics com server supplies nothing user see tracks visitors site We say trackers later The Client Side Let us examine Web browser side detail In essence browser program display Web page catch mouse clicks items displayed page When item selected browser follows hyperlink fetches page selected 650 THE APPLICATION LAYER When Web first created immediately apparent one page point another Web page required mechanisms naming locating pages In particular three questions answered selected page could displayed 1 What page called 2 Where page located 3 How page accessed If every page somehow assigned unique name would ambiguity identifying pages Nevertheless problem would solved Consider parallel people pages In United States almost everyone social security number unique identifier two people supposed one Nevertheless armed social security number way find owner address certainly way tell whether write person English Spanish Chinese The Web basically problems The solution chosen identifies pages way solves three problems Each page assigned URL Uniform Resource Locator effectively serves page worldwide name URLs three parts protocol also known scheme DNS name machine page located path uniquely indicating specific page file read program run machine In general case path hierarchical name models file directory structure However interpretation path server may may reflect actual directory structure As example URL page shown http www cs washington edu index html This URL consists three parts protocol http DNS name host www cs washington edu path name index html When user clicks hyperlink browser carries series steps order fetch page pointed Let us trace steps occur example link selected 1 The browser determines URL seeing selected 2 The browser asks DNS IP address server www cs washington edu 3 DNS replies 128 208 3 88 4 The browser makes TCP connection 128 208 3 88 port 80 well known port HTTP protocol 5 It sends HTTP request asking page index html SEC 7 3 THE WORLD WIDE WEB 6 The www cs washington edu server sends page HTTP response example sending file index html 7 If page includes URLs needed display browser fetches URLs using process In case URLs include multiple embedded images also fetched www cs washington edu embedded video youtube com script google analytics com 8 The browser displays page index html appears 9 The TCP connections released requests servers short period Many browsers display step currently executing status line bottom screen In way performance poor user see due DNS responding server responding simply page transmission slow congested network The URL design open ended sense straightforward browsers use multiple protocols get different kinds resources In fact URLs various protocols defined Slightly simplified forms common ones listed Name Used Example http Hypertext HTML http www ee uwa edu rob https Hypertext security https www bank com accounts ftp FTP ftp ftp cs vu nl pub minix README file Local file file usr suzanne prog c mailto Sending email mailto JohnUser acm org rtsp Streaming media rtsp youtube com montypython mpg sip Multimedia calls sip eve adversary com Browser information plugins Some common URL schemes Let us briefly go list The http protocol Web native language one spoken Web servers HTTP stands HyperText Transfer Protocol We examine detail later section The ftp protocol used access files FTP Internet file transfer protocol FTP predates Web use three decades The Web makes easy obtain files placed numerous FTP servers throughout world providing simple clickable interface instead command line interface This improved access information one reason spectacular growth Web 652 THE APPLICATION LAYER It possible access local file Web page using file protocol simply naming This approach require server Of course works local files remote ones The mailto protocol really flavor fetching Web pages useful anyway It allows users send email Web browser Most browsers respond mailto link followed starting user mail agent compose message address field already filled The rtsp sip protocols establishing streaming media sessions audio video calls Finally protocol convention provides information browser For example following plugins link cause browsers show page lists MIME types handle browser extensions called plug ins In short URLs designed allow users navigate Web run older protocols FTP email well newer protocols audio video provide convenient access local files browser information This approach makes specialized user interface programs services unnecessary integrates nearly Internet access single program Web browser If fact idea thought British physicist working research lab Switzerland could easily pass plan dreamed software company advertising department Despite nice properties growing use Web turned inherent weakness URL scheme A URL points one specific host sometimes useful reference page without simultaneously telling For example pages heavily referenced desirable multiple copies far apart reduce network traffic There way say I want page xyz I care get To solve kind problem URLs generalized URIs Uniform Resource Identifiers Some URIs tell locate resource These URLs Other URIs tell name resource find These URIs called URNs Uniform Resource Names The rules writing URIs given RFC 3986 different URI schemes use tracked IANA There many different kinds URIs besides schemes listed schemes dominate Web used today MIME Types To able display new page page browser understand format To allow browsers understand Web pages Web pages written standardized language called HTML It lingua franca Web We discuss detail later chapter SEC 7 3 THE WORLD WIDE WEB Although browser basically HTML interpreter browsers numerous buttons features make easier navigate Web Most button going back previous page button going forward next page operative user gone back button going straight user preferred start page Most browsers button menu item set bookmark given page another one display list bookmarks making possible revisit mouse clicks As example shows HTML pages contain rich content elements simply text hypertext For added generality pages need contain HTML A page may consist video MPEG format document PDF format photograph JPEG format song MP3 format one hundreds file types Since standard HTML pages may link browser problem hits page know interpret Rather making browsers larger larger building interpreters rapidly growing collection file types browsers chosen general solution When server returns page also returns additional information page This information includes MIME type page see Pages type text html displayed directly pages built types If MIME type one built ones browser consults table MIME types determine display page This table associates MIME types viewers There two possibilities plug ins helper applications A plug third party code module installed extension browser illustrated Common examples plug ins PDF Flash Quicktime render documents play audio video Because plug ins run inside browser access current page modify appearance Browser Plug Process Helper application Browser Process Process b A browser plug b A helper application Each browser set procedures plug ins must implement browser call plug ins For example typically procedure 654 THE APPLICATION LAYER browser base code calls supply plug data display This set procedures plug interface browser specific In addition browser makes set procedures available plug provide services plug ins Typical procedures browser interface allocating freeing memory displaying message browser status line querying browser parameters Before plug used must installed The usual installation procedure user go plug Web site download installation file Executing installation file unpacks plug makes appropriate calls register plug MIME type browser associate plug Browsers usually come preloaded popular plug ins The way extend browser make use helper application This complete program running separate process It illustrated Fig 720 b Since helper separate program interface arm length browser It usually accepts name scratch file content file stored opens file displays contents Typically helpers large programs exist independently browser example Microsoft Word PowerPoint Many helper applications use MIME type application As consequence considerable number subtypes defined use example application vnd ms powerpoint PowerPoint files vnd denotes vendor specific formats In way URL point directly PowerPoint file user clicks PowerPoint automatically started handed content displayed Helper applications restricted using application MIME type Adobe Photoshop uses image x photoshop example Consequently browsers configured handle virtually unlimited number document types changes Modern Web servers often configured hundreds type subtype combinations new ones often added every time new program installed A source conflicts multiple plug ins helper applications available subtypes video mpeg What happens last one register overwrites existing association MIME type capturing type As consequence installing new program may change way browser handles existing types Browsers also open local files network sight rather fetching remote Web servers However browser needs way determine MIME type file The standard method operating system associate file extension MIME type In typical configuration opening foo pdf open browser using application pdf plug opening bar doc open Word application msword helper Here conflicts arise since many programs willing make eager handle say mpg During installation programs intended sophisticated users often display checkboxes MIME types extensions SEC 7 3 THE WORLD WIDE WEB prepared handle allow user select appropriate ones thus overwrite existing associations accident Programs aimed consumer market assume user clue MIME type simply grab everything without regard previously installed programs done The ability extend browser large number new types convenient also lead trouble When browser Windows PC fetches file extension exe realizes file executable program therefore helper The obvious action run program However could enormous security hole All malicious Web site produce Web page pictures say movie stars sports heroes linked virus A single click picture causes unknown potentially hostile executable program fetched run user machine To prevent unwanted guests like Firefox browsers come configured cautious running unknown programs automatically users understand choices safe rather convenient The Server Side So much client side Now let us take look server side As saw user types URL clicks line hypertext browser parses URL interprets part http next slash DNS name look Armed IP address server browser establishes TCP connection port 80 server Then sends command containing rest URL path page server The server returns page browser display To first approximation simple Web server similar server That server given name file look return via network In cases steps server performs main loop 1 Accept TCP connection client browser 2 Get path page name file requested 3 Get file disk 4 Send contents file client 5 Release TCP connection Modern Web servers features essence Web server simple case content contained file For dynamic content third step may replaced execution program determined path returns contents However Web servers implemented different design serve many requests per second One problem simple design accessing files 656 THE APPLICATION LAYER often bottleneck Disk reads slow compared program execution files may read repeatedly disk using operating system calls Another problem one request processed time The file may large requests blocked transferred One obvious improvement used Web servers maintain cache memory n recently read files certain number gigabytes content Before going disk get file server checks cache If file served directly memory thus eliminating disk access Although effective caching requires large amount main memory extra processing time check cache manage contents savings time nearly always worth overhead expense To tackle problem serving single request time one strategy make server multithreaded In one design server consists front end module accepts incoming requests k processing modules shown The k 1 threads belong process processing modules access cache within process address space When request comes front end accepts builds short record describing It hands record one processing modules Processing module thread Disk Request Cache Front end Client Response Server A multithreaded Web server front end processing modules The processing module first checks cache see file needed If updates record include pointer file record If processing module starts disk operation read cache possibly discarding cached file make room When file comes disk put cache also sent back client The advantage scheme one processing modules blocked waiting disk network operation complete thus consuming CPU time modules actively working requests With k processing modules throughput much k times higher single threaded server Of course disk network limiting SEC 7 3 THE WORLD WIDE WEB factor necessary multiple disks faster network get real improvement single threaded model Modern Web servers accept path names return files In fact actual processing request get quite complicated For reason many servers processing module performs series steps The front end passes incoming request first available module carries using subset following steps depending ones needed particular request These steps occur TCP connection secure transport mechanism SSL TLS described Chap 8 established 1 Resolve name Web page requested 2 Perform access control Web page 3 Check cache 4 Fetch requested page disk run program build 5 Determine rest response e g MIME type send 6 Return response client 7 Make entry server log Step 1 needed incoming request may contain actual name file program literal string It may contain built shortcuts need translated As simple example URL http www cs vu nl empty file name It expanded default file name usually index html Another common rule map user onto user Web directory These rules used together Thus home page one authors AST reached http www cs vu nl ast even though actual file name index html certain default directory Also modern browsers specify configuration information browser software user default language e g Italian English This makes possible server select Web page small pictures mobile device preferred language available In general name expansion quite trivial might first appear due variety conventions map paths file directory programs Step 2 checks see access restrictions associated page met Not pages available general public Determining whether client fetch page may depend identity client e g given usernames passwords location client DNS IP space For example page may restricted users inside company How 658 THE APPLICATION LAYER accomplished depends design server For popular Apache server instance convention place file called htaccess lists access restrictions directory restricted page located Steps 3 4 involve getting page Whether taken cache depends processing rules For example pages created running programs always cached might produce different result time run Even files occasionally checked see contents changed old contents removed cache If page requires program run also issue setting program parameters input These data come path parts request Step 5 determining parts response accompany contents page The MIME type one example It may come file extension first words file program output configuration file possibly sources Step 6 returning page across network To increase performance single TCP connection may used client server multiple page fetches This reuse means logic needed map request shared connection return response associated correct request Step 7 makes entry system log administrative purposes along keeping important statistics Such logs later mined valuable information user behavior example order people access pages Cookies Navigating Web described far involves series independent page fetches There concept login session The browser sends request server gets back file Then server forgets ever seen particular client This model perfectly adequate retrieving publicly available documents worked well Web first created However suited returning different pages different users depending already done server This behavior needed many ongoing interactions Web sites For example Web sites e g newspapers require clients register possibly pay money use This raises question servers distinguish requests users previously registered everyone else A second example e commerce If user wanders around electronic store tossing items virtual shopping cart time time server keep track contents cart A third example customized Web portals Yahoo Users set personalized SEC 7 3 THE WORLD WIDE WEB detailed initial page information want e g stocks favorite sports teams server display correct page know user At first glance one might think servers could track users observing IP addresses However idea work Many users share computers especially home IP address merely identifies computer user Even worse many companies use NAT outgoing packets bear IP address users That computers behind NAT box look server And many ISPs assign IP addresses customers DHCP The IP addresses change time server might suddenly look like neighbor For reasons server use IP addresses track users This problem solved oft critized mechanism called cookies The name derives ancient programmer slang program calls procedure gets something back may need present later get work done In sense UNIX file descriptor Windows object handle considered cookie Cookies first implemented Netscape browser 1994 specified RFC 2109 When client requests Web page server supply additional information form cookie along requested page The cookie rather small named string 4 KB server associate browser This association thing user much closer useful IP address Browsers store offered cookies interval usually cookie directory client disk cookies persist across browser invocations unless user disabled cookies Cookies strings executable programs In principle cookie could contain virus since cookies treated data official way virus actually run damage However always possible hacker exploit browser bug cause activation A cookie may contain five fields shown The Domain tells cookie came Browsers supposed check servers lying domain Each domain store 20 cookies per client The Path path server directory structure identifies parts server file tree may use cookie It often means whole tree The Content field takes form name value Both name value anything server wants This field cookie content stored The Expires field specifies cookie expires If field absent browser discards cookie exits Such cookie called nonpersistent cookie If time date supplied cookie said persistent cookie kept expires Expiration times given Greenwich Mean Time To remove cookie client hard disk server sends expiration time past 660 Domain THE APPLICATION LAYER Path Content Expires Secure toms casino com CustomerID 297793521 15 10 10 17 00 Yes jills store com Cart 1 00501 1 07031 2 13721 11 1 11 14 22 No aportal com Prefs Stk CSCO ORCL Spt Jets 31 12 20 23 59 No sneaky com UserID 4627239101 31 12 19 23 59 No Some examples cookies Finally Secure field set indicate browser may return cookie server using secure transport namely SSL TLS describe Chap 8 This feature used e commerce banking secure applications We seen cookies acquired used Just browser sends request page Web site checks cookie directory see cookies placed domain request going If cookies placed domain domain included request message When server gets interpret way wants Let us examine possible uses cookies In first cookie set toms casino com used identify customer When client returns next week throw away money browser sends cookie server knows Armed customer ID server look customer record database use information build appropriate Web page display Depending customer known gambling habits page might consist poker hand listing today horse races slot machine The second cookie came jills store com The scenario client wandering around store looking good things buy When finds bargain clicks server adds shopping cart maintained server also builds cookie containing product code item sends cookie back client As client continues wander around store clicking new pages cookie returned server every new page request As purchases accumulate server adds cookie Finally client clicks PROCEED TO CHECKOUT cookie containing full list purchases sent along request In way server knows exactly customer wants buy The third cookie Web portal When customer clicks link portal browser sends cookie This tells portal build page containing stock prices Cisco Oracle New York Jets football results Since cookie 4 KB plenty room detailed preferences concerning newspaper headlines local weather special offers etc SEC 7 3 THE WORLD WIDE WEB A controversial use cookies track online behavior users This lets Web site operators understand users navigate sites advertisers build profiles ads sites particular user viewed The controversy users typically unaware activity tracked even detailed profiles across seemingly unrelated Web sites Nonetheless Web tracking big business DoubleClick provides tracks ads ranked among 100 busiest Web sites world Web monitoring company Alexa Google Analytics tracks site usage operators used half busiest 100 000 sites Web It easy server track user activity cookies Suppose server wants keep track many unique visitors many pages visitor looked leaving site When first request comes accompanying cookie server sends back cookie containing Counter 1 Subsequent page views site send cookie back server Each time counter incremented sent back client By keeping track counters server see many people give seeing first page many look two pages Tracking browsing behavior users across sites slightly complicated It works like An advertising agency say Sneaky Ads contacts major Web sites places ads clients products pages pays site owners fee Instead giving sites ad GIF file place page gives URL add page Each URL hands contains unique number path http www sneaky com 382674902342 gif When user first visits page P containing ad browser fetches HTML file Then browser inspects HTML file sees link image file www sneaky com sends request image A GIF file containing ad returned along cookie containing unique user ID 4627239101 Sneaky records fact user ID visited page P This easy since path requested 382674902342 gif referenced page P Of course actual ad may appear thousands pages time different name Sneaky probably collects fraction penny product manufacturer time ships ad Later user visits another Web page containing Sneaky ads browser first fetches HTML file server Then sees link say http www sneaky com 193654919923 gif page requests file Since already cookie domain sneaky com browser includes Sneaky cookie containing user ID Sneaky knows second page user visited In due course Sneaky build detailed profile user browsing habits even though user never clicked ads Of course yet user name although IP address 662 THE APPLICATION LAYER may enough deduce name databases However user ever supplies name site cooperating Sneaky complete profile along name available sale anyone wants buy The sale information may profitable enough Sneaky place ads Web sites thus collect information And Sneaky wants supersneaky ad need classical banner ad An ad consisting single pixel background color thus invisible exactly effect banner ad requires browser go fetch 1 1 pixel GIF image send cookies originating pixel domain Cookies become focal point debate online privacy tracking behavior like The insidious part whole business many users completely unaware information collection may even think safe click ads For reason cookies track users across sites considered many spyware Have look cookies already stored browser Most browsers display information along current privacy preferences You might surprised find names email addresses passwords well opaque identifiers Hopefully find credit card numbers potential abuse clear To maintain semblance privacy users configure browsers reject cookies However cause problems many Web sites work properly without cookies Alternatively browsers let users block third party cookies A third party cookie one different site main page fetched example sneaky com cookie used interacting page P completely different Web site Blocking cookies helps prevent tracking across Web sites Browser extensions also installed provide fine grained control cookies used rather used As debate continues many companies developing privacy policies limit share information prevent abuse Of course policies simply companies say handle information For example We may use information collected conduct business might selling information 7 3 2 Static Web Pages The basis Web transferring Web pages server client In simplest form Web pages static That files sitting server present way time fetched viewed Just static mean pages inert browser however A page containing video static Web page As mentioned earlier lingua franca Web pages written HTML The home pages teachers usually static HTML pages SEC 7 3 THE WORLD WIDE WEB The home pages companies usually dynamic pages put together Web design company In section take brief look static HTML pages foundation later material Readers already familiar HTML skip ahead next section describe dynamic content Web services HTML The HyperText Markup Language HTML HyperText Markup Language introduced Web It allows users produce Web pages include text graphics video pointers Web pages HTML markup language language describing documents formatted The term markup comes old days copyeditors actually marked documents tell printer days human fonts use Markup languages thus contain explicit commands formatting For example HTML b means start boldface mode b means leave boldface mode LaTeX TeX examples markup languages well known academic authors The key advantage markup language one explicit markup separates content presented Writing browser straightforward browser simply understand markup commands apply content Embedding markup commands within HTML file standardizing makes possible Web browser read reformat Web page That crucial page may produced 1600 1200 window 24 bit color high end computer may displayed 640 320 window mobile phone While certainly possible write documents like plain text editor many people also possible use word processors special HTML editors work correspondingly give user less direct control details final result A simple Web page written HTML presentation browser given A Web page consists head body enclosed html html tags formatting commands although browsers complain tags missing As seen head bracketed head head tags body bracketed body body tags The strings inside tags called directives Most HTML tags format That use something mark beginning something something mark end Tags either lowercase uppercase Thus head HEAD mean thing lower case best compatibility Actual layout HTML document irrelevant HTML parsers ignore extra spaces carriage returns since reformat text make fit current display area Consequently white space added make HTML documents 664 THE APPLICATION LAYER readable something badly need As another consequence blank lines used separate paragraphs simply ignored An explicit tag required Some tags named parameters called attributes For example img tag used including image inline text It two attributes src alt The first attribute gives URL image The HTML standard specify image formats permitted In practice browsers support GIF JPEG files Browsers free support formats extension two edged sword If user accustomed browser supports say TIFF files may include Web pages later surprised browsers ignore wonderful art The second attribute gives alternate text use image displayed For tag HTML standard gives list permitted parameters mean Because parameter named order parameters given significant Technically HTML documents written ISO 8859 1 Latin 1 character set users whose keyboards support ASCII escape sequences present special characters e The list special characters given standard All begin ampersand end semicolon For example nbsp produces space egrave produces e eacute produces e Since special meanings expressed escape sequences lt gt amp respectively The main item head title delimited title title Certain kinds metainformation may also present though none present example The title displayed page Some browsers use label page window Several headings used Each heading generated hn tag n digit range 1 6 Thus h1 important heading h6 least important one It browser render appropriately screen Typically lower numbered headings displayed larger heavier font The browser may also choose use different colors level heading Usually h1 headings large boldface least one blank line In contrast h2 headings smaller font less space The tags b used enter boldface italics mode respectively The hr tag forces break draws horizontal line across display The p tag starts paragraph The browser might display inserting blank line indentation example Interestingly p tag exists mark end paragraph often omitted lazy HTML programmers HTML provides various mechanisms making lists including nested lists Unordered lists like ones started ul li used mark start items There also ol tag starts ordered list The SEC 7 3 THE WORLD WIDE WEB html head title AMALGAMATED WIDGET INC title head body h1 Welcome AWI Home Page h1 img src http www widget com images logo gif ALT AWI Logo br We happy chosen visit b Amalgamated Widget b home page We hope find information need p Below links information many fine products You order electronically WWW telephone email p hr h2 Product information h2 ul li href http widget com products big Big widgets li li href http widget com products little Little widgets li ul h2 Contact information h2 ul li By telephone 1 800 WIDGETS li li By email info amalgamated widget com li ul body html Welcome AWI Home Page We happy chosen visit Amalgamated Widget home page We hope find information need Below links information many fine products You order electronically WWW telephone email Product Information Big widgets Little widgets Contact information By telephone 1 800 WIDGETS By email info amalgamated widget com b The HTML sample Web page b The formatted page 666 THE APPLICATION LAYER individual items unordered lists often appear bullets front Items ordered lists numbered browser Finally come hyperlinks Examples seen using anchor tags The tag various parameters important href linked URL The text displayed If selected hyperlink followed new page It also permitted link elements For example image given tags using img In case image displayed clicking activates hyperlink There many HTML tags attributes seen simple example For instance tag take parameter name plant hyperlink allowing hyperlink point middle page This useful example Web pages start clickable table contents By clicking item table contents user jumps corresponding section page An example different tag br It forces browser break start new line Probably best way understand tags look action To pick Web page look HTML browser see page put together Most browsers VIEW SOURCE menu item something similar Selecting item displays current page HTML source instead formatted output We sketched tags existed early Web HTML keeps evolving shows features added successive versions HTML HTML 1 0 refers version HTML used introduction Web HTML versions 2 0 3 0 4 0 appeared rapid succession space years Web exploded After HTML 4 0 period almost ten years passed path standarization next major version HTML 5 0 became clear Because major upgrade consolidates ways browsers handle rich content HTML 5 0 effort ongoing expected produce standard 2012 earliest Standards notwithstanding major browsers already support HTML 5 0 functionality The progression HTML versions adding new features people wanted handle nonstandard ways e g plug ins became standard For example HTML 1 0 HTML 2 0 tables They added HTML 3 0 An HTML table consists one rows consisting one table cells contain wide range material e g text images tables Before HTML 3 0 authors needing table resort ad hoc methods including image showing table In HTML 4 0 new features added These included accessibility features handicapped users object embedding generalization img tag objects also embedded pages support scripting languages allow dynamic content SEC 7 3 THE WORLD WIDE WEB Item HTML 1 0 HTML 2 0 HTML 3 0 HTML 4 0 HTML 5 0 Hyperlinks x x x x x Images x x x x x Lists x x x x x Active maps images x x x x Forms x x x x Equations x x x Toolbars x x x Tables x x x Accessibility features x x Object embedding x x Style sheets x x Scripting x x Video audio x Inline vector graphics x XML representation x Background threads x Browser storage x Drawing canvas x Some differences HTML versions HTML 5 0 includes many features handle rich media routinely used Web Video audio included pages played browser without requiring user install plug ins Drawings built browser vector graphics rather using bitmap image formats like JPEG GIF There also support running scripts browsers background threads computation access storage All features help support Web pages like traditional applications user interface documents This direction Web heading Input Forms There one important capability discussed yet input HTML 1 0 basically one way Users could fetch pages information providers difficult send information back way It quickly became apparent need two way traffic allow orders products placed via Web pages registration cards filled online search terms entered much much 668 THE APPLICATION LAYER Sending input user server via browser requires two kinds support First requires HTTP able carry data direction We describe done later section uses POST method The second requirement able present user interface elements gather package input Forms included functionality HTML 2 0 Forms contain boxes buttons allow users fill information make choices send information back page owner Forms written like parts HTML seen example Note forms still static content They exhibit behavior regardless using Dynamic content cover later provides sophisticated ways gather input sending program whose behavior may depend browser environment Like forms one enclosed form form tags The attributes tag tell data input case using POST method send data specified URL Text enclosed tag displayed All usual tags e g b allowed form let author page control look form screen Three kinds input boxes used form uses input tag It variety parameters determining size nature usage box displayed The common forms blank fields accepting user text boxes checked submit buttons cause data returned server The first kind input box text box follows text Name The box 46 characters wide expects user type string stored variable customer The next line form asks user street address 40 characters wide Then comes line asking city state country Since p tags used fields browser displays one line instead separate paragraphs fit As far browser concerned one paragraph contains six items three strings alternating three boxes The next line asks credit card number expiration date Transmitting credit card numbers Internet done adequate security measures taken We discuss Chap 8 Following expiration date encounter new feature radio buttons These used choice must made among two alternatives The intellectual model car radio half dozen buttons choosing stations Clicking one button turns ones group The visual presentation browser Widget size also uses two radio buttons The two groups distinguished name parameter static scoping using something like radiobutton radiobutton The value parameters used indicate radio button pushed For example depending credit card options user chosen variable cc set either string mastercard string visacard SEC 7 3 THE WORLD WIDE WEB html head title AWI CUSTOMER ORDERING FORM title head body h1 Widget Order Form h1 form ACTION http widget com cgi bin order cgi method POST p Name input name customer size 46 p p Street address input name address size 40 p p City input name city size 20 State input name state size 4 Country input name country size 10 p p Credit card input name cardno size 10 Expires input name expires size 4 M C input name cc type radio value mastercard VISA input name cc type radio value visacard p p Widget size Big input name product type radio value expensive Little input name product type radio value cheap Ship express courier input name express type checkbox p p input type submit value Submit order p Thank ordering AWI widget best widget money buy form body html Widget Order Form Name Street address City State Credit card Widget size Big Expires Little M C Country Visa Ship express courier Submit order Thank ordering AWI widget best widget money buy b The HTML order form b The formatted page After two sets radio buttons come shipping option represented box type checkbox It either Unlike radio buttons exactly one set must chosen box type checkbox independently others 670 THE APPLICATION LAYER Finally come submit button The value string label button displayed When user clicks submit button browser packages collected information single long line sends back server URL provided part form tag A simple encoding used The used separate fields used represent space For example form line might look like contents customer John Doe address 100 Main St city White Plains state NY country USA cardno 1234567890 expires 6 14 cc mastercard product cheap express A possible response browser server information filled user The string sent back server one line It broken three lines page wide enough It server make sense string likely passing information program process We discuss done next section There also types input shown simple example Two types password textarea A password box text box default type need named except characters displayed typed A textarea box also text box except contain multiple lines For long lists choice must made select select tags provided bracket list alternatives This list often rendered drop menu The semantics radio buttons unless multiple parameter given case semantics checkboxes Finally ways indicate default initial values user change For example text box given value field contents displayed form user edit erase CSS Cascading Style Sheets The original goal HTML specify structure document appearance For example h1 Deborah Photos h1 instructs browser emphasize heading say anything typeface point size color That left browser knows properties display e g many pixels However many Web page designers wanted absolute control pages appeared new tags added HTML control appearance font face helvetica size 24 color red Deborah Photos font SEC 7 3 THE WORLD WIDE WEB Also ways added control positioning screen accurately The trouble approach tedious produces bloated HTML portable Although page may render perfectly browser developed may complete mess another browser another release browser different screen resolution A better alternative use style sheets Style sheets text editors allow authors associate text logical style instead physical style example initial paragraph instead italic text The appearance style defined separately In way author decides change initial paragraphs 14 point italics blue 18 point boldface shocking pink requires changing one definition convert entire document CSS Cascading Style Sheets introduced style sheets Web HTML 4 0 though widespread use browser support take 2000 CSS defines simple language describing rules control appearance tagged content Let us look example Suppose AWI wants snazzy Web pages navy text Arial font white background level headings extra 100 50 larger text level respectively The CSS definition gives rules body background color linen color navy font family Arial h1 font size 200 h2 font size 150 CSS example As seen style definitions compact Each line selects element applies gives values properties The properties element apply defaults HTML elements contains Thus style body sets style paragraphs text body There also convenient shorthands color names e g red Any style parameters defined filled defaults browser This behavior makes style sheet definitions optional reasonable presentation occur without Style sheets placed HTML file e g using style tag common place separate file reference For example head tag AWI page modified refer style sheet file awistyle css shown The example also shows MIME type CSS files text css head title AMALGAMATED WIDGET INC title link rel stylesheet type text css href awistyle css head Including CSS style sheet 672 THE APPLICATION LAYER This strategy two advantages First lets one set styles applied many pages Web site This organization lends consistent appearance pages even developed different authors different times allows look entire site changed editing one CSS file HTML This method compared include file C program changing one macro definition changes program files include header The second advantage HTML files downloaded kept small This browser download one copy CSS file pages reference It need download new copy definitions along Web page 7 3 3 Dynamic Web Pages Web Applications The static page model used far treats pages multimedia documents conveniently linked together It fitting model early days Web vast amounts information put online Nowadays much excitement around Web using applications services Examples include buying products e commerce sites searching library catalogs exploring maps reading sending email collaborating documents These new uses like traditional application software e g mail readers word processors The twist applications run inside browser user data stored servers Internet data centers They use Web protocols access information via Internet browser display user interface The advantage approach users need install separate application programs user data accessed different computers backed service operator It proving successful rivaling traditional application software Of course fact applications offered free large providers helps This model prevalent form cloud computing computing moves individual desktop computers shared clusters servers Internet To act applications Web pages longer static Dynamic content needed For example page library catalog reflect books currently available books checked thus available Similarly useful stock market page would allow user interact page see stock prices different periods time compute profits losses As examples suggest dynamic content generated programs running server browser places In section examine two cases turn The general situation shown For example consider map service lets user enter street address presents corresponding map location Given request location Web server must use program create page shows map location database streets geographic information This action shown steps 1 3 The request step SEC 7 3 THE WORLD WIDE WEB 1 causes program run server The program consults database generate appropriate page step 2 returns browser step 3 Web page Program 5 Program DB Program Web browser Web server Dynamic pages There dynamic content however The page returned may contain programs run browser In map example program would let user find routes explore nearby areas different levels detail It would update page zooming directed user step 4 To handle interactions program may need data server In case program send request server step 5 retrieve information database step 6 return response step 7 The program continue updating page step 4 The requests responses happen background user may even aware page URL title typically change By including client side programs page present responsive interface server side programs alone Server Side Dynamic Web Page Generation Let us look case server side content generation detail A simple situation server side processing necessary use forms Consider user filling AWI order form b clicking Submit order button When user clicks request sent server URL specified form POST http widget com cgi bin order cgi case along contents form filled user These data must given program script process Thus URL identifies program run data provided program input In case processing would involve entering order AWI internal system updating customer records charging credit card The page returned request depend happens processing It fixed like static page If order succeeds page returned might give expected shipping date If unsuccessful returned page might say widgets requested stock credit card valid reason 674 THE APPLICATION LAYER Exactly server runs program instead retrieving file depends design Web server It specified Web protocols This interface proprietary browser need know details As far browser concerned simply making request fetching page Nonetheless standard APIs developed Web servers invoke programs The existence interfaces makes easier developers extend different servers Web applications We briefly look two APIs give sense entail The first API method handling dynamic page requests available since beginning Web It called CGI Common Gateway Interface defined RFC 3875 CGI provides interface allow Web servers talk back end programs scripts accept input e g forms generate HTML pages response These programs may written whatever language convenient developer usually scripting language ease development Pick Python Ruby Perl favorite language By convention programs invoked via CGI live directory called cgi bin visible URL The server maps request directory program name executes program separate process It provides data sent request input program The output program gives Web page returned browser In example program order cgi invoked input form encoded shown It parse parameters process order A useful convention program return HTML order form form input provided In way program sure know representation form The second API look quite different The approach embed little scripts inside HTML pages executed server generate page A popular language writing scripts PHP PHP Hypertext Preprocessor To use server understand PHP browser understand CSS interpret Web pages style sheets Usually servers identify Web pages containing PHP file extension php rather html htm PHP simpler use CGI As example works forms see example The top part figure contains normal HTML page simple form This time form tag specifies action php invoked handle parameters user submits form The page displays two text boxes one request name one request age After two boxes filled form submitted server parses type string sent back putting name name variable age age variable It starts process action php file shown b reply During processing file SEC 7 3 THE WORLD WIDE WEB PHP commands executed If user filled Barbara 24 boxes HTML file sent back one given c Thus handling forms becomes extremely simple using PHP html body form action action php method post p Please enter name input type text name name p p Please enter age input type text name age p input type submit form body html html body h1 Reply h1 Hello php echo name Prediction next year php echo age 1 body html b html body h1 Reply h1 Hello Barbara Prediction next year 33 body html c A Web page containing form b A PHP script handling output form c Output PHP script inputs Barbara 32 respectively Although PHP easy use actually powerful programming language interfacing Web server database It variables strings arrays control structures found C much powerful I O printf PHP open source code freely available widely used It designed specifically work well Apache also open source world widely used Web server For information PHP see Valade 2009 We seen two different ways generate dynamic HTML pages CGI scripts embedded PHP There several others choose JSP JavaServer Pages similar PHP except dynamic part written 676 THE APPLICATION LAYER Java programming language instead PHP Pages using technique file extension jsp ASP NET Active Server Pages NET Microsoft version PHP JavaServer Pages It uses programs written Microsoft proprietary NET networked application framework generating dynamic content Pages using technique extension aspx The choice among three techniques usually politics open source vs Microsoft technology since three languages roughly comparable Client Side Dynamic Web Page Generation PHP CGI scripts solve problem handling input interactions databases server They accept incoming information forms look information one databases generate HTML pages results What none respond mouse movements interact users directly For purpose necessary scripts embedded HTML pages executed client machine rather server machine Starting HTML 4 0 scripts permitted using tag script The technologies used produce interactive Web pages broadly referred dynamic HTML The popular scripting language client side JavaScript take quick look Despite similarity names JavaScript almost nothing Java programming language Like scripting languages high level language For example single line JavaScript possible pop dialog box wait text input store resulting string variable High level features like make JavaScript ideal designing interactive Web pages On hand fact mutating faster fruit fly trapped X ray machine makes extremely difficult write JavaScript programs work platforms maybe day stabilize As example program JavaScript consider Like displays form asking name age predicts old person next year The body almost PHP example main difference declaration Submit button assignment statement This assignment statement tells browser invoke response script button click pass form parameter What completely new declaration JavaScript function response head HTML file area normally reserved titles background colors This function extracts value name field form stores variable person string It also extracts value age field converts integer using eval function adds 1 stores result years Then opens document output four SEC 7 3 THE WORLD WIDE WEB html head script language javascript type text javascript function response test form var person test form name value var years eval test form age value 1 document open document writeln html body document writeln Hello person br document writeln Prediction next year years document writeln body html document close script head body form Please enter name input type text name name p Please enter age input type text name age p input type button value submit onclick response form form body html Use JavaScript processing form writes using writeln method closes document The document HTML file seen various HTML tags The browser displays document screen It important understand PHP JavaScript look similar embed code HTML files processed totally differently In PHP example user clicked submit button browser collects information long string sends server request PHP page The server loads PHP file executes PHP script embedded produce new HTML page That page sent back browser display The browser even sure produced program This processing shown steps 1 4 Fig 732 In JavaScript example submit button clicked browser interprets JavaScript function contained page All work done locally inside browser There contact server This processing shown steps 1 2 b As consequence result displayed virtually instantaneously whereas PHP delay several seconds resulting HTML arrives client 678 THE APPLICATION LAYER Browser Server Browser Server User User PHP module JavaScript b Server side scripting PHP b Client side scripting JavaScript This difference mean JavaScript better PHP Their uses completely different PHP implication JSP ASP used interaction database server needed JavaScript clientside languages mention VBScript used interaction user client computer It certainly possible combine see shortly JavaScript way make Web pages highly interactive An alternative Windows platforms VBScript based Visual Basic Another popular method across platforms use applets These small Java programs compiled machine instructions virtual computer called JVM Java Virtual Machine Applets embedded HTML pages applet applet interpreted JVM capable browsers Because Java applets interpreted rather directly executed Java interpreter prevent Bad Things At least theory In practice applet writers found nearly endless stream bugs Java I O libraries exploit Microsoft answer Sun Java applets allowing Web pages hold ActiveX controls programs compiled x86 machine language executed bare hardware This feature makes vastly faster flexible interpreted Java applets anything program When Internet Explorer sees ActiveX control Web page downloads verifies identity executes However downloading running foreign programs raises enormous security issues discuss Chap 8 Since nearly browsers interpret Java programs JavaScript designer wants make highly interactive Web page choice least two techniques portability multiple platforms issue ActiveX addition As general rule JavaScript programs easier write Java applets execute faster ActiveX controls run fastest Also since browsers implement exactly JVM two browsers implement version JavaScript Java applets portable JavaScript programs For information JavaScript many books many often 1000 pages See example Flanagan 2010 SEC 7 3 THE WORLD WIDE WEB AJAX Asynchronous JavaScript XML Compelling Web applications need responsive user interfaces seamless access data stored remote Web servers Scripting client e g JavaScript server e g PHP basic technologies provide pieces solution These technologies commonly used several key technologies combination called AJAX Asynchronous JAvascript Xml Many full featured Web applications Google Gmail Maps Docs written AJAX AJAX somewhat confusing language It set technologies work together enable Web applications every bit responsive powerful traditional desktop applications The technologies 1 HTML CSS present information pages 2 DOM Document Object Model change parts pages viewed 3 XML eXtensible Markup Language let programs exchange application data server 4 An asynchronous way programs send retrieve XML data 5 JavaScript language bind functionality together As quite collection go piece see contributes We already seen HTML CSS They standards describing content displayed Any program produce HTML CSS use Web browser display engine DOM Document Object Model representation HTML page accessible programs This representation structured tree reflects structure HTML elements For instance DOM tree HTML given At root html element represents entire HTML block This element parent body element turn parent form element The form two attributes drawn right hand side one form method POST one form action URL request This element three children reflecting two paragraph tags one input tag contained within form At bottom tree leaves contain either elements literals text strings The significance DOM model provides programs straightforward way change parts page There need rewrite entire page Only node contains change needs replaced When change made browser correspondingly update display For example image part page changed DOM browser update image without changing parts page We already seen DOM action JavaScript example added lines 680 THE APPLICATION LAYER Elements html body form Child elements Attributes right action action php method post input p p Please enter name input type txt name age Please enter age input type submit type txt name age The DOM tree HTML document element cause new lines text appear bottom browser window The DOM powerful method producing pages evolve The third technology XML eXtensible Markup Language language specifying structured content HTML mixes content formatting concerned presentation information However Web applications become common increasing need separate structured content presentation For example consider program searches Web best price book It needs analyze many Web pages looking item title price With Web pages HTML difficult program figure title price For reason W3C developed XML Bray et al 2006 allow Web content structured automated processing Unlike HTML defined tags XML Each user define tags A simple example XML document given It defines structure called book list list books Each book three fields title author year publication These structures extremely simple It permitted structures repeated fields e g multiple authors optional fields e g URL audio book alternative fields e g URL bookstore print URL auction site print In example three fields indivisible entity also permitted subdivide fields For example author field could done follows give finer grained control searching formatting author first name George first name last name Zipf last name author Each field subdivided subfields subsubfields arbitrarily deeply SEC 7 3 THE WORLD WIDE WEB xml version 1 0 book list book title Human Behavior Principle Least Effort title author George Zipf author year 1949 year book book title The Mathematical Theory Communication title author Claude E Shannon author author Warren Weaver author year 1949 year book book title Nineteen Eighty Four title author George Orwell author year 1949 year book book list A simple XML document All file define book list containing three books It well suited transporting information programs running browsers servers says nothing display document Web page To program consumes information judges 1949 fine year books might output HTML titles marked italic text Alternatively language called XSLT eXtensible Stylesheet Language Transformations used define XML transformed HTML XSLT like CSS much powerful We spare details The advantage expressing data XML instead HTML easier programs analyze HTML originally written manually often still lot bit sloppy Sometimes closing tags like p left Other tags matching closing tag like br Still tags may nested improperly case tag attribute names vary Most browsers best work probably intended XML stricter cleaner definition Tag names attributes always lowercase tags must always closed reverse order opened indicate clearly empty tag corresponding close attribute values must enclosed quotation marks This precision makes parsing easier unambiguous HTML even defined terms XML This approach called XHTML eXtended HyperText Markup Language Basically Very 682 THE APPLICATION LAYER Picky version HTML XHTML pages must strictly conform XML rules otherwise accepted browser No shoddy Web pages inconsistencies across browsers As XML intent produce pages better programs case Web applications process While XHTML around since 1998 slow catch People produce HTML see need XHTML browser support lagged Now HTML 5 0 defined page represented either HTML XHTML aid transition Eventually XHTML replace HTML long time transition complete XML also proved popular language communication programs When communication carried HTTP protocol described next section called Web service In particular SOAP Simple Object Access Protocol way implementing Web services performs RPC programs language system independent way The client constructs request XML message sends server using HTTP protocol The server sends back reply XML formatted message In way applications heterogeneous platforms communicate Getting back AJAX point simply XML useful format exchange data programs running browser server However provide responsive interface browser sending receiving data must possible scripts perform asynchronous I O block display awaiting response request For example consider map scrolled browser When notified scroll action script map page may request map data server view map near edge data The interface freeze data fetched Such interface would win user awards Instead scrolling continue smoothly When data arrive script notified use data If goes well new map data fetched needed Modern browsers support model communication The final piece puzzle scripting language holds AJAX together providing access list technologies In cases language JavaScript alternatives VBScript We presented simple example JavaScript earlier Do fooled simplicity JavaScript many quirks full blown programming language power C Java It variables strings arrays objects functions usual control structures It also interfaces specific browser Web pages JavaScript track mouse motion objects screen makes easy make menu suddenly appear leads lively Web pages It use DOM access pages manipulate HTML XML perform asynchronous HTTP communication Before leaving subject dynamic pages let us briefly summarize technologies covered far relating single figure Complete Web pages generated fly various scripts server SEC 7 3 THE WORLD WIDE WEB machine The scripts written server extension languages like PHP JSP ASP NET run separate CGI processes thus written language These options shown Client machine Java virtual machine VB Script interpreter HTML CSS XML interpreter Java Script interpreter Server machine Web browser process Helper application Web browser process HTML CSS etc XML PHP ASP CGI script JSP Plug ins Various technologies used generate dynamic pages Once Web pages received browser treated normal pages HTML CSS MIME types displayed Plug ins run browser helper applications run outside browser installed extend MIME types supported browser Dynamic content generation also possible client side The programs embedded Web pages written JavaScript VBScript Java languages These programs perform arbitrary computations update display With AJAX programs Web pages asynchronously exchange XML kinds data server This model supports rich Web applications look like traditional applications except run inside browser access information stored servers Internet 7 3 4 HTTP The HyperText Transfer Protocol Now understanding Web content applications time look protocol used transport information Web servers clients It HTTP HyperText Transfer Protocol specified RFC 2616 HTTP simple request response protocol normally runs TCP It specifies messages clients may send servers responses get back return The request response headers given ASCII like SMTP The contents given MIME like format also like SMTP This simple model partly responsible early success Web made development deployment straightforward In section look important properties HTTP used nowadays However getting details note way 684 THE APPLICATION LAYER used Internet evolving HTTP application layer protocol runs top TCP closely associated Web That covering chapter However another sense HTTP becoming like transport protocol provides way processes communicate content across boundaries different networks These processes Web browser Web server A media player could use HTTP talk server request album information Antivirus software could use HTTP download latest updates Developers could use HTTP fetch project files Consumer electronics products like digital photo frames often use embedded HTTP server interface outside world Machine machine communication increasingly runs HTTP For example airline server might use SOAP XML RPC HTTP contact car rental server make car reservation part vacation package These trends likely continue along expanding use HTTP Connections The usual way browser contact server establish TCP connection port 80 server machine although procedure formally required The value using TCP neither browsers servers worry handle long messages reliability congestion control All matters handled TCP implementation Early Web HTTP 1 0 connection established single request sent single response sent back Then TCP connection released In world typical Web page consisted entirely HTML text method adequate Quickly average Web page grew contain large numbers embedded links content icons eye candy Establishing separate TCP connection transport single icon became expensive way operate This observation led HTTP 1 1 supports persistent connections With possible establish TCP connection send request get response send additional requests get additional responses This strategy also called connection reuse By amortizing TCP setup startup release costs multiple requests relative overhead due TCP reduced per request It also possible pipeline requests send request 2 response request 1 arrived The performance difference three cases shown Part shows three requests one separate connection Let us suppose represents Web page two embedded images server The URLs images determined main page fetched fetched main page Nowadays typical page around 40 objects must fetched present would make figure far big use two embedded objects SEC 7 3 THE WORLD WIDE WEB Connection setup HTTP Request Connection setup HTTP Response Connection setup Pipelined requests Connection setup Time Connection setup b c HTTP multiple connections sequential requests b A persistent connection sequential requests c A persistent connection pipelined requests In b page fetched persistent connection That TCP connection opened beginning three requests sent one connection closed Observe fetch completes quickly There two reasons speedup First time wasted setting additional connections Each TCP connection requires least one round trip time establish Second transfer images proceeds quickly Why It TCP congestion control At start connection TCP uses slow start procedure increase throughput learns behavior network path The consequence warmup period multiple short TCP connections take disproportionately longer transfer information one longer TCP connection Finally c one persistent connection requests pipelined Specifically second third requests sent rapid succession soon enough main page retrieved identify images must fetched The responses requests follow eventually This method cuts time server idle improves performance Persistent connections come free however A new issue raise close connection A connection server stay open page loads What There good chance user click link requests another page server If connection remains open next request sent immediately However guarantee client make another request server time soon In practice 686 THE APPLICATION LAYER clients servers usually keep persistent connections open idle short time e g 60 seconds large number open connections need close The observant reader may noticed one combination left far It also possible send one request per TCP connection run multiple TCP connections parallel This parallel connection method widely used browsers persistent connections It disadvantage sequential connections extra overhead much better performance This setting ramping connections parallel hides latency In example connections embedded images could set time However running many TCP connections server discouraged The reason TCP performs congestion control connection independently As consequence connections compete causing added packet loss aggregate aggressive users network individual connection Persistent connections superior used preference parallel connections avoid overhead suffer congestion problems Methods Although HTTP designed use Web intentionally made general necessary eye future object oriented uses For reason operations called methods requesting Web page supported This generality permitted SOAP come existence Each request consists one lines ASCII text first word first line name method requested The built methods listed The names case sensitive GET allowed get Method Description GET Read Web page HEAD Read Web page header POST Append Web page PUT Store Web page DELETE Remove Web page TRACE Echo incoming request CONNECT Connect proxy OPTIONS Query options page The built HTTP request methods The GET method requests server send page When say page mean object general case thinking page contents SEC 7 3 THE WORLD WIDE WEB file sufficient understand concepts The page suitably encoded MIME The vast majority requests Web servers GETs The usual form GET GET filename HTTP 1 1 filename names page fetched 1 1 protocol version The HEAD method asks message header without actual page This method used collect information indexing purposes test URL validity The POST method used forms submitted Both GET also used SOAP Web services Like GET bears URL instead simply retrieving page uploads data server e contents form RPC parameters The server something data depends URL conceptually appending data object The effect might purchase item example call procedure Finally method returns page indicating result The remaining methods used much browsing Web The PUT method reverse GET instead reading page writes page This method makes possible build collection Web pages remote server The body request contains page It may encoded using MIME case lines following PUT might include authentication headers prove caller indeed permission perform requested operation DELETE might expect removes page least indicates Web server agreed remove page As PUT authentication permission play major role The TRACE method debugging It instructs server send back request This method useful requests processed correctly client wants know request server actually got The CONNECT method lets user make connection Web server intermediate device Web cache The OPTIONS method provides way client query server page obtain methods headers used page Every request gets response consisting status line possibly additional information e g part Web page The status line contains three digit status code telling whether request satisfied The first digit used divide responses five major groups shown The 1xx codes rarely used practice The 2xx codes mean request handled successfully content returned The 3xx codes tell client look elsewhere either using different URL cache discussed later The 4xx codes mean request failed due client error invalid request nonexistent page Finally 5xx errors mean server internal problem either due error code temporary overload 688 THE APPLICATION LAYER Code Meaning Examples 1xx Information 100 server agrees handle client request 2xx Success 200 request succeeded 204 content present 3xx Redirection 301 page moved 304 cached page still valid 4xx Client error 403 forbidden page 404 page found 5xx Server error 500 internal server error 503 try later The status code response groups Message Headers The request line e g line GET method may followed additional lines information They called request headers This information compared parameters procedure call Responses may also response headers Some headers used either direction A selection important ones given This list short might imagine often variety headers request response The User Agent header allows client inform server browser implementation e g Mozilla 5 0 Chrome 5 0 375 125 This information useful let servers tailor responses browser since different browsers widely varying capabilities behaviors The four Accept headers tell server client willing accept event limited repertoire acceptable The first header specifies MIME types welcome e g text html The second gives character set e g ISO 8859 5 Unicode 1 1 The third deals compression methods e g gzip The fourth indicates natural language e g Spanish If server choice pages use information supply one client looking If unable satisfy request error code returned request fails The If Modified Since If None Match headers used caching They let client ask page sent cached copy longer valid We describe caching shortly The Host header names server It taken URL This header mandatory It used IP addresses may serve multiple DNS names server needs way tell host hand request The Authorization header needed pages protected In case client may prove right see page requested This header used case The client uses misspelled Referer header give URL referred URL requested Most often URL previous page SEC 7 3 Header THE WORLD WIDE WEB Type Contents User Agent Request Information browser platform Accept Request The type pages client handle Accept Charset Request The character sets acceptable client Accept Encoding Request The page encodings client handle Accept Language Request The natural languages client handle If Modified Since Request Time date check freshness If None Match Request Previously sent tags check freshness Host Request The server DNS name Authorization Request A list client credentials Referer Request The previous URL request came Cookie Request Previously set cookie sent back server Set Cookie Response Cookie client store Server Response Information server Content Encoding Response How content encoded e g gzip Content Language Response The natural language used page Content Length Response The page length bytes Content Type Response The page MIME type Content Range Response Identifies portion page content Last Modified Response Time date page last changed Expires Response Time date page stops valid Location Response Tells client send request Accept Ranges Response Indicates server accept byte range requests Date Both Date time message sent Range Both Identifies portion page Cache Control Both Directives treat caches ETag Both Tag contents page Upgrade Both The protocol sender wants switch Some HTTP message headers This header particularly useful tracking Web browsing tells servers client arrived page Although cookies dealt RFC 2109 rather RFC 2616 also headers The Set Cookie header servers send cookies clients The client expected save cookie return subsequent requests server using Cookie header Note recent specification cookies newer headers RFC 2965 largely rejected industry widely implemented 690 THE APPLICATION LAYER Many headers used responses The Server header allows server identify software build wishes The next five headers starting Content allow server describe properties page sending The Last Modified header tells page last modified Expires header tells long page remain valid Both headers play important role page caching The Location header used server inform client try different URL This used page moved allow multiple URLs refer page possibly different servers It also used companies main Web page com domain redirect clients national regional page based IP addresses preferred language If page large small client may want Some servers accept requests byte ranges page fetched multiple small units The Accept Ranges header announces server willingness handle type partial page request Now come headers used directions The Date header used directions contains time date message sent Range header tells byte range page provided response The ETag header gives short tag serves name content page It used caching The Cache Control header gives explicit instructions cache usually cache pages Finally Upgrade header used switching new communication protocol future HTTP protocol secure transport It allows client announce support server assert using Caching People often return Web pages viewed related Web pages often embedded resources Some examples images used navigation across site well common style sheets scripts It would wasteful fetch resources pages time displayed browser already copy Squirreling away pages fetched subsequent use called caching The advantage cached page reused necessary repeat transfer HTTP built support help clients identify safely reuse pages This support improves performance reducing network traffic latency The trade browser must store pages nearly always worthwhile trade local storage inexpensive The pages usually kept disk used browser run later date The difficult issue HTTP caching determine previously cached copy page page would fetched SEC 7 3 THE WORLD WIDE WEB This determination made solely URL For example URL may give page displays latest news item The contents page updated frequently even though URL stays Alternatively contents page may list gods Greek Roman mythology This page change somewhat less rapidly HTTP uses two strategies tackle problem They shown forms processing request step 1 response step 5 The first strategy page validation step 2 The cache consulted copy page requested URL known fresh e still valid need fetch anew server Instead cached page returned directly The Expires header returned cached page originally fetched current date time used make determination 1 Request 2 Check expiry 3 Conditional GET 4a Not modified Program Cache 5 Response 4b Response Web browser Web server HTTP caching However pages come convenient Expires header tells page must fetched After making predictions hard especially future In case browser may use heuristics For example page modified past year told Last Modified header fairly safe bet change next hour There guarantee however may bad bet For example stock market might closed day page change hours change rapidly next trading session starts Thus cacheability page may vary wildly time For reason heuristics used care though often work well practice Finding pages expired beneficial use caching means server need contacted Unfortunately always work Servers must use Expires header conservatively since may unsure page updated Thus cached copies may still fresh client know The second strategy used case It ask server cached copy still valid This request conditional GET shown step 3 If server knows cached copy still valid send short reply say step 4a Otherwise must send full response step 4b 692 THE APPLICATION LAYER More header fields used let server check whether cached copy still valid The client time cached page last updated LastModified header It send time server using If Modified Since header ask page changed meantime Alternatively server may return ETag header page This header gives tag short name content page like checksum better It cryptographic hash describe Chap 8 The client validate cached copies sending server If None Match header listing tags cached copies If tags match content server would respond corresponding cached copy may used This method used convenient useful determine freshness For example server may return different content URL depending languages MIME types preferred In case modification date alone help server determine cached page fresh Finally note caching strategies overridden directives carried Cache Control header These directives used restrict caching e g cache appropriate An example dynamic page different next time fetched Pages require authorization also cached There much caching space make two important points First caching performed places besides browser In general case HTTP requests routed series caches The use cache external browser called proxy caching Each added level caching help reduce requests chain It common organizations ISPs companies run proxy caches gain benefits caching pages across different users We discuss proxy caching broader topic content distribution Sec 7 5 end chapter Second caches provide important boost performance much one might hope The reason certainly popular documents Web also great many unpopular documents people fetch many also long e g videos The long tail unpopular documents take space caches number requests handled cache grows slowly size cache Web caches always likely able handle less half requests See Breslau et al 1999 information Experimenting HTTP Because HTTP ASCII protocol quite easy person terminal opposed browser directly talk Web servers All needed TCP connection port 80 server Readers encouraged experiment following command sequence It work UNIX shells command window Windows telnet program enabled SEC 7 3 THE WORLD WIDE WEB telnet www ietf org 80 GET rfc html HTTP 1 1 Host www ietf org This sequence commands starts telnet e TCP connection port 80 IETF Web server www ietf org Then comes GET command naming path URL protocol Try servers URLs choosing The next line mandatory Host header A blank line following last header mandatory It tells server request headers The server send response Depending server URL many different kinds headers pages observed 7 3 5 The Mobile Web The Web used every type computer includes mobile phones Browsing Web wireless network mobile useful It also presents technical problems much Web content designed flashy presentations desktop computers broadband connectivity In section describe Web access mobile devices mobile Web developed Compared desktop computers work home mobile phones present several difficulties Web browsing 1 Relatively small screens preclude large pages large images 2 Limited input capabilities make tedious enter URLs lengthy input 3 Network bandwidth limited wireless links particularly cellular 3G networks often expensive 4 Connectivity may intermittent 5 Computing power limited reasons battery life size heat dissipation cost These difficulties mean simply using desktop content mobile Web likely deliver frustrating user experience Early approaches mobile Web devised new protocol stack tailored wireless devices limited capabilities WAP Wireless Application Protocol well known example strategy The WAP effort started 1997 major mobile phone vendors included Nokia Ericsson Motorola However something unexpected happened along way Over next decade network bandwidth device capabilities grew tremendously deployment 3G data services mobile phones larger color displays 694 THE APPLICATION LAYER faster processors 802 11 wireless capabilities All sudden possible mobiles run simple Web browsers There still gap mobiles desktops never close many technology problems gave impetus separate protocol stack faded The approach increasingly used run Web protocols mobiles desktops Web sites deliver mobile friendly content user happens mobile device Web servers able detect whether return desktop mobile versions Web pages looking request headers The User Agent header especially useful regard identifies browser software Thus Web server receives request may look headers return page small images less text simpler navigation iPhone full featured page user laptop W3C encouraging approach several ways One way standardize best practices mobile Web content A list 60 best practices provided first specification Rabin McCathieNevile 2008 Most practices take sensible steps reduce size pages including use compression since costs communication higher computation maximizing effectiveness caching This approach encourages sites especially large sites create mobile Web versions content required capture mobile Web users To help users along also logo indicate pages viewed well mobile Web Another useful tool stripped version HTML called XHTML Basic This language subset XHTML intended use mobile phones televisions PDAs vending machines pagers cars game machines even watches For reason support style sheets scripts frames standard tags They grouped 11 modules Some required optional All defined XML The modules example tags listed However pages designed work well mobile Web Thus complementary approach use content transformation transcoding In approach computer sits mobile server takes requests mobile fetches content server transforms mobile Web content A simple transformation reduce size large images reformatting lower resolution Many small useful transformations possible Transcoding used success since early days mobile Web See example Fox et al 1996 However approaches used tension mobile content decisions made server transcoder For instance Web site may select particular combination image text mobile Web user transcoder change format image Our discussion far content protocols content biggest problem realizing mobile Web However briefly mention issue protocols The HTTP TCP IP protocols used SEC 7 3 Module THE WORLD WIDE WEB Req Function Example tags Structure Yes Doc structure body head html title Text Yes Information br code dfn em hn kbd p strong Hypertext Yes Hyperlinks List Yes Itemized lists dl dt dd ol ul li Forms No Fill forms form input label option textarea Tables No Rectangular tables caption table td th tr Image No Pictures img Object No Applets maps etc object param Meta information No Extra info meta Link No Similar link Base No URL starting point base The XHTML Basic modules tags Web may consume significant amount bandwidth protocol overheads headers To tackle problem WAP solutions defined special purpose protocols This turns largely unecessary Header compression technologies ROHC RObust Header Compression described Chap 6 reduce overheads protocols In way possible one set protocols HTTP TCP IP use either high low bandwidth links Use low bandwidth links simply requires header compression turned 7 3 6 Web Search To finish description Web discuss arguably successful Web application search In 1998 Sergey Brin Larry Page graduate students Stanford formed startup called Google build better Web search engine They armed radical idea search algorithm counted many times page pointed pages better measure importance many times contained key words sought For instance many pages link main Cisco page makes page important user searching Cisco page outside company happens use word Cisco many times They right It prove possible build better search engine people flocked Backed venture capital Google grew tremendously It became public company 2004 market capitalization 23 billion By 2010 estimated run one million servers data centers throughout world 696 THE APPLICATION LAYER In one sense search simply another Web application albeit one mature Web applications development since early days Web However Web search proved indispensible everyday usage Over one billion Web searches estimated done day People looking manner information use search starting point For example find buy Vegemite Seattle obvious Web site use starting point But chances search engine knows page desired information quickly direct answer To perform Web search traditional manner user directs browser URL Web search site The major search sites include Google Yahoo Bing Next user submits search terms using form This act causes search engine perform query database relevant pages images whatever kind resource searched return result dynamic page The user follow links pages found Web search interesting topic discussion implications design use networks First question Web search finds pages The Web search engine must database pages run query Each HTML page may contain links pages everything interesting least searchable linked somewhere This means theoretically possible start handful pages find pages Web traversal pages links This process called Web crawling All Web search engines use Web crawlers One issue crawling kind pages find Fetching static documents following links easy However many Web pages contain programs display different pages depending user interaction An example online catalog store The catalog may contain dynamic pages created product database queries different products This kind content different static pages easy traverse How Web crawlers find dynamic pages The answer part This kind hidden content called deep Web How search deep Web open problem researchers tackling See example madhavan et al 2008 There also conventions sites make page known robots txt tell crawlers parts sites visited A second consideration process crawled data To let indexing algorithms run mass data pages must stored Estimates vary main search engines thought index tens billions pages taken visible part Web The average page size estimated 320 KB These figures mean crawled copy Web takes order 20 petabytes 2 1016 bytes store While truly huge number also amount data comfortably stored processed Internet data centers Chang et al 2006 For example disk storage costs 20 TB 2 104 TB costs 400 000 exactly huge amount companies size Google Microsoft Yahoo And Web SEC 7 3 THE WORLD WIDE WEB expanding disk costs dropping dramatically storing entire Web may continue feasible large companies foreseeable future Making sense data another matter You appreciate XML help programs extract structure data easily ad hoc formats lead much guesswork There also issue conversion formats even translation languages But even knowing structure data part problem The hard bit understand means This much value unlocked starting relevant result pages search queries The ultimate goal able answer questions example buy cheap decent toaster oven city A third aspect Web search come provide higher level naming There need remember long URL reliable perhaps search Web page person name assuming better remembering names URLs This strategy increasingly successful In way DNS names relegated IP addresses computers Web search relegating URLs computers Also favor search corrects spelling typing errors whereas type URL wrong get wrong page Finally Web search shows us something little network design much growth Internet services much money advertising Advertising economic engine driven growth Web search The main change print advertising ability target advertisements depending people searching increase relevance advertisements Variations auction mechanism used match search query valuable advertisement Edelman et al 2007 This new model given rise new problems course click fraud programs imitate users click advertisements cause payments fairly earned 7 4 STREAMING AUDIO AND VIDEO Web applications mobile Web exciting developments use networks For many people audio video holy grail networking When word multimedia mentioned propellerheads suits begin salivating cue The former see immense technical challenges providing voice IP video demand every computer The latter see equally immense profits While idea sending audio video Internet around since 1970s least since roughly 2000 real time audio real time video traffic grown vengeance Real time traffic different Web traffic must played predetermined rate useful After watching video slow motion fits starts 698 THE APPLICATION LAYER people idea fun In contrast Web short interruptions page loads take less time within limits without major problem Two things happened enable growth First computers became much powerful equipped microphones cameras input process output audio video data ease Second flood Internet bandwidth come available Long haul links core Internet run many gigabits sec broadband 802 11 wireless reaches users edge Internet These developments allow ISPs carry tremendous levels traffic across backbones mean ordinary users connect Internet 100 1000 times faster 56 kbps telephone modem The flood bandwidth caused audio video traffic grow different reasons Telephone calls take relatively little bandwidth principle 64 kbps less compressed yet telephone service traditionally expensive Companies saw opportunity carry voice traffic Internet using existing bandwidth cut telephone bills Startups Skype saw way let customers make free telephone calls using Internet connections Upstart telephone companies saw cheap way carry traditional voice calls using IP networking equipment The result explosion voice data carried Internet networks called voice IP Internet telephony Unlike audio video takes large amount bandwidth Reasonable quality Internet video encoded compression rates around 1 Mbps typical DVD movie 2 GB data Before broadband Internet access sending movies network prohibitive Not With spread broadband became possible first time users watch decent streamed video home People love Around quarter Internet users given day estimated visit YouTube popular video sharing site The movie rental business shifted online downloads And sheer size videos changed overall makeup Internet traffic The majority Internet traffic already video estimated 90 Internet traffic video within years Cisco 2010 Given enough bandwidth carry audio video key issue designing streaming conferencing applications network delay Audio video need real time presentation meaning must played predetermined rate useful Long delays mean calls interactive longer This problem clear ever talked satellite phone delay half second quite distracting For playing music movies network absolute delay matter affects media starts play But variation delay called jitter still matters It must masked player audio sound unintelligible video look jerky In section discuss strategies handle delay problem well protocols setting audio video sessions After introduction SEC 7 4 STREAMING AUDIO AND VIDEO digital audio video presentation broken three cases different designs used The first easiest case handle streaming stored media like watching video YouTube The next case terms difficulty streaming live media Two examples Internet radio IPTV radio television stations broadcast many users live Internet The last difficult case call might made Skype generally interactive audio video conference As aside term multimedia often used context Internet mean video audio Literally multimedia two media That definition makes book multimedia presentation contains text graphics figures However probably mind use term multimedia imply two continuous media media played well defined time interval The two media normally video audio moving pictures sound Many people also refer pure audio Internet telephony Internet radio multimedia well clearly Actually better term cases streaming media Nonetheless follow herd consider real time audio multimedia well 7 4 1 Digital Audio An audio sound wave one dimensional acoustic pressure wave When acoustic wave enters ear eardrum vibrates causing tiny bones inner ear vibrate along sending nerve pulses brain These pulses perceived sound listener In similar way acoustic wave strikes microphone microphone generates electrical signal representing sound amplitude function time The frequency range human ear runs 20 Hz 20 000 Hz Some animals notably dogs hear higher frequencies The ear hears loudness logarithmically ratio two sounds power A B conventionally expressed dB decibels quantity 10 log10 A B If define lower limit audibility sound pressure 20 Pascals 1 kHz sine wave 0 dB ordinary conversation 50 dB pain threshold 120 dB The dynamic range factor 1 million The ear surprisingly sensitive sound variations lasting milliseconds The eye contrast notice changes light level last milliseconds The result observation jitter milliseconds playout multimedia affects perceived sound quality much affects perceived image quality Digital audio digital representation audio wave used recreate Audio waves converted digital form ADC Analogto Digital Converter An ADC takes electrical voltage input generates binary number output In see example sine wave 700 THE APPLICATION LAYER To represent signal digitally sample every T seconds shown bar heights b If sound wave pure sine wave linear superposition sine waves highest frequency component present f Nyquist theorem see Chap 2 states sufficient make samples frequency 2f Sampling often value since higher frequencies sampling could detect present 1 00 0 75 0 50 0 25 0 25 T T T T T 2T 0 50 0 75 1 00 b c A sine wave b Sampling sine wave c Quantizing samples 4 bits The reverse process takes digital values produces analog electrical voltage It done DAC Digital Analog Converter A loudspeaker convert analog voltage acoustic waves people hear sounds Digital samples never exact The samples c allow nine values 1 00 1 00 steps 0 25 An 8 bit sample would allow 256 distinct values A 16 bit sample would allow 65 536 distinct values The error introduced finite number bits per sample called quantization noise If large ear detects Two well known examples sampled sound used telephone audio compact discs Pulse code modulation used within telephone system uses 8 bit samples made 8000 times per second The scale nonlinear minimize perceived distortion 8000 samples sec frequencies 4 kHz lost In North America Japan law encoding used In Europe internationally A law encoding used Each encoding gives data rate 64 000 bps Audio CDs digital sampling rate 44 100 samples sec enough capture frequencies 22 050 Hz good enough people bad canine music lovers The samples 16 bits linear range amplitudes Note 16 bit samples allow 65 536 distinct values even though dynamic range ear 1 million Thus even though CD quality audio much better telephone quality audio using 16 bits per sample introduces noticeable quantization noise although full dynamic range covered CDs supposed hurt Some fanatic audiophiles SEC 7 4 STREAMING AUDIO AND VIDEO still prefer 33 RPM LP records CDs records Nyquist frequency cutoff 22 kHz quantization noise But scratches unless handled carefully With 44 100 samples sec 16 bits uncompressed CD quality audio needs bandwidth 705 6 kbps monaural 1 411 Mbps stereo Audio Compression Audio often compressed reduce bandwidth needs transfer times even though audio data rates much lower video data rates All compression systems require two algorithms one compressing data source another decompressing destination In literature algorithms referred encoding decoding algorithms respectively We use terminology Compression algorithms exhibit certain asymmetries important understand Even though considering audio first asymmetries hold video well For many applications multimedia document encoded stored multimedia server decoded thousands times played back customers This asymmetry means acceptable encoding algorithm slow require expensive hardware provided decoding algorithm fast require expensive hardware The operator popular audio video server might quite willing buy cluster computers encode entire library requiring customers listen music watch movies likely big success Many practical compression systems go great lengths make decoding fast simple even price making encoding slow complicated On hand live audio video voice IP calls slow encoding unacceptable Encoding must happen fly real time Consequently real time multimedia uses different algorithms parameters stored audio videos disk often appreciably less compression A second asymmetry encode decode process need invertible That compressing data file transmitting decompressing user expects get original back accurate last bit With multimedia requirement exist It usually acceptable audio video signal encoding decoding slightly different original long sounds looks When decoded output exactly equal original input system said lossy If input output identical system lossless Lossy systems important accepting small amount information loss normally means huge payoff terms compression ratio possible Historically long haul bandwidth telephone network expensive substantial body work vocoders short voice coders compress audio special case speech Human speech tends 702 THE APPLICATION LAYER 600 Hz 6000 Hz range produced mechanical process depends speaker vocal tract tongue jaw Some vocoders make use models vocal system reduce speech parameters e g sizes shapes various cavities data rate little 2 4 kbps How vocoders work beyond scope book however We concentrate audio sent Internet typically closer CD quality It also desirable reduce data rates kind audio At 1 411 Mbps stereo audio would tie many broadband links leaving less room video Web traffic Its data rate compression reduced order magnitude little perceived loss quality Compression decompression require signal processing Fortunately digitized sound movies easily processed computers software In fact dozens programs exist let users record display edit mix store media multiple sources This led large amounts music movies available Internet legal resulted numerous lawsuits artists copyright owners Many audio compression algorithms developed Probably popular formats MP3 MPEG audio layer 3 AAC Advanced Audio Coding carried MP4 MPEG 4 files To avoid confusion note MPEG provides audio video compression MP3 refers audio compression portion part 3 MPEG 1 standard third version MPEG In fact third version MPEG released MPEG 1 MPEG 2 MPEG 4 AAC successor MP3 default audio encoding used MPEG 4 MPEG 2 allows MP3 AAC audio Is clear The nice thing standards many choose And like wait year two Audio compression done two ways In waveform coding signal transformed mathematically Fourier transform frequency components In Chap 2 showed example function time Fourier amplitudes The amplitude component encoded minimal way The goal reproduce waveform fairly accurately end bits possible The way perceptual coding exploits certain flaws human auditory system encode signal way sounds human listener even looks quite different oscilloscope Perceptual coding based science psychoacoustics people perceive sound Both MP3 AAC based perceptual coding The key property perceptual coding sounds mask sounds Imagine broadcasting live flute concert warm summer day Then sudden blue crew workmen nearby turn jackhammers start tearing street No one hear flute Its sounds masked jackhammers For transmission purposes sufficient encode frequency band used jackhammers SEC 7 4 STREAMING AUDIO AND VIDEO listeners hear flute anyway This called frequency masking ability loud sound one frequency band hide softer sound another frequency band would audible absence loud sound In fact even jackhammers stop flute inaudible short period time ear turns gain start takes finite time turn This effect called temporal masking To make effects quantitative imagine experiment 1 A person quiet room puts headphones connected computer sound card The computer generates pure sine wave 100 Hz low gradually increasing power The subject instructed strike key hears tone The computer records current power level repeats experiment 200 Hz 300 Hz frequencies limit human hearing When averaged many people log log graph much power takes tone audible looks like A direct consequence curve never necessary encode frequencies whose power falls threshold audibility For example power 100 Hz 20 dB could omitted output perceptible loss quality 20 dB 100 Hz falls level audibility Threshold audibility Power dB Power dB 20 Masked signal Threshold audibility Masking signal 150 Hz 20 02 05 1 2 5 Frequency kHz 02 05 1 2 5 Frequency kHz b The threshold audibility function frequency b The masking effect Now consider experiment 2 The computer runs experiment 1 time constant amplitude sine wave say 150 Hz superimposed test frequency What discover threshold audibility frequencies near 150 Hz raised shown b The consequence new observation keeping track signals masked powerful signals nearby frequency bands omit frequencies encoded signal saving bits In Fig 743 125 Hz signal completely omitted output one able hear difference Even powerful signal stops frequency band knowledge temporal masking properties allows us continue omit masked frequencies time interval ear recovers The 704 THE APPLICATION LAYER essence MP3 AAC Fourier transform sound get power frequency transmit unmasked frequencies encoding bits possible With information background see encoding done The audio compression done sampling waveform rate 8 96 kHz AAC often 44 1 kHz mimic CD sound Sampling done one mono two stereo channels Next output bit rate chosen MP3 compress stereo rock n roll CD 96 kbps little perceptible loss quality even rock n roll fans hearing loss For piano concert AAC least 128 kbps needed The difference signalto noise ratio rock n roll much higher piano concert engineering sense anyway It also possible choose lower output rates accept loss quality The samples processed small batches Each batch passed bank digital filters get frequency bands The frequency information fed psychoacoustic model determine masked frequencies Then available bit budget divided among bands bits allocated bands unmasked spectral power fewer bits allocated unmasked bands less spectral power bits allocated masked bands Finally bits encoded using Huffman encoding assigns short codes numbers appear frequently long codes occur infrequently There many details curious reader For information see Brandenburg 1999 7 4 2 Digital Video Now know ear time move eye No section followed one nose The human eye property image appears retina image retained number milliseconds decaying If sequence images drawn 50 images sec eye notice looking discrete images All video systems exploit principle produce moving pictures The simplest digital representation video sequence frames consisting rectangular grid picture elements pixels Each pixel single bit represent either black white However quality system awful Try using favorite image editor convert pixels color image black white shades gray The next step use 8 bits per pixel represent 256 gray levels This scheme gives high quality black white video For color video many systems use 8 bits red green blue RGB primary color components This representation possible color constructed linear superposition red green blue appropriate intensities With SEC 7 4 STREAMING AUDIO AND VIDEO 24 bits per pixel 16 million colors human eye distinguish On color LCD computer monitors televisions discrete pixel made closely spaced red green blue subpixels Frames displayed setting intensity subpixels eye blends color components Common frame rates 24 frames sec inherited 35mm motion picture film 30 frames sec inherited NTSC U S televisions 30 frames sec inherited PAL television system used nearly rest world For truly picky NTSC color television runs 29 97 frames sec The original black white system ran 30 frames sec color introduced engineers needed bit extra bandwidth signaling reduced frame rate 29 97 NTSC videos intended computers really use 30 PAL invented NTSC really uses 25 000 frames sec To make story complete third system SECAM used France Francophone Africa Eastern Europe It first introduced Eastern Europe Communist East Germany East German people could watch West German PAL television lest get Bad Ideas But many countries switching PAL Technology politics best Actually broadcast television 25 frames sec quite good enough smooth motion images split two fields one odd numbered scan lines one even numbered scan lines The two half resolution fields broadcast sequentially giving almost 60 NTSC exactly 50 PAL fields sec system known interlacing Videos intended viewing computer progressive use interlacing computer monitors buffers graphics cards making possible CPU put new image buffer 30 times sec graphics card redraw screen 50 even 100 times sec eliminate flicker Analog television sets frame buffer way computers When interlaced video rapid movement displayed computer short horizontal lines visible near sharp edges effect known combing The frame sizes used video sent Internet vary widely simple reason larger frames require bandwidth may always available Low resolution video might 320 240 pixels full screen video 640 480 pixels These dimensions approximate early computer monitors NTSC television respectively The aspect ratio width height ratio 4 3 standard television HDTV High Definition TeleVision videos downloaded 1280 720 pixels These widescreen images aspect ratio 16 9 closely match 3 2 aspect ratio film For comparison standard DVD video usually 720 480 pixels video Blu ray discs usually HDTV 1080 720 pixels On Internet number pixels part story media players present image different sizes Video another window computer screen blown shrunk The role 706 THE APPLICATION LAYER pixels increase quality image look blurry expanded However many monitors show images hence videos even pixels even HDTV Video Compression It obvious discussion digital video compression critical sending video Internet Even standard quality video 640 480 pixel frames 24 bits color information per pixel 30 frames sec takes 200 Mbps This far exceeds bandwidth company offices connected Internet let alone home users single video stream Since transmitting uncompressed video completely question least wide area networks hope massive compression possible Fortunately large body research past decades led many compression techniques algorithms make video transmission feasible Many formats used video sent Internet proprietary standard The popular encoding MPEG various forms It open standard found files mpg mp4 extensions well container formats In section look MPEG study video compression accomplished To begin look compression still images JPEG A video sequence images plus sound One way compress video encode image succession To first approximation MPEG JPEG encoding frame plus extra features removing redundancy across frames The JPEG Standard The JPEG Joint Photographic Experts Group standard compressing continuous tone still pictures e g photographs developed photographic experts working joint auspices ITU ISO IEC another standards body It widely used look files extension jpg often provides compression ratios 10 1 better natural images JPEG defined International Standard 10918 Really like shopping list single algorithm four modes defined lossy sequential mode relevant discussion Furthermore concentrate way JPEG normally used encode 24 bit RGB video images leave options details sake simplicity The algorithm illustrated Step 1 block preparation For sake specificity let us assume JPEG input 640 480 RGB image 24 bits pixel shown RGB best color model use compression The eye much sensitive luminance brightness video signals chrominance color video signals Thus SEC 7 4 STREAMING AUDIO AND VIDEO first compute luminance Y two chrominances Cb Cr R G B components The following formulas used 8 bit values range 0 255 Y 16 0 26R 0 50G 0 09B Cb 128 0 15R 0 29G 0 44B Cr 128 0 44R 0 37G 0 07B Input Discrete cosine transform Block preparation Quantization Runlength encoding Differential quantization Statistical Output output encoding Steps JPEG lossy sequential encoding Separate matrices constructed Y Cb Cr Next square blocks four pixels averaged Cb Cr matrices reduce 320 240 This reduction lossy eye barely notices since eye responds luminance chrominance Nevertheless compresses total amount data factor two Now 128 subtracted element three matrices put 0 middle range Finally matrix divided 8 8 blocks The Y matrix 4800 blocks two 1200 blocks shown b Y Cb240 RGB 8 Bit pixel 1 Block 24 Bit pixel b Block 4799 Cr RGB input data b After block preparation Step 2 JPEG encoding apply DCT Discrete Cosine Transformation 7200 blocks separately The output DCT 8 8 matrix DCT coefficients DCT element 0 0 average value block The elements tell much spectral power present spatial frequency Normally elements decay rapidly distance origin 0 0 suggested Once DCT complete JPEG encoding moves step 3 called quantization less important DCT coefficients wiped This lossy 708 Fy DCT Y Cb Cr Amplitude THE APPLICATION LAYER x b Fx One block Y matrix b The DCT coefficients transformation done dividing coefficients 8 8 DCT matrix weight taken table If weights 1 transformation nothing However weights increase sharply origin higher spatial frequencies dropped quickly An example step given Here see initial DCT matrix quantization table result obtained dividing DCT element corresponding quantization table element The values quantization table part JPEG standard Each application must supply allowing control loss compression trade Quantization table DCT coefficients 150 80 40 14 92 75 36 10 52 38 26 8 610022110000 8 16 32 64 2224 8 16 32 64 8 16 32 64 8 16 32 64 8 16 32 64 16 16 16 16 16 16 32 64 32 32 32 32 32 32 32 64 64 64 64 64 64 64 64 64 Quantized coefficients 150 80 20 92 75 18 26 19 13 3100000000000 Computation quantized DCT coefficients Step 4 reduces 0 0 value block one upper left corner replacing amount differs corresponding element previous block Since elements averages respective blocks change slowly taking differential values reduce small values No differentials computed values SEC 7 4 STREAMING AUDIO AND VIDEO Step 5 linearizes 64 elements applies run length encoding list Scanning block left right top bottom concentrate zeros together zigzag scanning pattern used shown In example zigzag pattern produces 38 consecutive 0s end matrix This string reduced single count saying 38 zeros technique known run length encoding The order quantized values transmitted Now list numbers represent image transform space Step 6 Huffman encodes numbers storage transmission assigning common numbers shorter codes uncommon ones JPEG may seem complicated complicated Still benefits 20 1 compression worth Decoding JPEG image requires running algorithm backward JPEG roughly symmetric decoding takes long encoding This property true compression algorithms shall see The MPEG Standard Finally come heart matter MPEG Motion Picture Experts Group standards Though many proprietary algorithms standards define main algorithms used compress videos They international standards since 1993 Because movies contain images sound MPEG compress audio video We already examined audio compression still image compression let us examine video compression The MPEG 1 standard includes MP3 audio first published 1993 still widely used Its goal produce video recorder quality output compressed 40 1 rates around 1 Mbps This video suitable 710 THE APPLICATION LAYER broad Internet use Web sites Do worry remember video recorders MPEG 1 also used storing movies CDs existed If know CDs move MPEG 2 The MPEG 2 standard released 1996 designed compressing broadcast quality video It common used basis video encoded DVDs inevitably finds way onto Internet digital broadcast television DVB DVD quality video typically encoded rates 4 8 Mbps The MPEG 4 standard two video formats The first format released 1999 encodes video object based representation This allows mixing natural synthetic images kinds media example weatherperson standing front weather map With structure easy let programs interact movie data The second format released 2003 known H 264 AVC Advanced Video Coding Its goal encode video half rate earlier encoders quality level better support transmission video networks This encoder used HDTV Blu ray discs The details standards many varied The later standards also many features encoding options earlier standards However go details For part gains video compression time come numerous small improvements rather fundamental shifts video compressed Thus sketch overall concepts MPEG compresses audio video Since audio video encoders work independently issue two streams get synchronized receiver The solution single clock outputs timestamps current time encoders These timestamps included encoded output propagated way receiver use synchronize audio video streams MPEG video compression takes advantage two kinds redundancies exist movies spatial temporal Spatial redundancy utilized simply coding frame separately JPEG This approach occasionally used especially random access frame needed editing video productions In mode JPEG levels compression achieved Additional compression achieved taking advantage fact consecutive frames often almost identical This effect smaller might first appear since many movie directors cut scenes every 3 4 seconds time movie fragment count scenes Nevertheless runs 75 highly similar frames offer potential major reduction simply encoding frame separately JPEG For scenes camera background stationary one two actors moving around slowly nearly pixels identical frame frame Here subtracting frame previous one running SEC 7 4 STREAMING AUDIO AND VIDEO JPEG difference would fine However scenes camera panning zooming technique fails badly What needed way compensate motion This precisely MPEG main difference MPEG JPEG MPEG output consists three kinds frames 1 I Intracoded frames self contained compressed still pictures 2 P Predictive frames block block difference previous frames 3 B Bidirectional frames block block differences previous future frames I frames still pictures They coded JPEG something similar It valuable I frames appear output stream periodically e g twice per second three reasons First MPEG used multicast transmission viewers tuning If frames depended predecessors going back first frame anybody missed first frame could never decode subsequent frames Second frame received error decoding would possible everything would unintelligble junk Third without I frames fast forward rewind decoder would calculate every frame passed would know full value one stopped P frames contrast code interframe differences They based idea macroblocks cover example 16 16 pixels luminance space 8 8 pixels chrominance space A macroblock encoded searching previous frame something slightly different An example P frames would useful given Here see three consecutive frames background differ position one person The macroblocks containing background scene match exactly macroblocks containing person offset position unknown amount tracked Three consecutive frames The MPEG standards specify search far search good match order count This implementation For 712 THE APPLICATION LAYER example implementation might search macroblock current position previous frame positions offset x x direction direction For position number matches luminance matrix could computed The position highest score would declared winner provided predefined threshold Otherwise macroblock would said missing Much sophisticated algorithms also possible course If macroblock found encoded taking difference current value one previous frame luminance chrominances These difference matrices subjected discrete cosine transformation quantization run length encoding Huffman encoding usual The value macroblock output stream motion vector far macroblock moved previous position direction followed encoding difference If macroblock located previous frame current value encoded I frame Clearly algorithm highly asymmetric An implementation free try every plausible position previous frame wants desperate attempt locate every last macroblock matter moved This approach minimize encoded MPEG stream expense slow encoding This approach might fine one time encoding film library would terrible real time videoconferencing Similarly implementation free decide constitutes found macroblock This freedom allows implementers compete quality speed algorithms always produce compliant MPEG output So far decoding MPEG straightforward Decoding I frames similar decoding JPEG images Decoding P frames requires decoder buffer previous frames build new one separate buffer based fully encoded macroblocks macroblocks containing differences previous frames The new frame assembled macroblock macroblock B frames similar P frames except allow reference macroblock either previous frames succeeding frames This additional freedom allows improved motion compensation It useful example objects pass front behind objects To B frame encoding encoder needs hold sequence frames memory past frames current frame encoded future frames Decoding similarly complicated adds delay This given B frame decoded successive frames depends decoded Thus although Bframes give best compression always used due greater complexity buffering requirements The MPEG standards contain many enhancements techniques achieve excellent levels compression AVC used compress video ratios excess 50 1 reduces network bandwidth requirements factor For information AVC see Sullivan Wiegand 2005 SEC 7 4 STREAMING AUDIO AND VIDEO 7 4 3 Streaming Stored Media Let us move network applications Our first case streaming media already stored files The common example watching videos Internet This one form VoD Video Demand Other forms video demand use provider network separate Internet deliver movies e g cable network In next section look streaming live media example broadcast IPTV Internet radio Then look third case real time conferencing An example voice IP call video conference Skype These three cases place increasingly stringent requirements deliver audio video network must pay increasing attention delay jitter The Internet full music video sites stream stored media files Actually easiest way handle stored media stream Imagine want create online movie rental site compete Apple iTunes A regular Web site let users download watch videos pay course The sequence steps shown We spell contrast next example Server Client 1 Media request HTTP Media player 4 Play media Browser Disk 3 Save media 2 Media response HTTP Web server Disk Playing media Web via simple downloads The browser goes action user clicks movie In step 1 sends HTTP request movie Web server movie linked In step 2 server fetches movie file MP4 format sends back browser Using MIME type example video mp4 browser looks supposed display file In case media player shown helper application though could also plug The browser saves entire movie scratch file disk step 3 It starts media player passing name scratch file Finally step 4 media player starts reading file playing movie In principle approach completely correct It play movie There real time network issue address either download simply 714 THE APPLICATION LAYER file download The trouble entire video must transmitted network movie starts Most customers want wait hour video demand This model problematic even audio Imagine previewing song purchasing album If song 4 MB typical size MP3 song broadband connectivity 1 Mbps user greeted half minute silence preview starts This model unlikely sell many albums To get around problem without changing browser works sites use design shown The page linked movie actual movie file Instead called metafile short file naming movie possibly key descriptors A simple metafile might one line ASCII text look like rtsp joes movie server movie 0025 mp4 The browser gets page usual one line file steps 1 2 Then starts media player hands one line file step 3 usual The media player reads metafile sees URL get movie It contacts joes video server asks movie step 4 The movie streamed back media player step 5 The advantage arrangement media player starts quickly short metafile downloaded Once happens browser loop The media sent directly media player start showing movie entire file downloaded Server Client 1 Metafile request HTTP Web server Browser 2 Metafile response HTTP Server 3 Handoff metafile 4 Media request RTSP Media player Media server 5 Media response via TCP UDP Disk Streaming media using Web media server We shown two servers server named metafile often Web server In fact generally even SEC 7 4 STREAMING AUDIO AND VIDEO HTTP server specialized media server In example media server uses RTSP Real Time Streaming Protocol indicated scheme name rtsp The media player four major jobs 1 Manage user interface 2 Handle transmission errors 3 Decompress content 4 Eliminate jitter Most media players nowadays glitzy user interface sometimes simulating stereo unit buttons knobs sliders visual displays Often interchangeable front panels called skins user drop onto player The media player manage interact user The jobs related depend network protocols We go one turn starting handling transmission errors Dealing errors depends whether TCP based transport like HTTP used transport media UDP based transport like RTP used Both used practice If TCP based transport used errors media player correct TCP already provides reliability using retransmissions This easy way handle errors least media player complicate removal jitter later step Alternatively UDP based transport like RTP used move data We studied Chap 6 With protocols retransmissions Thus packet loss due congestion transmission errors mean media arrive It media player deal problem Let us understand difficulty The loss problem customers like large gaps songs movies However much problem loss regular file transfer loss small amount media need degrade presentation user For video user unlikely notice occasionally 24 new frames second instead 25 new frames For audio short gaps playout masked sounds close time The user unlikely detect substitution unless paying close attention The key reasoning however gaps short Network congestion transmission error generally cause entire packet lost packets often lost small bursts Two strategies used reduce impact packet loss media lost FEC interleaving We describe turn FEC Forward Error Correction simply error correcting coding studied Chap 3 applied application level Parity across packets provides example Shacham McKenny 1990 For every four data packets 716 THE APPLICATION LAYER sent fifth parity packet constructed sent This shown packets A B C D The parity packet P contains redundant bits parity exclusive OR sums bits four data packets Hopefully packets arrive groups five packets When happens parity packet simply discarded receiver Or parity packet lost harm done Client Repair loss B P A C D Media player Lost packet A B Parity packet C D P Server Construct parity Media server P A B C D Disk Using parity packet repair loss Occasionally however data packet may lost transmission B The media player receives three data packets A C D plus parity packet P By design bits missing data packet reconstructed parity bits To specific using represent exclusive OR modulo 2 addition B reconstructed B P A C D properties exclusive OR e X Y Y X FEC reduce level loss seen media player repairing packet losses works certain level If two packets group five lost nothing recover data The property note FEC cost paid gain protection Every four packets become five packets bandwidth requirements media 25 larger The latency decoding increased may need wait parity packet arrived reconstruct data packet came There also one clever trick technique In Chap 3 described parity providing error detection Here providing error correction How The answer case known packet lost The lost data called erasure In Chap 3 considered frame received bits error know bit errored This case harder deal erasures Thus erasures parity provide error correction without erasures parity provide error detection We see another unexpected benefit parity soon get multicast scenarios The second strategy called interleaving This approach based mixing interleaving order media transmission unmixing SEC 7 4 STREAMING AUDIO AND VIDEO deinterleaving reception That way packet burst packets lost loss spread time unmixing It result single large gap media played For example packet might contain 220 stereo samples containing pair 16 bit numbers normally good 5 msec music If samples sent order lost packet would represent 5 msec gap music Instead samples transmitted shown Fig 753 All even samples 10 msec interval sent one packet followed odd samples next one The loss packet 3 represent 5 msec gap music loss every sample 10 msec This loss handled easily media player interpolate using previous succeeding samples The result lower temporal resolution 10 msec noticeable time gap media This packet contains 220 even time samples This packet contains 220 odd time samples Legend Lost Packet Even time sample Odd time sample b 15 Time msec When packets carry alternate samples loss packet reduces temporal resolution rather creating gap time This interleaving scheme works uncompressed sampling However interleaving short periods time individual samples also applied compression long way find sample boundaries compressed stream RFC 3119 gives scheme works compressed audio Interleaving attractive technique used needs additional bandwidth unlike FEC However interleaving adds latency like FEC need wait group packets arrive de interleaved The media player third job decompressing content Although task computationally intensive fairly straightforward The thorny issue decode media network protocol correct transmission errors In many compression schemes later data decompressed earlier data decompressed later data encoded relative earlier data For UDP based transport packet loss Thus encoding 718 THE APPLICATION LAYER process must designed permit decoding despite packet loss This requirement MPEG uses I P B frames Each I frame decoded independently frames recover loss earlier frames The fourth job eliminate jitter bane real time systems The general solution described Sec 6 4 3 use playout buffer All streaming systems start buffering 5 10 sec worth media starting play shown Playing drains media regularly buffer audio clear video smooth The startup delay gives buffer chance fill low water mark The idea data arrive regularly enough buffer never completely emptied If happen media playout would stall The value buffering data sometimes slow arrive due congestion buffered media allow playout continue normally new media arrive buffer replenished Client machine Server machine Buffer Media player Media server Lowwater mark Highwater mark The media player buffers input media server plays buffer rather directly network How much buffering needed fast media server sends media fill buffer depend network protocols There many possibilities The largest factor design whether UDP based transport TCP based transport used Suppose UDP based transport like RTP used Further suppose ample bandwidth send packets media server media player little loss little traffic network In case packets sent exact rate media played Each packet transit network propagation delay arrive right time media player present media Very little buffering needed variability delay If interleaving FEC used buffering needed least group packets interleaving FEC performed However adds small amount buffering Unfortunately scenario unrealistic two respects First bandwidth varies network paths usually clear media server whether sufficient bandwidth tries stream media A simple solution encode media multiple resolutions let user choose SEC 7 4 STREAMING AUDIO AND VIDEO resolution supported Internet connectivity Often two levels high quality say encoded 1 5 Mbps better low quality say encoded 512 kbps less Second jitter variation long takes media samples cross network This jitter comes two sources There often appreciable amount competing traffic network come multitasking users browsing Web ostensibly watching streamed movie This traffic cause fluctuations media arrives Moreover care arrival video frames audio samples packets With compression video frames particular may larger smaller depending content An action sequence typically take bits encode placid landscape If network bandwidth constant rate media delivery versus time vary The jitter variation delay sources larger low water mark buffer needs avoid underrun Now suppose TCP based transport like HTTP used send media By performing retransmissions waiting deliver packets order TCP increase jitter observed media player perhaps significantly The result larger buffer higher low water mark needed However advantage TCP send data fast network carry Sometimes media may delayed loss must repaired But much time network able deliver media faster player consumes In periods buffer fill prevent future underruns If network significantly faster average media rate often case buffer fill rapidly startup emptying soon cease concern With TCP UDP transmission rate exceeds playout rate question far ahead playout point media player media server willing proceed Often willing download entire file However proceeding far ahead playout point performs work yet needed may require significant storage necessary avoid buffer underruns When wanted solution media player define high water mark buffer Basically server pumps data buffer filled high water mark Then media player tells pause Since data continue pour server gotten pause request distance high water mark end buffer greater bandwidth delay product network After server stopped buffer begin empty When hits low water mark media player tells media server start To avoid underrun low water mark must also take bandwidth delay product network account asking media server resume sending media To start stop flow media media player needs remote control This RTSP provides It defined RFC 2326 provides 720 THE APPLICATION LAYER mechanism player control server As well starting stopping stream seek back forward position play specified intervals play fast slow speeds It provide data stream though usually RTP UDP RTP HTTP TCP The main commands provided RTSP listed They simple text format like HTTP messages usually carried TCP RTSP run UDP since command acknowledged resent acknowledged Command Server action DESCRIBE List media parameters SETUP Establish logical channel player server PLAY Start sending data client RECORD Start accepting data client PAUSE Temporarily stop sending data TEARDOWN Release logical channel RTSP commands player server Even though TCP would seem poor fit real time traffic often used practice The main reason able pass firewalls easily UDP especially run HTTP port Most administrators configure firewalls protect networks unwelcome visitors They almost always allow TCP connections remote port 80 pass HTTP Web traffic Blocking port quickly leads unhappy campers However ports blocked including RSTP RTP use ports 554 5004 amongst others Thus easiest way get streaming media firewall Web site pretend HTTP server sending regular HTTP response least firewall There advantages TCP Because provides reliability TCP gives client complete copy media This makes easy user rewind previously viewed playout point without concern lost data Finally TCP buffer much media possible quickly possible When buffer space cheap disk used storage media player download media user watches Once download complete user watch uninterrupted even loses connectivity This property helpful mobiles connectivity change rapidly motion The disadvantage TCP added startup latency TCP startup also higher low water mark However rarely much penalty long network bandwidth exceeds media rate large factor SEC 7 4 STREAMING AUDIO AND VIDEO 7 4 4 Streaming Live Media It recorded videos tremendously popular Web Live media streaming popular Once became possible stream audio video Internet commercial radio TV stations got idea broadcasting content Internet well air Not long college stations started putting signals Internet Then college students started Internet broadcasts Today people companies sizes stream live audio video The area hotbed innovation technologies standards evolve Live streaming used online presence major television stations This called IPTV IP TeleVision It also used broadcast radio stations like BBC This called Internet radio Both IPTV Internet radio reach audiences worldwide events ranging fashion shows World Cup soccer test matches live Melbourne Cricket Ground Live streaming IP used technology cable providers build broadcast systems And widely used low budget operations adult sites zoos With current technology virtually anyone start live streaming quickly little expense One approach live streaming record programs disk Viewers connect server archives pull program download listening A podcast episode retrieved manner For scheduled events also possible store content broadcast live archive running say half hour less behind live feed In fact approach exactly used streaming media discussed It easy techniques discussed work viewers pick choose among programs archive A different approach broadcast live Internet Viewers tune ongoing media stream like turning television However media players provide added features letting user pause rewind playout The live media continue streamed buffered player user ready From browser point view looks exactly like case streaming stored media It matter player whether content comes file sent live usually player able tell except possible skip forward live stream Given similarity mechanism much previous discussion applies also key differences Importantly still need buffering client side smooth jitter In fact larger amount buffering often needed live streaming independent consideration user may pause playback When streaming file media pushed rate greater playback rate This build buffer quickly compensate network jitter player stop stream want buffer data In contrast live media streaming always transmitted precisely rate 722 THE APPLICATION LAYER generated rate played back It sent faster As consequence buffer must large enough handle full range network jitter In practice 10 15 second startup delay usually adequate large problem The important difference live streaming events usually hundreds thousands simultaneous viewers content Under circumstances natural solution live streaming use multicasting This case streaming stored media users typically stream different content given time Streaming many users consists many individual streaming sessions happen occur time A multicast streaming scheme works follows The server sends media packet using IP multicast group address The network delivers copy packet member group All clients want receive stream joined group The clients using IGMP rather sending RTSP message media server This media server already sending live stream except first user joins What needed arrange stream received locally Since multicast one many delivery service media carried RTP packets UDP transport TCP operates single sender single receiver Since UDP provide reliability packets may lost To reduce level media loss acceptable level use FEC interleaving In case FEC beneficial interaction multicast shown parity example When packets multicast different clients may lose different packets For example client 1 lost packet B client 2 lost parity packet P client 3 lost D client 4 lose packets However even though three different packets lost across clients client recover data packets example All required client lose one packet whichever one may missing packet recovered parity computation Nonnenmacher et al 1997 describe idea used boost reliability For server large number clients multicast media RTP UDP packets clearly efficient way operate Otherwise server must transmit N streams N clients require large amount network bandwidth server large streaming events It may surprise learn Internet work like practice What usually happens user establishes separate TCP connection server media streamed connection To client streaming stored media And streaming stored media several reasons seemingly poor choice The first reason IP multicast broadly available Internet Some ISPs networks support internally usually available across network boundaries needed wide area streaming The reasons SEC 7 4 STREAMING AUDIO AND VIDEO P D C B A Client 1 Parity packet RTP UDP data packet P D C B Different packets lost A P D C B A P D C B A P D C B A Client 2 Server Multicast Client 3 Client 4 Multicast streaming media parity packet advantages TCP UDP discussed earlier Streaming TCP reach nearly clients Internet particularly disguised HTTP pass firewalls reliable media delivery allows users rewind easily There one important case UDP multicast used streaming however within provider network For example cable company might decide broadcast TV channels customer set top boxes using IP technology instead traditional video broadcasts The use IP distribute broadcast video broadly called IPTV discussed Since cable company complete control network engineer support IP multicast sufficient bandwidth UDP based distribution All invisible customer IP technology exists within walled garden provider It looks like cable TV terms service IP underneath set top box computer running UDP TV set simply monitor attached computer Back Internet case disadvantage live streaming TCP server must send separate copy media client This feasible moderate number clients especially audio The trick place server location good Internet connectivity sufficient bandwidth Usually means renting server data center hosting provider using server home broadband Internet connectivity There competitive hosting market need expensive In fact easy anybody even student set operate streaming media server Internet radio station The main components 724 THE APPLICATION LAYER station illustrated The basis station ordinary PC decent sound card microphone Popular software used capture audio encode various formats example MP4 media players used listen audio usual Microphone Media player Audio capture plug Codec plug Internet Media server TCP connections listeners Student PC A student radio station The audio stream captured PC fed Internet media server good network connectivity either podcasts stored file streaming live streaming The server handles task distributing media via large numbers TCP connections It also presents front end Web site pages station links content available streaming There commercial software packages managing pieces well open source packages icecast However large number clients becomes infeasible use TCP send media client single server There simply enough bandwidth one server For large streaming sites streaming done using set servers geographically spread client connect nearest server This content distribution network study end chapter 7 4 5 Real Time Conferencing Once upon time voice calls carried public switched telephone network network traffic primarily voice traffic little bit data traffic Then came Internet Web The data traffic grew grew 1999 much data traffic voice traffic since voice digitized measured bits By 2002 volume data traffic order magnitude volume voice traffic still growing exponentially voice traffic staying almost flat The consequence growth flip telephone network head Voice traffic carried using Internet technologies represents SEC 7 4 STREAMING AUDIO AND VIDEO tiny fraction network bandwidth This disruptive technology known voice IP also Internet telephony Voice IP used several forms driven strong economic factors English translation saves money people use One form look like regular old fashioned telephones plug Ethernet send calls network Pehr Anderson undergraduate student M I T friends prototyped design class project They got B grade Not content started company called NBX 1996 pioneered kind voice IP sold 3Com 90 million three years later Companies love approach lets away separate telephone lines make networks already Another approach use IP technology build long distance telephone network In countries U S network accessed competitive long distance service dialing special prefix Voice samples put packets injected network pulled packets leave Since IP equipment much cheaper telecommunications equipment leads cheaper services As aside difference price entirely technical For many decades telephone service regulated monopoly guaranteed phone companies fixed percentage profit costs Not surprisingly led run costs example lots lots redundant hardware justified name better reliability telephone system allowed total 2 hours every 40 years 3 min year average This effect often referred gold plated telephone pole syndrome Since deregulation effect decreased course legacy equipment still exists The IT industry never history operating like always lean mean However concentrate form voice IP likely visible users using one computer call another computer This form became commonplace PCs began shipping microphones speakers cameras CPUs fast enough process media people started connecting Internet home broadband rates A well known example Skype software released starting 2003 Skype companies also provide gateways make easy call regular telephone numbers well computers IP addresses As network bandwidth increased video calls joined voice calls Initially video calls domain companies Videoconferencing systems designed exchange video two locations enabling executives different locations see held meetings However good broadband Internet connectivity video compression software home users also videoconference Tools Skype started audio routinely include video calls friends family across world see well hear 726 THE APPLICATION LAYER From point view Internet voice video calls also media streaming problem one much constrained streaming stored file live event The added constraint low latency needed two way conversation The telephone network allows one way latency 150 msec acceptable usage delay begins perceived annoying participants International calls may latency 400 msec point far positive user experience This low latency difficult achieve Certainly buffering 5 10 seconds media going work would broadcasting live sports event Instead video voice IP systems must engineered variety techniques minimize latency This goal means starting UDP clear choice rather TCP TCP retransmissions introduce least one round trip worth delay Some forms latency reduced however even UDP For example distance Seattle Amsterdam close 8 000 km The speed light propagation delay distance optical fiber 40 msec Good luck beating In practice propagation delay network longer cover larger distance bits follow great circle route transmission delays IP router stores forwards packet This fixed delay eats acceptable delay budget Another source latency related packet size Normally large packets best way use network bandwidth efficient However audio sampling rate 64 kbps 1 KB packet would take 125 msec fill even longer samples compressed This delay would consume overall delay budget In addition 1 KB packet sent broadband access link runs 1 Mbps take 8 msec transmit Then add another 8 msec packet go broadband link end Clearly large packets work Instead voice IP systems use short packets reduce latency cost bandwidth efficiency They batch audio samples smaller units commonly 20 msec At 64 kbps 160 bytes data less compression However definition delay packetization 20 msec The transmission delay smaller well packet shorter In example would reduce around 1 msec By using short packets minimum one way delay Seattle Amsterdam packet reduced unacceptable 181 msec 40 125 16 acceptable 62 msec 40 20 2 We even talked software overhead eat delay budget This especially true video since compression usually needed fit video available bandwidth Unlike streaming stored file time computationally intensive encoder high levels compression The encoder decoder must run quickly Buffering still needed play media samples time avoid unintelligible audio jerky video amount buffering must kept small since time remaining delay budget measured milliseconds SEC 7 4 STREAMING AUDIO AND VIDEO When packet takes long arrive player skip missing samples perhaps playing ambient noise repeating frame mask loss user There trade size buffer used handle jitter amount media lost A smaller buffer reduces latency results loss due jitter Eventually size buffer shrinks loss become noticeable user Observant readers may noticed said nothing network layer protocols far section The network reduce latency least jitter using quality service mechanisms The reason issue come streaming able operate substantial latency even live streaming case If latency major concern buffer end host sufficient handle problem jitter However real time conferencing usually important network reduce delay jitter help meet delay budget The time important much network bandwidth everyone gets good service In Chap 5 described two quality service mechanisms help goal One mechanism DS Differentiated Services packets marked belonging different classes receive different handling within network The appropriate marking voice IP packets low delay In practice systems set DS codepoint well known value Expedited Forwarding class Low Delay type service This especially useful broadband access links links tend congested Web traffic traffic competes use link Given stable network path delay jitter increased congestion Every 1 KB packet takes 8 msec send 1 Mbps link voice IP packet incur delays sitting queue behind Web traffic However low delay marking voice IP packets jump head queue bypassing Web packets lowering delay The second mechanism reduce delay make sure sufficient bandwidth If available bandwidth varies transmission rate fluctuates compressed video sometimes sufficient bandwidth queues build add delay This occur even DS To ensure sufficient bandwidth reservation made network This capability provided integrated services Unfortunately widely deployed Instead networks engineered expected traffic level network customers provided service level agreements given traffic level Applications must operate level avoid causing congestion introducing unnecessary delays For casual videoconferencing home user may choose video quality proxy bandwidth needs software may test network path select appropriate quality automatically Any factors cause latency become unacceptable real time conferencing requires attention paid For overview voice IP analysis factors see Goode 2002 728 THE APPLICATION LAYER Now discussed problem latency media streaming path move main problem conferencing systems must address This problem set tear calls We look two protocols widely used purpose H 323 SIP Skype another important system inner workings proprietary H 323 One thing clear everyone voice video calls made Internet vendor designed protocol stack system would never work To avoid problem number interested parties got together ITU auspices work standards In 1996 ITU issued recommendation H 323 entitled Visual Telephone Systems Equipment Local Area Networks Which Provide Non Guaranteed Quality Service Only telephone industry would think name It quickly changed Packet based Multimedia Communications Systems 1998 revision H 323 basis first widespread Internet conferencing systems It remains widely deployed solution seventh version 2009 H 323 architectural overview Internet telephony specific protocol It references large number specific protocols speech coding call setup signaling data transport areas rather specifying things The general model depicted At center gateway connects Internet telephone network It speaks H 323 protocols Internet side PSTN protocols telephone side The communicating devices called terminals A LAN may gatekeeper controls end points jurisdiction called zone Zone Terminal Gateway Gatekeeper Internet Telephone network The H 323 architectural model Internet telephony A telephone network needs number protocols To start protocol encoding decoding audio video Standard telephony representations single voice channel 64 kbps digital audio 8000 samples 8 bits per second defined ITU recommendation G 711 All H 323 systems SEC 7 4 STREAMING AUDIO AND VIDEO must support G 711 Other encodings compress speech permitted required They use different compression algorithms make different tradeoffs quality bandwidth For video MPEG forms video compression described supported including H 264 Since multiple compression algorithms permitted protocol needed allow terminals negotiate one going use This protocol called H 245 It also negotiates aspects connection bit rate RTCP need control RTP channels Also required protocol establishing releasing connections providing dial tones making ringing sounds rest standard telephony ITU Q 931 used The terminals need protocol talking gatekeeper present well For purpose H 225 used The PC gatekeeper channel manages called RAS Registration Admission Status channel This channel allows terminals join leave zone request return bandwidth provide status updates among things Finally protocol needed actual data transmission RTP UDP used purpose It managed RTCP usual The positioning protocols shown Audio Video G 7xx H 26x Control RTCP RTP H 225 RAS Q 931 Signaling UDP H 245 Call Control TCP IP Link layer protocol Physical layer protocol The H 323 protocol stack To see protocols fit together consider case PC terminal LAN gatekeeper calling remote telephone The PC first discover gatekeeper broadcasts UDP gatekeeper discovery packet port 1718 When gatekeeper responds PC learns gatekeeper IP address Now PC registers gatekeeper sending RAS message UDP packet After accepted PC sends gatekeeper RAS admission message requesting bandwidth Only bandwidth granted may call setup begin The idea requesting bandwidth advance allow gatekeeper limit number calls It avoid oversubscribing outgoing line order help provide necessary quality service 730 THE APPLICATION LAYER As aside telephone system thing When pick receiver signal sent local end office If office enough spare capacity another call generates dial tone If hear nothing Nowadays system overdimensioned dial tone nearly always instantaneous early days telephony often took seconds So grandchildren ever ask Why dial tones know Except probably telephones longer exist The PC establishes TCP connection gatekeeper begin call setup Call setup uses existing telephone network protocols connection oriented TCP needed In contrast telephone system nothing like RAS allow telephones announce presence H 323 designers free use either UDP TCP RAS chose lower overhead UDP Now bandwidth allocated PC send Q 931 SETUP message TCP connection This message specifies number telephone called IP address port computer called The gatekeeper responds Q 931 CALL PROCEEDING message acknowledge correct receipt request The gatekeeper forwards SETUP message gateway The gateway half computer half telephone switch makes ordinary telephone call desired ordinary telephone The end office telephone attached rings called telephone also sends back Q 931 ALERT message tell calling PC ringing begun When person end picks telephone end office sends back Q 931 CONNECT message signal PC connection Once connection established gatekeeper longer loop although gateway course Subsequent packets bypass gatekeeper go directly gateway IP address At point bare tube running two parties This physical layer connection moving bits Neither side knows anything one The H 245 protocol used negotiate parameters call It uses H 245 control channel always open Each side starts announcing capabilities example whether handle video H 323 handle video conference calls codecs supports etc Once side knows one handle two unidirectional data channels set codec parameters assigned one Since side may different equipment entirely possible codecs forward reverse channels different After negotiations complete data flow begin using RTP It managed using RTCP plays role congestion control If video present RTCP handles audio video synchronization The various channels shown When either party hangs Q 931 call signaling channel used tear connection call completed order free resources longer needed SEC 7 4 STREAMING AUDIO AND VIDEO Call signaling channel Q 931 Call control channel H 245 Caller Forward data channel RTP Callee Reverse data channel RTP Data control channel RTCP Logical channels caller callee call When call terminated calling PC contacts gatekeeper RAS message release bandwidth assigned Alternatively make another call We said anything quality service part H 323 even though said important part making real time conferencing success The reason QoS falls outside scope H 323 If underlying network capable producing stable jitter free connection calling PC gateway QoS call good otherwise However portion call telephone side jitter free telephone network designed SIP The Session Initiation Protocol H 323 designed ITU Many people Internet community saw typical telco product large complex inflexible Consequently IETF set committee design simpler modular way voice IP The major result date SIP Session Initiation Protocol The latest version described RFC 3261 written 2002 This protocol describes set Internet telephone calls video conferences multimedia connections Unlike H 323 complete protocol suite SIP single module designed interwork well existing Internet applications For example defines telephone numbers URLs Web pages contain allowing click link initiate telephone call way mailto scheme allows click link bring program send email message SIP establish two party sessions ordinary telephone calls multiparty sessions everyone hear speak multicast sessions one sender many receivers The sessions may contain audio video data latter useful multiplayer real time games example SIP handles setup management termination sessions Other protocols RTP RTCP 732 THE APPLICATION LAYER also used data transport SIP application layer protocol run UDP TCP required SIP supports variety services including locating callee may home machine determining callee capabilities well handling mechanics call setup termination In simplest case SIP sets session caller computer callee computer examine case first Telephone numbers SIP represented URLs using sip scheme example sip ilse cs university edu user named Ilse host specified DNS name cs university edu SIP URLs may also contain IPv4 addresses IPv6 addresses actual telephone numbers The SIP protocol text based protocol modeled HTTP One party sends message ASCII text consisting method name first line followed additional lines containing headers passing parameters Many headers taken MIME allow SIP interwork existing Internet applications The six methods defined core specification listed Method Description INVITE Request initiation session ACK Confirm session initiated BYE Request termination session OPTIONS Query host capabilities CANCEL Cancel pending request REGISTER Inform redirection server user current location SIP methods To establish session caller either creates TCP connection callee sends INVITE message sends INVITE message UDP packet In cases headers second subsequent lines describe structure message body contains caller capabilities media types formats If callee accepts call responds HTTP type reply code three digit number using groups 200 acceptance Following reply code line callee also may supply information capabilities media types formats Connection done using three way handshake caller responds ACK message finish protocol confirm receipt 200 message Either party may request termination session sending message BYE method When side acknowledges session terminated The OPTIONS method used query machine capabilities It typically used session initiated find machine even capable voice IP whatever type session contemplated SEC 7 4 STREAMING AUDIO AND VIDEO The REGISTER method relates SIP ability track connect user away home This message sent SIP location server keeps track That server later queried find user current location The operation redirection illustrated Here caller sends INVITE message proxy server hide possible redirection The proxy looks user sends INVITE message It acts relay subsequent messages three way handshake The LOOKUP REPLY messages part SIP convenient protocol used depending kind location server used Caller 3 REPLY 2 LOOKUP Location server Proxy Callee 4 INVITE 5 OK 8 ACK 1 INVITE 6 OK 7 ACK 9 Data Use proxy server redirection SIP SIP variety features describe including call waiting call screening encryption authentication It also ability place calls computer ordinary telephone suitable gateway Internet telephone system available Comparison H 323 SIP Both H 323 SIP allow two party multiparty calls using computers telephones end points Both support parameter negotiation encryption RTP RTCP protocols A summary similarities differences given Although feature sets similar two protocols differ widely philosophy H 323 typical heavyweight telephone industry standard specifying complete protocol stack defining precisely allowed forbidden This approach leads well defined protocols layer easing task interoperability The price paid large complex rigid standard difficult adapt future applications In contrast SIP typical Internet protocol works exchanging short lines ASCII text It lightweight module interworks well Internet protocols less well existing telephone system signaling protocols 734 THE APPLICATION LAYER Item H 323 SIP Designed ITU IETF Compatibility PSTN Yes Largely Compatibility Internet Yes time Yes Architecture Monolithic Modular Completeness Full protocol stack SIP handles setup Parameter negotiation Yes Yes Call signaling Q 931 TCP SIP TCP UDP Message format Binary ASCII Media transport RTP RTCP RTP RTCP Multiparty calls Yes Yes Multimedia conferences Yes No Addressing URL phone number URL Call termination Explicit TCP release Explicit timeout Instant messaging No Yes Encryption Yes Yes Size standards 1400 pages 250 pages Implementation Large complex Moderate issues Status Widespread esp video Alternative esp voice Comparison H 323 SIP Because IETF model voice IP highly modular flexible adapted new applications easily The downside suffered ongoing interoperability problems people try interpret standard means 7 5 CONTENT DELIVERY The Internet used communication like telephone network Early academics would communicate remote machines logging network perform tasks People used email communicate long time use video voice IP well Since Web grew however Internet become content communication Many people use Web find information tremendous amount peer peer file sharing driven access movies music programs The switch content pronounced majority Internet bandwidth used deliver stored videos SEC 7 5 CONTENT DELIVERY Because task distributing content different communication places different requirements network For example Sally wants talk Jitu may make voice IP call mobile The communication must particular computer good call Paul computer But Jitu wants watch team latest cricket match happy stream video whichever computer provide service He mind whether computer Sally Paul likely unknown server Internet That location matter content except affects performance legality The difference Web sites provide content become tremendously popular YouTube prime example It allows users share videos creation every conceivable topic Many people want The rest us want watch With bandwidth hungry videos estimated YouTube accounts 10 Internet traffic today No single server powerful reliable enough handle startling level demand Instead YouTube large content providers build content distribution networks These networks use data centers spread around world serve content extremely large number clients good performance availability The techniques used content distribution developed time Early growth Web popularity almost undoing More demands content led servers networks frequently overloaded Many people began call WWW World Wide Wait In response consumer demand large amounts bandwidth provisioned core Internet faster broadband connectivity rolled edge network This bandwidth key improving performance part solution To reduce endless delays researchers also developed different architectures use bandwidth distributing content One architecture CDN Content Distribution Network In provider sets distributed collection machines locations inside Internet uses serve content clients This choice big players An alternative architecture P2P Peer Peer network In collection computers pool resources serve content without separately provisioned servers central point control This idea captured people imagination acting together many little players pack enormous punch In section look problem distributing content Internet solutions used practice After briefly discussing content popularity Internet traffic describe build powerful Web servers use caching improve performance Web clients Then come two main architectures distributing content CDNs P2P networks There design properties quite different see 736 THE APPLICATION LAYER 7 5 1 Content Internet Traffic To design engineer networks work well need understanding traffic must carry With shift content example servers migrated company offices Internet data centers provide large numbers machines excellent network connectivity To run even small server nowadays easier cheaper rent virtual server hosted Internet data center operate real machine home office broadband connectivity Internet Fortunately two facts Internet traffic essential know The first fact changes quickly details overall makeup Before 1994 traffic traditional FTP file transfer moving programs data sets computers email Then Web arrived grew exponentially Web traffic left FTP email traffic dust long dot com bubble 2000 Starting around 2000 P2P file sharing music movies took By 2003 Internet traffic P2P traffic leaving Web dust Sometime late 2000s video streamed using content distribution methods sites like YouTube began exceed P2P traffic By 2014 Cisco predicts 90 Internet traffic video one form another Cisco 2010 It always traffic volume matters For instance voice IP traffic boomed even Skype started 2003 always minor blip chart bandwidth requirements audio two orders magnitude lower video However voice IP traffic stresses network ways sensitive latency As another example online social networks grown furiously since Facebook started 2004 In 2010 first time Facebook reached users Web per day Google Even putting traffic aside awful lot traffic online social networks important changing way people interact via Internet The point making seismic shifts Internet traffic happen quickly regularity What come next Please check back 6th edition book let know The second essential fact Internet traffic highly skewed Many properties familiar clustered around average For instance adults close average height There tall people short people tall short people For kinds properties possible design range large nonetheless captures majority population Internet traffic like For long time known small number Web sites massive traffic vast number Web site much smaller traffic This feature become part language networking Early papers talked traffic terms packet trains idea SEC 7 5 CONTENT DELIVERY express trains large number packets would suddenly travel link Jain Routhier 1986 This formalized notion selfsimilarity purposes thought network traffic exhibits many short many long gaps even viewed different time scales Leland et al 1994 Later work spoke long traffic flows elephants short traffic flows mice The idea elephants many mice elephants matter big Returning Web content sort skew evident Experience video rental stores public libraries organizations shows items equally popular Experimentally N movies available fraction requests kth popular one approximately C k Here C computed normalize sum 1 namely C 1 1 1 2 1 3 1 4 1 5 1 N Thus popular movie seven times popular number seven movie This result known Zipf law Zipf 1949 It named George Zipf professor linguistics Harvard University noted frequency word usage large body text inversely proportional rank For example 40th common word used twice much 80th common word three times much 120th common word A Zipf distribution shown It captures notion small number popular items great many unpopular items To recognize distributions form convenient plot data log scale axes shown b The result straight line Relative Frequency Relative Frequency 10 1 10 2Rank Rank b Zipf distribution On linear scale b On log log scale When people looked popularity Web pages also turned roughly follow Zipf law Breslau et al 1999 A Zipf distribution one example family distributions known power laws Power laws evident 738 THE APPLICATION LAYER many human phenomena distribution city populations wealth They propensity describe large players great many smaller players appear straight line log log plot It soon discovered topology Internet could roughly described power laws Faloutsos et al 1999 Next researchers began plotting every imaginable property Internet log scale observing straight line shouting Power law However matters straight line log log plot distributions mean design use networks Given many forms content Zipf power law distributions seems fundamental Web sites Internet Zipf like popularity This turn means average site useful representation Sites better described either popular unpopular Both kinds sites matter The popular sites obviously matter since popular sites may responsible traffic Internet Perhaps surprisingly unpopular sites matter This total amount traffic directed unpopular sites add large fraction overall traffic The reason many unpopular sites The notion collectively many unpopular choices matter popularized books The Long Tail Anderson 2008a Curves showing decay like common In particular situations rate decay proportional much material left unstable radioactive atoms exhibit exponential decay drops much faster Zipf Law The number items say atoms left time usually expressed e constant determines fast decay The difference exponential decay Zipf Law exponential decay safe ignore end tail Zipf Law total weight tail significant ignored To work effectively skewed world must able build kinds Web sites Unpopular sites easy handle By using DNS many different sites may actually point computer Internet runs sites On hand popular sites difficult handle There single computer even remotely powerful enough using single computer would make site inaccessible millions users fails To handle sites must build content distribution systems We start quest next 7 5 2 Server Farms Web Proxies The Web designs seen far single server machine talking multiple client machines To build large Web sites perform well speed processing either server side client side On server side powerful Web servers built server farm cluster computers acts single server On client side better performance SEC 7 5 CONTENT DELIVERY achieved better caching techniques In particular proxy caches provide large shared cache group clients We describe techniques turn However note neither technique sufficient build largest Web sites Those popular sites require content distribution methods describe following sections combine computers many different locations Server Farms No matter much bandwidth one machine serve many Web requests load great The solution case use one computer make Web server This leads server farm model Internet access Balances load across servers Backend database Front end Server farm Servers Clients A server farm The difficulty seemingly simple model set computers make server farm must look like single logical Web site clients If set different Web sites run parallel There several possible solutions make set servers appear one Web site All solutions assume servers handle request client To server must copy Web site The servers shown connected common back end database dashed line purpose One solution use DNS spread requests across servers server farm When DNS request made Web URL DNS server returns rotating list IP addresses servers Each client tries one IP address typically first list The effect different clients contact different servers access Web site intended The DNS method heart CDNs revisit later section The solutions based front end sprays incoming requests pool servers server farm This happens even client 740 THE APPLICATION LAYER contacts server farm using single destination IP address The front end usually link layer switch IP router device handles frames packets All solutions based servers peeking network transport application layer headers using nonstandard ways A Web request response carried TCP connection To work correctly front end must distribute packets request server A simple design front end broadcast incoming requests servers Each server answers fraction requests prior agreement For example 16 servers might look source IP address reply request last 4 bits source IP address match configured selectors Other packets discarded While wasteful incoming bandwidth often responses much longer request nearly inefficient sounds In general design front end may inspect IP TCP HTTP headers packets arbitrarily map server The mapping called load balancing policy goal balance workload across servers The policy may simple complex A simple policy might use servers one turn round robin With approach front end must remember mapping request subsequent packets part request sent server Also make site reliable single server front end notice servers failed stop sending requests Much like NAT general design perilous least fragile created device violates basic principle layered protocols layer must use header control purposes may inspect use information payload purpose But people design systems anyway break future due changes higher layers tend surprised The front end case switch router may take action based transport layer information higher Such box called middlebox interposes middle network path business according protocol stack In case front end best considered internal part server farm terminates layers application layer hence use header information layers Nonetheless NAT design useful practice The reason looking TCP headers possible better job load balancing IP information alone For example one IP address may represent entire company make many requests It looking TCP higherlayer information requests mapped different servers The reason looking HTTP headers somewhat different Many Web interactions access update databases customer looks recent purchase The server fields request query back end database It useful direct subsequent requests user SEC 7 5 CONTENT DELIVERY server server already cached information user The simplest way cause happen use Web cookies information distinguish user inspect HTTP headers find cookies As final note although described design Web sites server farm built kinds servers well An example servers streaming media UDP The change required front end able load balance requests different protocol header fields Web requests Web Proxies Web requests responses sent using HTTP In Sec 7 3 described browsers cache responses reuse answer future requests Various header fields rules used browser determine cached copy Web page still fresh We repeat material Caching improves performance shortening response time reducing network load If browser determine cached page fresh page fetched cache immediately network traffic However even browser must ask server confirmation page still fresh response time shortened network load reduced especially large pages since small message needs sent However best browser cache Web pages user previously visited From discussion popularity may recall well popular pages many people visit repeatedly many many unpopular pages In practice limits effectiveness browser caching large number pages visited given user These pages always fetched server One strategy make caches effective share cache among multiple users That way page already fetched one user returned another user user makes request Without browser caching users would need fetch page server Of course sharing done encrypted traffic pages require authentication uncacheable pages e g current stock prices returned programs Dynamic pages created programs especially growing case caching effective Nonetheless plenty Web pages visible many users look matter user makes request e g images A Web proxy used share cache among users A proxy agent acts behalf someone else user There many kinds proxies For instance ARP proxy replies ARP requests behalf user elsewhere reply A Web proxy fetches Web requests behalf users It normally provides caching Web responses since shared across users substantially larger cache browser 742 THE APPLICATION LAYER When proxy used typical setup organization operate one Web proxy users The organization might company ISP Both stand benefit speeding Web requests users reducing bandwidth needs While flat pricing independent usage common end users companies ISPs charged according bandwidth use This setup shown To use proxy browser configured make page requests proxy instead page real server If proxy page returns page immediately If fetches page server adds cache future use returns client requested Browser cache Organization Internet Proxy cache Servers Clients A proxy cache Web browsers Web servers As well sending Web requests proxy instead real server clients perform caching using browser cache The proxy consulted browser tried satisfy request cache That proxy provides second level caching Further proxies may added provide additional levels caching Each proxy browser makes requests via upstream proxy Each upstream proxy caches downstream proxies browsers Thus possible browsers company use company proxy uses ISP proxy contacts Web servers directly However single level proxy caching shown often sufficient gain potential benefits practice The problem long tail popularity Studies Web traffic shown shared caching especially beneficial number users reaches size small company say 100 people As number people grows larger benefits sharing cache become marginal unpopular requests cached due lack storage space Wolman et al 1999 Web proxies provide additional benefits often factor decision deploy One benefit filter content The administrator may configure SEC 7 5 CONTENT DELIVERY proxy blacklist sites otherwise filter requests makes For example many administrators frown employees watching YouTube videos worse yet pornography company time set filters accordingly Another benefit proxies privacy anonymity proxy shields identity user server 7 5 3 Content Delivery Networks Server farms Web proxies help build large sites improve Web performance sufficient truly popular Web sites must serve content global scale For sites different approach needed CDNs Content Delivery Networks turn idea traditional Web caching head Instead clients look copy requested page nearby cache provider places copy page set nodes different locations directs client use nearby node server An example path data follows distributed CDN shown It tree The origin server CDN distributes copy content nodes CDN Sydney Boston Amsterdam example This shown dashed lines Clients fetch pages nearest node CDN This shown solid lines In way clients Sydney fetch page copy stored Sydney fetch page origin server may Europe CDN origin server Distribution CDN nodes CDN node Sydney Page fetch Boston Amsterdam Worldwide clients CDN distribution tree Using tree structure three virtues First content distribution scaled many clients needed using nodes CDN levels tree distribution among CDN nodes becomes bottleneck No matter many clients tree structure efficient The origin server overloaded talks many clients via tree 744 THE APPLICATION LAYER CDN nodes answer request page Second client gets good performance fetching pages nearby server instead distant server This round trip time setting connection shorter TCP slow start ramps quickly shorter round trip time shorter network path less likely pass regions congestion Internet Finally total load placed network also kept minimum If CDN nodes well placed traffic given page pass part network This important someone pays network bandwidth eventually The idea using distribution tree straightforward What less simple organize clients use tree For example proxy servers would seem provide solution Looking client configured use Sydney Boston Amsterdam CDN node caching Web proxy distribution would follow tree However strategy falls short practice three reasons The first reason clients given part network probably belong different organizations probably using different Web proxies Recall caches usually shared across organizations limited benefit caching large number clients security reasons Second multiple CDNs client uses single proxy cache Which CDN client use proxy Finally perhaps practical issue Web proxies configured clients They may may configured benefit content distribution CDN little CDN Another simple way support distribution tree one level use mirroring In approach origin server replicates content CDN nodes The CDN nodes different network regions called mirrors The Web pages origin server contain explicit links different mirrors usually telling user location This design lets user manually select nearby mirror use downloading content A typical use mirroring place large software package mirrors located example East West coasts U S Asia Europe Mirrored sites generally completely static choice sites remains stable months years They tried tested technique However depend user distribution mirrors really different Web sites even linked together The third approach overcomes difficulties previous two approaches uses DNS called DNS redirection Suppose client wants fetch page URL http www cdn com page html To fetch page browser use DNS resolve www cdn com IP address This DNS lookup proceeds usual manner By using DNS protocol browser learns IP address name server cdn com contacts name server ask resolve www cdn com Now comes really clever bit The name server run CDN Instead returning IP address request look IP address client making request return SEC 7 5 CONTENT DELIVERY different answers The answer IP address CDN node nearest client That client Sydney asks CDN name server resolve www cdn com name server return IP address Sydney CDN node client Amsterdam makes request name server return IP address Amsterdam CDN node instead This strategy perfectly legal according semantics DNS We previously seen name servers may return changing lists IP addresses After name resolution Sydney client fetch page directly Sydney CDN node Further pages server fetched directly Sydney CDN node well DNS caching The overall sequence steps shown Sydney CDN node CDN origin server Amsterdam CDN node 1 Distribute content 4 Fetch page 2 Query DNS 3 Contact Sydney Sydney clients CDN DNS server Contact Amsterdam Amsterdam clients Directing clients nearby CDN nodes using DNS A complex question process means find nearest CDN node go To define nearest really geography matters There least two factors consider mapping client CDN node One factor network distance The client short high capacity network path CDN node This situation produce quick downloads CDNs use map previously computed translate IP address client network location The CDN node selected might one shortest distance crow flies might What matters combination length network path capacity limits along The second factor load already carried CDN node If CDN nodes overloaded deliver slow responses like overloaded Web server sought avoid first place Thus may necessary balance load across CDN nodes mapping clients nodes slightly away lightly loaded The techniques using DNS content distribution pioneered Akamai starting 1998 Web groaning load early 746 THE APPLICATION LAYER growth Akamai first major CDN became industry leader Probably even clever idea using DNS connect clients nearby nodes incentive structure business Companies pay Akamai deliver content clients responsive Web sites customers like use The CDN nodes must placed network locations good connectivity initially meant inside ISP networks For ISPs benefit CDN node networks namely CDN node cuts amount upstream network bandwidth need must pay proxy caches In addition CDN node improves responsiveness ISP customers makes ISP look good eyes giving competitive advantage ISPs CDN node These benefits cost ISP makes installing CDN node brainer ISP Thus content provider ISP customers benefit CDN makes money Since 1998 companies gotten business competitive industry multiple providers As description implies companies build CDN Instead use services CDN provider Akamai actually deliver content To let companies use service CDN need add one last step picture After contract signed CDN distribute content behalf Web site owner owner gives CDN content This content pushed CDN nodes In addition owner rewrites Web pages link content Instead linking content Web site pages link content via CDN As example scheme works consider source code Fluffy Video Web page given After preprocessing transformed b placed Fluffy Video server www fluffyvideo com index html When user types URL www fluffyvideo com browser DNS returns IP address Fluffy Video Web site allowing main HTML page fetched normal way When user clicks hyperlinks browser asks DNS look www cdn com This lookup contacts CDN DNS server returns IP address nearby CDN node The browser sends regular HTTP request CDN node example fluffyvideo koalas mpg The URL identifies page return starting path fluffyvideo CDN node separate requests different companies serves Finally video returned user sees cute fluffy animals The strategy behind split content hosted CDN entry pages hosted content owner gives content owner control letting CDN move bulk data Most entry pages tiny HTML text These pages often link large files videos images It precisely large files served CDN even though use CDN completely transparent users The site looks performs faster SEC 7 5 CONTENT DELIVERY html head title Fluffy Video title head body h1 Fluffy Video Product List h1 p Click free samples p href koalas mpg Koalas Today br href kangaroos mpg Funny Kangaroos br href wombats mpg Nice Wombats br body html html head title Fluffy Video title head body h1 Fluffy Video Product List h1 p Click free samples p href http www cdn com fluffyvideo koalas mpg Koalas Today br href http www cdn com fluffyvideo kangaroos mpg Funny Kangaroos br href http www cdn com fluffyvideo wombats mpg Nice Wombats br body html b Original Web page b Same page linking CDN There another advantage sites using shared CDN The future demand Web site difficult predict Frequently surges demand known flash crowds Such surge may happen latest product released fashion show event company otherwise news Even Web site previously unknown unvisited backwater suddenly become focus Internet newsworthy linked popular sites Since sites prepared handle massive increases traffic result many crash traffic surges Case point Normally Florida Secretary State Web site busy place although look information Florida corporations notaries cultural affairs well information voting elections For odd reason Nov 7 2000 date U S presidential election Bush vs Gore whole lot people suddenly interested election results page site The site suddenly became one busiest Web sites world naturally crashed result If using CDN would probably survived By using CDN site access large content serving capacity The largest CDNs tens thousands servers deployed countries world Since small number sites experiencing flash crowd 748 THE APPLICATION LAYER one time definition sites may use CDN capacity handle load storm passes That CDN quickly scale site serving capacity The preceding discussion simplified description Akamai works There many details matter practice The CDN nodes pictured example normally clusters machines DNS redirection done two levels one map clients approximate network location another spread load nodes location Both reliability performance concerns To able shift client one machine cluster another DNS replies second level given short TTLs client repeat resolution short Finally concentrated distributing static objects like images videos CDNs also support dynamic page creation streaming media For information CDNs see Dilley et al 2002 7 5 4 Peer Peer Networks Not everyone set 1000 node CDN locations around world distribute content Actually hard rent 1000 virtual machines around globe well developed competitive hosting industry However setting CDN starts getting nodes Luckily alternative rest us simple use distribute tremendous amount content It P2P Peer Peer network P2P networks burst onto scene starting 1999 The first widespread application mass crime 50 million Napster users exchanging copyrighted songs without copyright owners permission Napster shut courts amid great controversy Nevertheless peer peer technology many interesting legal uses Other systems continued development great interest users P2P traffic quickly eclipsed Web traffic Today BitTorrent popular P2P protocol It used widely share licensed public domain videos well content accounts large fraction Internet traffic We look section The basic idea P2P Peer Peer file sharing network many computers come together pool resources form content distribution system The computers often simply home computers They need machines Internet data centers The computers called peers one alternately act client another peer fetching content server providing content peers What makes peer peer systems interesting dedicated infrastructure unlike CDN Everyone participates task distributing content often central point control Many people excited P2P technology seen empowering little guy The reason takes large company run SEC 7 5 CONTENT DELIVERY CDN anyone computer join P2P network It P2P networks formidable capacity distribute content match largest Web sites Consider P2P network made N average users broadband connectivity 1 Mbps The aggregate upload capacity P2P network rate users send traffic Internet N Mbps The download capacity rate users receive traffic also N Mbps Each user upload download time 1 Mbps link direction It obvious true turns capacity used productively distribute content even case sharing single copy file users To see imagine users organized binary tree non leaf user sending two users The tree carry single copy file users To use upload bandwidth many users possible times hence distribute large file low latency need pipeline network activity users Imagine file divided 1000 pieces Each user receive new piece somewhere tree send previously received piece tree time This way pipeline started small number pieces equal depth tree sent non leaf users busy uploading file users Since approximately N 2 non leaf users upload bandwidth tree N 2 Mbps We repeat trick create another tree uses N 2 Mbps upload bandwidth swapping roles leaf non leaf nodes Together construction uses capacity This argument means P2P networks self scaling Their usable upload capacity grows tandem download demands made users They always large enough sense without need dedicated infrastructure In contrast capacity even large Web site fixed either large small Consider site 100 clusters capable 10 Gbps This enormous capacity help small number users The site get information N users rate faster N Mbps limit users Web site And one million 1 Mbps users Web site pump data fast enough keep users busy downloading That may seem like large number users large BitTorrent networks e g Pirate Bay claim 10 000 000 users That like 10 terabits sec terms example You take back envelope numbers grain better yet metric ton salt oversimplify situation A significant challenge P2P networks use bandwidth well users come shapes sizes different download upload capacities Nevertheless numbers indicate enormous potential P2P 750 THE APPLICATION LAYER There another reason P2P networks important CDNs centrally run services put providers position trove personal information many users browsing preferences people shop online people locations email addresses This information used provide better personalized service used intrude people privacy The latter may happen either intentionally say part new product accidental disclosure compromise With P2P systems single provider capable monitoring entire system This mean P2P systems necessarily provide privacy users trusting extent It means provide different form privacy centrally managed systems P2P systems explored services beyond file sharing e g storage streaming time tell whether advantage significant P2P technology followed two related paths developed On practical side systems used every day The well known systems based BitTorrent protocol On academic side intense interest DHT Distributed Hash Table algorithms let P2P systems perform well whole yet rely centralized components We look technologies BitTorrent The BitTorrent protocol developed Brahm Cohen 2001 let set peers share files quickly easily There dozens freely available clients speak protocol many browsers speak HTTP protocol Web servers The protocol available open standard www bittorrent org In typical peer peer system like formed BitTorrent users information may interest users This information may free software music videos photographs There three problems need solved share content setting 1 How peer find peers content wants download 2 How content replicated peers provide high speed downloads everyone 3 How peers encourage upload content others well download content The first problem exists peers content least initially The approach taken BitTorrent every content provider create content description called torrent The torrent much smaller SEC 7 5 CONTENT DELIVERY content used peer verify integrity data downloads peers Other users want download content must first obtain torrent say finding Web page advertising content The torrent file specified format contains two key kinds information One kind name tracker server leads peers content torrent The kind information list equal sized pieces chunks make content Different chunk sizes used different torrents typically 64 KB 512 KB The torrent file contains name chunk given 160 bit SHA 1 hash chunk We cover cryptographic hashes SHA 1 Chap 8 For think hash longer secure checksum Given size chunks hashes torrent file least three orders magnitude smaller content transferred quickly To download content described torrent peer first contacts tracker torrent The tracker server maintains list peers actively downloading uploading content This set peers called swarm The members swarm contact tracker regularly report still active well leave swarm When new peer contacts tracker join swarm tracker tells peers swarm Getting torrent contacting tracker first two steps downloading content shown 1 Get torrent metafile Unchoked peers Torrent 3 Trade chunks peers 2 Get peers tracker Peer Source content Tracker Seed peer BitTorrent The second problem share content way gives rapid downloads When swarm first formed peers must chunks make content These peers called seeders Other peers join swarm chunks peers downloading content While peer participates swarm simultaneously downloads chunks missing peers uploads chunks peers 752 THE APPLICATION LAYER need This trading shown last step content distribution Fig 770 Over time peer gathers chunks downloaded content The peer leave swarm return time Normally peer stay short period finishes download With peers coming going rate churn swarm quite high For method work well chunk available many peers If everyone get chunks order likely many peers would depend seeders next chunk This would create bottleneck Instead peers exchange lists chunks Then select rare chunks hard find download The idea downloading rare chunk make copy make chunk easier peers find download If peers short chunks widely available The third problem perhaps interesting CDN nodes set exclusively provide content users P2P nodes They users computers users may interested getting movie helping users downloads Nodes take resources system without contributing kind called free riders leechers If many system function well Earlier P2P systems known host Saroiu et al 2003 BitTorrent sought minimize The approach taken BitTorrent clients reward peers show good upload behavior Each peer randomly samples peers retrieving chunks uploads chunks The peer continues trade chunks small number peers provide highest download performance also randomly trying peers find good partners Randomly trying peers also allows newcomers obtain initial chunks trade peers The peers node currently exchanging chunks said unchoked Over time algorithm intended match peers comparable upload download rates The peer contributing peers expect return Using set peers also helps saturate peer download bandwidth high performance Conversely peer uploading chunks peers slowly cut choked sooner later This strategy discourages antisocial behavior peers free ride swarm The choking algorithm sometimes described implementing tit tat strategy encourages cooperation repeated interactions However prevent clients gaming system strong sense Piatek et al 2007 Nonetheless attention issue mechanisms make difficult casual users free ride likely contributed success BitTorrent As see discussion BitTorrent comes rich vocabulary There torrents swarms leechers seeders trackers well snubbing SEC 7 5 CONTENT DELIVERY choking lurking For information see short paper BitTorrent Cohen 2003 look Web starting www bittorrent org DHTs Distributed Hash Tables The emergence P2P file sharing networks around 2000 sparked much interest research community The essence P2P systems avoid centrally managed structures CDNs systems This significant advantage Centrally managed components become bottleneck system grows large single point failure Central components also used point control e g shut P2P network However early P2P systems partly decentralized fully decentralized inefficient The traditional form BitTorrent described uses peer peer transfers centralized tracker swarm It tracker turns hard part decentralize peer peer system The key problem find peers specific content sought For example user might one data items songs photographs programs files users might want read How users find Making one index simple centralized Having every peer keep index help True distributed However requires much work keep indexes peers date content moved system worth effort The question tackled research community whether possible build P2P indexes entirely distributed performed well By perform well mean three things First node keeps small amount information nodes This property means expensive keep index date Second node look entries index quickly Otherwise useful index Third node use index time even nodes come go This property means performance index grows number nodes The answer question Yes Four different solutions invented 2001 They Chord Stoica et al 2001 CAN Ratnasamy et al 2001 Pastry Rowstron Druschel 2001 Tapestry Zhao et al 2004 Other solutions invented soon afterwards including Kademlia used practice Maymounkov Mazieres 2002 The solutions known DHTs Distributed Hash Tables basic functionality index map key value This like hash table solutions distributed versions course DHTs work imposing regular structure communication nodes see This behavior quite different traditional P2P networks use whatever connections peers happen make 754 THE APPLICATION LAYER For reason DHTs called structured P2P networks Traditional P2P protocols build unstructured P2P networks The DHT solution describe Chord As scenario consider replace centralized tracker traditionally used BitTorrent fully distributed tracker Chord used solve problem In scenario overall index listing swarms computer may join download content The key used look index torrent description content It uniquely identifies swarm content downloaded hashes content chunks The value stored index key list peers comprise swarm These peers computers contact download content A person wanting download content movie torrent description The question DHT must answer lacking central database person find peers millions BitTorrent nodes download movie A Chord DHT consists n participating nodes They nodes running BitTorrent scenario Each node IP address may contacted The overall index spread across nodes This implies node stores bits pieces index use nodes The key part Chord navigates index using identifiers virtual space IP addresses nodes names content like movies Conceptually identifiers simply bit numbers arranged ascending order ring To turn node address identifier mapped bit number using hash function hash Chord uses SHA 1 hash This hash mentioned describing BitTorrent We look discuss cryptography Chap 8 For suffice say function takes variable length byte string argument produces highly random 160 bit number Thus use convert IP address 160 bit number called node identifier In show node identifier circle 5 Just ignore arcs middle moment Some identifiers correspond nodes In example nodes identifiers 1 4 7 12 15 20 27 correspond actual nodes shaded figure rest exist Let us define function successor k node identifier first actual node following k around circle clockwise For example successor 6 7 successor 8 12 successor 22 27 A key also produced hashing content name hash e SHA 1 generate 160 bit number In scenario content name torrent Thus order convert torrent torrent description file key compute key hash torrent This computation local procedure call hash To start new swarm node needs insert new key value pair consisting torrent IP address index To accomplish node asks successor hash torrent store IP address In way index distributed nodes random For fault tolerance p different hash functions 2 0 1 2 2 3 Node 1 finger table Node 4 finger table 19 0 1 13 ddr su cc es IP 2 3 ar r St IP 4 Node identifier ar 24 St 0 1 ddr su cc es ddr su cc es r ar IP 30 Actual node CONTENT DELIVERY St Node 12 finger table b A set 32 node identifiers arranged circle The shaded ones correspond actual machines The arcs show fingers nodes 1 4 12 The labels arcs table indices b Examples finger tables could used store data p nodes consider subject fault tolerance Some time DHT constructed another node wants find torrent join swarm download content A node looks torrent first hashing get key second using successor key find IP address node storing corresponding value The value list peers swarm node add IP address list contact peers download content BitTorrent protocol The first step easy second one easy To make possible find IP address node corresponding certain key node required 756 THE APPLICATION LAYER maintain certain administrative data structures One IP address successor node along node identifier circle For example node 4 successor 7 node 7 successor 12 Lookup proceed follows The requesting node sends packet successor containing IP address key looking The packet propagated around ring locates successor node identifier sought That node checks see information matching key returns directly requesting node whose IP address However linearly searching nodes inefficient large peerto peer system since mean number nodes required per search n 2 To greatly speed search node also maintains Chord calls finger table The finger table entries indexed 0 1 one pointing different actual node Each entries two fields start IP address successor start shown three example nodes b The values fields entry node identifier k start k 2i modulo 2m IP address successor start Note node stores IP addresses relatively small number nodes fairly close terms node identifier Using finger table lookup key node k proceeds follows If key falls k successor k node holding information key successor k search terminates Otherwise finger table searched find entry whose start field closest predecessor key A request sent directly IP address finger table entry ask continue search Since closer key still chances good able return answer small number additional queries In fact since every lookup halves remaining distance target shown average number lookups log2 n As first example consider looking key 3 node 1 Since node 1 knows 3 lies successor 4 desired node 4 search terminates returning node 4 IP address As second example consider looking key 16 node 1 Since 16 lie 1 4 finger table consulted The closest predecessor 16 9 request forwarded IP address 9 entry namely node 12 Node 12 also know answer looks node closely preceding 16 finds 14 yields IP address node 15 A query sent Node 15 observes 16 lies successor 20 returns IP address 20 caller works way back node 1 Since nodes join leave time Chord needs way handle operations We assume system began operation small enough nodes could exchange information directly build first circle SEC 7 5 CONTENT DELIVERY finger tables After automated procedure needed When new node r wants join must contact existing node ask look IP address successor r Next new node asks successor r predecessor The new node asks insert r circle For example 24 wants join asks node look successor 24 27 Then asks 27 predecessor 20 After tells existence 20 uses 24 successor 27 uses 24 predecessor In addition node 27 hands keys range 21 24 belong 24 At point 24 fully inserted However many finger tables wrong To correct every node runs background process periodically recomputes finger calling successor When one queries hits new node corresponding finger entry updated When node leaves gracefully hands keys successor informs predecessor departure predecessor link departing node successor When node crashes problem arises predecessor longer valid successor To alleviate problem node keeps track direct successor also direct successors allow skip 1 consecutive failed nodes reconnect circle disaster strikes There tremendous amount research DHTs since invented To give idea much research let us pose question cited networking paper time You find difficult come paper cited seminal Chord paper Stoica et al 2001 Despite veritable mountain research applications DHTs slowly beginning emerge Some BitTorrent clients use DHTs provide fully distributed tracker kind described Large commercial cloud services Amazon Dynamo also incorporate DHT techniques DeCandia et al 2007 7 6 SUMMARY Naming ARPANET started simple way ASCII text file listed names hosts corresponding IP addresses Every night machines downloaded file But ARPANET morphed Internet exploded size far sophisticated dynamic naming scheme required The one used hierarchical scheme called Domain Name System It organizes machines Internet set trees At top level well known generic domains including com edu well 200 country domains DNS implemented distributed database servers world By querying DNS server process 758 THE APPLICATION LAYER map Internet domain name onto IP address used communicate computer domain Email original killer app Internet It still widely used everyone small children grandparents Most email systems world use mail system defined RFCs 5321 5322 Messages simple ASCII headers many kinds content sent using MIME Mail submitted message transfer agents delivery retrieved presentation variety user agents including Web applications Submitted mail delivered using SMTP works making TCP connection sending message transfer agent receiving one The Web application people think Internet Originally system seamlessly linking hypertext pages written HTML across machines The pages downloaded making TCP connection browser server using HTTP Nowadays much content Web produced dynamically either server e g PHP browser e g JavaScript When combined back end databases dynamic server pages allow Web applications e commerce search Dynamic browser pages evolving full featured applications email run inside browser use Web protocols communicate remote servers Caching persistent connections widely used enhance Web performance Using Web mobile devices challenging despite growth bandwidth processing power mobiles Web sites often send tailored versions pages smaller images less complex navigation devices small displays The Web protocols increasingly used machine machine communication XML preferred HTML description content easy machines process SOAP RPC mechanism sends XML messages using HTTP Digital audio video key drivers Internet since 2000 The majority Internet traffic today video Much streamed Web sites mix protocols including RTP UDP RTP HTTP TCP Live media streamed many consumers It includes Internet radio TV stations broadcast manner events Audio video also used real time conferencing Many calls use voice IP rather traditional telephone network include videoconferencing There small number tremendously popular Web sites well large number less popular ones To serve popular sites content distribution networks deployed CDNs use DNS direct clients nearby server servers placed data centers around world Alternatively P2P networks let collection machines share content movies among They provide content distribution capacity scales number machines P2P network rival largest sites CHAP 7 PROBLEMS PROBLEMS 1 Many business computers three distinct worldwide unique identifiers What 2 In period laserjet Why 3 Consider situation cyberterrorist makes DNS servers world crash simultaneously How change one ability use Internet 4 DNS uses UDP instead TCP If DNS packet lost automatic recovery Does cause problem solved 5 John wants original domain name uses randomized program generate secondary domain name He wants register domain name com generic domain The domain name generated 253 characters long Will com registrar allow domain name registered 6 Can machine single DNS name multiple IP addresses How could occur 7 The number companies Web site grown explosively recent years As result thousands companies registered com domain causing heavy load top level server domain Suggest way alleviate problem without changing naming scheme e without introducing new top level domain names It permitted solution requires changes client code 8 Some email systems support Content Return header field It specifies whether body message returned event nondelivery Does field belong envelope header 9 Electronic mail systems need directories people email addresses looked To build directories names broken standard components e g first name last name make searching possible Discuss problems must solved worldwide standard acceptable 10 A large law firm many employees provides single email address employee Each employee email address login lawfirm com However firm explicitly define format login Thus employees use first names login names use last names use initials etc The firm wishes make fixed format example firstname lastname lawfirm com used email addresses employees How done without rocking boat much 11 A binary file 4560 bytes long How long encoded using base64 encoding CR LF pair inserted every 110 bytes sent end 12 Name five MIME types listed book You check browser Internet information 760 PROBLEMS 13 Suppose want send MP3 file friend friend ISP limits size incoming message 1 MB MP3 file 4 MB Is way handle situation using RFC 5322 MIME 14 Suppose John set auto forwarding mechanism work email address receives business related emails forward personal email address shares wife John wife unaware activated vacation agent personal account Because John forwarded email set vacation daemon work machine What happens email received John work email address 15 In standard RFC 5322 precise grammar allowed needed different implementations interwork Even simple items defined carefully The SMTP headers allow white space tokens Give two plausible alternative definitions white space tokens 16 Is vacation agent part user agent message transfer agent Of course set using user agent user agent actually send replies Explain answer 17 In simple version Chord algorithm peer peer lookup searches use finger table Instead linear around circle either direction Can node accurately predict direction search Discuss answer 18 IMAP allows users fetch download email remote mailbox Does mean internal format mailboxes standardized IMAP program client side read mailbox mail server Discuss answer 19 Consider Chord circle Suppose node 18 suddenly goes online Which finger tables shown figure affected 20 Does Webmail use POP3 IMAP neither If one one chosen If neither one closer spirit 21 When Web pages sent prefixed MIME headers Why 22 Is possible user clicks link Firefox particular helper started clicking link Internet Explorer causes completely different helper started even though MIME type returned cases identical Explain answer 23 Although mentioned text alternative form URL use IP address instead DNS name Use information explain DNS name end digit 24 Imagine someone math department Stanford written new document including proof wants distribute FTP colleagues review He puts program FTP directory ftp pub forReview newProof pdf What URL program likely 25 In www aportal com keeps track user preferences cookie A disadvantage scheme cookies limited 4 KB preferences CHAP 7 PROBLEMS extensive example many stocks sports teams types news stories weather multiple cities specials numerous product categories 4 KB limit may reached Design alternative way keep track preferences problem 26 Sloth Bank wants make online banking easy lazy customers customer signs authenticated password bank returns cookie containing customer ID number In way customer identify type password future visits online bank What think idea Will work Is good idea 27 Consider following HTML tag h1 title header HEADER 1 h1 Under conditions browser use TITLE attribute b How TITLE attribute differ ALT attribute 28 How make image clickable HTML Give example 29 Write HTML page includes link email address username DomainName com What happens user clicks link 30 Write XML page university registrar listing multiple students name address GPA 31 For following applications tell whether would 1 possible 2 better use PHP script JavaScript Displaying calendar requested month since September 1752 b Displaying schedule flights Amsterdam New York c Graphing polynomial user supplied coefficients 32 Write program JavaScript accepts integer greater 2 tells whether prime number Note JavaScript statements syntax C Java The modulo operator If need square root x use Math sqrt x 33 An HTML page follows html body href www info source com welcome html Click info body html If user clicks hyperlink TCP connection opened series lines sent server List lines sent 34 The If Modified Since header used check whether cached page still valid Requests made pages containing images sound video well HTML Do think effectiveness technique better worse JPEG images compared HTML Think carefully effectiveness means explain answer 35 On day major sporting event championship game popular sport many people go official Web site Is flash crowd sense 2000 Florida presidential election Why 762 PROBLEMS 36 Does make sense single ISP function CDN If would work If wrong idea 37 Assume compression used audio CDs How many MB data must compact disc contain order able play two hours music 38 In c quantization noise occurs due use 4 bit samples represent nine signal values The first sample 0 exact next What percent error samples 1 32 2 32 3 32 period 39 Could psychoacoustic model used reduce bandwidth needed Internet telephony If conditions would met make work If 40 An audio streaming server one way distance 100 msec media player It outputs 1 Mbps If media player 2 MB buffer say position low water mark high water mark 41 Does voice IP problems firewalls streaming audio Discuss answer 42 What bit rate transmitting uncompressed 1200 800 pixel color frames 16 bits pixel 50 frames sec 43 Can 1 bit error MPEG frame affect frame error occurs Explain answer 44 Consider 50 000 customer video server customer watches three movies per month Two thirds movies served 9 P M How many movies server transmit time period If movie requires 6 Mbps many OC 12 connections server need network 45 Suppose Zipf law holds accesses 10 000 movie video server If server holds popular 1000 movies memory remaining 9000 disk give expression fraction references memory Write little program evaluate expression numerically 46 Some cybersquatters registered domain names misspellings common corporate sites example www microsfot com Make list least five domains 47 Numerous people registered DNS names consist www word com word common word For following categories list five Web sites briefly summarize e g www stomach com belongs gastroenterologist Long Island Here list categories animals foods household objects body parts For last category please stick body parts waist 48 Rewrite server true Web server using GET command HTTP 1 1 It also accept Host message The server maintain cache files recently fetched disk serve requests cache possible 8 NETWORK SECURITY For first decades existence computer networks primarily used university researchers sending email corporate employees sharing printers Under conditions security get lot attention But millions ordinary citizens using networks banking shopping filing tax returns weakness weakness found network security become problem massive proportions In chapter study network security several angles point numerous pitfalls discuss many algorithms protocols making networks secure Security broad topic covers multitude sins In simplest form concerned making sure nosy people read worse yet secretly modify messages intended recipients It concerned people trying access remote services authorized use It also deals ways tell whether message purportedly IRS Pay Friday else really IRS Mafia Security also deals problems legitimate messages captured replayed people later trying deny sent certain messages Most security problems intentionally caused malicious people trying gain benefit get attention harm someone A common perpetrators listed It clear list making network secure involves lot keeping free programming errors It involves outsmarting often intelligent dedicated sometimes wellfunded adversaries It also clear measures thwart casual 764 NETWORK SECURITY attackers little impact serious ones Police records show damaging attacks perpetrated outsiders tapping phone line insiders bearing grudge Security systems designed accordingly Adversary Goal Student To fun snooping people email Cracker To test someone security system steal data Sales rep To claim represent Europe Andorra Corporation To discover competitor strategic marketing plan Ex employee To get revenge fired Accountant To embezzle money company Stockbroker To deny promise made customer email Identity thief To steal credit card numbers sale Government To learn enemy military industrial secrets Terrorist To steal biological warfare secrets Some people may cause security problems Network security problems divided roughly four closely intertwined areas secrecy authentication nonrepudiation integrity control Secrecy also called confidentiality keeping information grubby little hands unauthorized users This usually comes mind people think network security Authentication deals determining talking revealing sensitive information entering business deal Nonrepudiation deals signatures prove customer really placed electronic order ten million left handed doohickeys 89 cents later claims price 69 cents Or maybe claims never placed order Finally integrity control sure message received really one sent something malicious adversary modified transit concocted All issues secrecy authentication nonrepudiation integrity control occur traditional systems significant differences Integrity secrecy achieved using registered mail locking documents Robbing mail train harder Jesse James day Also people usually tell difference original paper document photocopy often matters As test make photocopy valid check Try cashing original check bank Monday Now try cashing photocopy check Tuesday Observe difference bank behavior With electronic checks original copy indistinguishable It may take banks learn handle People authenticate people various means including recognizing faces voices handwriting Proof signing handled signatures letterhead paper raised seals Tampering usually detected 765 handwriting ink paper experts None options available electronically Clearly solutions needed Before getting solutions worth spending moments considering protocol stack network security belongs There probably one single place Every layer something contribute In physical layer wiretapping foiled enclosing transmission lines better yet optical fibers sealed tubes containing inert gas high pressure Any attempt drill tube release gas reducing pressure triggering alarm Some military systems use technique In data link layer packets point point line encrypted leave one machine decrypted enter another All details handled data link layer higher layers oblivious going This solution breaks packets traverse multiple routers however packets decrypted router leaving vulnerable attacks within router Also allow sessions protected e g involving online purchases credit card others Nevertheless link encryption method called added network easily often useful In network layer firewalls installed keep good packets bad packets IP security also functions layer In transport layer entire connections encrypted end end process process For maximum security end end security required Finally issues user authentication nonrepudiation handled application layer Since security fit neatly layer fit chapter book For reason rates chapter While chapter long technical essential also quasi irrelevant moment It well documented security failures banks example due lax security procedures incompetent employees numerous implementation bugs enable remote break ins unauthorized users socalled social engineering attacks customers tricked revealing account details All security problems prevalent clever criminals tapping phone lines decoding encrypted messages If person walk random branch bank ATM slip found street claiming forgotten PIN get new one spot name good customer relations cryptography world prevent abuse In respect Ross Anderson 2008a book real eye opener documents hundreds examples security failures numerous industries nearly due might politely called sloppy business practices inattention security Nevertheless technical foundation e commerce built factors done well cryptography Except physical layer security nearly network security based cryptographic principles For reason begin study security 766 NETWORK SECURITY examining cryptography detail In Sec 8 1 look basic principles In Sec 8 2 Sec 8 5 examine fundamental algorithms data structures used cryptography Then examine detail concepts used achieve security networks We conclude brief thoughts technology society Before starting one last thought order covered We tried focus networking issues rather operating system application issues although line often hard draw For example nothing user authentication using biometrics password security buffer overflow attacks Trojan horses login spoofing code injection cross site scripting viruses worms like All topics covered length Chap 9 Modern Operating Systems Tanenbaum 2007 The interested reader referred book systems aspects security Now let us begin journey 8 1 CRYPTOGRAPHY Cryptography comes Greek words secret writing It long colorful history going back thousands years In section sketch highlights background information follows For complete history cryptography Kahn 1995 book recommended reading For comprehensive treatment modern security cryptographic algorithms protocols applications related material see Kaufman et al 2002 For mathematical approach see Stinson 2002 For less mathematical approach see Burnett Paine 2001 Professionals make distinction ciphers codes A cipher character character bit bit transformation without regard linguistic structure message In contrast code replaces one word another word symbol Codes used although glorious history The successful code ever devised used U S armed forces World War II Pacific They simply Navajo Indians talking using specific Navajo words military terms example chay dagahi nail tsaidi literally tortoise killer antitank weapon The Navajo language highly tonal exceedingly complex written form And single person Japan knew anything In September 1945 San Diego Union described code saying For three years wherever Marines landed Japanese got earful strange gurgling noises interspersed sounds resembling call Tibetan monk sound hot water bottle emptied The Japanese never broke code many Navajo code talkers awarded high military honors extraordinary service bravery The fact U S broke Japanese code Japanese never broke Navajo code played crucial role American victories Pacific SEC 8 1 CRYPTOGRAPHY 8 1 1 Introduction Cryptography Historically four groups people used contributed art cryptography military diplomatic corps diarists lovers Of military important role shaped field centuries Within military organizations messages encrypted traditionally given poorly paid low level code clerks encryption transmission The sheer volume messages prevented work done elite specialists Until advent computers one main constraints cryptography ability code clerk perform necessary transformations often battlefield little equipment An additional constraint difficulty switching quickly one cryptographic method another one since entails retraining large number people However danger code clerk captured enemy made essential able change cryptographic method instantly need These conflicting requirements given rise model Passive intruder listens Plaintext P Active intruder alter messages Intruder Encryption method E Decryption method D Plaintext P Ciphertext C EK P Encryption key K Decryption key K The encryption model symmetric key cipher The messages encrypted known plaintext transformed function parameterized key The output encryption process known ciphertext transmitted often messenger radio We assume enemy intruder hears accurately copies complete ciphertext However unlike intended recipient know decryption key decrypt ciphertext easily Sometimes intruder listen communication channel passive intruder also record messages play back later inject messages modify legitimate messages get receiver active intruder The art 768 NETWORK SECURITY breaking ciphers known cryptanalysis art devising cryptography collectively known cryptology It often useful notation relating plaintext ciphertext keys We use C EK P mean encryption plaintext P using key K gives ciphertext C Similarly P DK C represents decryption C get plaintext It follows DK EK P P This notation suggests E D mathematical functions The tricky part functions two parameters written one parameters key subscript rather argument distinguish message A fundamental rule cryptography one must assume cryptanalyst knows methods used encryption decryption In words cryptanalyst knows encryption method E decryption D work detail The amount effort necessary invent test install new algorithm every time old method compromised thought compromised always made impractical keep encryption algorithm secret Thinking secret harm good This key enters The key consists relatively short string selects one many potential encryptions In contrast general method may changed every years key changed often required Thus basic model stable publicly known general method parameterized secret easily changed key The idea cryptanalyst knows algorithms secrecy lies exclusively keys called Kerckhoff principle named Flemish military cryptographer Auguste Kerckhoff first stated 1883 Kerckhoff 1883 Thus Kerckhoff principle All algorithms must public keys secret The nonsecrecy algorithm emphasized enough Trying keep algorithm secret known trade security obscurity never works Also publicizing algorithm cryptographer gets free consulting large number academic cryptologists eager break system publish papers demonstrating smart If many experts tried break algorithm long time publication one succeeded probably pretty solid Since real secrecy key length major design issue Consider simple combination lock The general principle enter digits sequence Everyone knows key secret A key length two digits means 100 possibilities A key length three digits means 1000 possibilities key length six digits means million The longer key higher work factor cryptanalyst deal The work factor breaking system exhaustive search key space exponential SEC 8 1 CRYPTOGRAPHY key length Secrecy comes strong public algorithm long key To prevent kid brother reading email 64 bit keys For routine commercial use least 128 bits used To keep major governments bay keys least 256 bits preferably needed From cryptanalyst point view cryptanalysis problem three principal variations When quantity ciphertext plaintext confronted ciphertext problem The cryptograms appear puzzle section newspapers pose kind problem When cryptanalyst matched ciphertext plaintext problem called known plaintext problem Finally cryptanalyst ability encrypt pieces plaintext choosing chosen plaintext problem Newspaper cryptograms could broken trivially cryptanalyst allowed ask questions What encryption ABCDEFGHIJKL Novices cryptography business often assume cipher withstand ciphertext attack secure This assumption naive In many cases cryptanalyst make good guess parts plaintext For example first thing many computers say call login Equipped matched plaintext ciphertext pairs cryptanalyst job becomes much easier To achieve security cryptographer conservative make sure system unbreakable even opponent encrypt arbitrary amounts chosen plaintext Encryption methods historically divided two categories substitution ciphers transposition ciphers We deal briefly background information modern cryptography 8 1 2 Substitution Ciphers In substitution cipher letter group letters replaced another letter group letters disguise One oldest known ciphers Caesar cipher attributed Julius Caesar With method becomes D b becomes E c becomes F z becomes C For example attack becomes DWWDFN In examples plaintext given lowercase letters ciphertext uppercase letters A slight generalization Caesar cipher allows ciphertext alphabet shifted k letters instead always three In case k becomes key general method circularly shifted alphabets The Caesar cipher may fooled Pompey fooled anyone since The next improvement symbols plaintext say 26 letters simplicity map onto letter For example plaintext ciphertext b c e f g h j k l mn p q r u vwx z QW E R T Y U I O P A S D F G H J K L Z X C V B NM 770 NETWORK SECURITY The general system symbol symbol substitution called monoalphabetic substitution cipher key 26 letter string corresponding full alphabet For key given plaintext attack would transformed ciphertext QZZQEA At first glance might appear safe system although cryptanalyst knows general system letter letter substitution know 26 4 1026 possible keys use In contrast Caesar cipher trying promising approach Even 1 nsec per solution million computer chips working parallel would take 10 000 years try keys Nevertheless given surprisingly small amount ciphertext cipher broken easily The basic attack takes advantage statistical properties natural languages In English example e common letter followed n etc The common two letter combinations digrams th er The common three letter combinations trigrams ing ion A cryptanalyst trying break monoalphabetic cipher would start counting relative frequencies letters ciphertext Then might tentatively assign common one e next common one He would look trigrams find common one form tXe strongly suggests X h Similarly pattern thYt occurs frequently Y probably stands With information look frequently occurring trigram form aZW likely By making guesses common letters digrams trigrams knowing likely patterns vowels consonants cryptanalyst builds tentative plaintext letter letter Another approach guess probable word phrase For example consider following ciphertext accounting firm blocked groups five characters CTBMN BYCTC BT JDS QXBNS GST JC BTSWX CTQTZ CQVU J QJ SGS T JQZZ MNQJ S VLNSX VSZ J U JDSTS JQUUS J UBX J DSKSU J SNTK BGAQJ ZBGYQ T LCTZ BNYBN QJ SW A likely word message accounting firm financial Using knowledge financial repeated letter four letters occurrences look repeated letters ciphertext spacing We find 12 hits positions 6 15 27 31 42 48 56 66 70 71 76 82 However two 31 42 next letter corresponding n plaintext repeated proper place Of two 31 also correctly positioned know financial begins position 30 From point deducing key easy using frequency statistics English text looking nearly complete words finish SEC 8 1 CRYPTOGRAPHY 8 1 3 Transposition Ciphers Substitution ciphers preserve order plaintext symbols disguise Transposition ciphers contrast reorder letters disguise depicts common transposition cipher columnar transposition The cipher keyed word phrase containing repeated letters In example MEGABUCK key The purpose key order columns column 1 key letter closest start alphabet The plaintext written horizontally rows padded fill matrix need The ciphertext read columns starting column whose key letter lowest M E G A B U C K 7 4 5 1 2 8 3 6 p l e e r n f e r n e l l n l r w l b n k c c u n w b c x w Plaintext pleasetransferonemilliondollarsto myswissbankaccountsixtwotwo Ciphertext AFLLSKSOSELAWAIATOOSSCTCLNMOMANT ESILYNTWRNNTSOWDPAEDOBUOERIRICXB A transposition cipher To break transposition cipher cryptanalyst must first aware dealing transposition cipher By looking frequency E T A O I N etc easy see fit normal pattern plaintext If cipher clearly transposition cipher cipher every letter represents keeping frequency distribution intact The next step make guess number columns In many cases probable word phrase may guessed context For example suppose cryptanalyst suspects plaintext phrase milliondollars occurs somewhere message Observe digrams MO IL LL LA IR OS occur ciphertext result phrase wrapping around The ciphertext letter O follows ciphertext letter M e vertically adjacent column 4 separated probable phrase distance equal key length If key length seven used digrams MD IO LL LL IA OR NS would occurred instead In fact key length different set digrams produced ciphertext By hunting various possibilities cryptanalyst often easily determine key length 772 NETWORK SECURITY The remaining step order columns When number columns k small k k 1 column pairs examined turn see digram frequencies match English plaintext The pair best match assumed correctly positioned Now remaining columns tentatively tried successor pair The column whose digram trigram frequencies give best match tentatively assumed correct The next column found way The entire process continued potential ordering found Chances plaintext recognizable point e g milloin occurs clear error Some transposition ciphers accept fixed length block input produce fixed length block output These ciphers completely described giving list telling order characters output For example cipher seen 64 character block cipher Its output 4 12 20 28 36 44 52 60 5 13 62 In words fourth input character first output followed twelfth f 8 1 4 One Time Pads Constructing unbreakable cipher actually quite easy technique known decades First choose random bit string key Then convert plaintext bit string example using ASCII representation Finally compute XOR eXclusive OR two strings bit bit The resulting ciphertext broken sufficiently large sample ciphertext letter occur equally often every digram every trigram This method known one time pad immune present future attacks matter much computational power intruder The reason derives information theory simply information message possible plaintexts given length equally likely An example one time pads used given First message 1 I love converted 7 bit ASCII Then one time pad pad 1 chosen XORed message get ciphertext A cryptanalyst could try possible one time pads see plaintext came one For example one time pad listed pad 2 figure could tried resulting plaintext 2 Elvis lives may may plausible subject beyond scope book In fact every 11 character ASCII plaintext one time pad generates That mean saying information ciphertext get message correct length One time pads great theory number disadvantages practice To start key memorized sender receiver must carry written copy If either one subject capture written keys clearly undesirable Additionally total amount data transmitted limited amount key available If spy strikes rich discovers wealth data may find unable transmit back SEC 8 1 CRYPTOGRAPHY Message 1 1001001 0100000 1101100 1101111 1110110 1100101 0100000 1111001 1101111 1110101 0101110 Pad 1 1010010 1001011 1110010 1010101 1010010 1100011 0001011 0101010 1010111 1100110 0101011 Ciphertext 0011011 1101011 0011110 0111010 0100100 0000110 0101011 1010011 0111000 0010011 0000101 Pad 2 1011110 0000111 1101000 1010011 1010111 0100110 1000111 0111010 1001110 1110110 1110110 Plaintext 2 1000101 1101100 1110110 1101001 1110011 0100000 1101100 1101001 1110110 1100101 1110011 The use one time pad encryption possibility getting possible plaintext ciphertext use pad headquarters key used Another problem sensitivity method lost inserted characters If sender receiver get synchronization data appear garbled With advent computers one time pad might potentially become practical applications The source key could special DVD contains several gigabytes information transported DVD movie box prefixed minutes video would even suspicious Of course gigabit network speeds insert new DVD every 30 sec could become tedious And DVDs must personally carried sender receiver messages sent greatly reduces practical utility Quantum Cryptography Interestingly may solution problem transmit one time pad network comes unlikely source quantum mechanics This area still experimental initial tests promising If perfected made efficient virtually cryptography eventually done using one time pads since provably secure Below briefly explain method quantum cryptography works In particular describe protocol called BB84 authors publication year Bennet Brassard 1984 Suppose user Alice wants establish one time pad second user Bob Alice Bob called principals main characters story For example Bob banker Alice would like business The names Alice Bob used principals virtually every paper book cryptography since Ron Rivest introduced many years ago Rivest et al 1978 Cryptographers love tradition If use Andy Barbara principals one would believe anything chapter So If Alice Bob could establish one time pad could use communicate securely The question establish without previously exchanging DVDs We assume Alice Bob opposite ends 774 NETWORK SECURITY optical fiber send receive light pulses However intrepid intruder Trudy cut fiber splice active tap Trudy read bits sent directions She also send false messages directions The situation might seem hopeless Alice Bob quantum cryptography shed new light subject Quantum cryptography based fact light comes little packets called photons peculiar properties Furthermore light polarized passed polarizing filter fact well known sunglasses wearers photographers If beam light e stream photons passed polarizing filter photons emerging polarized direction filter axis e g vertically If beam passed second polarizing filter intensity light emerging second filter proportional square cosine angle axes If two axes perpendicular photons get The absolute orientation two filters matter angle axes counts To generate one time pad Alice needs two sets polarizing filters Set one consists vertical filter horizontal filter This choice called rectilinear basis A basis plural bases coordinate system The second set filters except rotated 45 degrees one filter runs lower left upper right filter runs upper left lower right This choice called diagonal basis Thus Alice two bases rapidly insert beam In reality Alice four separate filters crystal whose polarization switched electrically four allowed directions great speed Bob equipment Alice The fact Alice Bob two bases available essential quantum cryptography For basis Alice assigns one direction 0 1 In example presented assume chooses vertical 0 horizontal 1 Independently also chooses lower left upper right 0 upper left lower right 1 She sends choices Bob plaintext Now Alice picks one time pad example based random number generator complex subject She transfers bit bit Bob choosing one two bases random bit To send bit photon gun emits one photon polarized appropriately basis using bit For example might choose bases diagonal rectilinear rectilinear diagonal rectilinear etc To send one time pad 1001110010100110 bases would send photons shown Given one time pad sequence bases polarization use bit uniquely determined Bits sent one photon time called qubits Bob know bases use picks one random arriving photon uses shown b If picks correct basis gets correct bit If picks incorrect basis gets random bit SEC 8 1 CRYPTOGRAPHY Bit number Data What Alice sends b Bob bases c What Bob gets No Yes No Yes No e No No Yes Yes No Yes Yes Yes No Yes No Onetime pad Trudy bases f g Correct basis x x x x x x x x Trudy pad An example quantum cryptography photon hits filter polarized 45 degrees polarization randomly jumps polarization filter polarization perpendicular filter equal probability This property photons fundamental quantum mechanics Thus bits correct random Bob know Bob results depicted c How Bob find bases got right got wrong He simply tells Alice basis used bit plaintext tells right wrong plaintext shown From information build bit string correct guesses shown e On average bit string half length original bit string since parties know use one time pad All Alice transmit bit string slightly twice desired length Bob one time pad desired length Done But wait minute We forgot Trudy Suppose curious Alice say cuts fiber inserting detector transmitter Unfortunately know basis use photon either The best pick one random photon Bob An example choices shown f When Bob later reports plaintext bases used Alice tells plaintext ones 776 NETWORK SECURITY correct Trudy knows got right got wrong In got right bits 0 1 2 3 4 6 8 12 13 But knows Alice reply bits 1 3 7 8 10 11 12 14 part one time pad For four bits 1 3 8 12 guessed right captured correct bit For four 7 10 11 14 guessed wrong know bit transmitted Thus Bob knows one time pad starts 01011001 e Trudy 01 1 0 g Of course Alice Bob aware Trudy may captured part one time pad would like reduce information Trudy They performing transformation For example could divide one time pad blocks 1024 bits square one form 2048 bit number use concatenation 2048 bit numbers one time pad With partial knowledge bit string transmitted Trudy way generate square nothing The transformation original one time pad different one reduces Trudy knowledge called privacy amplification In practice complex transformations every output bit depends every input bit used instead squaring Poor Trudy Not idea one time pad presence secret either After must relay received bit Bob trick thinking talking Alice The trouble best transmit qubit received using polarization used receive half time wrong causing many errors Bob one time pad When Alice finally starts sending data encodes using heavy forwarderror correcting code From Bob point view 1 bit error one time pad 1 bit transmission error Either way gets wrong bit If enough forward error correction recover original message despite errors easily count many errors corrected If number far expected error rate equipment knows Trudy tapped line act accordingly e g tell Alice switch radio channel call police etc If Trudy way clone photon one photon inspect identical photon send Bob could avoid detection present way clone photon perfectly known And even Trudy could clone photons value quantum cryptography establish onetime pads would reduced Although quantum cryptography shown operate distances 60 km fiber equipment complex expensive Still idea promise For information quantum cryptography see Mullins 2002 8 1 5 Two Fundamental Cryptographic Principles Although study many different cryptographic systems pages ahead two principles underlying important understand Pay attention You violate peril SEC 8 1 CRYPTOGRAPHY Redundancy The first principle encrypted messages must contain redundancy information needed understand message An example may make clear needed Consider mail order company The Couch Potato TCP 60 000 products Thinking efficient TCP programmers decide ordering messages consist 16byte customer name followed 3 byte data field 1 byte quantity 2 bytes product number The last 3 bytes encrypted using long key known customer TCP At first might seem secure sense passive intruders decrypt messages Unfortunately also fatal flaw renders useless Suppose recently fired employee wants punish TCP firing Just leaving takes customer list She works night writing program generate fictitious orders using real customer names Since list keys puts random numbers last 3 bytes sends hundreds orders TCP When messages arrive TCP computer uses customers name locate key decrypt message Unfortunately TCP almost every 3byte message valid computer begins printing shipping instructions While might seem odd customer order 837 sets children swings 540 sandboxes computer knows customer might planning open chain franchised playgrounds In way active intruder exemployee cause massive amount trouble even though understand messages computer generating This problem solved addition redundancy messages For example order messages extended 12 bytes first 9 must zeros attack longer works ex employee longer generate large stream valid messages The moral story messages must contain considerable redundancy active intruders send random junk interpreted valid message However adding redundancy makes easier cryptanalysts break messages Suppose mail order business highly competitive The Couch Potato main competitor The Sofa Tuber would dearly love know many sandboxes TCP selling taps TCP phone line In original scheme 3 byte messages cryptanalysis nearly impossible guessing key cryptanalyst way telling whether right almost every message technically legal With new 12 byte scheme easy cryptanalyst tell valid message invalid one Thus Cryptographic principle 1 Messages must contain redundancy In words upon decrypting message recipient must able tell whether valid simply inspecting message perhaps performing 778 NETWORK SECURITY simple computation This redundancy needed prevent active intruders sending garbage tricking receiver decrypting garbage acting plaintext However redundancy makes much easier passive intruders break system tension Furthermore redundancy never form n 0s start end message since running messages cryptographic algorithms gives predictable results making cryptanalysts job easier A CRC polynomial much better run 0s since receiver easily verify generates work cryptanalyst Even better use cryptographic hash concept explore later For moment think better CRC Getting back quantum cryptography moment also see redundancy plays role Due Trudy interception photons bits Bob one time pad wrong Bob needs redundancy incoming messages determine errors present One crude form redundancy repeating message two times If two copies identical Bob knows either fiber noisy someone tampering transmission Of course sending everything twice overkill Hamming Reed Solomon code efficient way error detection correction But clear redundancy needed distinguish valid message invalid message especially face active intruder Freshness The second cryptographic principle measures must taken ensure message received verified fresh sent recently This measure needed prevent active intruders playing back old messages If measures taken ex employee could tap TCP phone line keep repeating previously sent valid messages Thus Cryptographic principle 2 Some method needed foil replay attacks One measure including every message timestamp valid say 10 seconds The receiver keep messages around 10 seconds compare newly arrived messages previous ones filter duplicates Messages older 10 seconds thrown since replays sent 10 seconds later rejected old Measures timestamps discussed later 8 2 SYMMETRIC KEY ALGORITHMS Modern cryptography uses basic ideas traditional cryptography transposition substitution emphasis different Traditionally cryptographers used simple algorithms Nowadays reverse true object SEC 8 2 SYMMETRIC KEY ALGORITHMS make encryption algorithm complex involuted even cryptanalyst acquires vast mounds enciphered text choosing able make sense without key The first class encryption algorithms study chapter called symmetric key algorithms use key encryption decryption illustrates use symmetric key algorithm In particular focus block ciphers take n bit block plaintext input transform using key n bit block ciphertext Cryptographic algorithms implemented either hardware speed software flexibility Although treatment concerns algorithms protocols independent actual implementation words building cryptographic hardware may interest Transpositions substitutions implemented simple electrical circuits Figure 86 shows device known P box P stands permutation used effect transposition 8 bit input If 8 bits designated top bottom 01234567 output particular P box 36071245 By appropriate internal wiring P box made perform transposition practically speed light since computation involved signal propagation This design follows Kerckhoff principle attacker knows general method permuting bits What know bit goes P box Product cipher Encoder 8 3 Decoder 3 8 S box b S1 P1 S2 S3 S4 S5 P2 S6 S7 S8 S9 P3 S10 S11 P4 S12 c Basic elements product ciphers P box b S box c Product Substitutions performed S boxes shown b In example 3 bit plaintext entered 3 bit ciphertext output The 3 bit input selects one eight lines exiting first stage sets 1 lines 0 The second stage P box The third stage encodes selected input line binary With wiring shown eight octal numbers 01234567 input one another output sequence would 24506713 In words 0 replaced 2 1 replaced 4 etc Again appropriate wiring P box inside S box substitution accomplished Furthermore device built hardware achieve great speed since encoders decoders one two subnanosecond gate delays propagation time across P box may well less 1 picosec 780 NETWORK SECURITY The real power basic elements becomes apparent cascade whole series boxes form product cipher shown c In example 12 input lines transposed e permuted first stage P 1 In second stage input broken four groups 3 bits substituted independently others S 1 S 4 This arrangement shows method approximating larger S box multiple smaller S boxes It useful small S boxes practical hardware implementation e g 8 bit S box realized 256 entry lookup table large Sboxes become unwieldy build e g 12 bit S box would minimum need 212 4096 crossed wires middle stage Although method less general still powerful By inclusion sufficiently large number stages product cipher output made exceedingly complicated function input Product ciphers operate k bit inputs produce k bit outputs common Typically k 64 256 A hardware implementation usually least 10 physical stages instead 7 c A software implementation programmed loop least eight iterations one performing S box type substitutions subblocks 64 256 bit data block followed permutation mixes outputs S boxes Often special initial permutation one end well In literature iterations called rounds 8 2 1 DES The Data Encryption Standard In January 1977 U S Government adopted product cipher developed IBM official standard unclassified information This cipher DES Data Encryption Standard widely adopted industry use security products It longer secure original form modified form still useful We explain DES works An outline DES shown Plaintext encrypted blocks 64 bits yielding 64 bits ciphertext The algorithm parameterized 56 bit key 19 distinct stages The first stage key independent transposition 64 bit plaintext The last stage exact inverse transposition The stage prior last one exchanges leftmost 32 bits rightmost 32 bits The remaining 16 stages functionally identical parameterized different functions key The algorithm designed allow decryption done key encryption property needed symmetric key algorithm The steps run reverse order The operation one intermediate stages illustrated b Each stage takes two 32 bit inputs produces two 32 bit outputs The left output simply copy right input The right output bitwise XOR left input function right input key stage Ki Pretty much complexity algorithm lies function SEC 8 2 SYMMETRIC KEY ALGORITHMS 64 Bit plaintext L 1 R 1 Initial transposition 56 Bit key Iteration 1 Iteration 2 L 1 f Ri 1 Ki Iteration 16 32 Bit swap Inverse transposition 64 Bit ciphertext 32 bits Li 32 bits Ri b The Data Encryption Standard General outline b Detail one iteration The circled means exclusive OR The function consists four steps carried sequence First 48 bit number E constructed expanding 32 bit Ri 1 according fixed transposition duplication rule Second E Ki XORed together This output partitioned eight groups 6 bits fed different S box Each 64 possible inputs S box mapped onto 4bit output Finally 8 4 bits passed P box In 16 iterations different key used Before algorithm starts 56 bit transposition applied key Just iteration key partitioned two 28 bit units rotated left number bits dependent iteration number Ki derived rotated key applying yet another 56 bit transposition A different 48 bit subset 56 bits extracted permuted round A technique sometimes used make DES stronger called whitening It consists XORing random 64 bit key plaintext block feeding DES XORing second 64 bit key resulting ciphertext transmitting Whitening easily removed running 782 NETWORK SECURITY reverse operations receiver two whitening keys Since technique effectively adds bits key length makes exhaustive search key space much time consuming Note whitening key used block e one whitening key DES enveloped controversy since day launched It based cipher developed patented IBM called Lucifer except IBM cipher used 128 bit key instead 56 bit key When U S Federal Government wanted standardize one cipher unclassified use invited IBM discuss matter NSA U S Government code breaking arm world largest employer mathematicians cryptologists NSA secret industry joke goes Q What NSA stand A No Such Agency Actually NSA stands National Security Agency After discussions took place IBM reduced key 128 bits 56 bits decided keep secret process DES designed Many people suspected key length reduced make sure NSA could break DES organization smaller budget could The point secret design supposedly hide back door could make even easier NSA break DES When NSA employee discreetly told IEEE cancel planned conference cryptography make people comfortable NSA denied everything In 1977 two Stanford cryptography researchers Diffie Hellman 1977 designed machine break DES estimated could built 20 million dollars Given small piece plaintext matched ciphertext machine could find key exhaustive search 256 entry key space 1 day Nowadays game Such machine exists sale costs less 10 000 make Kumar et al 2006 Triple DES As early 1979 IBM realized DES key length short devised way effectively increase using triple encryption Tuchman 1979 The method chosen since incorporated International Standard 8732 illustrated Here two keys three stages used In first stage plaintext encrypted using DES usual way K 1 In second stage DES run decryption mode using K 2 key Finally another DES encryption done K 1 This design immediately gives rise two questions First two keys used instead three Second EDE Encrypt Decrypt Encrypt used instead EEE Encrypt Encrypt Encrypt The reason two keys used even paranoid cryptographers believe 112 bits SEC 8 2 P SYMMETRIC KEY ALGORITHMS K1 K2 K1 E D E C C K1 K2 K1 D E D P b Triple encryption using DES b Decryption adequate routine commercial applications time And among cryptographers paranoia considered feature bug Going 168 bits would add unnecessary overhead managing transporting another key little real gain The reason encrypting decrypting encrypting backward compatibility existing single key DES systems Both encryption decryption functions mappings sets 64 bit numbers From cryptographic point view two mappings equally strong By using EDE however instead EEE computer using triple encryption speak one using single encryption setting K 1 K 2 This property allows triple encryption phased gradually something concern academic cryptographers considerable importance IBM customers 8 2 2 AES The Advanced Encryption Standard As DES began approaching end useful life even triple DES NIST National Institute Standards Technology agency U S Dept Commerce charged approving standards U S Federal Government decided government needed new cryptographic standard unclassified use NIST keenly aware controversy surrounding DES well knew announced new standard everyone knowing anything cryptography would automatically assume NSA built back door NSA could read everything encrypted Under conditions probably one would use standard would died quietly So NIST took surprisingly different approach government bureaucracy sponsored cryptographic bake contest In January 1997 researchers world invited submit proposals new standard called AES Advanced Encryption Standard The bake rules 1 The algorithm must symmetric block cipher 2 The full design must public 3 Key lengths 128 192 256 bits must supported 784 NETWORK SECURITY 4 Both software hardware implementations must possible 5 The algorithm must public licensed nondiscriminatory terms Fifteen serious proposals made public conferences organized presented attendees actively encouraged find flaws In August 1998 NIST selected five finalists primarily basis security efficiency simplicity flexibility memory requirements important embedded systems More conferences held potshots taken In October 2000 NIST announced selected Rijndael Joan Daemen Vincent Rijmen The name Rijndael pronounced Rhine doll less derived last names authors Rijmen Daemen In November 2001 Rijndael became AES U S Government standard published FIPS Federal Information Processing Standard 197 Due extraordinary openness competition technical properties Rijndael fact winning team consisted two young Belgian cryptographers unlikely built back door please NSA Rijndael become world dominant cryptographic cipher AES encryption decryption part instruction set microprocessors e g Intel Rijndael supports key lengths block sizes 128 bits 256 bits steps 32 bits The key length block length may chosen independently However AES specifies block size must 128 bits key length must 128 192 256 bits It doubtful anyone ever use 192 bit keys de facto AES two variants 128 bit block 128 bit key 128 bit block 256 bit key In treatment algorithm examine 128 128 case likely become commercial norm A 128 bit key gives key space 2128 3 1038 keys Even NSA manages build machine 1 billion parallel processors able evaluate one key per picosecond would take machine 1010 years search key space By sun burned folks present read results candlelight Rijndael From mathematical perspective Rijndael based Galois field theory gives provable security properties However also viewed C code without getting mathematics Like DES Rijndael uses substitution permutations also uses multiple rounds The number rounds depends key size block size 10 128 bit keys 128 bit blocks moving 14 largest key largest block However unlike DES operations involve entire bytes SEC 8 2 SYMMETRIC KEY ALGORITHMS allow efficient implementations hardware software An outline code given Note code purpose illustration Good implementations security code follow additional practices zeroing sensitive memory used See example Ferguson et al 2010 define LENGTH 16 define NROWS 4 define NCOLS 4 define ROUNDS 10 typedef unsigned char byte bytes data block key number rows state number columns state number iterations unsigned 8 bit integer rijndael byte plaintext LENGTH byte ciphertext LENGTH byte key LENGTH int r loop index byte state NROWS NCOLS current state struct byte k NROWS NCOLS rk ROUNDS 1 round keys expand key key rk copy plaintext state state plaintext xor roundkey state state rk 0 construct round keys init current state XOR key state r 1 r ROUNDS r substitute state rotate rows state r ROUNDS mix columns state xor roundkey state state rk r copy state ciphertext ciphertext state apply S box byte rotate row bytes mix function XOR key state return result An outline Rijndael C The function rijndael three parameters They plaintext array 16 bytes containing input data ciphertext array 16 bytes enciphered output returned key 16 byte key During calculation current state data maintained byte array state whose size NROWS NCOLS For 128 bit blocks array 4 4 bytes With 16 bytes full 128 bit data block stored The state array initialized plaintext modified every step computation In steps byte byte substitution performed In others bytes permuted within array Other transformations also used At end contents state returned ciphertext The code starts expanding key 11 arrays size state They stored rk array structs containing state array One used start calculation 10 used 10 rounds one per round The calculation round 786 NETWORK SECURITY keys encryption key complicated us get Suffice say round keys produced repeated rotation XORing various groups key bits For details see Daemen Rijmen 2002 The next step copy plaintext state array processed rounds It copied column order first 4 bytes going column 0 next 4 bytes going column 1 Both columns rows numbered starting 0 although rounds numbered starting 1 This initial setup 12 byte arrays size 4 4 illustrated 128 Bit plaintext state rk 0 128 Bit encryption key rk 1 rk 2 rk 3 rk 4 rk 5 rk 6 rk 7 rk 8 rk 9 rk 10 Round keys Creating state rk arrays There one step main computation begins rk 0 XORed state byte byte In words 16 bytes state replaced XOR corresponding byte rk 0 Now time main attraction The loop executes 10 iterations one per round transforming state iteration The contents round produced four steps Step 1 byte byte substitution state Each byte turn used index S box replace value contents S box entry This step straight monoalphabetic substitution cipher Unlike DES multiple S boxes Rijndael one S box Step 2 rotates four rows left Row 0 rotated 0 bytes e changed row 1 rotated 1 byte row 2 rotated 2 bytes row 3 rotated 3 bytes This step diffuses contents current data around block analogous permutations Step 3 mixes column independently ones The mixing done using matrix multiplication new column product old column constant matrix multiplication done using finite Galois field GF 28 Although may sound complicated algorithm exists allows element new column computed using two table lookups three XORs Daemen Rijmen 2002 Appendix E SEC 8 2 SYMMETRIC KEY ALGORITHMS Finally step 4 XORs key round state array use next round Since every step reversible decryption done running algorithm backward However also trick available decryption done running encryption algorithm using different tables The algorithm designed great security also great speed A good software implementation 2 GHz machine able achieve encryption rate 700 Mbps fast enough encrypt 100 MPEG 2 videos real time Hardware implementations faster still 8 2 3 Cipher Modes Despite complexity AES DES block cipher matter basically monoalphabetic substitution cipher using big characters 128 bit characters AES 64 bit characters DES Whenever plaintext block goes front end ciphertext block comes back end If encrypt plaintext abcdefgh 100 times DES key get ciphertext 100 times An intruder exploit property help subvert cipher Electronic Code Book Mode To see monoalphabetic substitution cipher property used partially defeat cipher use triple DES easier depict 64 bit blocks 128 bit blocks AES exactly problem The straightforward way use DES encrypt long piece plaintext break consecutive 8 byte 64 bit blocks encrypt one another key The last piece plaintext padded 64 bits need This technique known ECB mode Electronic Code Book mode analogy old fashioned code books plaintext word listed followed ciphertext usually five digit decimal number In start computer file listing annual bonuses company decided award employees This file consists consecutive 32 byte records one per employee format shown 16 bytes name 8 bytes position 8 bytes bonus Each sixteen 8 byte blocks numbered 0 15 encrypted triple DES Leslie fight boss expecting much bonus Kim contrast boss favorite everyone knows Leslie get access file encrypted sent bank Can Leslie rectify unfair situation given encrypted file No problem All Leslie make copy 12th ciphertext block contains Kim bonus use replace fourth ciphertext block contains Leslie bonus Even without knowing 12th 788 NETWORK SECURITY Name Position A L e l B l c k R b n C l l n D v e K B b b e Bytes Bonus C l e r k B 5 0 0 0 0 0 M n g e r 1 0 0 0 0 0 J n r 1 0 8 The plaintext file encrypted 16 DES blocks block says Leslie expect much merrier Christmas year Copying eighth ciphertext block also possibility likely detected besides Leslie greedy person Cipher Block Chaining Mode To thwart type attack block ciphers chained various ways replacing block way Leslie cause plaintext decrypted starting replaced block garbage One way chaining cipher block chaining In method shown plaintext block XORed previous ciphertext block encrypted Consequently plaintext block longer maps onto ciphertext block encryption longer big monoalphabetic substitution cipher The first block XORed randomly chosen IV Initialization Vector transmitted plaintext along ciphertext P0 P1 P2 P3 IV Key E E E E C0 C1 C2 C3 C0 C1 C2 C3 Key D D D D Encryption box IV Decryption box P0 P1 P2 P3 Exclusive OR b Cipher block chaining Encryption b Decryption We see cipher block chaining mode works examining example We start computing C 0 E P 0 XOR IV Then compute C 1 E P 1 XOR C 0 Decryption also uses XOR reverse process P 0 IV XOR D C 0 Note encryption block SEC 8 2 SYMMETRIC KEY ALGORITHMS function plaintext blocks 0 1 plaintext generates different ciphertext depending occurs A transformation type Leslie made result nonsense two blocks starting Leslie bonus field To astute security officer peculiarity might suggest start ensuing investigation Cipher block chaining also advantage plaintext block result ciphertext block making cryptanalysis difficult In fact main reason used Cipher Feedback Mode However cipher block chaining disadvantage requiring entire 64 bit block arrive decryption begin For byte byte encryption cipher feedback mode using triple DES used shown For AES idea exactly 128 bit shift register used In figure state encryption machine shown bytes 0 9 encrypted sent When plaintext byte 10 arrives illustrated Fig 813 DES algorithm operates 64 bit shift register generate 64 bit ciphertext The leftmost byte ciphertext extracted XORed P 10 That byte transmitted transmission line In addition shift register shifted left 8 bits causing C 2 fall left end C 10 inserted position vacated right end C 9 64 bit shift register 64 bit shift register C2 C3 C4 C5 C6 C7 C8 C9 C2 C3 C4 C 5 C6 C7 C8 C 9 Key E Encryption box Key E C10 Select leftmost byte P10 Encryption box C10 Select leftmost byte C10 C10 P10 Exclusive OR b Cipher feedback mode Encryption b Decryption Note contents shift register depend entire previous history plaintext pattern repeats multiple times plaintext encrypted differently time ciphertext As cipher block chaining initialization vector needed start ball rolling 790 NETWORK SECURITY Decryption cipher feedback mode works way encryption In particular content shift register encrypted decrypted selected byte XORed C 10 get P 10 one XORed P 10 generate C 10 first place As long two shift registers remain identical decryption works correctly This illustrated b A problem cipher feedback mode one bit ciphertext accidentally inverted transmission 8 bytes decrypted bad byte shift register corrupted Once bad byte pushed shift register correct plaintext generated Thus effects single inverted bit relatively localized ruin rest message ruin many bits shift register wide Stream Cipher Mode Nevertheless applications exist 1 bit transmission error mess 64 bits plaintext large effect For applications fourth option stream cipher mode exists It works encrypting initialization vector using key get output block The output block encrypted using key get second output block This block encrypted get third block The arbitrarily large sequence output blocks called keystream treated like one time pad XORed plaintext get ciphertext shown Note IV used first step After output encrypted Also note keystream independent data computed advance need completely insensitive transmission errors Decryption shown b IV IV Encryption box Key E Encryption box Key E Keystream Plaintext Ciphertext Keystream Ciphertext Plaintext b A stream cipher Encryption b Decryption Decryption occurs generating keystream receiving side Since keystream depends IV key affected transmission errors ciphertext Thus 1 bit error transmitted ciphertext generates 1 bit error decrypted plaintext SEC 8 2 SYMMETRIC KEY ALGORITHMS It essential never use key IV pair twice stream cipher generate keystream time Using keystream twice exposes ciphertext keystream reuse attack Imagine plaintext block P 0 encrypted keystream get P 0 XOR K 0 Later second plaintext block Q 0 encrypted keystream get Q 0 XOR K 0 An intruder captures ciphertext blocks simply XOR together get P 0 XOR Q 0 eliminates key The intruder XOR two plaintext blocks If one known guessed also found In event XOR two plaintext streams attacked using statistical properties message For example English text common character stream probably XOR two spaces followed XOR space letter e etc In short equipped XOR two plaintexts cryptanalyst excellent chance deducing Counter Mode One problem modes except electronic code book mode random access encrypted data impossible For example suppose file transmitted network stored disk encrypted form This might reasonable way operate receiving computer notebook computer might stolen Storing critical files encrypted form greatly reduces damage due secret information leaking event computer falls wrong hands However disk files often accessed nonsequential order especially files databases With file encrypted using cipher block chaining accessing random block requires first decrypting blocks ahead expensive proposition For reason yet another mode invented counter mode illustrated Here plaintext encrypted directly Instead initialization vector plus constant encrypted resulting ciphertext XORed plaintext By stepping initialization vector 1 new block easy decrypt block anywhere file without first decrypt predecessors Although counter mode useful weakness worth pointing Suppose key K used future different plaintext IV attacker acquires ciphertext runs The keystreams cases exposing cipher keystream reuse attack kind saw stream ciphers All cryptanalyst XOR two ciphertexts together eliminate cryptographic protection get XOR plaintexts This weakness mean counter mode bad idea It means keys initialization vectors chosen independently random Even key accidentally used twice IV different time plaintext safe 792 NETWORK SECURITY IV IV 2 IV 1 IV 3 Key E Key E Key E Key E P0 P1 P2 P3 C0 C1 C2 Encryption box C3 Encryption using counter mode 8 2 4 Other Ciphers AES Rijndael DES best known symmetric key cryptographic algorithms standard industry choices liability reasons No one blame use AES product AES cracked certainly blame use nonstandard cipher later broken However worth mentioning numerous symmetric key ciphers devised Some embedded inside various products A common ones listed It possible use combinations ciphers example AES Twofish ciphers need broken recover data Cipher Author DES IBM Key length RC4 Ronald Rivest 1 2048 bits Caution keys weak RC5 Ronald Rivest 128 256 bits Good patented 56 bits Comments Too weak use AES Rijndael Daemen Rijmen 128 256 bits Best choice Serpent Anderson Biham Knudsen 128 256 bits Very strong Triple DES IBM Twofish Bruce Schneier 168 bits 128 256 bits Good getting old Very strong widely used Some common symmetric key cryptographic algorithms 8 2 5 Cryptanalysis Before leaving subject symmetric key cryptography worth least mentioning four developments cryptanalysis The first development differential cryptanalysis Biham Shamir 1997 This technique used SEC 8 2 SYMMETRIC KEY ALGORITHMS attack block cipher It works beginning pair plaintext blocks differing small number bits watching carefully happens internal iteration encryption proceeds In many cases bit patterns common others lead probabilistic attacks The second development worth noting linear cryptanalysis Matsui 1994 It break DES 243 known plaintexts It works XORing certain bits plaintext ciphertext together examining result When done repeatedly half bits 0s half 1s Often however ciphers introduce bias one direction bias however small exploited reduce work factor For details see Matsui paper The third development using analysis electrical power consumption find secret keys Computers typically use around 3 volts represent 1 bit 0 volts represent 0 bit Thus processing 1 takes electrical energy processing 0 If cryptographic algorithm consists loop key bits processed order attacker replaces main n GHz clock slow e g 100 Hz clock puts alligator clips CPU power ground pins precisely monitor power consumed machine instruction From data deducing key surprisingly easy This kind cryptanalysis defeated carefully coding algorithm assembly language make sure power consumption independent key also independent individual round keys The fourth development timing analysis Cryptographic algorithms full statements test bits round keys If else parts take different amounts time slowing clock seeing long various steps take may also possible deduce round keys Once round keys known original key usually computed Power timing analysis also employed simultaneously make job easier While power timing analysis may seem exotic reality powerful techniques break cipher specifically designed resist 8 3 PUBLIC KEY ALGORITHMS Historically distributing keys always weakest link cryptosystems No matter strong cryptosystem intruder could steal key system worthless Cryptologists always took granted encryption key decryption key easily derived one another But key distributed users system Thus seemed inherent problem Keys protected theft also distributed could locked bank vault In 1976 two researchers Stanford University Diffie Hellman 1976 proposed radically new kind cryptosystem one encryption decryption keys different decryption key could feasibly 794 NETWORK SECURITY derived encryption key In proposal keyed encryption algorithm E keyed decryption algorithm D meet three requirements These requirements stated simply follows 1 D E P P 2 It exceedingly difficult deduce D E 3 E broken chosen plaintext attack The first requirement says apply D encrypted message E P get original plaintext message P back Without property legitimate receiver could decrypt ciphertext The second requirement speaks The third requirement needed shall see moment intruders may experiment algorithm hearts content Under conditions reason encryption key made public The method works like A person say Alice wants receive secret messages first devises two algorithms meeting requirements The encryption algorithm Alice key made public hence name publickey cryptography Alice might put public key home page Web example We use notation EA mean encryption algorithm parameterized Alice public key Similarly secret decryption algorithm parameterized Alice private key DA Bob thing publicizing EB keeping DB secret Now let us see solve problem establishing secure channel Alice Bob never previous contact Both Alice encryption key EA Bob encryption key EB assumed publicly readable files Now Alice takes first message P computes EB P sends Bob Bob decrypts applying secret key DB e computes DB EB P P No one else read encrypted message EB P encryption system assumed strong difficult derive DB publicly known EB To send reply R Bob transmits EA R Alice Bob communicate securely A note terminology perhaps useful Public key cryptography requires user two keys public key used entire world encrypting messages sent user private key user needs decrypting messages We consistently refer keys public private keys respectively distinguish secret keys used conventional symmetric key cryptography 8 3 1 RSA The catch need find algorithms indeed satisfy three requirements Due potential advantages public key cryptography many researchers hard work algorithms already published SEC 8 3 PUBLIC KEY ALGORITHMS One good method discovered group M I T Rivest et al 1978 It known initials three discoverers Rivest Shamir Adleman RSA It survived attempts break 30 years considered strong Much practical security based For reason Rivest Shamir Adleman given 2002 ACM Turing Award Its major disadvantage requires keys least 1024 bits good security versus 128 bits symmetric key algorithms makes quite slow The RSA method based principles number theory We summarize use method details consult paper 1 Choose two large primes p q typically 1024 bits 2 Compute n p q z p 1 q 1 3 Choose number relatively prime z call 4 Find e e 1 mod z With parameters computed advance ready begin encryption Divide plaintext regarded bit string blocks plaintext message P falls interval 0 P n Do grouping plaintext blocks k bits k largest integer 2k n true To encrypt message P compute C P e mod n To decrypt C compute P C mod n It proven P specified range encryption decryption functions inverses To perform encryption need e n To perform decryption need n Therefore public key consists pair e n private key consists n The security method based difficulty factoring large numbers If cryptanalyst could factor publicly known n could find p q z Equipped knowledge z e found using Euclid algorithm Fortunately mathematicians trying factor large numbers least 300 years accumulated evidence suggests exceedingly difficult problem According Rivest colleagues factoring 500 digit number would require 1025 years using brute force In cases assumed best known algorithm computer 1 sec instruction time With million chips running parallel instruction time 1 nsec would still take 1016 years Even computers continue get faster order magnitude per decade many years factoring 500 digit number becomes feasible time descendants simply choose p q still larger A trivial pedagogical example RSA algorithm works given For example chosen p 3 q 11 giving n 33 z 20 A suitable value 7 since 7 20 common factors With choices e found solving equation 7e 1 mod 20 yields e 3 The ciphertext C corresponding plaintext message P 796 NETWORK SECURITY given C P 3 mod 33 The ciphertext decrypted receiver making use rule P C 7 mod 33 The figure shows encryption plaintext SUZANNE example Plaintext P Symbolic Numeric S U Z A N N E 210114 Ciphertext C After decryption P3 P3 mod 33 C7 C7 mod 33 Symbolic 92611274421151801088541178125210114 S U Z A N N E Sender computation Receiver computation An example RSA algorithm Because primes chosen example small P must less 33 plaintext block contain single character The result monoalphabetic substitution cipher impressive If instead chosen p q 21024 block could 1024 2512 would n bits 128 eight bit characters versus 8 characters DES 16 characters AES It pointed using RSA described similar using symmetric algorithm ECB mode input block gives output block Therefore form chaining needed data encryption However practice RSA based systems use public key cryptography primarily distributing one time session keys use symmetric key algorithm AES triple DES RSA slow actually encrypting large volumes data widely used key distribution 8 3 2 Other Public Key Algorithms Although RSA widely used means public key algorithm known The first public key algorithm knapsack algorithm Merkle Hellman 1978 The idea someone owns large number objects different weight The owner encodes message secretly selecting subset objects placing knapsack The total weight objects knapsack made public list possible objects corresponding weights The list objects knapsack kept secret With certain additional restrictions problem figuring possible list objects given weight thought computationally infeasible formed basis public key algorithm SEC 8 3 PUBLIC KEY ALGORITHMS The algorithm inventor Ralph Merkle quite sure algorithm could broken offered 100 reward anyone could break Adi Shamir S RSA promptly broke collected reward Undeterred Merkle strengthened algorithm offered 1000 reward anyone could break new one Ronald Rivest R RSA promptly broke new one collected reward Merkle dare offer 10 000 next version A Leonard Adleman luck Nevertheless knapsack algorithm considered secure used practice Other public key schemes based difficulty computing discrete logarithms Algorithms use principle invented El Gamal 1985 Schnorr 1991 A schemes exist based elliptic curves Menezes Vanstone 1993 two major categories based difficulty factoring large numbers computing discrete logarithms modulo large prime These problems thought genuinely difficult solve mathematicians working many years without great breakthroughs 8 4 DIGITAL SIGNATURES The authenticity many legal financial documents determined presence absence authorized handwritten signature And photocopies count For computerized message systems replace physical transport paper ink documents method must found allow documents signed unforgeable way The problem devising replacement handwritten signatures difficult one Basically needed system one party send signed message another party way following conditions hold 1 The receiver verify claimed identity sender 2 The sender later repudiate contents message 3 The receiver possibly concocted message The first requirement needed example financial systems When customer computer orders bank computer buy ton gold bank computer needs able make sure computer giving order really belongs customer whose account debited In words bank authenticate customer customer authenticate bank The second requirement needed protect bank fraud Suppose bank buys ton gold immediately thereafter price gold 798 NETWORK SECURITY drops sharply A dishonest customer might proceed sue bank claiming never issued order buy gold When bank produces message court customer may deny sent The property party contract later deny signed called nonrepudiation The digital signature schemes study help provide The third requirement needed protect customer event price gold shoots bank tries construct signed message customer asked one bar gold instead one ton In fraud scenario bank keeps rest gold 8 4 1 Symmetric Key Signatures One approach digital signatures central authority knows everything everyone trusts say Big Brother BB Each user chooses secret key carries hand BB office Thus Alice BB know Alice secret key KA When Alice wants send signed plaintext message P banker Bob generates KA B RA P B Bob identity RA random number chosen Alice timestamp ensure freshness KA B RA P message encrypted key KA Then sends depicted BB sees message Alice decrypts sends message Bob shown The message Bob contains plaintext Alice message also signed message KBB A P Bob carries Alice request Bob A KA B RA P BB Alice KB A RA P KBB A P Digital signatures Big Brother What happens Alice later denies sending message Step 1 everyone sues everyone least United States Finally case comes court Alice vigorously denies sending Bob disputed message judge ask Bob sure disputed message came Alice Trudy Bob first points BB accept message Alice unless encrypted KA possibility Trudy sending BB false message Alice without BB detecting immediately Bob dramatically produces Exhibit A KBB A P Bob says message signed BB proves Alice sent P Bob The judge asks BB everyone trusts decrypt Exhibit A When BB testifies Bob telling truth judge decides favor Bob Case dismissed SEC 8 4 DIGITAL SIGNATURES One potential problem signature protocol Trudy replaying either message To minimize problem timestamps used throughout Furthermore Bob check recent messages see RA used If message discarded replay Note based timestamp Bob reject old messages To guard instant replay attacks Bob checks RA every incoming message see message received Alice past hour If Bob safely assume new request 8 4 2 Public Key Signatures A structural problem using symmetric key cryptography digital signatures everyone agree trust Big Brother Furthermore Big Brother gets read signed messages The logical candidates running Big Brother server government banks accountants lawyers Unfortunately none inspire total confidence citizens Hence would nice signing documents require trusted authority Fortunately public key cryptography make important contribution area Let us assume public key encryption decryption algorithms property E D P P addition course usual property D E P P RSA property assumption unreasonable Assuming case Alice send signed plaintext message P Bob transmitting EB DA P Note carefully Alice knows private key DA well Bob public key EB constructing message something Alice When Bob receives message transforms using private key usual yielding DA P shown He stores text safe place applies EA get original plaintext Transmission line Alice computer P Bob public key EB Alice private key DA DA P Bob computer Alice public key EA Bob private key DB EB DA P P DA P Digital signatures using public key cryptography To see signature property works suppose Alice subsequently denies sent message P Bob When case comes court Bob produce P DA P The judge easily verify Bob indeed valid message encrypted DA simply applying EA Since Bob 800 NETWORK SECURITY know Alice private key way Bob could acquired message encrypted Alice indeed send While jail perjury fraud Alice much time devise interesting new public key algorithms Although using public key cryptography digital signatures elegant scheme problems related environment operate rather basic algorithm For one thing Bob prove message sent Alice long DA remains secret If Alice discloses secret key argument longer holds anyone could sent message including Bob The problem might arise example Bob Alice stockbroker Suppose Alice tells Bob buy certain stock bond Immediately thereafter price drops sharply To repudiate message Bob Alice runs police claiming home burglarized PC holding key stolen Depending laws state country may may legally liable especially claims discovered break getting home work several hours allegedly happened Another problem signature scheme happens Alice decides change key Doing clearly legal probably good idea periodically If court case later arises described judge apply current EA DA P discover produce P Bob look pretty stupid point In principle public key algorithm used digital signatures The de facto industry standard RSA algorithm Many security products use However 1991 NIST proposed using variant El Gamal public key algorithm new Digital Signature Standard DSS El Gamal gets security difficulty computing discrete logarithms rather difficulty factoring large numbers As usual government tries dictate cryptographic standards uproar DSS criticized 1 Too secret NSA designed protocol using El Gamal 2 Too slow 10 40 times slower RSA checking signatures 3 Too new El Gamal yet thoroughly analyzed 4 Too insecure fixed 512 bit key In subsequent revision fourth point rendered moot keys 1024 bits allowed Nevertheless first two points remain valid 8 4 3 Message Digests One criticism signature methods often couple two distinct functions authentication secrecy Often authentication needed secrecy always needed Also getting export license often easier system SEC 8 4 DIGITAL SIGNATURES question provides authentication secrecy Below describe authentication scheme require encrypting entire message This scheme based idea one way hash function takes arbitrarily long piece plaintext computes fixed length bit string This hash function MD often called message digest four important properties 1 Given P easy compute MD P 2 Given MD P effectively impossible find P 3 Given P one find P MD P MD P 4 A change input even 1 bit produces different output P DA MD P Bob Alice To meet criterion 3 hash least 128 bits long preferably To meet criterion 4 hash must mangle bits thoroughly unlike symmetric key encryption algorithms seen Computing message digest piece plaintext much faster encrypting plaintext public key algorithm message digests used speed digital signature algorithms To see works consider signature protocol Instead signing P KBB A P BB computes message digest applying MD P yielding MD P BB encloses KBB A MD P fifth item list encrypted KB sent Bob instead KBB A P If dispute arises Bob produce P KBB A MD P After Big Brother decrypted judge Bob MD P guaranteed genuine alleged P However since effectively impossible Bob find message gives hash judge easily convinced Bob telling truth Using message digests way saves encryption time message transport costs Message digests work public key cryptosystems shown Fig 820 Here Alice first computes message digest plaintext She signs message digest sends signed digest plaintext Bob If Trudy replaces P along way Bob see computes MD P Digital signatures using message digests 802 NETWORK SECURITY SHA 1 SHA 2 A variety message digest functions proposed One widely used functions SHA 1 Secure Hash Algorithm 1 NIST 1993 Like message digests operates mangling bits sufficiently complicated way every output bit affected every input bit SHA 1 developed NSA blessed NIST FIPS 180 1 It processes input data 512 bit blocks generates 160 bit message digest A typical way Alice send nonsecret signed message Bob illustrated Here plaintext message fed SHA 1 algorithm get 160 bit SHA 1 hash Alice signs hash RSA private key sends plaintext message signed hash Bob Alice plaintext message M arbitrary length Alice private key DA 160 Bit SHA 1 hash M SHA 1 algorithm H Signed hash RSA algorithm DA H Sent Bob Use SHA 1 RSA signing nonsecret messages After receiving message Bob computes SHA 1 hash also applies Alice public key signed hash get original hash H If two agree message considered valid Since way Trudy modify plaintext message transit produce new one hashes H Bob easily detect changes Trudy made message For messages whose integrity important whose contents secret scheme widely used For relatively small cost computation guarantees modifications made plaintext message transit detected high probability Now let us briefly see SHA 1 works It starts padding message adding 1 bit end followed many 0 bits necessary least 64 make length multiple 512 bits Then 64 bit number containing message length padding ORed low order 64 bits In message shown padding right English text figures go left right e lower right generally perceived end figure With computers orientation corresponds big endian machines SPARC IBM 360 successors SHA 1 always pads end message matter endian machine used SEC 8 4 Start message DIGITAL SIGNATURES 512 Bit block 32 Bit word M0 H0 W0 M1 H1 W1 M2 H2 W2 Padding H3 H4 Mn 1 W79 b c A message padded multiple 512 bits b The output variables c The word array During computation SHA 1 maintains five 32 bit variables H 0 H 4 hash accumulates These shown b They initialized constants specified standard Each blocks M 0 Mn 1 processed turn For current block 16 words first copied start auxiliary 80 word array W shown c Then 64 words W filled using formula Wi S 1 Wi 3 XOR Wi 8 XOR Wi 14 XOR Wi 16 16 79 S b W represents left circular rotation 32 bit word W b bits Now five scratch variables A E initialized H 0 H 4 respectively The actual calculation expressed pseudo C 0 80 temp S5 A fi B C D E Wi Ki E D D C C S30 B B A A temp Ki constants defined standard The mixing functions fi defined fi B C D B AND C OR NOT B AND D fi B C D B XOR C XOR D fi B C D B AND C OR B AND D OR C AND D fi B C D B XOR C XOR D 0 19 20 39 40 59 60 79 When 80 iterations loop completed A E added H 0 H 4 respectively Now first 512 bit block processed next one started The W array reinitialized new block H left When 804 NETWORK SECURITY block finished next one started 512 bit message blocks tossed soup When last block finished five 32 bit words H array output 160 bit cryptographic hash The complete C code SHA 1 given RFC 3174 New versions SHA 1 developed produce hashes 224 256 384 512 bits Collectively versions called SHA 2 Not hashes longer SHA 1 hashes digest function changed combat potential weaknesses SHA 1 SHA 2 yet widely used likely future MD5 For completeness mention another digest popular MD5 Rivest 1992 fifth series message digests designed Ronald Rivest Very briefly message padded length 448 bits modulo 512 Then original length message appended 64 bit integer give total input whose length multiple 512 bits Each round computation takes 512 bit block input mixes thoroughly running 128 bit buffer For good measure mixing uses table constructed sine function The point using known function avoid suspicion designer built clever back door enter This process continues input blocks consumed The contents 128 bit buffer form message digest After decade solid use study weaknesses MD5 led ability find collisions different messages hash Sotirov et al 2008 This death knell digest function means digest safely used represent message Thus security community considers MD5 broken replaced possible new systems use part design Nevertheless may still see MD5 used existing systems 8 4 4 The Birthday Attack In world crypto nothing ever seems One might think would take order 2m operations subvert bit message digest In fact 2m 2 operations often using birthday attack approach published Yuval 1979 classic paper How Swindle Rabin The idea attack comes technique math professors often use probability courses The question many students need class probability two people birthday exceeds 1 2 Most students expect answer way 100 In fact probability theory says 23 Without giving rigorous analysis intuitively 23 SEC 8 4 DIGITAL SIGNATURES people form 23 22 2 253 different pairs probability 1 365 hit In light really surprising More generally mapping inputs outputs n inputs people messages etc k possible outputs birthdays message digests etc n n 1 2 input pairs If n n 1 2 k chance least one match pretty good Thus approximately match likely n k This result means 64 bit message digest probably broken generating 232 messages looking two message digest Let us look practical example The Department Computer Science State University one position tenured faculty member two candidates Tom Dick Tom hired two years Dick goes review first If gets Dick luck Tom knows department chairperson Marilyn thinks highly work asks write letter recommendation Dean decide Tom case Once sent letters become confidential Marilyn tells secretary Ellen write Dean letter outlining wants When ready Marilyn review compute sign 64 bit digest send Dean Ellen send letter later email Unfortunately Tom Ellen romantically involved Dick would like Tom writes following letter 32 bracketed options Dear Dean Smith This letter message give honest frank opinion Prof Tom Wilson candidate tenure year I known worked Prof Wilson almost six years He outstanding excellent researcher great talent ability known worldwide internationally brilliant creative insights many wide variety difficult challenging problems He also highly greatly respected admired teacher educator His students give classes courses rave spectacular reviews He Department popular best loved teacher instructor In addition Additionally Prof Wilson gifted effective fund raiser His grants contracts brought large substantial amount money Department This money These funds enabled permitted us pursue carry many special important programs example State 2000 program Without funds would unable able continue program important essential us I strongly urge grant tenure Unfortunately Tom soon Ellen finishes composing typing letter also writes second one 806 NETWORK SECURITY Dear Dean Smith This letter message give honest frank opinion Prof Tom Wilson candidate tenure year I known worked Tom almost six years He poor weak researcher well known field area His research hardly ever rarely shows insight understanding key major problems day Furthermore respected admired teacher educator His students give classes courses poor bad reviews He Department least popular teacher instructor known mostly primarily within Department tendency propensity ridicule embarrass students foolish imprudent enough ask questions classes In addition Additionally Tom poor marginal fund raiser His grants contracts brought meager insignificant amount money Department Unless new money funds quickly located may cancel essential programs State 2000 program Unfortunately conditions circumstances I good conscience faith recommend tenure permanent position Now Ellen programs computer compute 232 message digests letter overnight Chances one digest first letter match one digest second If add options try tonight Suppose finds match Call good letter A bad one B Ellen emails letter A Marilyn approval Letter B keeps secret showing one Marilyn course approves computes 64 bit message digest signs digest emails signed digest Dean Smith Independently Ellen emails letter B Dean letter A supposed After getting letter signed message digest Dean runs message digest algorithm letter B sees agrees Marilyn sent fires Tom The Dean realize Ellen managed generate two letters message digest sent different one one Marilyn saw approved Optional ending Ellen tells Dick Dick appalled breaks affair Ellen furious confesses Marilyn Marilyn calls Dean Tom gets tenure With SHA 1 birthday attack difficult even ridiculous speed 1 trillion digests per second would take 32 000 years compute 280 digests two letters 80 variants even match guaranteed With cloud 1 000 000 chips working parallel 32 000 years becomes 2 weeks 8 5 MANAGEMENT OF PUBLIC KEYS Public key cryptography makes possible people share common key advance nevertheless communicate securely It also makes signing messages possible without presence trusted third party Finally SEC 8 5 MANAGEMENT OF PUBLIC KEYS signed message digests make possible recipient verify integrity received messages easily securely However one problem glossed bit quickly Alice Bob know get public keys start communication process The obvious solution put public key Web site work following reason Suppose Alice wants look Bob public key Web site How She starts typing Bob URL Her browser looks DNS address Bob home page sends GET request shown Unfortunately Trudy intercepts request replies fake home page probably copy Bob home page except replacement Bob public key Trudy public key When Alice encrypts first message ET Trudy decrypts reads encrypts Bob public key sends Bob none wiser Trudy reading incoming messages Worse yet Trudy could modify messages reencrypting Bob Clearly mechanism needed make sure public keys exchanged securely 1 GET Bob home page Alice 2 Fake home page ET Trudy Bob 3 ET Message 4 EB Message A way Trudy subvert public key encryption 8 5 1 Certificates As first attempt distributing public keys securely could imagine KDC key distribution center available online 24 hours day provide public keys demand One many problems solution scalable key distribution center would rapidly become bottleneck Also ever went Internet security would suddenly grind halt For reasons people developed different solution one require key distribution center online time In fact online Instead certify public keys belonging people companies organizations An organization certifies public keys called CA Certification Authority As example suppose Bob wants allow Alice people know communicate securely He go CA public key along passport driver license ask certified The CA issues certificate similar one signs SHA 1 808 NETWORK SECURITY hash CA private key Bob pays CA fee gets CD ROM containing certificate signed hash I hereby certify public key 19836A8B03030CF83737E3837837FC3s87092827262643FFA82710382828282A belongs Robert John Smith 12345 University Avenue Berkeley CA 94702 Birthday July 4 1958 Email bob superdupernet com SHA 1 hash certificate signed CA private key A possible certificate signed hash The fundamental job certificate bind public key name principal individual company etc Certificates secret protected Bob might example decide put new certificate Web site link main page saying Click public key certificate The resulting click would return certificate signature block signed SHA 1 hash certificate Now let us run scenario When Trudy intercepts Alice request Bob home page She put certificate signature block fake page Alice reads contents certificate immediately see talking Bob Bob name Trudy modify Bob home page fly replacing Bob public key However Alice runs SHA 1 algorithm certificate get hash agree one gets applies CA well known public key signature block Since Trudy CA private key way generating signature block contains hash modified Web page public key In way Alice sure Bob public key Trudy someone else And promised scheme require CA online verification thus eliminating potential bottleneck While standard function certificate bind public key principal certificate also used bind public key attribute For example certificate could say This public key belongs someone 18 It could used prove owner private key minor thus allowed access material suitable children without disclosing owner identity Typically person holding certificate would send Web site principal process cared age That site principal process would generate random number encrypt public key certificate If owner able decrypt send back SEC 8 5 MANAGEMENT OF PUBLIC KEYS would proof owner indeed attribute stated certificate Alternatively random number could used generate session key ensuing conversation Another example certificate might contain attribute object oriented distributed system Each object normally multiple methods The owner object could provide customer certificate giving bit map methods customer allowed invoke binding bit map public key using signed certificate Again certificate holder prove possession corresponding private key allowed perform methods bit map This approach property owner identity need known property useful situations privacy important 8 5 2 X 509 If everybody wanted something signed went CA different kind certificate managing different formats would soon become problem To solve problem standard certificates devised approved ITU The standard called X 509 widespread use Internet It gone three versions since initial standardization 1988 We discuss V3 X 509 heavily influenced OSI world borrowing worst features e g naming encoding Surprisingly IETF went along X 509 even though nearly every area machine addresses transport protocols email formats IETF generally ignored OSI tried right The IETF version X 509 described RFC 5280 At core X 509 way describe certificates The primary fields certificate listed The descriptions given provide general idea fields For additional information please consult standard RFC 2459 For example Bob works loan department Money Bank X 500 address might C US O MoneyBank OU Loan CN Bob C country O organization OU organizational unit CN common name CAs entities named similar way A substantial problem X 500 names Alice trying contact bob moneybank com given certificate X 500 name may obvious certificate refers Bob wants Fortunately starting version 3 DNS names permitted instead X 500 names problem may eventually vanish Certificates encoded using OSI ASN 1 Abstract Syntax Notation 1 sort like struct C except extremely peculiar verbose notation More information X 509 given Ford Baum 2000 810 NETWORK SECURITY Field Meaning Version Which version X 509 Serial number This number plus CA name uniquely identifies certificate Signature algorithm The algorithm used sign certificate Issuer X 500 name CA Validity period The starting ending times validity period Subject name The entity whose key certified Public key The subject public key ID algorithm using Issuer ID An optional ID uniquely identifying certificate issuer Subject ID An optional ID uniquely identifying certificate subject Extensions Many extensions defined Signature The certificate signature signed CA private key The basic fields X 509 certificate 8 5 3 Public Key Infrastructures Having single CA issue world certificates obviously would work It would collapse load central point failure well A possible solution might multiple CAs run organization using private key sign certificates While would solve load failure problems introduces new problem key leakage If dozens servers spread around world holding CA private key chance private key stolen otherwise leaking would greatly increased Since compromise key would ruin world electronic security infrastructure single central CA risky In addition organization would operate CA It hard imagine authority would accepted worldwide legitimate trustworthy In countries people would insist government countries would insist government For reasons different way certifying public keys evolved It goes general name PKI Public Key Infrastructure In section summarize works general although many proposals details probably evolve time A PKI multiple components including users CAs certificates directories What PKI provide way structuring components define standards various documents protocols A particularly simple form PKI hierarchy CAs depicted In example shown three levels practice might fewer The toplevel CA root certifies second level CAs call RAs Regional SEC 8 5 MANAGEMENT OF PUBLIC KEYS Authorities might cover geographic region country continent This term standard though fact term really standard different levels tree These turn certify real CAs issue X 509 certificates organizations individuals When root authorizes new RA generates X 509 certificate stating approved RA includes new RA public key signs hands RA Similarly RA approves new CA produces signs certificate stating approval containing CA public key Root RA 2 approved Its public key 47383AE349 RA 2 approved Its public key 47383AE349 Root signature Root signature RA 1 RA 2 CA 5 approved Its public key 6384AF863B RA 2 signature CA 1 CA 2 CA 3 CA 4 CA 5 CA 5 approved Its public key 6384AF863B RA 2 signature b A hierarchical PKI b A chain certificates Our PKI works like Suppose Alice needs Bob public key order communicate looks finds certificate containing signed CA 5 But Alice never heard CA 5 For knows CA 5 might Bob 10 year old daughter She could go CA 5 say Prove legitimacy CA 5 respond certificate got RA 2 contains CA 5 public key Now armed CA 5 public key verify Bob certificate indeed signed CA 5 thus legal Unless RA 2 Bob 12 year old son So next step ask RA 2 prove legitimate The response query certificate signed root containing RA 2 public key Now Alice sure Bob public key But Alice find root public key Magic It assumed everyone knows root public key For example browser might shipped root public key built Bob friendly sort guy want cause Alice lot work He knows going check CA 5 RA 2 save trouble collects two needed certificates gives two certificates along Now use knowledge root public key verify top level certificate public key contained therein verify second one Alice need contact anyone verification 812 NETWORK SECURITY Because certificates signed easily detect attempts tamper contents A chain certificates going back root like sometimes called chain trust certification path The technique widely used practice Of course still problem going run root The solution single root many roots RAs CAs In fact modern browsers come preloaded public keys 100 roots sometimes referred trust anchors In way single worldwide trusted authority avoided But issue browser vendor decides purported trust anchors reliable sleazy It comes user trusting browser vendor make wise choices simply approve trust anchors willing pay inclusion fee Most browsers allow users inspect root keys usually form certificates signed root delete seem shady Directories Another issue PKI certificates chains back known trust anchor stored One possibility user store certificates While safe e way users tamper signed certificates without detection also inconvenient One alternative proposed use DNS certificate directory Before contacting Bob Alice probably look IP address using DNS DNS return Bob entire certificate chain along IP address Some people think way go others would prefer dedicated directory servers whose job managing X 509 certificates Such directories could provide lookup services using properties X 500 names For example theory directory service could answer query Give list people named Alice work sales departments anywhere U S Canada Revocation The real world full certificates passports drivers licenses Sometimes certificates revoked example drivers licenses revoked drunken driving driving offenses The problem occurs digital world grantor certificate may decide revoke person organization holding abused way It also revoked subject private key exposed worse yet CA private key compromised Thus PKI needs deal issue revocation The possibility revocation complicates matters SEC 8 5 MANAGEMENT OF PUBLIC KEYS A first step direction CA periodically issue CRL Certificate Revocation List giving serial numbers certificates revoked Since certificates contain expiry times CRL need contain serial numbers certificates yet expired Once expiry time passed certificate automatically invalid distinction needed timed actually revoked In cases used Unfortunately introducing CRLs means user use certificate must acquire CRL see certificate revoked If used However even certificate list might revoked list published Thus way really sure ask CA And next use certificate CA asked since certificate might revoked seconds ago Another complication revoked certificate could conceivably reinstated example revoked nonpayment fee since paid Having deal revocation possibly reinstatement eliminates one best properties certificates namely used without contact CA Where CRLs stored A good place would place certificates stored One strategy CA actively push CRLs periodically directories process simply removing revoked certificates If directories used storing certificates CRLs cached various places around network Since CRL signed document tampered tampering easily detected If certificates long lifetimes CRLs long For example credit cards valid 5 years number revocations outstanding much longer new cards issued every 3 months A standard way deal long CRLs issue master list infrequently issue updates often Doing reduces bandwidth needed distributing CRLs 8 6 COMMUNICATION SECURITY We finished study tools trade Most important techniques protocols covered The rest chapter techniques applied practice provide network security plus thoughts social aspects security end chapter In following four sections look communication security get bits secretly without modification source destination keep unwanted bits outside door These means security issues networking certainly among important ones making good place start study 814 NETWORK SECURITY 8 6 1 IPsec IETF known years security lacking Internet Adding easy war broke put Most security experts believe really secure encryption integrity checks end end e application layer That source process encrypts integrity protects data sends destination process decrypted verified Any tampering done two processes including within either operating system detected The trouble approach requires changing applications make security aware In view next best approach putting encryption transport layer new layer application layer transport layer making still end end requiring applications changed The opposite view users understand security capable using correctly nobody wants modify existing programs way network layer authenticate encrypt packets without users involved After years pitched battles view enough support network layer security standard defined In part argument network layer encryption prevent security aware users right help security unaware users extent The result war design called IPsec IP security described RFCs 2401 2402 2406 among others Not users want encryption computationally expensive Rather make optional decided require encryption time permit use null algorithm The null algorithm described praised simplicity ease implementation great speed RFC 2410 The complete IPsec design framework multiple services algorithms granularities The reason multiple services everyone wants pay price services time services available la carte The major services secrecy data integrity protection replay attacks intruder replays conversation All based symmetric key cryptography high performance crucial The reason multiple algorithms algorithm thought secure may broken future By making IPsec algorithm independent framework survive even particular algorithm later broken The reason multiple granularities make possible protect single TCP connection traffic pair hosts traffic pair secure routers among possibilities One slightly surprising aspect IPsec even though IP layer connection oriented Actually surprising security key must established used period time essence kind connection different name Also connections amortize setup SEC 8 6 COMMUNICATION SECURITY costs many packets A connection context IPsec called SA Security Association An SA simplex connection two endpoints security identifier associated If secure traffic needed directions two security associations required Security identifiers carried packets traveling secure connections used look keys relevant information secure packet arrives Technically IPsec two principal parts The first part describes two new headers added packets carry security identifier integrity control data information The part ISAKMP Internet Security Association Key Management Protocol deals establishing keys ISAKMP framework The main protocol carrying work IKE Internet Key Exchange Version 2 IKE described RFC 4306 used earlier version deeply flawed pointed Perlman Kaufman 2000 IPsec used either two modes In transport mode IPsec header inserted IP header The Protocol field IP header changed indicate IPsec header follows normal IP header TCP header The IPsec header contains security information primarily SA identifier new sequence number possibly integrity check payload In tunnel mode entire IP packet header encapsulated body new IP packet completely new IP header Tunnel mode useful tunnel ends location final destination In cases end tunnel security gateway machine example company firewall This commonly case VPN Virtual Private Network In mode security gateway encapsulates decapsulates packets pass By terminating tunnel secure machine machines company LAN aware IPsec Only security gateway know Tunnel mode also useful bundle TCP connections aggregated handled one encrypted stream prevents intruder seeing sending many packets Sometimes knowing much traffic going valuable information For example military crisis amount traffic flowing Pentagon White House drop sharply amount traffic Pentagon military installation deep Colorado Rocky Mountains increase amount intruder might able deduce useful information data Studying flow patterns packets even encrypted called traffic analysis Tunnel mode provides way foil extent The disadvantage tunnel mode adds extra IP header thus increasing packet size substantially In contrast transport mode affect packet size much The first new header AH Authentication Header It provides integrity checking antireplay security secrecy e data encryption The 816 NETWORK SECURITY use AH transport mode illustrated In IPv4 interposed IP header including options TCP header In IPv6 another extension header treated In fact format close standard IPv6 extension header The payload may padded particular length authentication algorithm shown Authenticated IP header AH TCP header Payload padding 32 Bits Next header Payload len Reserved Security parameters index Sequence number Authentication data HMAC The IPsec authentication header transport mode IPv4 Let us examine AH header The Next header field used store value IP Protocol field replaced 51 indicate AH header follows In cases code TCP 6 go The Payload length number 32 bit words AH header minus 2 The Security parameters index connection identifier It inserted sender indicate particular record receiver database This record contains shared key used connection information connection If protocol invented ITU rather IETF field would called Virtual circuit number The Sequence number field used number packets sent SA Every packet gets unique number even retransmissions In words retransmission packet gets different number original even though TCP sequence number The purpose field detect replay attacks These sequence numbers may wrap around If 232 exhausted new SA must established continue communication Finally come Authentication data variable length field contains payload digital signature When SA established two sides negotiate signature algorithm going use Normally public key cryptography used packets must processed extremely rapidly known public key algorithms slow Since IPsec based symmetric key cryptography sender receiver negotiate shared key setting SA shared key used signature computation One simple way compute hash packet plus shared key The shared key transmitted course A scheme like called HMAC SEC 8 6 COMMUNICATION SECURITY Hashed Message Authentication Code It much faster compute first running SHA 1 running RSA result The AH header allow encryption data mostly useful integrity checking needed secrecy needed One noteworthy feature AH integrity check covers fields IP header namely change packet moves router router The Time live field changes hop example included integrity check However IP source address included check making impossible intruder falsify origin packet The alternative IPsec header ESP Encapsulating Security Payload Its use transport mode tunnel mode shown Authenticated IP header ESP header TCP header Payload padding Authentication HMAC Encrypted Authenticated b New IP header ESP header Old IP header TCP header Payload padding Authentication HMAC Encrypted ESP transport mode b ESP tunnel mode The ESP header consists two 32 bit words They Security parameters index Sequence number fields saw AH A third word generally follows technically part header Initialization vector used data encryption unless null encryption used case omitted ESP also provides HMAC integrity checks AH rather included header come payload shown Putting HMAC end advantage hardware implementation HMAC calculated bits going network interface appended end This Ethernet LANs CRCs trailer rather header With AH packet buffered signature computed packet sent potentially reducing number packets sec sent Given ESP everything AH efficient boot question arises bother AH The answer mostly historical Originally AH handled integrity ESP handled secrecy Later integrity added ESP people designed AH want let die work Their real argument AH checks part IP header ESP really weak argument Another weak argument product supporting AH ESP might 818 NETWORK SECURITY less trouble getting export license encryption AH likely phased future 8 6 2 Firewalls The ability connect computer anywhere computer anywhere mixed blessing For individuals home wandering around Internet lots fun For corporate security managers nightmare Most companies large amounts confidential information online trade secrets product development plans marketing strategies financial analyses etc Disclosure information competitor could dire consequences In addition danger information leaking also danger information leaking In particular viruses worms digital pests breach security destroy valuable data waste large amounts administrators time trying clean mess leave Often imported careless employees want play nifty new game Consequently mechanisms needed keep good bits bad bits One method use IPsec This approach protects data transit secure sites However IPsec nothing keep digital pests intruders getting onto company LAN To see accomplish goal need look firewalls Firewalls modern adaptation old medieval security standby digging deep moat around castle This design forced everyone entering leaving castle pass single drawbridge could inspected I O police With networks trick possible company many LANs connected arbitrary ways traffic company forced electronic drawbridge firewall shown No route exists Internal network DeMilitarized zone External Internet Firewall Security perimeter Web Email server server A firewall protecting internal network SEC 8 6 COMMUNICATION SECURITY The firewall acts packet filter It inspects every incoming outgoing packet Packets meeting criterion described rules formulated network administrator forwarded normally Those fail test uncermoniously dropped The filtering criterion typically given rules tables list sources destinations acceptable sources destinations blocked default rules packets coming going machines In common case TCP IP setting source destination might consist IP address port Ports indicate service desired For example TCP port 25 mail TCP port 80 HTTP Some ports simply blocked For example company could block incoming packets IP addresses combined TCP port 79 It popular Finger service look people email addresses little used today Other ports easily blocked The difficulty network administrators want security cut communication outside world That arrangement would much simpler better security would end user complaints This arrangements DMZ DeMilitarized Zone shown come handy The DMZ part company network lies outside security perimeter Anything goes By placing machine Web server DMZ computers Internet contact browse company Web site Now firewall configured block incoming TCP traffic port 80 computers Internet use port attack computers internal network To allow Web server managed firewall rule permit connections internal machines Web server Firewalls become much sophisticated time arms race attackers Originally firewalls applied rule set independently packet proved difficult write rules allowed useful functionality blocked unwanted traffic Stateful firewalls map packets connections use TCP IP header fields keep track connections This allows rules example allow external Web server send packets internal host internal host first establishes connection external Web server Such rule possible stateless designs must either pass drop packets external Web server Another level sophistication stateful processing firewall implement application level gateways This processing involves firewall looking inside packets beyond even TCP header see application With capability possible distinguish HTTP traffic used Web browsing HTTP traffic used peer peer file sharing Administrators write rules spare company peer peer file sharing allow Web browsing vital business For methods outgoing traffic inspected well incoming traffic example prevent sensitive documents emailed outside company 820 NETWORK SECURITY As discussion make clear firewalls violate standard layering protocols They network layer devices peek transport applications layers filtering This makes fragile For instance firewalls tend rely standard port numbering conventions determine kind traffic carried packet Standard ports often used computers applications either Some peer peer applications select ports dynamically avoid easily spotted blocked Encryption IPSEC schemes hides higher layer information firewall Finally firewall readily talk computers communicate tell policies applied connection dropped It must simply pretend broken wire For reasons networking purists consider firewalls blemish architecture Internet However Internet dangerous place computer Firewalls help problem likely stay Even firewall perfectly configured plenty security problems still exist For example firewall configured allow packets specific networks e g company plants intruder outside firewall put false source addresses bypass check If insider wants ship secret documents encrypt even photograph ship photos JPEG files bypasses email filters And even discussed fact although three quarters attacks come outside firewall attacks come inside firewall example disgruntled employees typically damaging Verizon 2009 A different problem firewalls provide single perimeter defense If defense breached bets For reason firewalls often used layered defense For example firewall may guard entrance internal network computer may also run firewall Readers think one security checkpoint enough clearly made international flight scheduled airline recently In addition whole class attacks firewalls deal The basic idea firewall prevent intruders getting secret data getting Unfortunately people nothing better try bring certain sites They sending legitimate packets target great numbers collapses load For example cripple Web site intruder send TCP SYN packet establish connection The site allocate table slot connection send SYN ACK packet reply If intruder respond table slot tied seconds times If intruder sends thousands connection requests table slots fill legitimate connections able get Attacks intruder goal shut target rather steal data called DoS Denial Service attacks Usually request packets false source addresses intruder traced easily DoS attacks major Web sites common Internet SEC 8 6 COMMUNICATION SECURITY An even worse variant one intruder already broken hundreds computers elsewhere world commands attack target time Not approach increase intruder firepower also reduces chances detection since packets coming large number machines belonging unsuspecting users Such attack called DDoS Distributed Denial Service attack This attack difficult defend Even attacked machine quickly recognize bogus request take time process discard request enough requests per second arrive CPU spend time dealing 8 6 3 Virtual Private Networks Many companies offices plants scattered many cities sometimes multiple countries In olden days public data networks common companies lease lines telephone company pairs locations Some companies still A network built company computers leased telephone lines called private network Private networks work fine secure If lines available leased lines traffic leak company locations intruders physically wiretap lines break easy The problem private networks leasing dedicated T1 line two points costs thousands dollars month T3 lines many times expensive When public data networks later Internet appeared many companies wanted move data possibly voice traffic public network without giving security private network This demand soon led invention VPNs Virtual Private Networks overlay networks top public networks properties private networks They called virtual merely illusion virtual circuits real circuits virtual memory real memory One popular approach build VPNs directly Internet A common design equip office firewall create tunnels Internet pairs offices illustrated A advantage using Internet connectivity tunnels set demand include example computer employee home traveling long person Internet connection This flexibility much greater provided leased lines yet perspective computers VPN topology looks like private network case shown b When system brought pair firewalls negotiate parameters SA including services modes algorithms keys If IPsec used tunneling possible aggregate traffic 822 NETWORK SECURITY London office Paris office London Paris Home Travel Internet Home Travel b A virtual private network b Topology seen inside two pairs offices onto single authenticated encrypted SA thus providing integrity control secrecy even considerable immunity traffic analysis Many firewalls VPN capabilities built Some ordinary routers well since firewalls primarily security business natural tunnels begin end firewalls providing clear separation company Internet Thus firewalls VPNs IPsec ESP tunnel mode natural combination widely used practice Once SAs established traffic begin flowing To router within Internet packet traveling along VPN tunnel ordinary packet The thing unusual presence IPsec header IP header since extra headers effect forwarding process routers care extra header Another approach gaining popularity ISP set VPN Using MPLS discussed Chap 5 paths VPN traffic set across ISP network company offices These paths keep VPN traffic separate Internet traffic guaranteed certain amount bandwidth quality service A key advantage VPN completely transparent user software The firewalls set manage SAs The person even aware setup system administrator configure manage security gateways ISP administrator configure MPLS paths To everyone else like leased line private network For VPNs see Lewis 2006 8 6 4 Wireless Security It surprisingly easy design system using VPNs firewalls logically completely secure practice leaks like sieve This situation occur machines wireless use radio communication passes right firewall directions The range 802 11 networks SEC 8 6 COMMUNICATION SECURITY often hundred meters anyone wants spy company simply drive employee parking lot morning leave 802 11 enabled notebook computer car record everything hears take day By late afternoon hard disk full valuable goodies Theoretically leakage supposed happen Theoretically people supposed rob banks either Much security problem traced manufacturers wireless base stations access points trying make products user friendly Usually user takes device box plugs electrical power socket begins operating immediately nearly always security blurting secrets everyone within radio range If plugged Ethernet Ethernet traffic suddenly appears parking lot well Wireless snooper dream come true free data without work It therefore goes without saying security even important wireless systems wired ones In section look ways wireless networks handle security Some additional information given Nichols Lekkas 2002 802 11 Security Part 802 11 standard originally called 802 11i prescribes data linklevel security protocol preventing wireless node reading interfering messages sent another pair wireless nodes It also goes trade name WPA2 WiFi Protected Access 2 Plain WPA interim scheme implements subset 802 11i It avoided favor WPA2 We describe 802 11i shortly first note replacement WEP Wired Equivalent Privacy first generation 802 11 security protocols WEP designed networking standards committee completely different process example way NIST selected design AES The results devastating What wrong Pretty much everything security perspective turns For example WEP encrypted data confidentiality XORing output stream cipher Unfortunately weak keying arrangements meant output often reused This led trivial ways defeat As another example integrity check based 32 bit CRC That efficient code detecting transmission errors cryptographically strong mechanism defeating attackers These design flaws made WEP easy compromise The first practical demonstration WEP broken came Adam Stubblefield intern AT T Stubblefield et al 2002 He able code test attack outlined Fluhrer et al 2001 one week time spent convincing management buy WiFi card use experiments Software crack WEP passwords within minute freely available use WEP strongly discouraged While prevent casual 824 NETWORK SECURITY access provide real form security The 802 11i group put together hurry clear WEP seriously broken It produced formal standard June 2004 Now describe 802 11i provide real security set used properly There two common scenarios WPA2 used The first corporate setting company separate authentication server username password database used determine wireless client allowed access network In setting clients use standard protocols authenticate network The main standards 802 1X access point lets client carry dialogue authentication server observes result EAP Extensible Authentication Protocol RFC 3748 tells client authentication server interact Actually EAP framework standards define protocol messages However delve many details exchange much matter overview The second scenario home setting authentication server Instead single shared password used clients access wireless network This setup less complex authentication server used home small businesses less secure well The main difference authentication server client gets key encrypting traffic known clients With single shared password different keys derived client clients password derive others keys want The keys used encrypt traffic computed part authentication handshake The handshake happens right client associates wireless network authenticates authentication server one At start handshake client either shared network password password authentication server This password used derive master key However master key used directly encrypt packets It standard cryptographic practice derive session key period usage change key different sessions expose master key observation little possible It session key computed handshake The session key computed four packet handshake shown Fig 831 First AP access point sends random number identification Random numbers used security protocols like one called nonces less contraction number used The client also picks nonce It uses nonces MAC address AP master key compute session key KS The session key split portions used different purposes omitted detail Now client session keys AP So client sends nonce AP AP performs computation derive session keys The nonces sent clear keys derived without extra secret information The message client protected SEC 8 6 COMMUNICATION SECURITY integrity check called MIC Message Integrity Check based session key The AP check MIC correct message indeed must come client computes session keys A MIC another name message authentication code HMAC The term MIC often used instead networking protocols potential confusion MAC Medium Access Control addresses Client Verify AP KS NonceAP NonceC MICS KS KG MICS Distribute group key KG KS ACK MICS Acknowledge Access Point AP Compute session keys KS MAC addresses nonces master key Compute session keys KS client Verify client KS The 802 11i key setup handshake In last two messages AP distributes group key KG client client acknowledges message Receipt messages lets client verify AP correct session keys vice versa The group key used broadcast multicast traffic 802 11 LAN Because result handshake every client encryption keys none keys used AP broadcast packets wireless clients separate copy would need sent client using key Instead shared key distributed broadcast traffic sent received clients It must updated clients leave join network Finally get part keys actually used provide security Two protocols used 802 11i provide message confidentiality integrity authentication Like WPA one protocols called TKIP Temporary Key Integrity Protocol interim solution It designed improve security old slow 802 11 cards least security better WEP rolled firmware upgrade However broken better recommended protocol CCMP What CCMP stand It short somewhat spectacular name Counter mode Cipher block chaining Message authentication code Protocol We call CCMP You call anything want 826 NETWORK SECURITY CCMP works fairly straightforward way It uses AES encryption 128 bit key block size The key comes session key To provide confidentiality messages encrypted AES counter mode Recall discussed cipher modes Sec 8 2 3 These modes prevent message encrypted set bits time Counter mode mixes counter encryption To provide integrity message including header fields encrypted cipher block chaining mode last 128 bit block kept MIC Then message encrypted counter mode MIC sent The client AP perform encryption verify encryption wireless packet received For broadcast multicast messages procedure used group key Bluetooth Security Bluetooth considerably shorter range 802 11 easily attacked parking lot security still issue For example imagine Alice computer equipped wireless Bluetooth keyboard In absence security Trudy happened adjacent office could read everything Alice typed including outgoing email She could also capture everything Alice computer sent Bluetooth printer sitting next e g incoming email confidential reports Fortunately Bluetooth elaborate security scheme try foil world Trudies We summarize main features Bluetooth version 2 1 later four security modes ranging nothing full data encryption integrity control As 802 11 security disabled default older devices security Most users security turned serious breach occurred turn In agricultural world approach known locking barn door horse escaped Bluetooth provides security multiple layers In physical layer frequency hopping provides tiny little bit security since Bluetooth device moves piconet told frequency hopping sequence sequence obviously secret The real security starts newly arrived slave asks channel master Before Bluetooth 2 1 two devices assumed share secret key set advance In cases hardwired manufacturer e g headset mobile phone sold unit In cases one device e g headset hardwired key user enter key device e g mobile phone decimal number These shared keys called passkeys Unfortunately passkeys often hardcoded 1234 another predictable value case four decimal digits allowing 104 choices With simple secure pairing Bluetooth 2 1 devices pick code six digit range makes passkey much less predictable still far secure SEC 8 6 COMMUNICATION SECURITY To establish channel slave master check see one knows passkey If negotiate whether channel encrypted integrity controlled Then select random 128 bit session key whose bits may public The point allowing key weakening comply government restrictions various countries designed prevent export use keys longer government break Encryption uses stream cipher called E0 integrity control uses SAFER Both traditional symmetric key block ciphers SAFER submitted AES bake eliminated first round slower candidates Bluetooth finalized AES cipher chosen otherwise would likely used Rijndael The actual encryption using stream cipher shown plaintext XORed keystream generate ciphertext Unfortunately E 0 like RC4 may fatal weaknesses Jakobsson Wetzel 2001 While broken time writing similarities A5 1 cipher whose spectacular failure compromises GSM telephone traffic cause concern Biryukov et al 2000 It sometimes amazes people including authors book perennial cat mouse game cryptographers cryptanalysts cryptanalysts often winning side Another security issue Bluetooth authenticates devices users theft Bluetooth device may give thief access user financial accounts However Bluetooth also implements security upper layers even event breach link level security security may remain especially applications require PIN code entered manually kind keyboard complete transaction 8 7 AUTHENTICATION PROTOCOLS Authentication technique process verifies communication partner supposed imposter Verifying identity remote process face malicious active intruder surprisingly difficult requires complex protocols based cryptography In section study many authentication protocols used insecure computer networks As aside people confuse authorization authentication Authentication deals question whether actually communicating specific process Authorization concerned process permitted For example say client process contacts file server says I Scott process I want delete file cookbook old From file server point view two questions must answered 828 NETWORK SECURITY 1 Is actually Scott process authentication 2 Is Scott allowed delete cookbook old authorization Only questions unambiguously answered affirmative requested action take place The former question really key one Once file server knows talking checking authorization matter looking entries local tables databases For reason concentrate authentication section The general model essentially authentication protocols use Alice starts sending message either Bob trusted KDC Key Distribution Center expected honest Several message exchanges follow various directions As messages sent Trudy may intercept modify replay order trick Alice Bob gum works Nevertheless protocol completed Alice sure talking Bob Bob sure talking Alice Furthermore protocols two also established secret session key use upcoming conversation In practice performance reasons data traffic encrypted using symmetric key cryptography typically AES triple DES although public key cryptography widely used authentication protocols establishing session key The point using new randomly chosen session key new connection minimize amount traffic gets sent users secret keys public keys reduce amount ciphertext intruder obtain minimize damage done process crashes core dump falls wrong hands Hopefully key present session key All permanent keys carefully zeroed session established 8 7 1 Authentication Based Shared Secret Key For first authentication protocol assume Alice Bob already share secret key KAB This shared key might agreed upon telephone person event insecure network This protocol based principle found many authentication protocols one party sends random number transforms special way returns result Such protocols called challenge response protocols In subsequent authentication protocols following notation used A B identities Alice Bob Ri challenges identifies challenger Ki keys indicates owner KS session key SEC 8 7 AUTHENTICATION PROTOCOLS The message sequence first shared key authentication protocol illustrated In message 1 Alice sends identity A Bob way Bob understands Bob course way knowing whether message came Alice Trudy chooses challenge large random number RB sends back Alice message 2 plaintext Alice encrypts message key shares Bob sends ciphertext KAB RB back message 3 When Bob sees message immediately knows came Alice Trudy know KAB thus could generated Furthermore since RB chosen randomly large space say 128 bit random numbers unlikely Trudy would seen RB response earlier session It equally unlikely could guess correct response challenge Alice 3 RB KAB RB A Bob RA KAB RA Two way authentication using challenge response protocol At point Bob sure talking Alice Alice sure anything For Alice knows Trudy might intercepted message 1 sent back RB response Maybe Bob died last night To find talking Alice picks random number RA sends Bob plaintext message 4 When Bob responds KAB RA Alice knows talking Bob If wish establish session key Alice pick one KS send Bob encrypted KAB The protocol contains five messages Let us see clever eliminate One approach illustrated Here Alice initiates challenge response protocol instead waiting Bob Similarly responding Alice challenge Bob sends The entire protocol reduced three messages instead five Is new protocol improvement original one In one sense shorter Unfortunately also wrong Under certain circumstances Trudy defeat protocol using known reflection attack In particular Trudy break possible open multiple sessions Bob This situation would true example Bob bank prepared accept many simultaneous connections teller machines 830 NETWORK SECURITY A RA Bob Alice RB KAB RA KAB RB A shortened two way authentication protocol Trudy reflection attack shown It starts Trudy claiming Alice sending RT Bob responds usual challenge RB Now Trudy stuck What She know KAB RB First session RB KAB RT A RT A RB Bob Trudy Second session RB2 KAB RB KAB RB First session The reflection attack She open second session message 3 supplying RB taken message 2 challenge Bob calmly encrypts sends back KAB RB message 4 We shaded messages second session make stand Now Trudy missing information complete first session abort second one Bob convinced Trudy Alice asks bank account balance gives without question Then asks transfer secret bank account Switzerland without moment hesitation The moral story Designing correct authentication protocol much harder looks The following four general rules often help designer avoid common pitfalls SEC 8 7 AUTHENTICATION PROTOCOLS 1 Have initiator prove responder This avoids Bob giving away valuable information Trudy give evidence 2 Have initiator responder use different keys proof even means two shared keys KAB K AB 3 Have initiator responder draw challenges different sets For example initiator must use even numbers responder must use odd numbers 4 Make protocol resistant attacks involving second parallel session information obtained one session used different one If even one rules violated protocol frequently broken Here four rules violated disastrous consequences Now let us go take closer look Surely protocol subject reflection attack Maybe It quite subtle Trudy able defeat protocol using reflection attack possible open second session Bob trick answering questions What would happen Alice general purpose computer also accepted multiple sessions rather person computer Let us take look Trudy To see Trudy attack works see Alice starts announcing identity message 1 Trudy intercepts message begins session message 2 claiming Bob Again shaded session 2 messages Alice responds message 2 saying message 3 You claim Bob Prove At point Trudy stuck prove Bob What Trudy She goes back first session turn send challenge sends RA got message 3 Alice kindly responds message 5 thus supplying Trudy information needs send message 6 session 2 At point Trudy basically home free successfully responded Alice challenge session 2 She cancel session 1 send old number rest session 2 authenticated session Alice session 2 But Trudy nasty really wants rub Instead sending old number complete session 2 waits Alice sends message 7 Alice challenge session 1 Of course Trudy know respond uses reflection attack sending back RA 2 message 8 Alice conveniently encrypts RA 2 message 9 Trudy switches back session 1 sends Alice number wants message 10 conveniently copied Alice sent message 9 At point Trudy two fully authenticated sessions Alice This attack somewhat different result attack three message protocol saw This time Trudy two authenticated 832 NETWORK SECURITY2 KAB RA RA2 Second session RA KAB RA B First session Trudy Alice First session RA A Second session First session RA2 KAB RA2 KAB RA2 Second session First session A reflection attack protocol connections Alice In previous example one authenticated connection Bob Again applied general authentication protocol rules discussed earlier attack could stopped For detailed discussion kinds attacks thwart see Bird et al 1993 They also show possible systematically construct protocols provably correct The simplest protocol nevertheless bit complicated show different class protocol also works The new authentication protocol shown Bird et al 1993 It uses HMAC type saw studying IPsec Alice starts sending Bob nonce RA message 1 Bob responds selecting nonce RB sending back along HMAC The HMAC formed building data structure consisting Alice nonce Bob nonce identities shared secret key KAB This data structure hashed HMAC example using SHA 1 When Alice receives message 2 RA picked RB arrives plaintext two identities secret key KAB known along compute HMAC If agrees HMAC message knows talking Bob Trudy know KAB thus figure HMAC send Alice responds Bob HMAC containing two nonces Can Trudy somehow subvert protocol No force either party encrypt hash value choice happened Both HMACs include values chosen sending party something Trudy control 833 AUTHENTICATION PROTOCOLS Alice RA RB HMAC RA RB A B KAB Bob HMAC RA RB KAB Authentication using HMACs Using HMACs way use idea An alternative scheme often used instead computing HMAC series items encrypt items sequentially using cipher block chaining 8 7 2 Establishing Shared Key The Diffie Hellman Key Exchange So far assumed Alice Bob share secret key Suppose far universally accepted PKI signing distributing certificates How establish one One way would Alice call Bob give key phone would probably start saying How I know Alice Trudy They could try arrange meeting one bringing passport driver license three major credit cards busy people might able find mutually acceptable date months Fortunately incredible may sound way total strangers establish shared secret key broad daylight even Trudy carefully recording every message The protocol allows strangers establish shared secret key called Diffie Hellman key exchange Diffie Hellman 1976 works follows Alice Bob agree two large numbers n g n prime n 1 2 also prime certain conditions apply g These numbers may public either one pick n g tell openly Now Alice picks large say 1024 bit number x keeps secret Similarly Bob picks large secret number Alice initiates key exchange protocol sending Bob message containing n g g x mod n shown Bob responds sending Alice message containing g mod n Now Alice raises number Bob sent xth power modulo n get g mod n x mod n Bob performs similar operation get g x mod n mod n By laws modular arithmetic calculations yield g xy mod n Lo behold magic Alice Bob suddenly share secret key g xy mod n 834 NETWORK SECURITY Alice picks x Bob picks n g gx mod n gy mod n Alice computes gy mod n x mod n gxy mod n Bob Alice Bob computes gx mod n mod n gxy mod n The Diffie Hellman key exchange Trudy course seen messages She knows g n message 1 If could compute x could figure secret key The trouble given g x mod n find x No practical algorithm computing discrete logarithms modulo large prime number known To make example concrete use completely unrealistic values n 47 g 3 Alice picks x 8 Bob picks 10 Both kept secret Alice message Bob 47 3 28 38 mod 47 28 Bob message Alice 17 Alice computes 178 mod 47 4 Bob computes 2810 mod 47 4 Alice Bob independently determined secret key 4 To find key Trudy solve equation 3x mod 47 28 done exhaustive search small numbers like numbers hundreds bits long All currently known algorithms simply take far long even massively parallel lightning fast supercomputers Despite elegance Diffie Hellman algorithm problem Bob gets triple 47 3 28 know Alice Trudy There way know Unfortunately Trudy exploit fact deceive Alice Bob illustrated Here Alice Bob choosing x respectively Trudy picks random number z Alice sends message 1 intended Bob Trudy intercepts sends message 2 Bob using correct g n public anyway z instead x She also sends message 3 back Alice Later Bob sends message 4 Alice Trudy intercepts keeps Now everybody modular arithmetic Alice computes secret key g xz mod n Trudy messages Alice Bob computes g yz mod n Trudy messages Bob Alice thinks talking Bob establishes session key Trudy So Bob Every message Alice sends encrypted session captured Trudy stored modified desired optionally passed Bob Similarly direction Trudy sees everything modify messages Alice Bob illusion secure channel one another For SEC 8 7 AUTHENTICATION PROTOCOLS Alice picks x Trudy picks z n g gx mod n gz mod n n g gz mod n Bob Trudy Alice Bob picks gy mod n The man middle attack reason attack known man middle attack It also called bucket brigade attack vaguely resembles old time volunteer fire department passing buckets along line fire truck fire 8 7 3 Authentication Using Key Distribution Center A KA B KS KB A KS Bob Alice KDC Setting shared secret stranger almost worked quite On hand probably worth first place sour grapes attack To talk n people way would need n keys For popular people key management would become real burden especially key stored separate plastic chip card A different approach introduce trusted key distribution center In model user single key shared KDC Authentication session key management go KDC The simplest known KDC authentication protocol involving two parties trusted KDC depicted A first attempt authentication protocol using KDC The idea behind protocol simple Alice picks session key KS tells KDC wants talk Bob using KS This message encrypted 836 NETWORK SECURITY secret key Alice shares KDC KA The KDC decrypts message extracting Bob identity session key It constructs new message containing Alice identity session key sends message Bob This encryption done KB secret key Bob shares KDC When Bob decrypts message learns Alice wants talk key wants use The authentication happens free The KDC knows message 1 must come Alice since one else would able encrypt Alice secret key Similarly Bob knows message 2 must come KDC trusts since one else knows secret key Unfortunately protocol serious flaw Trudy needs money figures legitimate service perform Alice makes attractive offer gets job After work Trudy politely requests Alice pay bank transfer Alice establishes session key banker Bob Then sends Bob message requesting money transferred Trudy account Meanwhile Trudy back old ways snooping network She copies message 2 money transfer request follows Later replays Bob thinks Alice must hired Trudy She clearly good work Bob transfers equal amount money Alice account Trudy Some time 50th message pair Bob runs office find Trudy offer big loan expand obviously successful business This problem called replay attack Several solutions replay attack possible The first one include timestamp message Then anyone receives obsolete message discarded The trouble approach clocks never exactly synchronized network interval timestamp valid Trudy replay message interval get away The second solution put nonce message Each party remember previous nonces reject message containing previously used nonce But nonces remembered forever lest Trudy try replaying 5 year old message Also machine crashes loses nonce list vulnerable replay attack Timestamps nonces combined limit long nonces remembered clearly protocol going get lot complicated A sophisticated approach mutual authentication use multiway challenge response protocol A well known example protocol Needham Schroeder authentication protocol Needham Schroeder 1978 one variant shown The protocol begins Alice telling KDC wants talk Bob This message contains large random number RA nonce The KDC sends back message 2 containing Alice random number session key ticket AUTHENTICATION PROTOCOLS KA RA B KS KB A KS KB A KS KS RA2 Bob Alice RA A B KDC KS RA2 1 RB KS RB 1 The Needham Schroeder authentication protocol send Bob The point random number RA assure Alice message 2 fresh replay Bob identity also enclosed case Trudy gets funny ideas replacing B message 1 identity KDC encrypt ticket end message 2 KT instead KB The ticket encrypted KB included inside encrypted message prevent Trudy replacing something else way back Alice Alice sends ticket Bob along new random number RA 2 encrypted session key KS In message 4 Bob sends back KS RA 2 1 prove Alice talking real Bob Sending back KS RA 2 would worked since Trudy could stolen message 3 After receiving message 4 Alice convinced talking Bob replays could used far After generated RA 2 milliseconds ago The purpose message 5 convince Bob indeed Alice talking replays used either By party generate challenge respond one possibility kind replay attack eliminated Although protocol seems pretty solid slight weakness If Trudy ever manages obtain old session key plaintext initiate new session Bob replaying message 3 corresponds compromised key convince Alice Denning Sacco 1981 This time plunder Alice bank account without perform legitimate service even Needham Schroeder 1987 later published protocol corrects problem In issue journal Otway Rees 1987 also published protocol solves problem shorter way shows slightly modified Otway Rees protocol In Otway Rees protocol Alice starts generating pair random numbers R used common identifier RA Alice use challenge Bob When Bob gets message constructs new message encrypted part Alice message analogous one NETWORK SECURITY A B R KA A B R RA KDC Alice KA RA KS A KA A B R RA B KB A B R RB Bob KB RB KS The Otway Rees authentication protocol slightly simplified Both parts encrypted KA KB identify Alice Bob contain common identifier contain challenge The KDC checks see R parts It might Trudy tampered R message 1 replaced part message 2 If two Rs match KDC believes request message Bob valid It generates session key encrypts twice Alice Bob Each message contains receiver random number proof KDC Trudy generated message At point Alice Bob possession session key start communicating The first time exchange data messages one see one identical copy KS authentication complete 8 7 4 Authentication Using Kerberos An authentication protocol used many real systems including Windows 2000 later versions Kerberos based variant NeedhamSchroeder It named multiheaded dog Greek mythology used guard entrance Hades presumably keep undesirables Kerberos designed M I T allow workstation users access network resources secure way Its biggest difference Needham Schroeder assumption clocks fairly well synchronized The protocol gone several iterations V5 one widely used industry defined RFC 4120 The earlier version V4 finally retired serious flaws found Yu et al 2004 V5 improves V4 many small changes protocol improved features fact longer relies dated DES For information see Neuman Ts 1994 Kerberos involves three servers addition Alice client workstation 1 Authentication Server AS Verifies users login 2 Ticket Granting Server TGS Issues proof identity tickets 3 Bob server Actually work Alice wants performed SEC 8 7 AUTHENTICATION PROTOCOLS Alice 4 6 KA TGS KS KTGS A KS B KS A KTGS A KS KS B KAB KB A B KAB KAB A KB A B KAB Bob A TGS TGS AS AS similar KDC shares secret password every user The TGS job issue tickets convince real servers bearer TGS ticket really claims To start session Alice sits arbitrary public workstation types name The workstation sends name name TGS AS plaintext shown message 1 What comes back session key ticket KTGS A KS intended TGS The session key encrypted using Alice secret key Alice decrypt Only message 2 arrives workstation ask Alice password The password used generate KA order decrypt message 2 obtain session key At point workstation overwrites Alice password make sure inside workstation milliseconds If Trudy tries logging Alice password types wrong workstation detect standard part message 2 incorrect KAB The operation Kerberos V5 After logs Alice may tell workstation wants contact Bob file server The workstation sends message 3 TGS asking ticket use Bob The key element request ticket KTGS A KS encrypted TGS secret key used proof sender really Alice The TGS responds message 4 creating session key KAB Alice use Bob Two versions sent back The first encrypted KS Alice read The second another ticket encrypted Bob key KB Bob read 840 NETWORK SECURITY Trudy copy message 3 try use foiled encrypted timestamp sent along Trudy replace timestamp recent one know KS session key Alice uses talk TGS Even Trudy replays message 3 quickly get another copy message 4 could decrypt first time able decrypt second time either Now Alice send KAB Bob via new ticket establish session message 5 This exchange also timestamped The optional response message 6 proof Alice actually talking Bob Trudy After series exchanges Alice communicate Bob cover KAB If later decides needs talk another server Carol repeats message 3 TGS specifying C instead B The TGS promptly respond ticket encrypted KC Alice send Carol Carol accept proof came Alice The point work Alice access servers network secure way password never go network In fact workstation milliseconds However note server authorization When Alice presents ticket Bob merely proves Bob sent Precisely Alice allowed Bob Since Kerberos designers expect entire world trust single authentication server made provision multiple realms AS TGS To get ticket server distant realm Alice would ask TGS ticket accepted TGS distant realm If distant TGS registered local TGS way local servers local TGS give Alice ticket valid distant TGS She business getting tickets servers realm Note however parties two realms business one must trust TGS Otherwise business 8 7 5 Authentication Using Public Key Cryptography Mutual authentication also done using public key cryptography To start Alice needs get Bob public key If PKI exists directory server hands certificates public keys Alice ask Bob shown message 1 The reply message 2 X 509 certificate containing Bob public key When Alice verifies signature correct sends Bob message containing identity nonce When Bob receives message idea whether came Alice Trudy plays along asks directory server Alice public key message 4 soon gets message 5 He sends Alice message 6 containing Alice RA nonce RB proposed session key KS AUTHENTICATION PROTOCOLS Directory EB E B e v Gi ere 1 H 2 Alice 4 G 5 H ive ere e E E A A 6 EB A RA EA RA RB KS Bob KS RB Mutual authentication using public key cryptography When Alice gets message 6 decrypts using private key She sees RA gives warm feeling inside The message must come Bob since Trudy way determining RA Furthermore must fresh replay since sent Bob RA Alice agrees session sending back message 7 When Bob sees RB encrypted session key generated knows Alice got message 6 verified RA Bob happy camper What Trudy try subvert protocol She fabricate message 3 trick Bob probing Alice Alice see RA send proceed Trudy forge message 7 back Bob know RB KS determine without Alice private key She luck 8 8 EMAIL SECURITY When email message sent two distant sites generally transit dozens machines way Any read record message future use In practice privacy nonexistent despite many people think Nevertheless many people would like able send email read intended recipient one else boss even government This desire stimulated several people groups apply cryptographic principles studied earlier email produce secure email In following sections study widely used secure email system PGP briefly mention one S MIME For additional information secure email see Kaufman et al 2002 Schneier 1995 842 NETWORK SECURITY 8 8 1 PGP Pretty Good Privacy Our first example PGP Pretty Good Privacy essentially brainchild one person Phil Zimmermann 1995a 1995b Zimmermann privacy advocate whose motto If privacy outlawed outlaws privacy Released 1991 PGP complete email security package provides privacy authentication digital signatures compression easy use form Furthermore complete package including source code distributed free charge via Internet Due quality price zero easy availability UNIX Linux Windows Mac OS platforms widely used today PGP encrypts data using block cipher called IDEA International Data Encryption Algorithm uses 128 bit keys It devised Switzerland time DES seen tainted AES yet invented Conceptually IDEA similar DES AES mixes bits series rounds details mixing functions different DES AES Key management uses RSA data integrity uses MD5 topics already discussed PGP also embroiled controversy since day 1 Levy 1993 Because Zimmermann nothing stop people placing PGP Internet people world could get U S Government claimed Zimmermann violated U S laws prohibiting export munitions The U S Government investigation Zimmermann went 5 years eventually dropped probably two reasons First Zimmermann place PGP Internet lawyer claimed never exported anything little matter whether creating Web site constitutes export Second government eventually came realize winning trial meant convincing jury Web site containing downloadable privacy program covered arms trafficking law prohibiting export war materiel tanks submarines military aircraft nuclear weapons Years negative publicity probably help much either As aside export rules bizarre put mildly The government considered putting code Web site illegal export harassed Zimmermann 5 years On hand someone published complete PGP source code C book large font checksum page make scanning easy exported book fine government books classified munitions The sword mightier pen least Uncle Sam Another problem PGP ran involved patent infringement The company holding RSA patent RSA Security Inc alleged PGP use RSA algorithm infringed patent problem settled releases starting 2 6 Furthermore PGP uses another patented encryption algorithm IDEA whose use caused problems first SEC 8 8 EMAIL SECURITY Since PGP open source various people groups modified produced number versions Some designed get around munitions laws others focused avoiding use patented algorithms still others wanted turn closed source commercial product Although munitions laws slightly liberalized otherwise products using AES would exportable U S RSA patent expired September 2000 legacy problems several incompatible versions PGP circulation various names The discussion focuses classic PGP oldest simplest version Another popular version Open PGP described RFC 2440 Yet another GNU Privacy Guard PGP intentionally uses existing cryptographic algorithms rather inventing new ones It largely based algorithms withstood extensive peer review designed influenced government agency trying weaken For people distrust government property big plus PGP supports text compression secrecy digital signatures also provides extensive key management facilities oddly enough email facilities It like preprocessor takes plaintext input produces signed ciphertext base64 output This output emailed course Some PGP implementations call user agent final step actually send message To see PGP works let us consider example Here Alice wants send signed plaintext message P Bob secure way Both Alice Bob private DX public EX RSA keys Let us assume one knows public key cover PGP key management shortly Alice starts invoking PGP program computer PGP first hashes message P using MD5 encrypts resulting hash using private RSA key DA When Bob eventually gets message decrypt hash Alice public key verify hash correct Even someone else e g Trudy could acquire hash stage decrypt Alice known public key strength MD5 guarantees would computationally infeasible produce another message MD5 hash The encrypted hash original message concatenated single message P1 compressed using ZIP program uses ZivLempel algorithm Ziv Lempel 1977 Call output step P1 Z Next PGP prompts Alice random input Both content typing speed used generate 128 bit IDEA message key KM called session key PGP literature really misnomer since session KM used encrypt P1 Z IDEA cipher feedback mode In addition KM encrypted Bob public key EB These two components concatenated converted base64 discussed section MIME Chap 7 The resulting message contains letters digits symbols means put RFC 822 body expected arrive unmodified 844 NETWORK SECURITY KM One time message key IDEA Bob public RSA key EB Concatenation KM Alice private RSA key DA MD5 P RSA P1 Zip P1 Z RSA IDEA Base ASCII text network P1 compressed Original plaintext message Alice Concatenation P signed hash P Concatenation P1 Z encrypted IDEA KM encrypted EB PGP operation sending message When Bob gets message reverses base64 encoding decrypts IDEA key using private RSA key Using key decrypts message get P1 Z After decompressing Bob separates plaintext encrypted hash decrypts hash using Alice public key If plaintext hash agrees MD5 computation knows P correct message came Alice It worth noting RSA used two places encrypt 128 bit MD5 hash encrypt 128 bit IDEA key Although RSA slow encrypt 256 bits large volume data Furthermore 256 plaintext bits exceedingly random considerable amount work required Trudy part determine guessed key correct The heavyduty encryption done IDEA orders magnitude faster RSA Thus PGP provides security compression digital signature much efficient way scheme illustrated PGP supports four RSA key lengths It user select one appropriate The lengths 1 Casual 384 bits Can broken easily today 2 Commercial 512 bits Breakable three letter organizations 3 Military 1024 bits Not breakable anyone earth 4 Alien 2048 bits Not breakable anyone planets either SEC 8 8 EMAIL SECURITY Since RSA used two small computations everyone use alienstrength keys time The format classic PGP message shown Numerous formats also use The message three parts containing IDEA key signature message respectively The key part contains key also key identifier since users permitted multiple public keys Base64 Compressed encrypted IDEA Message Signature part key part ID EB Encrypted KM EB Sig hdr T e ID EA Message part T MD5 p hash e T Msg File hdr name e Message DA A PGP message The signature part contains header concern us The header followed timestamp identifier sender public key used decrypt signature hash type information identifies algorithms used allow MD6 RSA2 used invented encrypted hash The message part also contains header default name file used receiver writes file disk message creation timestamp finally message Key management received large amount attention PGP Achilles heel security systems Key management works follows Each user maintains two data structures locally private key ring public key ring The private key ring contains one personal private public key pairs The reason supporting multiple pairs per user permit users change public keys periodically one thought compromised without invalidating messages currently preparation transit Each pair identifier associated message sender tell recipient public key used encrypt Message identifiers consist low order 64 bits public key Users responsible avoiding conflicts public key identifiers The private keys disk encrypted using special arbitrarily long password protect sneak attacks The public key ring contains public keys user correspondents These needed encrypt message keys associated message Each entry 846 NETWORK SECURITY public key ring contains public key also 64 bit identifier indication strongly user trusts key The problem tackled following Suppose public keys maintained bulletin boards One way Trudy read Bob secret email attack bulletin board replace Bob public key one choice When Alice later fetches key allegedly belonging Bob Trudy mount bucket brigade attack Bob To prevent attacks least minimize consequences Alice needs know much trust item called Bob key public key ring If knows Bob personally handed CD ROM containing key set trust value highest value It decentralized user controlled approach public key management sets PGP apart centralized PKI schemes Nevertheless people sometimes obtain public keys querying trusted key server For reason X 509 standardized PGP supported certificates well traditional PGP public key ring mechanism All current versions PGP X 509 support 8 8 2 S MIME IETF venture email security called S MIME Secure MIME described RFCs 2632 2643 It provides authentication data integrity secrecy nonrepudiation It also quite flexible supporting variety cryptographic algorithms Not surprisingly given name S MIME integrates well MIME allowing kinds messages protected A variety new MIME headers defined example holding digital signatures S MIME rigid certificate hierarchy beginning single root one political problems doomed earlier system called PEM Privacy Enhanced Mail Instead users multiple trust anchors As long certificate traced back trust anchor user believes considered valid S MIME uses standard algorithms protocols examining far discuss For details please consult RFCs 8 9 WEB SECURITY We studied two important areas security needed communications email You think soup appetizer Now time main course Web security The Web Trudies hang nowadays dirty work In following sections look problems issues relating Web security SEC 8 9 WEB SECURITY Web security roughly divided three parts First objects resources named securely Second secure authenticated connections established Third happens Web site sends client piece executable code After looking threats examine issues 8 9 1 Threats One reads Web site security problems newspaper almost weekly The situation really pretty grim Let us look examples already happened First home pages numerous organizations attacked replaced new home pages crackers choosing The popular press calls people break computers hackers many programmers reserve term great programmers We prefer call people crackers Sites cracked include belonging Yahoo U S Army CIA NASA New York Times In cases crackers put funny text sites repaired within hours Now let us look much serious cases Numerous sites brought denial service attacks cracker floods site traffic rendering unable respond legitimate queries Often attack mounted large number machines cracker already broken DDoS attacks These attacks common even make news cost attacked sites thousands dollars lost business In 1999 Swedish cracker broke Microsoft Hotmail Web site created mirror site allowed anyone type name Hotmail user read person current archived email In another case 19 year old Russian cracker named Maxim broke e commerce Web site stole 300 000 credit card numbers Then approached site owners told pay 100 000 would post credit card numbers Internet They give blackmail indeed posted credit card numbers inflicting great damage many innocent victims In different vein 23 year old California student emailed press release news agency falsely stating Emulex Corporation going post large quarterly loss C E O resigning immediately Within hours company stock dropped 60 causing stockholders lose 2 billion The perpetrator made quarter million dollars selling stock short sending announcement While event Web site break clear putting announcement home page big corporation would similar effect We could unfortunately go like many pages But time examine technical issues related Web security For 848 NETWORK SECURITY information security problems kinds see Anderson 2008a Stuttard Pinto 2007 Schneier 2004 Searching Internet also turn vast numbers specific cases 8 9 2 Secure Naming Let us start something basic Alice wants visit Bob Web site She types Bob URL browser seconds later Web page appears But Bob Maybe yes maybe Trudy might old tricks For example might intercepting Alice outgoing packets examining When captures HTTP GET request headed Bob Web site could go Bob Web site get page modify wishes return fake page Alice Alice would none wiser Worse yet Trudy could slash prices Bob e store make goods look attractive thereby tricking Alice sending credit card number Bob buy merchandise One disadvantage classic man middle attack Trudy position intercept Alice outgoing traffic forge incoming traffic In practice tap either Alice phone line Bob since tapping fiber backbone fairly difficult While active wiretapping certainly possible fair amount work Trudy clever also lazy Besides easier ways trick Alice DNS Spoofing One way would Trudy crack DNS system maybe DNS cache Alice ISP replace Bob IP address say 36 1 2 3 Trudy IP address say 42 9 9 9 That leads following attack The way supposed work illustrated Here Alice 1 asks DNS Bob IP address 2 gets 3 asks Bob home page 4 gets After Trudy modified Bob DNS record contain IP address instead Bob get situation b Here Alice looks Bob IP address gets Trudy traffic intended Bob goes Trudy Trudy mount man middle attack without go trouble tapping phone lines Instead break DNS server change one record much easier proposition How might Trudy fool DNS It turns relatively easy Briefly summarized Trudy trick DNS server Alice ISP sending query look Bob address Unfortunately since DNS uses UDP DNS server real way checking supplied answer Trudy exploit property forging expected reply thus injecting false IP address DNS server cache For simplicity assume Alice ISP initially entry Bob Web site bob com If Trudy wait times try later use tricks SEC 8 9 WEB SECURITY Cracked DNS server DNS server Alice Bob Web server 36 1 2 3 Alice Trudy Web server 42 9 9 9 1 Give Bob IP address 2 36 1 2 3 Bob IP address 3 GET index html 4 Bob home page 1 Give Bob IP address 2 42 9 9 9 Trudy IP address 3 GET index html 4 Trudy fake Bob home page b Normal situation b An attack based breaking DNS server modifying Bob record Trudy starts attack sending lookup request Alice ISP asking IP address bob com Since entry DNS name cache server queries top level server com domain get one However Trudy beats com server punch sends back false reply saying bob com 42 9 9 9 IP address If false reply gets back Alice ISP first one cached real reply rejected unsolicited reply query longer outstanding Tricking DNS server installing false IP address called DNS spoofing A cache holds intentionally false IP address like called poisoned cache Actually things quite simple First Alice ISP checks see reply bears correct IP source address top level server But since Trudy put anything wants IP field defeat test easily since IP addresses top level servers public Second allow DNS servers tell reply goes request requests carry sequence number To spoof Alice ISP Trudy know current sequence number The easiest way learn current sequence number Trudy register domain say trudy intruder com Let us assume IP address also 42 9 9 9 She also creates DNS server newly hatched domain dns trudy intruder com It uses Trudy 42 9 9 9 IP address since Trudy one computer Now make Alice ISP aware DNS server That easy All ask Alice ISP foobar trudy intruder com cause Alice ISP find serves Trudy new domain asking top level com server 850 NETWORK SECURITY With dns trudy intruder com safely cache Alice ISP real attack start Trudy queries Alice ISP www trudy intruder com The ISP naturally sends Trudy DNS server query asking This query bears sequence number Trudy looking Quick like bunny Trudy asks Alice ISP look Bob She immediately answers question sending ISP forged reply allegedly top level com server saying bob com 42 9 9 9 This forged reply carries sequence number one higher one received While also send second forgery sequence number two higher maybe dozen increasing sequence numbers One bound match The rest thrown When Alice forged reply arrives cached real reply comes later rejected since query outstanding Now Alice looks bob com told use 42 9 9 9 Trudy address Trudy mounted successful man middle attack comfort living room The various steps attack illustrated This one specific attack foiled DNS servers use random IDs queries rather counting seems every time one hole plugged another one turns In particular IDs 16 bits working easy computer guessing DNS server com 5 Trudy24 Alice ISP cache 1 Look foobar trudy intruder com force ISP cache 2 Look www trudy intruder com get ISP next sequence number 3 Request www trudy intruder com Carrying ISP next sequence number n 4 Quick like bunny look bob com force ISP query com server step 5 5 Legitimate query bob com seq n 1 6 Trudy forged answer Bob 42 9 9 9 seq n 1 7 Real answer rejected late How Trudy spoofs Alice ISP Secure DNS The real problem DNS designed time Internet research facility hundred universities neither Alice Bob Trudy invited party Security issue making Internet work issue The environment changed radically SEC 8 9 WEB SECURITY years 1994 IETF set working group make DNS fundamentally secure This ongoing project known DNSsec DNS security first output presented RFC 2535 Unfortunately DNSsec fully deployed yet numerous DNS servers still vulnerable spoofing attacks DNSsec conceptually extremely simple It based public key cryptography Every DNS zone sense public private key pair All information sent DNS server signed originating zone private key receiver verify authenticity DNSsec offers three fundamental services 1 Proof data originated 2 Public key distribution 3 Transaction request authentication The main service first one verifies data returned approved zone owner The second one useful storing retrieving public keys securely The third one needed guard playback spoofing attacks Note secrecy offered service since information DNS considered public Since phasing DNSsec expected take several years ability security aware servers interwork security ignorant servers essential implies protocol changed Let us look details DNS records grouped sets called RRSets Resource Record Sets records name class type lumped together set An RRSet may contain multiple A records example DNS name resolves primary IP address secondary IP address The RRSets extended several new record types discussed Each RRSet cryptographically hashed e g using SHA 1 The hash signed zone private key e g using RSA The unit transmission clients signed RRSet Upon receipt signed RRSet client verify whether signed private key originating zone If signature agrees data accepted Since RRSet contains signature RRSets cached anywhere even untrustworthy servers without endangering security DNSsec introduces several new record types The first KEY record This records holds public key zone user host principal cryptographic algorithm used signing protocol used transmission bits The public key stored naked X 509 certificates used due bulk The algorithm field holds 1 MD5 RSA signatures preferred choice values combinations The protocol field indicate use IPsec security protocols The second new record type SIG record It holds signed hash according algorithm specified KEY record The signature applies records RRSet including KEY records present excluding 852 NETWORK SECURITY It also holds times signature begins period validity expires well signer name items The DNSsec design zone private key kept offline Once twice day contents zone database manually transported e g CD ROM disconnected machine private key located All RRSets signed SIG records thus produced conveyed back zone primary server CD ROM In way private key stored CD ROM locked safe except inserted disconnected machine signing day new RRSets After signing completed copies key erased memory disk CD ROM returned safe This procedure reduces electronic security physical security something people understand deal This method presigning RRSets greatly speeds process answering queries since cryptography done fly The trade large amount disk space needed store keys signatures DNS databases Some records increase tenfold size due signature When client process gets signed RRSet must apply originating zone public key decrypt hash compute hash compare two values If agree data considered valid However procedure begs question client gets zone public key One way acquire trusted server using secure connection e g using IPsec However practice expected clients preconfigured public keys top level domains If Alice wants visit Bob Web site ask DNS RRSet bob com contain IP address KEY record containing Bob public key This RRSet signed top level com domain Alice easily verify validity An example RRSet might contain shown Domain name Time live Class Type Value bob com IN A 36 1 2 3 bob com IN KEY 3682793A7B73F731029CE2737D bob com IN SIG 86947503A8B848F5272E53930C An example RRSet bob com The KEY record Bob public key The SIG record top level com server signed hash A KEY records verify authenticity Now armed verified copy Bob public key Alice ask Bob DNS server run Bob IP address www bob com This RRSet signed Bob private key Alice verify signature RRSet Bob returns If Trudy somehow manages inject false RRSet caches Alice easily detect lack authenticity SIG record contained incorrect SEC 8 9 WEB SECURITY However DNSsec also provides cryptographic mechanism bind response specific query prevent kind spoof Trudy managed pull This optional antispoofing measure adds response hash query message signed respondent private key Since Trudy know private key top level com server forge response query Alice ISP sent She certainly get response back first rejected due invalid signature hashed query DNSsec also supports record types For example CERT record used storing e g X 509 certificates This record provided people want turn DNS PKI Whether actually happen remains seen We stop discussion DNSsec For details please consult RFC 2535 8 9 3 SSL The Secure Sockets Layer Secure naming good start much Web security The next step secure connections We look secure connections achieved Nothing involving security simple either When Web burst public view initially used distributing static pages However long companies got idea using financial transactions purchasing merchandise credit card online banking electronic stock trading These applications created demand secure connections In 1995 Netscape Communications Corp dominant browser vendor responded introducing security package called SSL Secure Sockets Layer meet demand This software protocol widely used example Firefox Safari Internet Explorer worth examining detail SSL builds secure connection two sockets including 1 Parameter negotiation client server 2 Authentication server client 3 Secret communication 4 Data integrity protection We seen items need elaborate The positioning SSL usual protocol stack illustrated Effectively new layer interposed application layer transport layer accepting requests browser sending TCP transmission server Once secure connection established SSL main job handling compression encryption When HTTP used SSL called HTTPS Secure HTTP even though standard HTTP protocol Sometimes available new port 443 instead port 80 854 NETWORK SECURITY As aside SSL restricted Web browsers common application It also provide mutual authentication Application HTTP Security SSL Transport TCP Network IP Data link PPP Physical modem ADSL cable TV Layers protocols home user browsing SSL The SSL protocol gone several versions Below discuss version 3 widely used version SSL supports variety different options These options include presence absence compression cryptographic algorithms used matters relating export restrictions cryptography The last mainly intended make sure serious cryptography used ends connection United States In cases keys limited 40 bits cryptographers regard something joke Netscape forced put restriction order get export license U S Government SSL consists two subprotocols one establishing secure connection one using Let us start seeing secure connections established The connection establishment subprotocol shown It starts message 1 Alice sends request Bob establish connection The request specifies SSL version Alice preferences respect compression cryptographic algorithms It also contains nonce RA used later Now Bob turn In message 2 Bob makes choice among various algorithms Alice support sends nonce RB Then message 3 sends certificate containing public key If certificate signed well known authority also sends chain certificates followed back one All browsers including Alice come preloaded 100 public keys Bob establish chain anchored one Alice able verify Bob public key At point Bob may send messages request Alice public key certificate When Bob done sends message 4 tell Alice turn Alice responds choosing random 384 bit premaster key sending Bob encrypted public key message 5 The actual session key used encrypting data derived premaster key combined nonces complex way After message 5 received Alice Bob able compute session key For reason Alice tells Bob switch SEC 8 9 SSL version preferences RA SSL version choices RB X 509 certificate chain Server done EB premaster key Bob Alice WEB SECURITY Change cipher Finished Change cipher Finished A simplified version SSL connection establishment subprotocol new cipher message 6 also finished establishment subprotocol message 7 Bob acknowledges messages 8 9 However although Alice knows Bob Bob know Alice unless Alice public key corresponding certificate unlikely situation individual Therefore Bob first message may well request Alice log using previously established login name password The login protocol however outside scope SSL Once accomplished whatever means data transport begin As mentioned SSL supports multiple cryptographic algorithms The strongest one uses triple DES three separate keys encryption SHA 1 message integrity This combination relatively slow mostly used banking applications highest security required For ordinary e commerce applications RC4 used 128 bit key encryption MD5 used message authentication RC4 takes 128 bit key seed expands much larger number internal use Then uses internal number generate keystream The keystream XORed plaintext provide classical stream cipher saw The export versions also use RC4 128 bit keys 88 bits made public make cipher easy break For actual transport second subprotocol used shown Messages browser first broken units 16 KB If data 856 NETWORK SECURITY compression enabled unit separately compressed After secret key derived two nonces premaster key concatenated compressed text result hashed agreed hashing algorithm usually MD5 This hash appended fragment MAC The compressed fragment plus MAC encrypted agreed symmetric encryption algorithm usually XORing RC4 keystream Finally fragment header attached fragment transmitted TCP connection Message browser Fragmentation Part 1 Part 2 Message authentication code Compression MAC added Encryption Header added Data transmission using SSL A word caution order however Since shown RC4 weak keys easily cryptanalyzed security SSL using RC4 shaky ground Fluhrer et al 2001 Browsers allow user choose cipher suite configured use triple DES 168 bit keys SHA 1 time even though combination slower RC4 MD5 Or better yet users upgrade browsers support successor SSL describe shortly A problem SSL principals may certificates even always verify keys used match In 1996 Netscape Communications Corp turned SSL IETF standardization The result TLS Transport Layer Security It described RFC 5246 TLS built SSL version 3 The changes made SSL relatively small enough SSL version 3 TLS interoperate For example way session key derived premaster key nonces SEC 8 9 WEB SECURITY changed make key stronger e harder cryptanalyze Because incompatibility browsers implement protocols TLS falling back SSL negotiation necessary This referred SSL TLS The first TLS implementation appeared 1999 version 1 2 defined August 2008 It includes support stronger cipher suites notably AES SSL remained strong marketplace although TLS probably gradually replace 8 9 4 Mobile Code Security Naming connections two areas concern related Web security But In early days Web pages static HTML files contain executable code Now often contain small programs including Java applets ActiveX controls JavaScripts Downloading executing mobile code obviously massive security risk various methods devised minimize We take quick peek issues raised mobile code approaches dealing Java Applet Security Java applets small Java programs compiled stack oriented machine language called JVM Java Virtual Machine They placed Web page downloading along page After page loaded applets inserted JVM interpreter inside browser illustrated 0xFFFFFFFF Virtual address space Untrusted applet Sandbox Trusted applet Interpreter Web browser Applets interpreted Web browser The advantage running interpreted code compiled code every instruction examined interpreter executed This gives interpreter opportunity check whether instruction address valid In addition system calls also caught interpreted How calls handled matter security policy For example applet trusted e g 858 NETWORK SECURITY came local disk system calls could carried without question However applet trusted e g came Internet could encapsulated called sandbox restrict behavior trap attempts use system resources When applet tries use system resource call passed security monitor approval The monitor examines call light local security policy makes decision allow reject In way possible give applets access resources Unfortunately reality security model works badly bugs crop time ActiveX ActiveX controls x86 binary programs embedded Web pages When one encountered check made see executed passes test executed It interpreted sandboxed way much power user program potentially great harm Thus security decision whether run ActiveX control In retrospect whole idea gigantic security hole The method Microsoft chose making decision based idea code signing Each ActiveX control accompanied digital signature hash code signed creator using public key cryptography When ActiveX control shows browser first verifies signature make sure tampered transit If signature correct browser checks internal tables see program creator trusted chain trust back trusted creator If creator trusted program executed otherwise The Microsoft system verifying ActiveX controls called Authenticode It useful contrast Java ActiveX approaches With Java approach attempt made determine wrote applet Instead run time interpreter makes sure things machine owner said applets may In contrast code signing attempt monitor mobile code run time behavior If came trusted source modified transit runs No attempt made see whether code malicious If original programmer intended code format hard disk erase flash ROM computer never booted programmer certified trusted code run destroy computer unless ActiveX controls disabled browser Many people feel trusting unknown software company scary To demonstrate problem programmer Seattle formed software company got certified trustworthy easy He wrote ActiveX control clean shutdown machine distributed ActiveX control widely It shut many machines could rebooted SEC 8 9 WEB SECURITY harm done He trying expose problem world The official response revoke certificate specific ActiveX control ended short episode acute embarrassment underlying problem still evil programmer exploit Garfinkel Spafford 2002 Since way police thousands software companies might write mobile code technique code signing disaster waiting happen JavaScript JavaScript formal security model long history leaky implementations Each vendor handles security different way For example Netscape Navigator version 2 used something akin Java model version 4 abandoned code signing model The fundamental problem letting foreign code run machine asking trouble From security standpoint like inviting burglar house trying watch carefully escape kitchen living room If something unexpected happens distracted moment bad things happen The tension mobile code allows flashy graphics fast interaction many Web site designers think much important security especially somebody else machine risk Browser Extensions As well extending Web pages code booming marketplace browser extensions add ons plug ins They computer programs extend functionality Web browsers Plug ins often provide capability interpret display certain type content PDFs Flash animations Extensions add ons provide new browser features better password management ways interact pages example marking enabling easy shopping related items Installing extension add plug simple coming across something want browsing following link install program This action cause code downloaded across Internet installed browser All programs written frameworks differ depending browser enhanced However first approximation become part trusted computing base browser That code installed buggy entire browser compromised There two obvious failure modes well The first program may behave maliciously example gathering personal information sending remote server For browser knows user installed extension precisely purpose The second problem plug ins give browser ability interpret new types content Often content full 860 NETWORK SECURITY blown programming language PDF Flash good examples When users view pages PDF Flash content plug ins browser executing PDF Flash code That code better safe often vulnerabilities exploit For reasons add ons plug ins installed needed trusted vendors Viruses Viruses another form mobile code Only unlike examples viruses invited The difference virus ordinary mobile code viruses written reproduce When virus arrives either via Web page email attachment way usually starts infecting executable programs disk When one programs run control transferred virus usually tries spread machines example emailing copies everyone victim email address book Some viruses infect boot sector hard disk machine booted virus gets run Viruses become huge problem Internet caused billions dollars worth damage There obvious solution Perhaps whole new generation operating systems based secure microkernels tight compartmentalization users processes resources might help 8 10 SOCIAL ISSUES The Internet security technology area social issues public policy technology meet head often huge consequences Below briefly examine three areas privacy freedom speech copyright Needless say scratch surface For additional reading see Anderson 2008a Garfinkel Spafford 2002 Schneier 2004 The Internet also full material Just type words privacy censorship copyright search engine Also see book Web site links It http www pearsonhighered com tanenbaum 8 10 1 Privacy Do people right privacy Good question The Fourth Amendment U S Constitution prohibits government searching people houses papers effects without good reason goes restrict circumstances search warrants shall issued Thus privacy public agenda 200 years least U S What changed past decade ease governments spy citizens ease citizens prevent SEC 8 10 SOCIAL ISSUES spying In 18th century government search citizen papers send policeman horse go citizen farm demanding see certain documents It cumbersome procedure Nowadays telephone companies Internet providers readily provide wiretaps presented search warrants It makes life much easier policeman danger falling horse Cryptography changes Anybody goes trouble downloading installing PGP uses well guarded alien strength key fairly sure nobody known universe read email search warrant search warrant Governments well understand like Real privacy means much harder spy criminals stripes also much harder spy journalists political opponents Consequently governments restrict forbid use export cryptography In France example prior 1999 cryptography banned unless government given keys France alone In April 1993 U S Government announced intention make hardware cryptoprocessor clipper chip standard networked communication It said would guarantee citizens privacy It also mentioned chip provided government ability decrypt traffic via scheme called key escrow allowed government access keys However government promised snoop valid search warrant Needless say huge furor ensued privacy advocates denouncing whole plan law enforcement officials praising Eventually government backed dropped idea A large amount information electronic privacy available Electronic Frontier Foundation Web site www eff org Anonymous Remailers PGP SSL technologies make possible two parties establish secure authenticated communication free third party surveillance interference However sometimes privacy best served authentication fact making communication anonymous The anonymity may desired point point messages newsgroups Let us consider examples First political dissidents living authoritarian regimes often wish communicate anonymously escape jailed killed Second wrongdoing many corporate educational governmental organizations often exposed whistleblowers frequently prefer remain anonymous avoid retribution Third people unpopular social political religious views may wish communicate via email newsgroups without exposing Fourth people may wish discuss alcoholism mental illness sexual harassment child abuse 862 NETWORK SECURITY member persecuted minority newsgroup without go public Numerous examples exist course Let us consider specific example In 1990s critics nontraditional religious group posted views USENET newsgroup via anonymous remailer This server allowed users create pseudonyms send email server remailed posted using pseudonyms one could tell messages really came Some postings revealed religious group claimed trade secrets copyrighted documents The religious group responded telling local authorities trade secrets disclosed copyright infringed crimes server located A court case followed server operator compelled turn mapping information revealed true identities persons made postings Incidentally first time religious group unhappy someone leaked trade secrets William Tyndale burned stake 1536 translating Bible English A substantial segment Internet community completely outraged breach confidentiality The conclusion everyone drew anonymous remailer stores mapping real email addresses pseudonyms called type 1 remailer worth much This case stimulated various people designing anonymous remailers could withstand subpoena attacks These new remailers often called cypherpunk remailers work follows The user produces email message complete RFC 822 headers except From course encrypts remailer public key sends remailer There outer RFC 822 headers stripped content decrypted message remailed The remailer accounts maintains logs even server later confiscated retains trace messages passed Many users wish anonymity chain requests multiple anonymous remailers shown Here Alice wants send Bob really really really anonymous Valentine Day card uses three remailers She composes message M puts header containing Bob email address Then encrypts whole thing remailer 3 public key E 3 indicated horizontal hatching To prepends header remailer 3 email address plaintext This message shown remailers 2 3 figure Then encrypts message remailer 2 public key E 2 indicated vertical hatching prepends plaintext header containing remailer 2 email address This message shown 1 2 Finally encrypts entire message remailer 1 public key E 1 prepends plaintext header remailer 1 email address This message shown right Alice figure message actually transmits SEC 8 10 Encrypted E1 To 1 To 2 Encrypted E2 To 2 To 3 Alice SOCIAL ISSUES Encrypted E3 To 3 To 3 To Bob To Bob To Bob To Bob M M M M Bob Anonymous remailer How Alice uses three remailers send Bob message When message hits remailer 1 outer header stripped The body decrypted emailed remailer 2 Similar steps occur two remailers Although extremely difficult anyone trace final message back Alice many remailers take additional safety precautions For example may hold messages random time add remove junk end message reorder messages make harder anyone tell message output remailer corresponds input order thwart traffic analysis For description kind remailer see Mazie res Kaashoek 1998 Anonymity restricted email Services also exist allow anonymous Web surfing using form layered path one node knows next node chain This method called onion routing node peels another layer onion determine forward packet next The user configures browser use anonymizer service proxy Tor well known example system Dingledine et al 2004 Henceforth HTTP requests go anonymizer network requests page sends back The Web site sees exit node anonymizer network source request user As long anonymizer network refrains keeping log fact one determine requested page 8 10 2 Freedom Speech Privacy relates individuals wanting restrict people see A second key social issue freedom speech opposite censorship governments wanting restrict individuals read publish With Web containing millions millions pages become censor paradise Depending nature ideology regime banned material may include Web sites containing following 864 NETWORK SECURITY 1 Material inappropriate children teenagers 2 Hate aimed various ethnic religious sexual groups 3 Information democracy democratic values 4 Accounts historical events contradicting government version 5 Manuals picking locks building weapons encrypting messages etc The usual response ban bad sites Sometimes results unexpected For example public libraries installed Web filters computers make child friendly blocking pornography sites The filters veto sites blacklists also check pages dirty words displaying In one case Loudoun County Virginia filter blocked patron search information breast cancer filter saw word breast The library patron sued Loudoun County However Livermore California parent sued public library installing filter 12 year old son caught viewing pornography What library It escaped many people World Wide Web worldwide Web It covers whole world Not countries agree allowed Web For example November 2000 French court ordered Yahoo California Corporation block French users viewing auctions Nazi memorabilia Yahoo Web site owning material violates French law Yahoo appealed U S court sided issue whose laws apply far settled Just imagine What would happen court Utah instructed France block Web sites dealing wine comply Utah much stricter laws alcohol Suppose China demanded Web sites dealing democracy banned interest State Do Iranian laws religion apply liberal Sweden Can Saudi Arabia block Web sites dealing women rights The whole issue veritable Pandora box A relevant comment John Gilmore The net interprets censorship damage routes around For concrete implementation consider eternity service Anderson 1996 Its goal make sure published information depublished rewritten common Soviet Union Josef Stalin reign To use eternity service user specifies long material preserved pays fee proportional duration size uploads Thereafter one remove edit even uploader How could service implemented The simplest model use peer peer system stored documents would placed dozens participating servers gets fraction fee thus incentive join system The servers spread many legal jurisdictions maximum resilience Lists 10 randomly selected servers would stored SEC 8 10 SOCIAL ISSUES securely multiple places compromised others would still exist An authority bent destroying document could never sure found copies The system could also made self repairing sense became known copies destroyed remaining sites would attempt find new repositories replace The eternity service first proposal censorship resistant system Since others proposed cases implemented Various new features added encryption anonymity fault tolerance Often files stored broken multiple fragments fragment stored many servers Some systems Freenet Clarke et al 2002 PASIS Wylie et al 2000 Publius Waldman et al 2000 Other work reported Serjantov 2002 Increasingly many countries trying regulate export intangibles often include Web sites software scientific papers email telephone helpdesks Even U K centuries long tradition freedom speech seriously considering highly restrictive laws would example define technical discussions British professor foreign Ph D student located University Cambridge regulated export needing government license Anderson 2002 Needless say many people consider policy outrageous Steganography In countries censorship abounds dissidents often try use technology evade Cryptography allows secret messages sent although possibly lawfully government thinks Alice Bad Person mere fact communicating Bob may get put category repressive governments understand concept transitive closure even short mathematicians Anonymous remailers help banned domestically messages foreign ones require government export license help much But Web People want communicate secretly often try hide fact communication taking place The science hiding messages called steganography Greek words covered writing In fact ancient Greeks used Herodotus wrote general shaved head messenger tattooed message scalp let hair grow back sending Modern techniques conceptually higher bandwidth lower latency require services barber As case point consider This photograph taken one authors AST Kenya contains three zebras contemplating acacia tree b appears three zebras acacia tree extra added attraction It contains complete unabridged text five 866 NETWORK SECURITY Shakespeare plays embedded Hamlet King Lear Macbeth The Merchant Venice Julius Caesar Together plays total 700 KB text b Three zebras tree b Three zebras tree complete text five plays William Shakespeare How steganographic channel work The original color image 1024 768 pixels Each pixel consists three 8 bit numbers one red green blue intensity pixel The pixel color formed linear superposition three colors The steganographic encoding method uses low order bit RGB color value covert channel Thus pixel room 3 bits secret information 1 red value 1 green value 1 blue value With image size 1024 768 3 bits 294 912 bytes secret information stored The full text five plays short notice add 734 891 bytes This text first compressed 274 KB using standard compression algorithm The compressed output encrypted using IDEA inserted low order bits color value As seen actually seen existence information completely invisible It equally invisible large full color version photo The eye easily distinguish 21 bit color 24 bit color Viewing two images black white low resolution justice powerful technique To get better feel steganography works prepared demonstration including full color highresolution image b five plays embedded The demonstration including tools inserting extracting text images found book Web site To use steganography undetected communication dissidents could create Web site bursting politically correct pictures photographs Great Leader local sports movie television stars etc Of course pictures would riddled steganographic messages If messages first SEC 8 10 SOCIAL ISSUES compressed encrypted even someone suspected presence would immense difficulty distinguishing messages white noise Of course images fresh scans copying picture Internet changing bits dead giveaway Images means carrier steganographic messages Audio files also work fine Hidden information carried voice IP call manipulating packet delays distorting audio even header fields packets Lubacz et al 2010 Even layout ordering tags HTML file carry information Although examined steganography context free speech numerous uses One common use owners images encode secret messages stating ownership rights If image stolen placed Web site lawful owner reveal steganographic message court prove whose image This technique called watermarking It discussed Piva et al 2002 For steganography see Wayner 2008 8 10 3 Copyright Privacy censorship two areas technology meets public policy A third one copyright law Copyright granting creators IP Intellectual Property including writers poets artists composers musicians photographers cinematographers choreographers others exclusive right exploit IP period time typically life author plus 50 years 75 years case corporate ownership After copyright work expires passes public domain anyone use sell wish The Gutenberg Project www promo net pg example placed thousands public domain works e g Shakespeare Twain Dickens Web In 1998 U S Congress extended copyright U S another 20 years request Hollywood claimed without extension nobody would create anything By way contrast patents last 20 years people still invent things Copyright came forefront Napster music swapping service 50 million members Although Napster actually copy music courts held holding central database song contributory infringement helping people infringe While nobody seriously claims copyright bad idea although many claim term far long favoring big corporations public next generation music sharing already raising major ethical issues For example consider peer peer network people share legal files public domain music home videos religious tracts trade secrets etc perhaps copyrighted Assume everyone online time via ADSL cable Each machine index hard 868 NETWORK SECURITY disk plus list members Someone looking specific item pick random member see If check members person list members lists Computers good kind work Having found item requester copies If work copyrighted chances requester infringing although international transfers question whose law applies matters countries uploading illegal downloading But supplier Is crime keep music paid legally downloaded hard disk others might find If unlocked cabin country IP thief sneaks carrying notebook computer scanner scans copyrighted book notebook hard disk sneaks guilty crime failing protect someone else copyright But trouble brewing copyright front There huge battle going Hollywood computer industry The former wants stringent protection intellectual property latter want Hollywood policeman In October 1998 Congress passed DMCA Digital Millennium Copyright Act makes crime circumvent protection mechanism present copyrighted work tell others circumvent Similar legislation enacted European Union While virtually one thinks pirates Far East allowed duplicate copyrighted works many people think DMCA completely shifts balance copyright owner interest public interest A case point September 2000 music industry consortium charged building unbreakable system selling music online sponsored contest inviting people try break system precisely right thing new security system A team security researchers several universities led Prof Edward Felten Princeton took challenge broke system They wrote paper findings submitted USENIX security conference underwent peer review accepted Before paper presented Felten received letter Recording Industry Association America threatened sue authors DMCA published paper Their response file lawsuit asking federal court rule whether publishing scientific papers security research still legal Fearing definitive court ruling industry withdrew threat court dismissed Felten suit No doubt industry motivated weakness case invited people try break system threatened sue accepting challenge With threat withdrawn paper published Craver et al 2001 A new confrontation virtually certain Meanwhile pirated music movies fueled massive growth peer peer networks This pleased copyright holders used DMCA take action There automated systems search peer topeer networks fire warnings network operators users SEC 8 10 SOCIAL ISSUES suspected infringing copyright In United States warnings known DMCA takedown notices This search arms race hard reliably catch copyright infringers Even printer might mistaken culprit Piatek et al 2008 A related issue extent fair use doctrine established court rulings various countries This doctrine says purchasers copyrighted work certain limited rights copy work including right quote parts scientific purposes use teaching material schools colleges cases make backup copies personal use case original medium fails The tests constitutes fair use include 1 whether use commercial 2 percentage whole copied 3 effect copying sales work Since DMCA similar laws within European Union prohibit circumvention copy protection schemes laws also prohibit legal fair use In effect DMCA takes away historical rights users give content sellers power A major showdown inevitable Another development works dwarfs even DMCA shifting balance copyright owners users trusted computing advocated industry bodies TCG Trusted Computing Group led companies like Intel Microsoft The idea provide support carefully monitoring user behavior various ways e g playing pirated music level operating system order prohibit unwanted behavior This accomplished small chip called TPM Trusted Platform Module difficult tamper Most PCs sold nowadays come equipped TPM The system allows software written content owners manipulate PCs ways users change This raises question trusted trusted computing Certainly user Needless say social consequences scheme immense It nice industry finally paying attention security lamentable driver enforcing copyright law rather dealing viruses crackers intruders security issues people concerned In short lawmakers lawyers busy balancing economic interests copyright owners public interest years come Cyberspace different meatspace constantly pits one group another resulting power struggles litigation hopefully eventually kind resolution least new disruptive technology comes along 8 11 SUMMARY Cryptography tool used keep information confidential ensure integrity authenticity All modern cryptographic systems based Kerckhoff principle publicly known algorithm secret 870 NETWORK SECURITY key Many cryptographic algorithms use complex transformations involving substitutions permutations transform plaintext ciphertext However quantum cryptography made practical use one time pads may provide truly unbreakable cryptosystems Cryptographic algorithms divided symmetric key algorithms public key algorithms Symmetric key algorithms mangle bits series rounds parameterized key turn plaintext ciphertext AES Rijndael triple DES popular symmetric key algorithms present These algorithms used electronic code book mode cipher block chaining mode stream cipher mode counter mode others Public key algorithms property different keys used encryption decryption decryption key derived encryption key These properties make possible publish public key The main public key algorithm RSA derives strength fact difficult factor large numbers Legal commercial documents need signed Accordingly various schemes devised digital signatures using symmetric key public key algorithms Commonly messages signed hashed using algorithms SHA 1 hashes signed rather original messages Public key management done using certificates documents bind principal public key Certificates signed trusted authority someone recursively approved trusted authority The root chain obtained advance browsers generally many root certificates built These cryptographic tools used secure network traffic IPsec operates network layer encrypting packet flows host host Firewalls screen traffic going organization often based protocol port used Virtual private networks simulate old leased line network provide certain desirable security properties Finally wireless networks need good security lest everyone read messages protocols like 802 11i provide When two parties establish session authenticate need establish shared session key Various authentication protocols exist including use trusted third party Diffie Hellman Kerberos public key cryptography Email security achieved combination techniques studied chapter PGP example compresses messages encrypts secret key sends secret key encrypted receiver public key In addition also hashes message sends signed hash verify message integrity Web security also important topic starting secure naming DNSsec provides way prevent DNS spoofing Most e commerce Web sites use SEC 8 11 SUMMARY SSL TLS establish secure authenticated sessions client server Various techniques used deal mobile code especially sandboxing code signing The Internet raises many issues technology interacts strongly public policy Some areas include privacy freedom speech copyright PROBLEMS 1 Break following monoalphabetic substitution cipher The plaintext consisting letters excerpt poem Lewis Carroll mvyy bek mnyx n yvjjyr snijrh invq n muvjvdt je n idnvy jurhri n fehfevir pyeir oruvdq ki ndq uri jhrnqvdt ed zb jnvy Irr uem rntrhyb jur yeoijrhi ndq jur jkhjyri nyy nqlndpr Jurb nhr mnvjvdt ed jur iuvdtyr mvyy bek pezr ndq wevd jur qndpr mvyy bek medj bek mvyy bek medj bek mvyy bek wevd jur qndpr mvyy bek medj bek mvyy bek medj bek medj bek wevd jur qndpr 2 An affine cipher version monoalphabetic substitution cipher letters alphabet size first map integers range 0 1 Subsequently integer representing plaintext letter transformed integer representing corresponding cipher text letter The encryption function single letter E x ax b mod size alphabet b key cipher co prime Trudy finds Bob generated ciphertext using affine cipher She gets copy ciphertext finds frequent letter ciphertext R second frequent letter ciphertext K Show Trudy break code retrieve plaintext 3 Break following columnar transposition cipher The plaintext taken popular computer textbook computer probable word The plaintext consists entirely letters spaces The ciphertext broken blocks five characters readability aauan cvlre rurnn dltme aeepb ytust iceat npmey iicgo gorch srsoc nntii imiha oofpa gsivt tpsit lbolr otoex 4 Alice used transposition cipher encrypt messages Bob For added security encrypted transposition cipher key using substitution cipher kept encrypted cipher computer Trudy managed get hold encrypted transposition cipher key Can Trudy decipher Alice messages Bob Why 5 Find 77 bit one time pad generates text Hello World ciphertext 6 You spy conveniently library infinite number books disposal Your operator also library disposal You agreed 872 NETWORK SECURITY use Lord Rings one time pad Explain could use assets generate infinitely long one time pad 7 Quantum cryptography requires photon gun demand fire single photon carrying 1 bit In problem calculate many photons bit carries 250 Gbps fiber link Assume length photon equal wavelength purposes problem 1 micron The speed light fiber 20 cm nsec 8 If Trudy captures regenerates photons quantum cryptography use get wrong cause errors appear Bob one time pad What fraction Bob one time pad bits error average 9 A fundamental cryptographic principle states messages must redundancy But also know redundancy helps intruder tell guessed key correct Consider two forms redundancy First initial n bits plaintext contain known pattern Second final n bits message contain hash message From security point view two equivalent Discuss answer 10 In P boxes S boxes alternate Although arrangement esthetically pleasing secure first P boxes S boxes Discuss answer 11 Design attack DES based knowledge plaintext consists exclusively uppercase ASCII letters plus space comma period semicolon carriage return line feed Nothing known plaintext parity bits 12 In text computed cipher breaking machine million processors could analyze key 1 nanosecond would take 1016 years break 128 bit version AES Let us compute long take time get 1 year still along time course To achieve goal need computers 1016 times faster If Moore Law computing power doubles every 18 months continues hold many years take parallel computer get cipherbreaking time year 13 AES supports 256 bit key How many keys AES 256 See find number physics chemistry astronomy size Use Internet help search big numbers Draw conclusion research 14 Suppose message encrypted using DES counter mode One bit ciphertext block Ci accidentally transformed 0 1 transmission How much plaintext garbled result 15 Now consider ciphertext block chaining Instead single 0 bit transformed 1 bit extra 0 bit inserted ciphertext stream block Ci How much plaintext garbled result 16 Compare cipher block chaining cipher feedback mode terms number encryption operations needed transmit large file Which one efficient much 17 Using RSA public key cryptosystem 1 b 2 25 z 26 If p 5 q 13 list five legal values CHAP 8 PROBLEMS b If p 5 q 31 37 find e c Using p 3 q 11 9 find e encrypt hello 18 Alice Bob use RSA public key encryption order communicate Trudy finds Alice Bob shared one primes used determine number n public key pairs In words Trudy found na pa q nb pb q How Trudy use information break Alice code 19 Consider use counter mode shown IV 0 Does use 0 threaten security cipher general 20 In see Alice send Bob signed message If Trudy replaces P Bob detect But happens Trudy replaces P signature 21 Digital signatures potential weakness due lazy users In e commerce transactions contract might drawn user asked sign SHA 1 hash If user actually verify contract hash correspond user may inadvertently sign different contract Suppose Mafia try exploit weakness make money They set pay Web site e g pornography gambling etc ask new customers credit card number Then send contract saying customer wishes use service pay credit card ask customer sign knowing sign without verifying contract hash agree Show Mafia buy diamonds legitimate Internet jeweler charge unsuspecting customers 22 A math class 25 students Assuming students born first half year January 1st June 30th probability least two students birthday Assume nobody born leap day 181 possible birthdays 23 After Ellen confessed Marilyn tricking matter Tom tenure Marilyn resolved avoid problem dictating contents future messages dictating machine new secretary type Marilyn planned examine messages terminal typed make sure contained exact words Can new secretary still use birthday attack falsify message Hint She 24 Consider failed attempt Alice get Bob public key Suppose Bob Alice already share secret key Alice still wants Bob public key Is way get securely If 25 Alice wants communicate Bob using public key cryptography She establishes connection someone hopes Bob She asks public key sends plaintext along X 509 certificate signed root CA Alice already public key root CA What steps Alice carry verify talking Bob Assume Bob care talking e g Bob kind public service 26 Suppose system uses PKI based tree structured hierarchy CAs Alice wants communicate Bob receives certificate Bob signed CA X establishing communication channel Bob Suppose Alice never heard X What steps Alice take verify talking Bob 874 NETWORK SECURITY 27 Can IPsec using AH used transport mode one machines behind NAT box Explain answer 28 Alice wants send message Bob using SHA 1 hashes She consults regarding appropriate signature algorithm used What would suggest 29 Give one reason firewall might configured inspect incoming traffic Give one reason might configured inspect outgoing traffic Do think inspections likely successful 30 Suppose organization uses VPN securely connect sites Internet Jim user organization uses VPN communicate boss Mary Describe one type communication Jim Mary would require use encryption security mechanism another type communication would require encryption security mechanisms Explain answer 31 Change one message protocol minor way make resistant reflection attack Explain change works 32 The Diffie Hellman key exchange used establish secret key Alice Bob Alice sends Bob 227 5 82 Bob responds 125 Alice secret number x 12 Bob secret number 3 Show Alice Bob compute secret key 33 Two users establish shared secret key using Diffie Hellman algorithm even never met share secrets certificates Explain algorithm susceptible man middle attack b How would susceptibility change n g secret 34 In protocol A sent plaintext along encrypted session key 35 In Needham Schroeder protocol Alice generates two challenges RA RA 2 This seems like overkill Would one done job 36 Suppose organization uses Kerberos authentication In terms security service availability effect AS TGS goes 37 Alice using public key authentication protocol authenticate communication Bob However sending message 7 Alice forgot encrypt RB Trudy knows value RB Do Alice Bob need repeat authentication procedure new parameters order ensure secure communication Explain answer 38 In public key authentication protocol message 7 RB encrypted KS Is encryption necessary would adequate send back plaintext Explain answer 39 Point sale terminals use magnetic stripe cards PIN codes fatal flaw malicious merchant modify card reader log information card PIN code order post additional fake transactions future Next generation terminals use cards complete CPU keyboard tiny display card Devise protocol system malicious merchants break CHAP 8 PROBLEMS 40 Is possible multicast PGP message What restrictions would apply 41 Assuming everyone Internet used PGP could PGP message sent arbitrary Internet address decoded correctly concerned Discuss answer 42 The attack shown leaves one step The step needed spoof work including might reduce potential suspicion fact What missing step 43 The SSL data transport protocol involves two nonces well premaster key What value using nonces 44 Consider image 2048 512 pixels You want encrypt file sized 2 5 MB What fraction file encrypt image What fraction would able encrypt compressed file quarter original size Show calculations 45 The image b contains ASCII text five plays Shakespeare Would possible hide music among zebras instead text If would work much could hide picture If 46 You given text file size 60 MB encrypted using steganography low order bits color image file What size image would required order encrypt entire file What size would needed file first compressed third original size Give answer pixels show calculations Assume images aspect ratio 3 2 example 3000 2000 pixels 47 Alice heavy user type 1 anonymous remailer She would post many messages favorite newsgroup alt fanclub alice everyone would know came Alice bore pseudonym Assuming remailer worked correctly Trudy could impersonate Alice After type 1 remailers shut Alice switched cypherpunk remailer started new thread newsgroup Devise way prevent Trudy posting new messages newsgroup impersonating Alice 48 Search Internet interesting case involving privacy write one page report 49 Search Internet court case involving copyright versus fair use write 1 page report summarizing findings 50 Write program encrypts input XORing keystream Find write good random number generator generate keystream The program act filter taking plaintext standard input producing ciphertext standard output vice versa The program take one parameter key seeds random number generator 51 Write procedure computes SHA 1 hash block data The procedure two parameters pointer input buffer pointer 20 byte output buffer To see exact specification SHA 1 search Internet FIPS 180 1 full specification 876 NETWORK SECURITY 52 Write function accepts stream ASCII characters encrypts input using substitution cipher Cipher Block Chaining mode The block size 8 bytes The program take plaintext standard input print ciphertext standard output For problem allowed select reasonable system determine end input reached padding applied complete block You may select output format long unambiguous The program receive two parameters 1 A pointer initializing vector 2 A number k representing substitution cipher shift ASCII character would encrypted kth character ahead alphabet For example x 3 A encoded D B encoded E etc Make reasonable assumptions respect reaching last character ASCII set Make sure document clearly code assumptions make input encryption algorithm 53 The purpose problem give better understanding mechanisms RSA Write function receives parameters primes p q calculates public private RSA keys using parameters outputs n z e printouts standard output The function also accept stream ASCII characters encrypt input using calculated RSA keys The program take plaintext standard input print ciphertext standard output The encryption carried character wise take character input encrypt independently characters input For problem allowed select reasonable system determine end input reached You may select output format long unambiguous Make sure document clearly code assumptions make input encryption algorithm 9 READING LIST AND BIBLIOGRAPHY We finished study computer networks beginning Many interesting topics treated much detail deserve others omitted altogether lack space In chapter provide suggestions reading bibliography benefit readers wish continue study computer networks 9 1 SUGGESTIONS FOR FURTHER READING There extensive literature aspects computer networks Two journals publish papers area IEEE ACM Transactions Networking IEEE Journal Selected Areas Communications The periodicals ACM Special Interest Groups Data Communications SIGCOMM Mobility Systems Users Data Computing SIGMOBILE publish many papers interest especially emerging topics They Computer Communication Review Mobile Computing Communications Review IEEE also publishes three magazines IEEE Internet Computing IEEE Network Magazine IEEE Communications Magazine contain surveys tutorials case studies networking The first two emphasize architecture standards software last tends toward communications technology fiber optics satellites 878 READING LIST AND BIBLIOGRAPHY There number annual biannual conferences attract numerous papers networks In particular look SIGCOMM conference NSDI Symposium Networked Systems Design Implementation MobiSys Conference Mobile Systems Applications Services SOSP Symposium Operating Systems Principles OSDI Symposium Operating Systems Design Implementation Below list suggestions supplementary reading keyed chapters book Many suggestions books chapters books tutorials surveys Full references Sec 9 2 9 1 1 Introduction General Works Comer The Internet Book 4th ed Anyone looking easygoing introduction Internet look Comer describes history growth technology protocols services Internet terms novices understand much material covered book also interest technical readers Computer Communication Review 25th Anniversary Issue Jan 1995 For firsthand look Internet developed special issue collects important papers 1995 Included papers show development TCP multicast DNS Ethernet overall architecture Crovella Krishnamurthy Internet Measurement How know well Internet works anyway This question trivial answer one charge Internet This book describes techniques developed measure operation Internet network infrastructure applications IEEE Internet Computing Jan Feb 2000 The first issue IEEE Internet Computing new millennium exactly would expect asked people helped create Internet previous millennium speculate going next one The experts Paul Baran Lawrence Roberts Leonard Kleinrock Stephen Crocker Danny Cohen Bob Metcalfe Bill Gates Bill Joy others See well predictions fared decade later Kipnis Beating System Abuses Standards Adoption Process Standards committees try fair vendor neutral work unfortunately companies try abuse system For example happened repeatedly company helps develop standard approved announces standard based patent owns license companies likes companies like SEC 9 1 SUGGESTIONS FOR FURTHER READING prices alone determines For look dark side standardization article excellent start Hafner Lyon Where Wizards Stay Up Late Naughton A Brief History Future Who invented Internet anyway Many people claimed credit And rightly since many people hand different ways There Paul Baran wrote report describing packet switching people various universities designed ARPANET architecture people BBN programmed first IMPs Bob Kahn Vint Cerf invented TCP IP These books tell story Internet least 2000 replete many anecdotes 9 1 2 The Physical Layer Bellamy Digital Telephony 3rd ed For look back important network telephone network authoritative book contains everything ever wanted know Particularly interesting chapters transmission multiplexing digital switching fiber optics mobile telephony DSL Hu Li Satellite Based Internet A Tutorial Internet access via satellite different using terrestrial lines Not issue delay routing switching also different In paper authors examine issues related using satellites Internet access Joel Telecommunications IEEE Communications Society For compact surprisingly comprehensive history telecommunications starting telegraph ending 802 11 article place look It also covers radio telephones analog digital switching submarine cables digital transmission television broadcasting satellites cable TV optical communications mobile phones packet switching ARPANET Internet Palais Fiber Optic Communication 5th ed Books fiber optic technology tend aimed specialist one accessible It covers waveguides light sources light detectors couplers modulation noise many topics Su The UMTS Air Interface RF Engineering This book provides detailed overview one main 3G cellular systems It focused air interface wireless protocols used mobiles network infrastructure 880 READING LIST AND BIBLIOGRAPHY Want RFID Explained Want book easy read primer unusual technology RFID physical layer works It covers aspects RFID including potential applications Some real world examples RFID deployments experience gained also convered 9 1 3 The Data Link Layer Kasim Delivering Carrier Ethernet Nowadays Ethernet local area technology The new fashion use Ethernet long distance link carrier grade Ethernet This book brings together essays cover topic depth Lin Costello Error Control Coding 2nd ed Codes detect correct errors central reliable computer networks This popular textbook explains important codes simple linear Hamming codes complex low density parity check codes It tries minimum algebra necessary still lot Stallings Data Computer Communications 9th ed Part two covers digital data transmission variety links including error detection error control retransmissions flow control 9 1 4 The Medium Access Control Sublayer Andrews et al Fundamentals WiMAX This comprehensive book gives definitive treatment WiMAX technology idea broadband wireless wireless techniques using OFDM multiple antennas multi access system Its tutorial style gives accessible treatment find heavy material Gast 802 11 Wireless Networks 2nd ed For readable introduction technology protocols 802 11 good place start It begins MAC sublayer introduces material different physical layers also security However second edition new enough much say 802 11n Perlman Interconnections 2nd ed For authoritative entertaining treatment bridges routers routing general Perlman book place look The author designed algorithms used IEEE 802 spanning tree bridge one world leading authorities various aspects networking SEC 9 1 SUGGESTIONS FOR FURTHER READING 9 1 5 The Network Layer Comer Internetworking TCP IP Vol 1 5th ed Comer written definitive work TCP IP protocol suite fifth edition Most first half deals IP related protocols network layer The chapters deal primarily higher layers also worth reading Grayson et al IP Design Mobile Networks Traditional telephone networks Internet collision course mobile phone networks implemented IP inside This book tells design network using IP protocols supports mobile telephone service Huitema Routing Internet 2nd ed If want gain deep understanding routing protocols good book Both pronounceable algorithms e g RIP CIDR unpronounceable algorithms e g OSPF IGRP BGP treated great detail Newer developments covered since older book covered explained well Koodli Perkins Mobile Inter networking IPv6 Two important network layer developments presented one volume IPv6 Mobile IP Both topics covered well Perkins one driving forces behind Mobile IP Nucci Papagiannaki Design Measurement Management Large Scale IP Networks We talked great deal networks work would design deploy manage one ISP This book fills gap looking modern methods traffic engineering ISPs provide services using networks Perlman Interconnections 2nd ed In Chaps 12 15 Perlman describes many issues involved unicast multicast routing algorithm design wide area networks networks LANs But far best part book Chap 18 author distills many years experience network protocols informative fun chapter It required reading protocol designers Stevens TCP IP Illustrated Vol 1 Chapters 3 10 provide comprehensive treatment IP related protocols ARP RARP ICMP illustrated examples 882 READING LIST AND BIBLIOGRAPHY Varghese Network Algorithmics We spent much time talking routers network elements interact This book different routers actually designed forward packets prodigious speeds For inside scoop related questions book read The author authority clever algorithms used practice implement high speed network elements software hardware 9 1 6 The Transport Layer Comer Internetworking TCP IP Vol 1 5th ed As mentioned Comer written definitive work TCP IP protocol suite The second half book UDP TCP Farrell Cahill Delay Disruption Tolerant Networking This short book one read deeper look architecture protocols applications challenged networks must operate harsh conditions connectivity The authors participated development DTNs IETF DTN Research Group Stevens TCP IP Illustrated Vol 1 Chapters 17 24 provide comprehensive treatment TCP illustrated examples 9 1 7 The Application Layer Berners Lee et al The World Wide Web Take trip back time perspective Web going person invented colleagues CERN The article focuses Web architecture URLs HTTP HTML well future directions compares distributed information systems Held A Practical Guide Content Delivery Networks 2nd ed This book gives earth exposition CDNs work emphasizing practical considerations designing operating CDN performs well Hunter et al Beginning XML 4th ed There many many books HTML XML Web services This 1000page book covers likely want know It explains write XML XHTML also develop Web services produce manipulate XML using Ajax SOAP techniques commonly used practice SEC 9 1 SUGGESTIONS FOR FURTHER READING Krishnamurthy Rexford Web Protocols Practice It would hard find comprehensive book aspects Web one It covers clients servers proxies caching might expect But also chapters Web traffic measurements well chapters current research improving Web Simpson Video Over IP 2nd ed The author takes broad look IP technology used move video across networks Internet private networks designed carry video Interestingly book oriented video professional learning networking rather way around Wittenburg Understanding Voice Over IP Technology This book covers voice IP works carrying audio data IP protocols quality service issues SIP H 323 suite protocols It necessarily detailed given material accessible broken digestible units 9 1 8 Network Security Anderson Security Engineering 2nd ed This book presents wonderful mix security techniques couched understanding people use misuse It technical Secrets Lies less technical Network Security see After introduction basic security techniques entire chapters devoted various applications including banking nuclear command control security printing biometrics physical security electronic warfare telecom security e commerce copyright protection Ferguson et al Cryptography Engineering Many books tell popular cryptographic algorithms work This book tells use cryptography cryptographic protocols designed way put together system meet security goals It fairly compact book essential reading anyone designing systems depend cryptography Fridrich Steganography Digital Media Steganography goes back ancient Greece wax melted blank tablets secret messages could applied underlying wood wax reapplied Nowadays videos audio content Internet provide different carriers secret messages Various modern techniques hiding finding information images discussed 884 READING LIST AND BIBLIOGRAPHY Kaufman et al Network Security 2nd ed This authoritative witty book first place look technical information network security algorithms protocols Secret public key algorithms protocols message hashes authentication Kerberos PKI IPsec SSL TLS email security explained carefully considerable length many examples Chapter 26 security folklore real gem In security devil details Anyone planning design security system actually used learn lot real world advice chapter Schneier Secrets Lies If read Cryptography Engineering cover cover know everything know cryptographic algorithms If read Secrets Lies cover cover done lot less time learn cryptographic algorithms whole story Most security weaknesses due faulty algorithms even keys short flaws security environment For nontechnical fascinating discussion computer security broadest sense book good read Skoudis Liston Counter Hack Reloaded 2nd ed The best way stop hacker think like hacker This book shows hackers see network argues security function entire network design afterthought based one specific technology It covers almost common attacks including social engineering types take advantage users always familiar computer security measures 9 2 ALPHABETICAL BIBLIOGRAPHY ABRAMSON N Internet Access Using VSATs IEEE Commun Magazine vol 38 pp 60 68 July 2000 AHMADI S An Overview Next Generation Mobile WiMAX Technology IEEE Commun Magazine vol 47 pp 84 88 June 2009 ALLMAN M PAXSON V On Estimating End End Network Path Properties Proc SIGCOMM 99 Conf ACM pp 263 274 1999 ANDERSON C The Long Tail Why Future Business Selling Less More rev upd ed New York Hyperion 2008a ANDERSON R J Security Engineering A Guide Building Dependable Distributed Systems 2nd ed New York John Wiley Sons 2008b ANDERSON R J Free Speech Online Offline IEEE Computer vol 25 pp 28 30 June 2002 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY ANDERSON R J The Eternity Service Proc Pragocrypt Conf CTU Publishing House pp 242 252 1996 ANDREWS J GHOSH A MUHAMED R Fundamentals WiMAX Under standing Broadband Wireless Networking Upper Saddle River NJ Pearson Education 2007 ASTELY D DAHLMAN E FURUSKAR A JADING Y LINDSTROM M PARKVALL S LTE The Evolution Mobile Broadband IEEE Commun Maga zine vol 47 pp 44 51 Apr 2009 BALLARDIE T FRANCIS P CROWCROFT J Core Based Trees CBT Proc SIGCOMM 93 Conf ACM pp 85 95 1993 BARAN P On Distributed Communications I Introduction Distributed Communica tion Networks Memorandum RM 420 PR Rand Corporation Aug 1964 BELLAMY J Digital Telephony 3rd ed New York John Wiley Sons 2000 BELLMAN R E Dynamic Programming Princeton NJ Princeton University Press 1957 BELLOVIN S The Security Flag IPv4 Header RFC 3514 Apr 2003 BELSNES D Flow Control Packet Switching Networks Communications Net works Uxbridge England Online pp 349 361 1975 BENNET C H BRASSARD G Quantum Cryptography Public Key Distribution Coin Tossing Int l Conf Computer Systems Signal Processing pp 175 179 1984 BERESFORD A STAJANO F Location Privacy Pervasive Computing IEEE Pervasive Computing vol 2 pp 46 55 Jan 2003 BERGHEL H L Cyber Privacy New Millennium IEEE Computer vol 34 pp 132 134 Jan 2001 BERNERS LEE T CAILLIAU A LOUTONEN A NIELSEN H F SECRET A The World Wide Web Commun ACM vol 37 pp 76 82 Aug 1994 BERTSEKAS D GALLAGER R Data Networks 2nd ed Englewood Cliffs NJ Prentice Hall 1992 BHATTI S N CROWCROFT J QoS Sensitive Flows Issues IP Packet Han dling IEEE Internet Computing vol 4 pp 48 57 July Aug 2000 BIHAM E SHAMIR A Differential Fault Analysis Secret Key Cryptosystems Proc 17th Ann Int l Cryptology Conf Berlin Springer Verlag LNCS 1294 pp 513 525 1997 BIRD R GOPAL I HERZBERG A JANSON P A KUTTEN S MOLVA R YUNG M Systematic Design Family Attack Resistant Authentication Proto cols IEEE J Selected Areas Commun vol 11 pp 679 693 June 1993 BIRRELL A D NELSON B J Implementing Remote Procedure Calls ACM Trans Computer Systems vol 2 pp 39 59 Feb 1984 886 READING LIST AND BIBLIOGRAPHY BIRYUKOV A SHAMIR A WAGNER D Real Time Cryptanalysis A5 1 PC Proc Seventh Int l Workshop Fast Software Encryption Berlin SpringerVerlag LNCS 1978 pp 1 8 2000 BLAZE M BELLOVIN S Tapping My Network Door Commun ACM vol 43 p 136 Oct 2000 BOGGS D MOGUL J KENT C Measured Capacity Ethernet Myths Reality Proc SIGCOMM 88 Conf ACM pp 222 234 1988 BORISOV N GOLDBERG I WAGNER D Intercepting Mobile Communications The Insecurity 802 11 Seventh Int l Conf Mobile Computing Networking ACM pp 180 188 2001 BRADEN R Requirements Internet Hosts Communication Layers RFC 1122 Oct 1989 BRADEN R BORMAN D PARTRIDGE C Computing Internet Checksum RFC 1071 Sept 1988 BRANDENBURG K MP3 AAC Explained Proc 17th Intl Conf High Quality Audio Coding Audio Engineering Society pp 99 110 Aug 1999 BRAY T PAOLI J SPERBERG MCQUEEN C MALER E YERGEAU F COWAN J Extensible Markup Language XML 1 1 Second Edition W3C Recommendation Sept 2006 BRESLAU L CAO P FAN L PHILLIPS G SHENKER S Web Caching Zipf like Distributions Evidence Implications Proc INFOCOM Conf IEEE pp 126 134 1999 BURLEIGH S HOOKE A TORGERSON L FALL K CERF V DURST B SCOTT K WEISS H Delay Tolerant Networking An Approach Interplanetary In ternet IEEE Commun Magazine vol 41 pp 128 136 June 2003 BURNETT S PAINE S RSA Security Official Guide Cryptography Berkeley CA Osborne McGraw Hill 2001 BUSH V As We May Think Atlantic Monthly vol 176 pp 101 108 July 1945 CAPETANAKIS J I Tree Algorithms Packet Broadcast Channels IEEE Trans Information Theory vol IT 5 pp 505 515 Sept 1979 CASTAGNOLI G BRAUER S HERRMANN M Optimization Cyclic Redun dancy Check Codes 24 32 Parity Bits IEEE Trans Commun vol 41 pp 883 892 June 1993 CERF V KAHN R A Protocol Packet Network Interconnection IEEE Trans Commun vol COM 2 pp 637 648 May 1974 CHANG F DEAN J GHEMAWAT S HSIEH W WALLACH D BURROWS M CHANDRA T FIKES A GRUBER R Bigtable A Distributed Storage Sys tem Structured Data Proc OSDI 2006 Symp USENIX pp 15 29 2006 CHASE J S GALLATIN A J YOCUM K G End System Optimizations High Speed TCP IEEE Commun Magazine vol 39 pp 68 75 Apr 2001 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY CHEN S NAHRSTEDT K An Overview QoS Routing Next Generation Net works IEEE Network Magazine vol 12 pp 64 69 Nov Dec 1998 CHIU D JAIN R Analysis Increase Decrease Algorithms Conges tion Avoidance Computer Networks Comput Netw ISDN Syst vol 17 pp 1 4 June 1989 CISCO Cisco Visual Networking Index Forecast Methodology 2009 2014 Cisco Systems Inc June 2010 CLARK D D The Design Philosophy DARPA Internet Protocols Proc SIGCOMM 88 Conf ACM pp 106 114 1988 CLARK D D Window Acknowledgement Strategy TCP RFC 813 July 1982 CLARK D D JACOBSON V ROMKEY J SALWEN H An Analysis TCP Processing Overhead IEEE Commun Magazine vol 27 pp 23 29 June 1989 CLARK D D SHENKER S ZHANG L Supporting Real Time Applications Integrated Services Packet Network Proc SIGCOMM 92 Conf ACM pp 14 26 1992 CLARKE A C Extra Terrestrial Relays Wireless World 1945 CLARKE I MILLER S G HONG T W SANDBERG O WILEY B Protecting Free Expression Online Freenet IEEE Internet Computing vol 6 pp 40 49 Jan Feb 2002 COHEN B Incentives Build Robustness BitTorrent Proc First Workshop Economics Peer Peer Systems June 2003 COMER D E The Internet Book 4th ed Englewood Cliffs NJ Prentice Hall 2007 COMER D E Internetworking TCP IP vol 1 5th ed Englewood Cliffs NJ Pren tice Hall 2005 CRAVER S A WU M LIU B STUBBLEFIELD A SWARTZLANDER B WALLACH D W DEAN D FELTEN E W Reading Between Lines Lessons SDMI Challenge Proc 10th USENIX Security Symp USENIX 2001 CROVELLA M KRISHNAMURTHY B Internet Measurement New York John Wiley Sons 2006 DAEMEN J RIJMEN V The Design Rijndael Berlin Springer Verlag 2002 DALAL Y METCLFE R Reverse Path Forwarding Broadcast Packets Com mun ACM vol 21 pp 1040 1048 Dec 1978 DAVIE B FARREL A MPLS Next Steps San Francisco Morgan Kaufmann 2008 DAVIE B REKHTER Y MPLS Technology Applications San Francisco Mor gan Kaufmann 2000 DAVIES J Understanding IPv6 2nd ed Redmond WA Microsoft Press 2008 DAY J D The Un Revised OSI Reference Model Computer Commun Rev vol 25 pp 39 55 Oct 1995 888 READING LIST AND BIBLIOGRAPHY DAY J D ZIMMERMANN H The OSI Reference Model Proc IEEE vol 71 pp 1334 1340 Dec 1983 DECANDIA G HASTORIN D JAMPANI M KAKULAPATI G LAKSHMAN A PILCHIN A SIVASUBRAMANIAN S VOSSHALL P VOGELS W Dynamo Amazon Highly Available Key value Store Proc 19th Symp Operating Systems Prin ACM pp 205 220 Dec 2007 DEERING S E SIP Simple Internet Protocol IEEE Network Magazine vol 7 pp 16 28 May June 1993 DEERING S CHERITON D Multicast Routing Datagram Networks Ex tended LANs ACM Trans Computer Systems vol 8 pp 85 110 May 1990 DEMERS A KESHAV S SHENKER S Analysis Simulation Fair Queue ing Algorithm Internetwork Research Experience vol 1 pp 3 26 Sept 1990 DENNING D E SACCO G M Timestamps Key Distribution Protocols Com mun ACM vol 24 pp 533 536 Aug 1981 DEVARAPALLI V WAKIKAWA R PETRESCU A THUBERT P Network Mobility NEMO Basic Support Protocol RFC 3963 Jan 2005 DIFFIE W HELLMAN M E Exhaustive Cryptanalysis NBS Data En cryption Standard IEEE Computer vol 10 pp 74 84 June 1977 DIFFIE W HELLMAN M E New Directions Cryptography IEEE Trans Information Theory vol IT 2 pp 644 654 Nov 1976 DIJKSTRA E W A Note Two Problems Connexion Graphs Numer Math vol 1 pp 269 271 Oct 1959 DILLEY J MAGGS B PARIKH J PROKOP H SITARAMAN R WHEIL B Globally Distributed Content Delivery IEEE Internet Computing vol 6 pp 50 58 2002 DINGLEDINE R MATHEWSON N SYVERSON P Tor The Second Generation Onion Router Proc 13th USENIX Security Symp USENIX pp 303 320 Aug 2004 DONAHOO M CALVERT K TCP IP Sockets C 2nd ed San Francisco Morgan Kaufmann 2009 DONAHOO M CALVERT K TCP IP Sockets Java 2nd ed San Francisco Mor gan Kaufmann 2008 DONALDSON G JONES D Cable Television Broadband Network Architectures IEEE Commun Magazine vol 39 pp 122 126 June 2001 DORFMAN R Detection Defective Members Large Population Annals Math Statistics vol 14 pp 436 440 1943 DUTCHER B The NAT Handbook New York John Wiley Sons 2001 DUTTA ROY A An Overview Cable Modem Technology Market Perspectives IEEE Commun Magazine vol 39 pp 81 88 June 2001 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY EDELMAN B OSTROVSKY M SCHWARZ M Internet Advertising Gen eralized Second Price Auction Selling Billions Dollars Worth Keywords American Economic Review vol 97 pp 242 259 Mar 2007 EL GAMAL T A Public Key Cryptosystem Signature Scheme Based Discrete Logarithms IEEE Trans Information Theory vol IT 1 pp 469 472 July 1985 EPCGLOBAL EPC Radio Frequency Identity Protocols Class Generation UHF RFID Protocol Communication 860 MHz 960 MHz Version 1 2 0 Brussels EPCglobal Inc Oct 2008 FALL K A Delay Tolerant Network Architecture Challenged Internets Proc SIGCOMM 2003 Conf ACM pp 27 34 Aug 2003 FALOUTSOS M FALOUTSOS P FALOUTSOS C On Power Law Relationships Internet Topology Proc SIGCOMM 99 Conf ACM pp 251 262 1999 FARRELL S CAHILL V Delay Disruption Tolerant Networking London Artech House 2007 FELLOWS D JONES D DOCSIS Cable Modem Technology IEEE Commun Magazine vol 39 pp 202 209 Mar 2001 FENNER B HANDLEY M HOLBROOK H KOUVELAS I Protocol Indepen dent Multicast Sparse Mode PIM SM RFC 4601 Aug 2006 FERGUSON N SCHNEIER B KOHNO T Cryptography Engineering Design Principles Practical Applications New York John Wiley Sons 2010 FLANAGAN D JavaScript The Definitive Guide 6th ed Sebastopol CA O Reilly 2010 FLETCHER J An Arithmetic Checksum Serial Transmissions IEEE Trans Commun vol COM 0 pp 247 252 Jan 1982 FLOYD S HANDLEY M PADHYE J WIDMER J Equation Based Congestion Control Unicast Applications Proc SIGCOMM 2000 Conf ACM pp 43 56 Aug 2000 FLOYD S JACOBSON V Random Early Detection Congestion Avoidance IEEE ACM Trans Networking vol 1 pp 397 413 Aug 1993 FLUHRER S MANTIN I SHAMIR A Weakness Key Scheduling Algo rithm RC4 Proc Eighth Ann Workshop Selected Areas Cryptography Berlin Springer Verlag LNCS 2259 pp 1 24 2001 FORD B Structured Streams A New Transport Abstraction Proc SIGCOMM 2007 Conf ACM pp 361 372 2007 FORD L R Jr FULKERSON D R Flows Networks Princeton NJ Princeton University Press 1962 FORD W BAUM M S Secure Electronic Commerce Upper Saddle River NJ Pren tice Hall 2000 FORNEY G D The Viterbi Algorithm Proc IEEE vol 61 pp 268 278 Mar 1973 890 READING LIST AND BIBLIOGRAPHY FOULI K MALER M The Road Carrier Grade Ethernet IEEE Commun Magazine vol 47 pp S30 S38 Mar 2009 FOX A GRIBBLE S BREWER E AMIR E Adapting Network Client Variability via On Demand Dynamic Distillation SIGOPS Oper Syst Rev vol 30 pp 160 170 Dec 1996 FRANCIS P A Near Term Architecture Deploying Pip IEEE Network Magazine vol 7 pp 30 37 May June 1993 FRASER A G Towards Universal Data Transport System IEEE J Selected Areas Commun vol 5 pp 803 816 Nov 1983 FRIDRICH J Steganography Digital Media Principles Algorithms Applications Cambridge Cambridge University Press 2009 FULLER V LI T Classless Inter domain Routing CIDR The Internet Address Assignment Aggregation Plan RFC 4632 Aug 2006 GALLAGHER R G A Minimum Delay Routing Algorithm Using Distributed Computa tion IEEE Trans Commun vol COM 5 pp 73 85 Jan 1977 GALLAGHER R G Low Density Parity Check Codes IRE Trans Information Theory vol 8 pp 21 28 Jan 1962 GARFINKEL S SPAFFORD G Web Security Privacy Commerce Sebastopol CA O Reilly 2002 GAST M 802 11 Wireless Networks The Definitive Guide 2nd ed Sebastopol CA O Reilly 2005 GERSHENFELD N KRIKORIAN R COHEN D The Internet Things Scientific American vol 291 pp 76 81 Oct 2004 GILDER G Metcalfe Law Legacy Forbes ASAP Sepy 13 1993 GOODE B Voice Internet Protocol Proc IEEE vol 90 pp 1495 1517 Sept 2002 GORALSKI W J SONET 2nd ed New York McGraw Hill 2002 GRAYSON M SHATZKAMER K WAINNER S IP Design Mobile Networks Indianapolis IN Cisco Press 2009 GROBE K ELBERS J PON Adolescence From TDMA WDM PON IEEE Commun Magazine vol 46 pp 26 34 Jan 2008 GROSS G KAYCEE M LIN A MALIS A STEPHENS J The PPP Over AAL5 RFC 2364 July 1998 HA S RHEE I LISONG X CUBIC A New TCP Friendly High Speed TCP Vari ant SIGOPS Oper Syst Rev vol 42 pp 64 74 June 2008 HAFNER K LYON M Where Wizards Stay Up Late New York Simon Schuster 1998 HALPERIN D HEYDT BENJAMIN T RANSFORD B CLARK S DEFEND B MORGAN W FU K KOHNO T MAISEL W Pacemakers Implantable Cardi SEC 9 2 ALPHABETICAL BIBLIOGRAPHY ac Defibrillators Software Radio Attacks Zero Power Defenses IEEE Symp Security Privacy pp 129 142 May 2008 HALPERIN D HU W SHETH A WETHERALL D 802 11 Multiple Anten nas Dummies Computer Commun Rev vol 40 pp 19 25 Jan 2010 HAMMING R W Error Detecting Error Correcting Codes Bell System Tech J vol 29 pp 147 160 Apr 1950 HARTE L KELLOGG S DREHER R SCHAFFNIT T The Comprehensive Guide Wireless Technology Fuquay Varina NC APDG Publishing 2000 HAWLEY G T Historical Perspectives U S Telephone Loop IEEE Commun Magazine vol 29 pp 24 28 Mar 1991 HECHT J Understanding Fiber Optics Upper Saddle River NJ Prentice Hall 2005 HELD G A Practical Guide Content Delivery Networks 2nd ed Boca Raton FL CRC Press 2010 HEUSSE M ROUSSEAU F BERGER SABBATEL G DUDA A Performance Ano maly 802 11b Proc INFOCOM Conf IEEE pp 836 843 2003 HIERTZ G DENTENEER D STIBOR L ZANG Y COSTA X WALKE B The IEEE 802 11 Universe IEEE Commun Magazine vol 48 pp 62 70 Jan 2010 HOE J Improving Start Behavior Congestion Control Scheme TCP Proc SIGCOMM 96 Conf ACM pp 270 280 1996 HU Y LI V O K Satellite Based Internet A Tutorial IEEE Commun Magazine vol 30 pp 154 162 Mar 2001 HUITEMA C Routing Internet 2nd ed Englewood Cliffs NJ Prentice Hall 1999 HULL B BYCHKOVSKY V CHEN K GORACZKO M MIU A SHIH E ZHANG Y BALAKRISHNAN H MADDEN S CarTel A Distributed Mobile Sensor Computing System Proc Sensys 2006 Conf ACM pp 125 138 Nov 2006 HUNTER D RAFTER J FAWCETT J VAN DER LIST E AYERS D DUCKETT J WATT A MCKINNON L Beginning XML 4th ed New Jersey Wrox 2007 IRMER T Shaping Future Telecommunications The Challenge Global Stan dardization IEEE Commun Magazine vol 32 pp 20 28 Jan 1994 ITU INTERNATIONAL TELECOMMUNICATION UNION ITU Internet Reports 2005 The Internet Things Geneva ITU Nov 2005 ITU INTERNATIONAL TELECOMMUNICATION UNION Measuring Information Society The ICT Development Index Geneva ITU Mar 2009 JACOBSON V Compressing TCP IP Headers Low Speed Serial Links RFC 1144 Feb 1990 JACOBSON V Congestion Avoidance Control Proc SIGCOMM 88 Conf ACM pp 314 329 1988 892 READING LIST AND BIBLIOGRAPHY JAIN R ROUTHIER S Packet Trains Measurements New Model Com puter Network Traffic IEEE J Selected Areas Commun vol 6 pp 986 995 Sept 1986 JAKOBSSON M WETZEL S Security Weaknesses Bluetooth Topics Cryp tology CT RSA 2001 Berlin Springer Verlag LNCS 2020 pp 176 191 2001 JOEL A Telecommunications IEEE Communications Society IEEE Commun Magazine 50th Anniversary Issue pp 6 14 162 167 May 2002 JOHNSON D PERKINS C ARKKO J Mobility Support IPv6 RFC 3775 June 2004 JOHNSON D B MALTZ D BROCH J DSR The Dynamic Source Routing Proto col Multi Hop Wireless Ad Hoc Networks Ad Hoc Networking Boston Addison Wesley pp 139 172 2001 JUANG P OKI H WANG Y MARTONOSI M PEH L RUBENSTEIN D En ergy Efficient Computing Wildlife Tracking Design Tradeoffs Early Experiences ZebraNet SIGOPS Oper Syst Rev vol 36 pp 96 107 Oct 2002 KAHN D The Codebreakers 2nd ed New York Macmillan 1995 KAMOUN F KLEINROCK L Stochastic Performance Evaluation Hierarchical Routing Large Networks Computer Networks vol 3 pp 337 353 Nov 1979 KARN P MACA A New Channel Access Protocol Packet Radio ARRL CRRL Amateur Radio Ninth Computer Networking Conf pp 134 140 1990 KARN P PARTRIDGE C Improving Round Trip Estimates Reliable Transport Protocols Proc SIGCOMM 87 Conf ACM pp 2 7 1987 KARP B KUNG H T GPSR Greedy Perimeter Stateless Routing Wireless Networks Proc MOBICOM 2000 Conf ACM pp 243 254 2000 KASIM A Delivering Carrier Ethernet New York McGraw Hill 2007 KATABI D HANDLEY M ROHRS C Internet Congestion Control Future High Bandwidth Delay Product Environments Proc SIGCOMM 2002 Conf ACM pp 89 102 2002 KATZ D FORD P S TUBA Replacing IP CLNP IEEE Network Magazine vol 7 pp 38 47 May June 1993 KAUFMAN C PERLMAN R SPECINER M Network Security 2nd ed Engle wood Cliffs NJ Prentice Hall 2002 KENT C MOGUL J Fragmentation Considered Harmful Proc SIGCOMM 87 Conf ACM pp 390 401 1987 KERCKHOFF A La Cryptographie Militaire J des Sciences Militaires vol 9 pp 5 38 Jan 1883 pp 161 191 Feb 1883 KHANNA A ZINKY J The Revised ARPANET Routing Metric Proc SIGCOMM 89 Conf ACM pp 45 56 1989 KIPNIS J Beating System Abuses Standards Adoption Process IEEE Com mun Magazine vol 38 pp 102 105 July 2000 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY KLEINROCK L Power Other Deterministic Rules Thumb Probabilistic Prob lems Computer Communications Proc Intl Conf Commun pp 43 1 1 43 1 10 June 1979 KLEINROCK L TOBAGI F Random Access Techniques Data Transmission Packet Switched Radio Channels Proc Nat Computer Conf pp 187 201 1975 KOHLER E HANDLEY H FLOYD S Designing DCCP Congestion Control without Reliability Proc SIGCOMM 2006 Conf ACM pp 27 38 2006 KOODLI R PERKINS C E Mobile Inter networking IPv6 New York John Wiley Sons 2007 KOOPMAN P 32 Bit Cyclic Redundancy Codes Internet Applications Proc Intl Conf Dependable Systems Networks IEEE pp 459 472 2002 KRISHNAMURTHY B REXFORD J Web Protocols Practice Boston Addison Wesley 2001 KUMAR S PAAR C PELZL J PFEIFFER G SCHIMMLER M Breaking Ciphers COPACOBANA A Cost Optimized Parallel Code Breaker Proc 8th Cryptographic Hardware Embedded Systems Wksp IACR pp 101 118 Oct 2006 LABOVITZ C AHUJA A BOSE A JAHANIAN F Delayed Internet Routing Convergence IEEE ACM Trans Networking vol 9 pp 293 306 June 2001 LAM C K M TAN B C Y The Internet Is Changing Music Industry Commun ACM vol 44 pp 62 66 Aug 2001 LAOUTARIS N SMARAGDAKIS G RODRIGUEZ P SUNDARAM R Delay Tolerant Bulk Data Transfers Internet Proc SIGMETRICS 2009 Conf ACM pp 229 238 June 2009 LARMO A LINDSTROM M MEYER M PELLETIER G TORSNER J WIEMANN H The LTE Link Layer Design IEEE Commun Magazine vol 47 pp 52 59 Apr 2009 LEE J S MILLER L E CDMA Systems Engineering Handbook London Artech House 1998 LELAND W TAQQU M WILLINGER W WILSON D On Self Similar Nature Ethernet Traffic IEEE ACM Trans Networking vol 2 pp 1 15 Feb 1994 LEMON J Resisting SYN Flood DOS Attacks SYN Cache Proc BSDCon Conf USENIX pp 88 98 2002 LEVY S Crypto Rebels Wired pp 54 61 May June 1993 LEWIS M Comparing Designing Deploying VPNs Indianapolis IN Cisco Press 2006 LI M AGRAWAL D GANESAN D VENKATARAMANI A Block Switched Networks A New Paradigm Wireless Transport Proc NSDI 2009 Conf USENIX pp 423 436 2009 894 READING LIST AND BIBLIOGRAPHY LIN S COSTELLO D Error Control Coding 2nd ed Upper Saddle River NJ Pearson Education 2004 LUBACZ J MAZURCZYK W SZCZYPIORSKI K Vice IP IEEE Spec trum pp 42 47 Feb 2010 MACEDONIA M R Distributed File Sharing IEEE Computer vol 33 pp 99 101 2000 MADHAVAN J KO D LOT L GANGPATHY V RASMUSSEN A HALEVY A Google Deep Web Crawl Proc VLDB 2008 Conf VLDB Endowment pp 1241 1252 2008 MAHAJAN R RODRIG M WETHERALL D ZAHORJAN J Analyzing MAC Level Behavior Wireless Networks Wild Proc SIGCOMM 2006 Conf ACM pp 75 86 2006 MALIS A SIMPSON W PPP SONET SDH RFC 2615 June 1999 MASSEY J L Shift Register Synthesis BCH Decoding IEEE Trans Infor mation Theory vol IT 5 pp 122 127 Jan 1969 MATSUI M Linear Cryptanalysis Method DES Cipher Advances Cryptology Eurocrypt 1993 Proceedings Berlin Springer Verlag LNCS 765 pp 386 397 1994 MAUFER T A IP Fundamentals Upper Saddle River NJ Prentice Hall 1999 MAYMOUNKOV P MAZIERES D Kademlia A Peer Peer Information System Based XOR Metric Proc First Intl Wksp Peer Peer Systems Berlin Springer Verlag LNCS 2429 pp 53 65 2002 MAZIERES D KAASHOEK M F The Design Implementation Operation Email Pseudonym Server Proc Fifth Conf Computer Commun Security ACM pp 27 36 1998 MCAFEE LABS McAfee Threat Reports First Quarter 2010 McAfee Inc 2010 MENEZES A J VANSTONE S A Elliptic Curve Cryptosystems Their Imple mentation Journal Cryptology vol 6 pp 209 224 1993 MERKLE R C HELLMAN M Hiding Signatures Trapdoor Knapsacks IEEE Trans Information Theory vol IT 4 pp 525 530 Sept 1978 METCALFE R M Computer Network Interface Design Lessons Arpanet Ethernet IEEE J Selected Areas Commun vol 11 pp 173 179 Feb 1993 METCALFE R M BOGGS D R Ethernet Distributed Packet Switching Local Computer Networks Commun ACM vol 19 pp 395 404 July 1976 METZ C Interconnecting ISP Networks IEEE Internet Computing vol 5 pp 74 80 Mar Apr 2001 MISHRA P P KANAKIA H TRIPATHI S On Hop Hop Rate Based Conges tion Control IEEE ACM Trans Networking vol 4 pp 224 239 Apr 1996 MOGUL J C IP Network Performance Internet System Handbook D C Lynch M Y Rose eds Boston Addison Wesley pp 575 575 1993 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY MOGUL J DEERING S Path MTU Discovery RFC 1191 Nov 1990 MOGUL J MINSHALL G Rethinking Nagle Algorithm Comput Commun Rev vol 31 pp 6 20 Jan 2001 MOY J Multicast Routing Extensions OSPF Commun ACM vol 37 pp 61 66 Aug 1994 MULLINS J Making Unbreakable Code IEEE Spectrum pp 40 45 May 2002 NAGLE J On Packet Switches Infinite Storage IEEE Trans Commun vol COM 5 pp 435 438 Apr 1987 NAGLE J Congestion Control TCP IP Internetworks Computer Commun Rev vol 14 pp 11 17 Oct 1984 NAUGHTON J A Brief History Future Woodstock NY Overlook Press 2000 NEEDHAM R M SCHROEDER M D Using Encryption Authentication Large Networks Computers Commun ACM vol 21 pp 993 999 Dec 1978 NEEDHAM R M SCHROEDER M D Authentication Revisited Operating Sys tems Rev vol 21 p 7 Jan 1987 NELAKUDITI S ZHANG Z L A Localized Adaptive Proportioning Approach QoS Routing IEEE Commun Magazine vol 40 pp 66 71 June 2002 NEUMAN C TS O T Kerberos An Authentication Service Computer Net works IEEE Commun Mag vol 32 pp 33 38 Sept 1994 NICHOLS R K LEKKAS P C Wireless Security New York McGraw Hill 2002 NIST Secure Hash Algorithm U S Government Federal Information Processing Stan dard 180 1993 NONNENMACHER J BIERSACK E TOWSLEY D Parity Based Loss Recovery Reliable Multicast Transmission Proc SIGCOMM 97 Conf ACM pp 289 300 1997 NUCCI A PAPAGIANNAKI D Design Measurement Management Large Scale IP Networks Cambridge Cambridge University Press 2008 NUGENT R MUNAKANA R CHIN A COELHO R PUIG SUARI J The CubeSat The PicoSatellite Standard Research Education Proc SPACE 2008 Conf AIAA 2008 ORAN D OSI IS IS Intra domain Routing Protocol RFC 1142 Feb 1990 OTWAY D REES O Efficient Timely Mutual Authentication Operating Systems Rev pp 8 10 Jan 1987 PADHYE J FIROIU V TOWSLEY D KUROSE J Modeling TCP Throughput A Simple Model Its Empirical Validation Proc SIGCOMM 98 Conf ACM pp 303 314 1998 PALAIS J C Fiber Optic Commun 5th ed Englewood Cliffs NJ Prentice Hall 2004 896 READING LIST AND BIBLIOGRAPHY PARAMESWARAN M SUSARLA A WHINSTON A B P2P Networking An Information Sharing Alternative IEEE Computer vol 34 pp 31 38 July 2001 PAREKH A GALLAGHER R A Generalized Processor Sharing Approach Flow Control Integrated Services Networks The Multiple Node Case IEEE ACM Trans Networking vol 2 pp 137 150 Apr 1994 PAREKH A GALLAGHER R A Generalized Processor Sharing Approach Flow Control Integrated Services Networks The Single Node Case IEEE ACM Trans Networking vol 1 pp 344 357 June 1993 PARTRIDGE C HUGHES J STONE J Performance Checksums CRCs Real Data Proc SIGCOMM 95 Conf ACM pp 68 76 1995 PARTRIDGE C MENDEZ T MILLIKEN W Host Anycasting Service RFC 1546 Nov 1993 PAXSON V FLOYD S Wide Area Traffic The Failure Poisson Modeling IEEE ACM Trans Networking vol 3 pp 226 244 June 1995 PERKINS C IP Mobility Support IPv4 RFC 3344 Aug 2002 PERKINS C E RTP Audio Video Internet Boston Addison Wesley 2003 PERKINS C E ed Ad Hoc Networking Boston Addison Wesley 2001 PERKINS C E Mobile IP Design Principles Practices Upper Saddle River NJ Prentice Hall 1998 PERKINS C E ROYER E The Ad Hoc On Demand Distance Vector Protocol Ad Hoc Networking edited C Perkins Boston Addison Wesley 2001 PERLMAN R Interconnections 2nd ed Boston Addison Wesley 2000 PERLMAN R Network Layer Protocols Byzantine Robustness Ph D thesis M I T 1988 PERLMAN R An Algorithm Distributed Computation Spanning Tree Extended LAN Proc SIGCOMM 85 Conf ACM pp 44 53 1985 PERLMAN R KAUFMAN C Key Exchange IPsec IEEE Internet Computing vol 4 pp 50 56 Nov Dec 2000 PETERSON W W BROWN D T Cyclic Codes Error Detection Proc IRE vol 49 pp 228 235 Jan 1961 PIATEK M KOHNO T KRISHNAMURTHY A Challenges Directions Monitoring P2P File Sharing Networks Why My Printer Received DMCA Takedown Notice 3rd Workshop Hot Topics Security USENIX July 2008 PIATEK M ISDAL T ANDERSON T KRISHNAMURTHY A VENKATARAMANI V Do Incentives Build Robustness BitTorrent Proc NSDI 2007 Conf USENIX pp 1 14 2007 PISCITELLO D M CHAPIN A L Open Systems Networking TCP IP OSI Bos ton Addison Wesley 1993 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY PIVA A BARTOLINI F BARNI M Managing Copyrights Open Networks IEEE Internet Computing vol 6 pp 18 26 May 2002 POSTEL J Internet Control Message Protocols RFC 792 Sept 1981 RABIN J MCCATHIENEVILE C Mobile Web Best Practices 1 0 W3C Recom mendation July 2008 RAMAKRISHNAM K K FLOYD S BLACK D The Addition Explicit Conges tion Notification ECN IP RFC 3168 Sept 2001 RAMAKRISHNAN K K JAIN R A Binary Feedback Scheme Congestion Avoidance Computer Networks Connectionless Network Layer Proc SIGCOMM 88 Conf ACM pp 303 313 1988 RAMASWAMI R KUMAR S SASAKI G Optical Networks A Practical Perspec tive 3rd ed San Francisco Morgan Kaufmann 2009 RATNASAMY S FRANCIS P HANDLEY M KARP R SHENKER S A Scal able Content Addressable Network Proc SIGCOMM 2001 Conf ACM pp 161 172 2001 RIEBACK M CRISPO B TANENBAUM A Is Your Cat Infected Com puter Virus Proc IEEE Percom pp 169 179 Mar 2006 RIVEST R L The MD5 Message Digest Algorithm RFC 1320 Apr 1992 RIVEST R L SHAMIR A ADLEMAN L On Method Obtaining Digital Sig natures Public Key Cryptosystems Commun ACM vol 21 pp 120 126 Feb 1978 ROBERTS L G Extensions Packet Communication Technology Hand Held Per sonal Terminal Proc Spring Joint Computer Conf AFIPS pp 295 298 1972 ROBERTS L G Multiple Computer Networks Intercomputer Communication Proc First Symp Operating Systems Prin ACM pp 3 1 3 6 1967 ROSE M T The Simple Book Englewood Cliffs NJ Prentice Hall 1994 ROSE M T The Internet Message Englewood Cliffs NJ Prentice Hall 1993 ROWSTRON A DRUSCHEL P Pastry Scalable Distributed Object Location Routing Large Scale Peer Peer Storage Utility Proc 18th Int l Conf Distributed Systems Platforms London Springer Verlag LNCS 2218 pp 329 350 2001 RUIZ SANCHEZ M A BIERSACK E W DABBOUS W Survey Taxonomy IP Address Lookup Algorithms IEEE Network Magazine vol 15 pp 8 23 Mar Apr 2001 SALTZER J H REED D P CLARK D D End End Arguments System De sign ACM Trans Computer Systems vol 2 pp 277 288 Nov 1984 SAMPLE A YEAGER D POWLEDGE P MAMISHEV A SMITH J Design RFID Based Battery Free Programmable Sensing Platform IEEE Trans Instrumentation Measurement vol 57 pp 2608 2615 Nov 2008 SAROIU S GUMMADI K GRIBBLE S Measuring Analyzing Charac teristics Napster Gnutella Hosts Multim Syst vol 9 pp 170 184 Aug 2003 898 READING LIST AND BIBLIOGRAPHY SCHALLER R Moore Law Past Present Future IEEE Spectrum vol 34 pp 52 59 June 1997 SCHNEIER B Secrets Lies New York John Wiley Sons 2004 SCHNEIER B E Mail Security New York John Wiley Sons 1995 SCHNORR C P Efficient Signature Generation Smart Cards Journal Cryptol ogy vol 4 pp 161 174 1991 SCHOLTZ R A The Origins Spread Spectrum Communications IEEE Trans Commun vol COM 0 pp 822 854 May 1982 SCHWARTZ M ABRAMSON N The AlohaNet Surfing Wireless Data IEEE Commun Magazine vol 47 pp 21 25 Dec 2009 SEIFERT R EDWARDS J The All New Switch Book NY John Wiley 2008 SENN J A The Emergence M Commerce IEEE Computer vol 33 pp 148 150 Dec 2000 SERJANTOV A Anonymizing Censorship Resistant Systems Proc First Int l Workshop Peer Peer Systems London Springer Verlag LNCS 2429 pp 111 120 2002 SHACHAM N MCKENNY P Packet Recovery High Speed Networks Using Coding Buffer Management Proc INFOCOM Conf IEEE pp 124 131 June 1990 SHAIKH A REXFORD J SHIN K Load Sensitive Routing Long Lived IP Flows Proc SIGCOMM 99 Conf ACM pp 215 226 Sept 1999 SHALUNOV S CARLSON R Detecting Duplex Mismatch Ethernet Passive Active Network Measurement Berlin Springer Verlag LNCS 3431 pp 3135 3148 2005 SHANNON C A Mathematical Theory Communication Bell System Tech J vol 27 pp 379 423 July 1948 pp 623 656 Oct 1948 SHEPARD S SONET SDH Demystified New York McGraw Hill 2001 SHREEDHAR M VARGHESE G Efficient Fair Queueing Using Deficit Round Robin Proc SIGCOMM 95 Conf ACM pp 231 243 1995 SIMPSON W Video Over IP 2nd ed Burlington MA Focal Press 2008 SIMPSON W PPP HDLC like Framing RFC 1662 July 1994b SIMPSON W The Point Point Protocol PPP RFC 1661 July 1994a SIU K JAIN R A Brief Overview ATM Protocol Layers LAN Emulation Traffic ACM Computer Communications Review vol 25 pp 6 20 Apr 1995 SKOUDIS E LISTON T Counter Hack Reloaded 2nd ed Upper Saddle River NJ Prentice Hall 2006 SMITH D K ALEXANDER R C Fumbling Future New York William Mor row 1988 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY SNOEREN A C BALAKRISHNAN H An End End Approach Host Mobil ity Int l Conf Mobile Computing Networking ACM pp 155 166 2000 SOBEL D L Will Carnivore Devour Online Privacy IEEE Computer vol 34 pp 87 88 May 2001 SOTIROV A STEVENS M APPELBAUM J LENSTRA A MOLNAR D OSVIK D DE WEGER B MD5 Considered Harmful Today Proc 25th Chaos Commu nication Congress Verlag Art Ameublement 2008 SOUTHEY R The Doctors London Longman Brown Green Longmans 1848 SPURGEON C E Ethernet The Definitive Guide Sebastopol CA O Reilly 2000 STALLINGS W Data Computer Communications 9th ed Upper Saddle River NJ Pearson Education 2010 STARR T SORBARA M COIFFI J SILVERMAN P DSL Advances Upper Saddle River NJ Prentice Hall 2003 STEVENS W R TCP IP Illustrated The Protocols Boston Addison Wesley 1994 STINSON D R Cryptography Theory Practice 2nd ed Boca Raton FL CRC Press 2002 STOICA I MORRIS R KARGER D KAASHOEK M F BALAKRISHNAN H Chord A Scalable Peer Peer Lookup Service Internet Applications Proc SIGCOMM 2001 Conf ACM pp 149 160 2001 STUBBLEFIELD A IOANNIDIS J RUBIN A D Using Fluhrer Mantin Shamir Attack Break WEP Proc Network Distributed Systems Security Symp ISOC pp 1 11 2002 STUTTARD D PINTO M The Web Application Hacker Handbook New York John Wiley Sons 2007 SU S The UMTS Air Interface RF Engineering New York McGraw Hill 2007 SULLIVAN G WIEGAND T Tree Algorithms Packet Broadcast Channels Proc IEEE vol 93 pp 18 31 Jan 2005 SUNSHINE C A DALAL Y K Connection Management Transport Protocols Computer Networks vol 2 pp 454 473 1978 TAN K SONG J ZHANG Q SRIDHARN M A Compound TCP Approach High Speed Long Distance Networks Proc INFOCOM Conf IEEE pp 1 12 2006 TANENBAUM A S Modern Operating Systems 3rd ed Upper Saddle River NJ Pren tice Hall 2007 TANENBAUM A S VAN STEEN M Distributed Systems Principles Para digms Upper Saddle River NJ Prentice Hall 2007 R S Selecting Sequence Numbers Proc SIGCOMM SIGOPS Interprocess Commun Workshop ACM pp 11 23 1975 TOMLINSON 900 READING LIST AND BIBLIOGRAPHY TUCHMAN W Hellman Presents No Shortcut Solutions DES IEEE Spectrum vol 16 pp 40 41 July 1979 TURNER J S New Directions Communications Which Way Information Age IEEE Commun Magazine vol 24 pp 8 15 Oct 1986 UNGERBOECK G Trellis Coded Modulation Redundant Signal Sets Part I Intro duction IEEE Commun Magazine vol 25 pp 5 11 Feb 1987 VALADE J PHP MySQL Dummies 5th ed New York John Wiley Sons 2009 VARGHESE G Network Algorithmics San Francisco Morgan Kaufmann 2004 VARGHESE G LAUCK T Hashed Hierarchical Timing Wheels Data Struc tures Efficient Implementation Timer Facility Proc 11th Symp Operating Systems Prin ACM pp 25 38 1987 VERIZON BUSINESS 2009 Data Breach Investigations Report Verizon 2009 VITERBI A CDMA Principles Spread Spectrum Communication Englewood Cliffs NJ Prentice Hall 1995 VON AHN L BLUM B LANGFORD J Telling Humans Computers Apart Automatically Commun ACM vol 47 pp 56 60 Feb 2004 WAITZMAN D PARTRIDGE C DEERING S Distance Vector Multicast Routing Protocol RFC 1075 Nov 1988 WALDMAN M RUBIN A D CRANOR L F Publius A Robust Tamper Evident Censorship Resistant Web Publishing System Proc Ninth USENIX Security Symp USENIX pp 59 72 2000 WANG Z CROWCROFT J SEAL Detects Cell Misordering IEEE Network Magazine vol 6 pp 8 9 July 1992 WANT R RFID Explained San Rafael CA Morgan Claypool 2006 WARNEKE B LAST M LIEBOWITZ B PISTER K S J Smart Dust Communi cating Cubic Millimeter Computer IEEE Computer vol 34 pp 44 51 Jan 2001 WAYNER P Disappearing Cryptography Information Hiding Steganography Wa termarking 3rd ed San Francisco Morgan Kaufmann 2008 WEI D CHENG J LOW S HEGDE S FAST TCP Motivation Architecture Al gorithms Performance IEEE ACM Trans Networking vol 14 pp 1246 1259 Dec 2006 WEISER M The Computer Twenty First Century Scientific American vol 265 pp 94 104 Sept 1991 WELBOURNE E BATTLE L COLE G GOULD K RECTOR K RAYMER S BALAZINSKA M BORRIELLO G Building Internet Things Using RFID IEEE Internet Computing vol 13 pp 48 55 May 2009 WITTENBURG N Understanding Voice Over IP Technology Clifton Park NY Delmar Cengage Learning 2009 SEC 9 2 ALPHABETICAL BIBLIOGRAPHY WOLMAN A VOELKER G SHARMA N CARDWELL N KARLIN A LEVY H On Scale Performance Cooperative Web Proxy Caching Proc 17th Symp Operating Systems Prin ACM pp 16 31 1999 WOOD L IVANCIC W EDDY W STEWART D NORTHAM J JACKSON C DA SILVA CURIEL A Use Delay Tolerant Networking Bundle Protocol Space Proc 59th Int l Astronautical Congress Int l Astronautical Federation pp 3123 3133 2008 WU T Network Neutrality Broadband Discrimination Journal Telecom High Tech Law vol 2 pp 141 179 2003 WYLIE J BIGRIGG M W STRUNK J D GANGER G R KILICCOTE H KHOSLA P K Survivable Information Storage Systems IEEE Computer vol 33 pp 61 68 Aug 2000 YU T HARTMAN S RAEBURN K The Perils Unauthenticated Encryption Kerberos Version 4 Proc NDSS Symposium Internet Society Feb 2004 YUVAL G How Swindle Rabin Cryptologia vol 3 pp 187 190 July 1979 ZACKS M Antiterrorist Legislation Expands Electronic Snooping IEEE Internet Computing vol 5 pp 8 9 Nov Dec 2001 ZHANG Y BRESLAU L PAXSON V SHENKER S On Characteristics Origins Internet Flow Rates Proc SIGCOMM 2002 Conf ACM pp 309 322 2002 ZHAO B LING H STRIBLING J RHEA S JOSEPH A KUBIATOWICZ J Tapestry A Resilient Global Scale Overlay Service Deployment IEEE J Selected Areas Commun vol 22 pp 41 53 Jan 2004 ZIMMERMANN P R The Official PGP User Guide Cambridge MA M I T Press 1995a ZIMMERMANN P R PGP Source Code Internals Cambridge MA M I T Press 1995b ZIPF G K Human Behavior Principle Least Effort An Introduction Human Ecology Boston Addison Wesley 1949 ZIV J LEMPEL Z A Universal Algorithm Sequential Data Compression IEEE Trans Information Theory vol IT 3 pp 337 343 May 1977 This page intentionally left blank INDEX This page intentionally left blank INDEX Numbers Acknowledgement cumulative 238 558 duplicate 577 selective 560 580 Acknowledgement clock TCP 574 Acknowledgement frame 43 ACL see Asynchronous Connectionless link Active server page 676 ActiveX 858 859 ActiveX control 678 Ad hoc network 70 299 389 392 routing 389 392 Ad hoc demand distance vector 389 Adaptation rate 301 Adaptive frequency hopping Bluetooth 324 Adaptive routing algorithm 364 Adaptive tree walk protocol 275 277 ADC see Analog Digital Converter Additive increase multiplicative decrease law 537 Address resolution protocol 467 469 gratuitous 469 Address resolution protocol proxy 469 Addressing 34 classful IP 449 451 transport layer 509 512 1 persistent CSMA 266 3GPP see Third Generation Partnership Project 4B 5B encoding 128 292 8B 10B encoding 129 295 10 Gigabit Ethernet 296 297 64B 66B encoding 297 100Base FX Ethernet 292 100Base T4 Ethernet 291 292 802 11 see IEEE 802 11 1000Base T Ethernet 295 296 A A law 153 700 AAL5 see ATM Adaptation Layer 5 Abstract Syntax Notation 1 809 Access point 19 70 299 transport layer 509 Acknowledged datagram 37 906 INDEX Adjacent router 478 Admission control 395 397 398 415 418 ADSL see Asymmetric Digital Subscriber Line Advanced audio coding 702 Advanced Encryption Standard 312 783 787 Advanced Mobile Phone System 65 167 170 Advanced Research Projects Agency 56 Advanced video coding 710 AES see Advanced Encryption Standard Aggregation route 447 AH see Authentication Header AIFS see Arbitration InterFrame Space AIMD see Additive Increase Multiplicative Decrease law Air interface 66 171 AJAX see Asynchronous JavaScript XML Akamai 745 746 Algorithm adaptive routing 364 backward learning 333 335 Bellman Ford 370 binary exponential backoff 285 286 congestion control 392 404 Dijkstra 369 encoding 550 forwarding 27 international data encryption 842 Karn 571 leaky bucket 397 407 411 longest matching prefix 448 lottery 112 Nagle 566 network layer routing 362 392 nonadaptive 363 364 reverse path forwarding 381 419 Rivest Shamir Adleman 794 796 routing 27 362 392 token bucket 408 411 Alias 617 619 630 Allocation channel 258 261 ALOHA 72 pure 262 264 slotted 264 266 Alternate mark inversion 129 AMI see Alternate Mark Inversion Amplitude shift keying 130 AMPS see Advanced Mobile Phone System Analog digital converter 699 Andreessen Marc 646 647 Anomaly rate 309 Anonymous remailer 861 863 ANSNET 60 Antenna sectored 178 Antheil George 108 Anycast routing 385 386 AODV see Ad hoc On demand Distance Vector routing AP see Access Point Apocalypse two elephants 51 52 Applet 678 Application business 3 Web 4 Application layer 45 47 48 content delivery network 734 757 distributed hash table 753 757 Domain Name System 611 623 email 623 646 multimedia 607 734 world Wide Web 646 697 Application level gateway 819 APSD see Automatic Power Save Delivery Arbitration interframe space 308 Architectural overview Web 647 649 Architecture services email 624 626 Area autonomous system backbone 476 stub 477 Area border router 476 ARP see Address Resolution Protocol ARPA see Advanced Research Projects Agency ARPANET 55 59 ARQ see Automatic Repeat reQuest AS see Autonomous System ASK see Amplitude Shift Keying ASN 1 see Abstract Syntax Notation 1 ASP see Active Server Pages Aspect ratio video 705 Association IEEE 802 11 311 Assured forwarding 423 424 Asymmetric digital subscriber line 94 124 147 248 250 vs cable 185 Asynchronous connectionless link 325 Asynchronous I O 682 Asynchronous Javascript XML 679 683 Asynchronous transfer mode 249 AT T 55 110 ATM see Asynchronous Transfer Mode ATM adaptation layer 5 250 INDEX Attack birthday 804 806 bucket brigade 835 chosen plaintext 769 ciphertext 769 denial service 820 keystream reuse 791 known plaintext 769 man middle 835 reflection 829 replay 836 Attenuation 102 109 Attribute cryptographic certificate 808 HTML 664 Auction spectrum 112 Audio digital 699 704 streaming 697 704 Audio compression 701 704 Authentication 35 IEEE 802 11 311 Needham Schroeder 836 838 using key distribution center 835 838 Authentication header 815 816 Authentication protocol 827 841 Authentication using shared secret 828 833 Authentication using Kerberos 838 840 Authentication using public keys 840 841 Authenticode 858 Authoritative record 620 Autocorrelation 176 Autonegotiation 293 Automatic power save delivery 307 Automatic repeat request 225 522 Autonomous system 432 437 472 476 474 Autoresponder 629 AVC see Advanced Video Coding B B frame 712 Backbone Internet 63 Backbone area 476 Backbone router 476 Backpressure hop hop 400 401 Backscatter RFID 74 329 Backward learning algorithm 333 335 Backward learning bridge 335 336 Balanced signal 129 130 Bandwidth 91 Bandwidth allocation 531 535 Bandwidth efficiency 126 127 Bandwidth delay product 233 267 597 Baran Paul 55 Barker sequence 302 Base station 19 70 Base station controller 171 Base T Ethernet 295 296 Base64 encoding 634 Baseband signal 91 130 Baseband transmission 125 130 Basic bit map method 270 Baud rate 127 146 BB84 protocol 773 Beacon frame 307 Beauty contest allocating spectrum 112 Bell Alexander Graham 139 Bell Operating Company 142 Bellman Ford routing algorithm 370 Bent pipe transponder 116 Berkeley socket 500 507 Best effort service 318 319 BGP see Border Gateway Protocol Big endian computer 439 Binary countdown protocol 272 273 Binary exponential backoff algorithm 285 286 Binary phase shift keying 130 Bipolar encoding 129 Birthday attack 804 806 Bit rate 127 Bit stuffing 199 Bit map protocol 270 271 BitTorrent 750 753 choked peer 752 chunk 751 free rider 752 leecher 752 seeder 751 swarm 751 tit tat strategy 752 torrent 750 tracker 751 unchoked peer 752 Blaatand Harald 320 Block cipher 779 Block code 204 908 Bluetooth 18 320 327 adaptive frequency hopping 324 applications 321 322 architecture 320 321 frame structure 325 327 link 324 link layer 324 325 pairing 320 piconet 320 profile 321 protocol stack 322 323 radio layer 324 scatternet 320 secure pairing 325 security 826 827 Bluetooth SIG 321 BOC see Bell Operating Company Body HTML tag 625 Border gateway protocol 432 479 484 Botnet 16 628 Boundary router 477 BPSK see Binary Phase Shift Keying Bridge 332 342 backward learning 335 336 compared devices 340 342 learning 334 337 spanning tree 337 340 use 332 333 Broadband 63 147 151 Broadband wireless 312 320 Broadcast control channel 173 Broadcast network 17 Broadcast routing 380 382 Broadcast storm 344 583 Broadcasting 17 283 Browser 648 extension 859 860 helper application 654 plug 653 654 859 BSC see Base Station Controller Bucket leaky 397 Bucket brigade attack 835 Buffering 222 238 290 341 Bundle delay tolerant network 601 Bundle protocol 603 605 Bursty traffic 407 Bush Vannevar 647 Business application 3 Byte stream reliable 502 Byte stuffing 198 INDEX C CA see Certification Authority Cable headend 23 63 179 Cable Internet 180 182 Cable modem 63 183 185 183 195 Cable modem termination system 63 183 Cable television 179 186 Cache ARP 468 469 DNS 620 622 848 850 poisoned 849 Web 656 690 692 Caesar cipher 769 Call management 169 Capacitive coupling 129 Capacity channel 94 CAPTCHA 16 Care address 387 Carnivore 15 Carrier extension Ethernet 294 Carrier sense multiple access 72 266 269 1 persistent 266 collision detection 268 269 nonpersistent 267 p persistent 267 Carrier sensing 260 Carrier grade Ethernet 299 Cascading style sheet 670 672 Category 3 wiring 96 Category 5 wiring 96 Category 6 wiring 96 Category 7 wiring 96 CCITT see International Telecommunication Union CCK see Complementary Code Keying CD see Committee Draft CDM see Code Division Multiplexing CDMA see Code Division Multiple Access CDMA2000 175 CDN see Content Delivery Network Cell mobile phone 167 249 Cell phone 165 first generation 166 170 second generation 170 174 third generation 65 69 174 179 Cellular base station 66 Cellular network 65 Certificate cryptographic 807 809 X 509 809 810 INDEX Certificate revocation list 813 Certification authority 807 Certification path 812 CGI see Common Gateway Interface Chain trust 812 Challenge response protocol 828 Channel access grant 174 broadcast control 173 common control 174 dedicated control 174 erasure 203 multiaccess 257 paging 174 random access 174 257 Channel allocation 258 261 dynamic 260 261 Channel capacity 94 Channel associated signaling 155 Checksum 211 CRC 210 Fletcher 212 Chip sequence CDMA 136 Choke packet 399 400 Choked peer BitTorrent 752 Chord 754 757 finger table 756 key 754 Chosen plaintext attack 769 Chromatic dispersion 103 Chrominance video 706 Chunk BitTorrent 751 CIDR see Classless InterDomain Routing Cintent delivery network 743 748 Cipher 766 AES 783 787 Caesar 769 monoalphabetic substitution 770 Rijndael 784 787 substitution 767 770 symmetric key 778 787 transposition 771 772 Cipher block chaining mode 788 789 Cipher feedback mode 789 790 Cipher modes 787 792 Ciphertext 767 Ciphertext attack 769 Circuit 35 virtual 249 Circuit switching 161 162 Clark David 51 81 Class A network 450 Class B network 450 Class C network 450 Class based routing 421 Classful addressing IP 449 451 Classic Ethernet 21 280 281 288 Classless interdomain routing 447 449 Clear send 279 Click fraud 697 Client 4 Client side Web 649 652 Client side dynamic Web page generation 676 678 Client side Web 649 652 Client stub 544 Client server model 4 Clipper chip 861 Clock recovery 127 129 Cloud computing 672 CMTS see Cable Modem Termination System Coaxial cable 97 98 Code cryptographic 766 Code division multiple access 66 108 135 170 Code division multiplexing 135 138 Code rate 204 Code signing 858 Codec 153 Codeword 204 Collision 260 Collision detection CSMA 268 269 Collision domain 289 Collision free protocol 269 273 Combing visual artifact 705 Committee draft 79 Common control channel 174 Common gateway interface 674 Common channel signaling 155 Communication medium 5 Communication satellite 116 125 Communication security 813 827 Communication subnet 24 Community antenna television 179 180 Companding 154 Comparison OSI TCP IP models 49 51 Complementary code keying 302 Compression audio 701 704 header 593 595 video 706 712 910 Computer wearable 13 Computer network see Network Conditional GET HTTP 691 Confidentiality 35 Congestion network 35 392 404 Congestion avoidance 398 Congestion collapse 393 TCP 572 Congestion control convergence 534 535 network layer 392 404 provisioning 395 TCP 571 581 Congestion window TCP 571 Connection HTTP 684 686 Connection establishment 512 517 TCP 560 562 Connection management TCP 562 565 Connection release 517 522 TCP 562 Connection reuse HTTP 684 Connection oriented service 35 38 359 361 implementation 359 361 Connectionless service 35 38 358 359 implementation 358 359 Connectivity 6 11 Constellation 146 Constellation diagram 131 Constraint length 207 Contact delay tolerant network 601 Content Internet traffic 7360738 Content delivery network 743 748 Content distribution 734 757 Content transformation 694 Contention system 262 Continuous media 699 Control channel broadcast 173 Control law 536 Convergence 372 congestion control 534 535 Convolutional code 207 Cookie 15 SYN 561 Web 658 662 Copyright 867 869 Cordless telephone 165 Core network 66 Core based tree 384 Count infinity problem 372 373 Counter mode 791 792 INDEX Crash recovery 527 530 CRC see Cyclic Redundancy Check Critique OSI TCP IP 51 53 CRL see Certificate Revocation List Cross correlation 176 Cryptanalysis 768 792 793 differential 792 793 linear 793 Cryptographic certificate 807 809 Cryptographic key 767 Cryptographic principles 776 778 Cryptographic round 780 Cryptography 766 797 AES 312 certificate 807 809 ciphertext 767 DES 780 784 Kerckhoff principle 768 key 767 one time pad 772 773 P box 779 plaintext 767 public key 793 797 quantum 773 776 Rijndael 312 S box 779 security obscurity 768 symmetric key 778 793 triple DES 782 783 vs code 766 work factor 768 Cryptology 768 CSMA see Carrier Sense Multiple Access CSMA collision avoidance 303 CSMA collision detection 268 CSMA CA see CSMA Collision Avoidance CSMA CD see CSMA Collision Detection CSNET 59 CSS see Cascading Style Sheet CTS see Clear To Send CubeSat 123 Cumulative acknowledgement 238 558 TCP 568 Custody transfer delay tolerant network 604 Cut switching 36 336 Cybersquatting 614 Cyclic redundancy check 212 Cypherpunk remailer 862 INDEX D D AMPS see Digital Advanced Mobile Phone System DAC see Digital Analog Converter Daemen Joan 784 Daemon 554 DAG see Directed Acyclic Graph Data center 64 Data delivery service IEEE 802 11 312 Data encryption standard 780 784 Data frame 43 Data link layer 43 193 251 bit stuffing 199 byte stuffing 197 design issues 194 215 elementary protocols 215 244 example protocols 244 250 sliding window protocols 226 244 stop wait protocol 222 223 Data link layer switching 332 349 Data link protocol 215 250 ADSL 248 250 elementary 215 244 examples 215 250 packet SONET 245 248 sliding window 226 244 stop wait 222 223 Data cable service interface specification 183 Datagram 37 358 Datagram congestion control protocol 503 Datagram network 358 Datagram service comparison VCs 361 362 Davies Donald 56 DB see Decibel DCCP see Datagram Congestion Controlled Protocol DCF see Distributed Coordination Function DCF interframe spacing 308 DCT see Discrete Cosine Transformation DDoS attack see Distributed Denial Service attack De facto standard 76 De jure standard 76 Decibel 94 699 Decoding audio 701 Dedicated control channel 174 Deep Web 696 Default gateway 469 Default free zone 446 Deficit round robin 414 Delay queueing 164 Delay tolerant network 599 605 architecture 600 603 custody transfer 604 protocol 603 605 Delayed acknowledgement TCP 566 Demilitarized zone 819 Denial service attack 820 distributed 821 822 Dense wavelength division multiplexing 160 DES see Data Encryption Standard Design issues data link layer 194 202 fast networks 586 590 network 33 35 network layer 355 362 transport layer 507 530 Designated router 375 478 Desktop sharing 5 Destination port 453 454 Device driver 215 DHCP see Dynamic Host Configuration Protocol DHT see Distributed Hash Table Diagonal basis quantum cryptography 774 Dial modem 62 Dialog control 44 Differential cryptanalysis 792 793 Differentiated service 421 424 440 458 Diffie Hellman protocol 833 835 DIFS see DCF InterFrame Spacing Digital advanced mobile phone system 170 Digital audio 699 704 Digital Millennium Copyright Act 14 868 Digital modulation 125 Digital signature 797 806 Digital signature standard 800 Digital subscriber line 62 147 151 Digital subscriber line access multiplexer 62 150 Digital video 704 712 Digital analog converter 700 Digitizing voice signals 153 154 Digram 770 Dijkstra Edsger 367 Dijkstra algorithm 369 Direct acyclic graph 365 Direct sequence spread spectrum 108 Directed acyclic graph 365 Directive HTML 663 Directory PKI 812 912 INDEX DIS see Draft International Standard Disassociation IEEE 802 11 311 Discovery path MTU 556 Discrete cosine transformation MPEG 707 Discrete multitone 148 Dispersion chromatic 103 Disposition message 628 Disruption tolerant network 600 Distance vector multicast routing protocol 383 Distance vector routing 370 378 Distortion 700 Distributed coordination function 304 Distributed denial service attack 821 822 Distributed Hash Table 753 757 Distributed system 2 Distribution service IEEE 802 11 311 Distribution system 299 DIX Ethernet standard 281 283 DMCA see Digital Millennium Copyright Act DMCA takedown notice 14 DMT see Discrete MultiTone DMZ see DeMilitarized Zone DNS see Domain Name System DNS Name Space 612 616 DNS spoofing 848 850 DNSsec see Domain Name System security DOCSIS see Data Over Cable Service Interface Specification Document object model 679 DOM see Document Object Model Domain collision 289 frequency 133 Domain Name System 59 611 623 authoritative record 620 622 cybersquatting 614 domain resource record 616 619 name server 619 623 name space 613 registrar 613 resource record 616 619 reverse lookup 617 spoofing 851 top level domain 613 zone 851 852 DoS attack see Denial Service attack Dot com era 647 Dotted decimal notation 443 Downstream proxy 742 Draft International Standard 79 Draft standard 82 DSL see Digital Subscriber Line DSLAM see Digital Subscriber Line Access Multiplexer DTN see Delay Tolerant Network Duplicate acknowledgement TCP 577 DVMRP see Distance Vector Multicast Routing Protocol DWDM see Dense Wavelength Division Multiplexing Dwell time 324 Dynamic channel allocation 260 261 Dynamic frequency selection 312 Dynamic host configuration protocol 470 Dynamic HTML 676 Dynamic page Web 649 Dynamic routing 364 Dynamic Web page 649 672 673 Dynamic Web page generation client side 676 678 server side 673 676 E E commerce 6 9 E mail see Email E1 line 155 EAP see Extensible Authentication Protocol Early exit 484 ECB see Electronic Code Book mode ECMP see Equal Cost MultiPath ECN see Explicit Congestion Notification EDE see Encrypt Decrypt Encrypt mode EDGE see Enhanced Data rates GSM Evolution EEE see Encrypt Encrypt Encrypt mode EIFS see Extended InterFrame Spacing Eisenhower Dwight 56 Electromagnetic spectrum 105 109 111 114 Electronic code book mode 787 788 Electronic commerce 6 Electronic mail see Email Electronic product code 327 Elephant flow 737 Email 5 623 646 architecture services 624 626 authoritative record 620 base64 encoding 634 body 625 cached record 620 INDEX Email continued envelope 625 final delivery 643 IMAP 644 645 mail server 624 mail submission 641 mailbox 625 message format 630 message transfer 624 637 643 642 MIME 633 name resolution 620 open mail relay 642 POP3 644 quoted printable encoding 634 signature block 629 simple mail transfer protocol 625 transfer agent 624 625 user agent 624 626 vacation agent 629 Webmail 645 646 X400 629 Email header 625 Email reader 626 Email security 841 846 Emoticon 623 Encapsulating security payload 817 Encapsulation packet 387 Encoding 4B 5B 292 audio 701 704 video 706 712 Ethernet 4B 5B 292 Ethernet 8B 10B 295 Ethernet 64B 66B 297 Encrypt decrypt encrypt mode 782 Encrypt encrypt encrypt mode 782 Encryption link 765 End office 140 End end argument 357 523 Endpoint multiplexing 527 Enhanced data rates GSM evolution 178 Enterprise network 19 Entity transport 496 Envelope 625 EPC see Electronic Product Code EPON see Ethernet PON Equal cost multipath 476 Erasure 716 Erasure channel 203 Error control 200 201 transport layer 522 527 Error correction 34 Error detection 33 Error syndrome 207 Error correcting code 204 209 Error detecting code 209 215 ESMTP see Extended SMTP ESP see Encapsulating Security Payload Eternity service 864 Ethernet 20 280 299 10 gigabit 296 297 100Base FX 292 100Base T4 292 1000Base T 295 296 Base T 295 296 carrier grade 299 classic 21 281 288 DIX 281 283 fast 290 293 gigabit 293 296 MAC sublayer 280 299 promiscuous mode 290 retrospective 298 299 switched 20 288 290 Ethernet carrier extension 294 Ethernet encoding 4B 5B 292 64B 66B 297 8B 10B 295 Ethernet frame bursting 294 Ethernet header 282 Ethernet hub 288 Ethernet jumbo frame 296 Ethernet performance 286 288 Ethernet PON 151 152 Ethernet port 20 Ethernet switch 20 289 EuroDOCSIS 183 EWMA see Exponentially Weighted Moving Average Expedited forwarding 422 423 Explicit congestion notification 400 Exponential decay 738 Exponentially weighted moving average 399 570 Exposed terminal problem 278 280 Extended hypertext markup language 681 Extended interframe spacing 309 Extended SMTP 639 Extended superframe 154 Extensible authentication protocol 824 914 INDEX Extensible markup language 680 Extensible stylesheet language transformation 681 Extension header IPv6 461 463 Exterior gateway protocol 431 474 F Facebook 8 Fair queueing 412 Fair use doctrine 869 Fast Ethernet 290 293 Fast network design 586 590 Fast recovery TCP 578 Fast retransmission TCP 577 Fast segment processing 590 593 FCFS see First Come First Served packet scheduling FDD see Frequency Division Duplex FDDI see Fiber Distributed Data Interface FDM see Frequency Division Multiplexing FEC see Forwarding Equivalence Class FEC see Forward Error Correction FEC see Forwarding Equivalence Class Fiber distributed data interface 272 Fiber node 180 Fiber optics 99 105 compared copper wire 104 105 Fiber home 63 100 151 Fibre channel 298 Field video 705 FIFO see First In First Out packet scheduling File transfer protocol 455 623 Filtering ingress 487 Final delivery email 643 Finger table Chord 756 Firewall 818 821 stateful 819 First come first served packet scheduling 412 First generation mobile phone network 166 170 First first packet scheduling 412 Fixed wireless 11 Flag byte 198 Flash crowd 747 748 Fletcher checksum 212 Flooding algorithm 368 370 Flow control 35 201 202 transport layer 522 527 Flow specification 416 Footprint satellite 119 Forbidden region 514 515 Foreign agent 388 487 Form Web 667 670 Forward error correction 203 715 Forwarding 363 assured 423 424 expedited 422 423 Forwarding algorithm 27 Forwarding equivalence class 472 Fourier analysis 90 Fourier series 90 Fourier transform 135 702 Fragment frame 307 packet 433 Fragmentation packet 432 436 Frame 194 acknowledgement 43 beacon 307 data 43 Frame bursting Ethernet 294 Frame fragment 307 Frame header 218 Frame structure Bluetooth 325 327 IEEE 802 11 309 310 IEEE 802 16 319 320 Framing 197 201 Free rider BitTorrent 752 Free space optics 114 Freedom speech 863 865 Frequency electromagnetic spectrum 106 Frequency division duplex 169 317 Frequency division multiplexing 132 135 Frequency hopping Bluetooth 324 Frequency hopping spread spectrum 107 Frequency masking psychoacoustics 703 Frequency reuse 65 Frequency selection dynamic 312 Frequency shift keying 130 Freshness messages 778 Front end Web server 739 FSK see Frequency Shift Keying FTP see File Transfer Program FttH see Fiber Home Full duplex link 97 Future TCP 581 582 Fuzzball 59 INDEX G G 711 standard 728 G dmt 149 G lite 150 Gatekeeper multimedia 728 Gateway 28 application level 819 default 469 media 68 multimedia 728 Gateway GPRS support node 68 Gateway mobile switching center 68 Gen 2 RFID 327 331 General packet radio service 68 Generator polynomial 213 GEO see Geostationary Earth Orbit Geostationary earth orbit 117 Geostationary satellite 117 GGSN see Gateway GPRS Support Node Gigabit Ethernet 293 296 Gigabit capable PON 151 Global Positioning System 12 121 Global system mobile communication 65 170 174 Globalstar 122 Gmail 15 GMSC see Gateway Mobile Switching Center Go back n protocol 232 239 Goodput 393 531 GPON see Gigabit capable PON GPRS see General Packet Radio Service GPS see Global Positioning System Gratuitous ARP 469 487 Gray Elisha 139 Gray code 132 Group 153 Group telephone hierarchy 153 GSM see Global System Mobile communication Guard band 133 Guard time 135 Guided transmission media 85 105 95 105 H H 225 standard 729 H 245 standard 729 H 264 standard 710 H 323 compared SIP 733 734 standard 728 731 Half duplex link 97 Hamming code 206 207 Hamming distance 205 Handoff 68 69 168 hard 178 soft 178 Handover see Handoff Hard decision decoding 208 Harmonic 90 Hashed message authentication code 817 HDLC see High level Data Link Control HDTV see High Definition TeleVision Headend cable 63 179 Header 625 email 625 Ethernet 282 IPv4 439 442 IPv6 458 463 IPv6 extension 461 463 packet 31 TCP segment 557 560 Header compression 593 595 robust 594 Header prediction 592 Helper application browser 654 Hertz 106 Hertz Heinrich 106 HF RFID 74 HFC see Hybrid Fiber Coax Hidden terminal problem 278 Hierarchical routing 378 380 High definition television 705 High level data link control 199 246 High water mark 719 History Internet 54 61 HLR see Home Location Register HMAC see Hashed Message Authentication Code Home agent 387 486 Home location 386 Home location register 171 Home network 6 10 Home subscriber server 69 Hop hop backpressure 400 401 Host 23 mobile 386 Host design fast networks 586 590 Hosting 64 916 INDEX Hot potato routing 484 Hotspot 11 HSS see Home Subscriber Server HTML see HyperText Markup Language HTTP see HyperText Transfer Protocol HTTPS see Secure HyperText Transfer Protocol Hub 340 342 compared bridge switch 340 342 Ethernet 288 satellite 119 Hybrid fiber coax 180 Hyperlink 648 Hypertext 647 Hypertext markup language 663 670 attribute 664 directive 663 tag 663 666 Hypertext transfer protocol 45 649 651 683 693 conditional get 691 connection 684 686 connection reuse 684 method 686 688 parallel connection 686 persistent connection 684 scheme 650 secure 853 Hz see Hertz I IAB see Internet Activities Board ICANN see Internet Corporation Assigned Names Number ICMP see Internet Control Message Protocol IDEA see International Data Encryption Algorithm IEEE 802 11 19 299 312 architecture 299 301 association 311 authentication 311 comparison IEEE 802 16 313 314 data delivery service 312 disassociation 311 distribution service 311 frame structure 309 310 integration service 312 MAC sublayer 299 312 MAC sublayer protocol 303 309 IEEE 802 11 continued physical layer 301 303 privacy service 312 procotol stack 299 301 reassociation 311 security 823 826 services 311 312 transmit power control 312 IEEE 802 11a 302 IEEE 802 11b 17 301 302 IEEE 802 11g 203 IEEE 802 11i 823 IEEE 802 11n 302 303 IEEE 802 16 179 313 320 architecture 314 315 comparison IEEE 802 11 313 314 frame structure 319 320 MAC sublayer protocol 317 319 physical layer 316 317 protocol stack 314 315 ranging 317 IEEE 802 1Q 346 349 IEEE 802 1X 824 IEEE see Institute Electrical Electronics Engineers IETF see Internet Engineering Task Force IGMP see Internet Group Management Protocol IKE see Internet Key Exchange IMAP see Internet Message Access Protocol IMP see Interface Message Processor Improved mobile telephone system 166 IMT 2000 174 175 IMTS see Improved Mobile Telephone System In band signaling 155 Industrial scientific medical bands 70 112 Inetd 554 Infrared Data Association 114 Infrared transmission 114 Ingress filtering 487 Initial connection protocol 511 Initialization vector 788 Input form Web 667 670 Instant messaging 8 Institute Electrical Electronics Engineers 79 Integrated services 418 421 Integration service IEEE 802 11 312 Intellectual property 867 Interdomain protocol 431 Interdomain routing 474 Interexchange carrier 143 INDEX Interface 30 air 66 171 Interface message processor 56 57 Interior gateway protocol 431 474 Interlacing video 705 Interleaving 716 Internal router 476 International data encryption algorithm 842 International Mobile Telecommunication 2000 174 175 International Standard 78 79 International Standard IS 95 170 International Standards Organization 78 International Telecommunication Union 77 Internet 2 28 architecture 61 64 backbone 63 cable 180 182 control protocols 465 470 daemon 554 history 54 61 interplanetary 18 key exchange 815 message access protocol 644 645 multicasting 484 488 protocol version 4 439 455 protocol version 6 455 465 radio 721 TCP IP layer 46 47 Internet Activities Board 81 Internet Architecture Board 81 Internet control message protocol 47 Internet Corporation Assigned Names Numbers 444 612 Internet Engineering Task Force 81 Internet exchange point 63 480 Internet group management protocol 485 Internet cable 180 182 Internet protocol IP 47 438 488 CIDR 447 449 classful addressing 449 451 control 465 470 control message 47 control protocols 465 470 dotted decimal notation 443 group management 485 IP addresses 442 455 message access 644 645 mobile 485 488 subnet 444 446 Internet protocol continued version 4 439 442 version 5 439 version 6 455 465 version 6 controversies 463 465 version 6 extension headers 461 463 version 6 main header 458 461 Internet protocol version 4 439 455 Internet protocol version 6 455 465 Internet Research Task Force 81 Internet service provider 26 62 Internet Society 81 Internet standard 82 Internet telephony 698 725 Internetwork 25 28 29 424 436 Internetwork routing 431 432 Internetworking 34 424 436 network layer 19 424 436 Internetworking network layer 424 436 Interoffice trunk 141 Interplanetary Internet 18 Intradomain protocol 431 Intradomain routing 474 Intranet 64 Intruder security 767 Inverse multiplexing 527 IP see Internet protocol IP address 442 455 CIDR 447 449 classful 449 451 NAT 451 455 prefix 443 444 IP security 814 818 transport mode 815 tunnel mode 815 IP telephony 5 IP television 9 721 IPsec see IP security IPTV see IP TeleVision IPv4 see Internet Protocol version 4 IPv5 see Internet Protocol version 5 IPv6 see Internet Protocol version 6 IrDA see Infrared Data Association Iridium 121 IRTF see Internet Research Task Force IS see International Standard IS 95 170 IS IS 378 474 ISAKMP see Internet Security Association Key Management Protocol 918 INDEX ISM see Industrial Scientific Medical bands ISO see International Standards Organization ISP see Internet Service Provider ISP network 26 Iterative query 622 ITU see International Telecommunication Union IV see Initialization Vector IXC see IntereXchange Carrier IXP see Internet eXchange Point J Java applet security 857 858 Java virtual machine 678 Java Virtual Machine 857 JavaScript 676 859 Javaserver page 675 Jitter 406 698 Jitter control 550 552 Joint photographic experts group 706 JPEG see Joint Photographic Experts Group JPEG standard 706 709 JSP see JavaServer Page Jumbo frame Ethernet 296 Jumbogram 462 JVM see Java Virtual Machine K Karn algorithm 571 KDC see Key Distribution Center Keepalive timer TCP 571 Kepler Law 116 Kerberos 838 840 realm 840 Kerckhoff principle 768 Key Chord 754 cryptographic 767 Key distribution center 807 828 authentication using 835 836 Key escrow 861 Keystream 790 Keystream reuse attack 791 Known plaintext attack 769 L L2CAP see Logical Link Control Adaptation Protocol Label edge router 472 Label switched router 472 Label switching 360 470 474 Lamarr Hedy 107 108 LAN see Local Area Network LAN virtual 21 LATA see Local Access Transport Area Layer application 45 47 48 611 758 data link 193 251 IEEE 802 11 physical 301 303 IEEE 802 16 physical 316 317 network 29 355 489 physical 89 187 session 44 45 transport 44 495 606 LCP see Link Control Protocol LDPC see Low Density Parity Check Leaky bucket algorithm 397 407 411 Learning bridge 334 337 LEC see Local Exchange Carrier Leecher BitTorrent 752 LEO see Low Earth Orbit satellite LER see Label Edge Router Level network 29 Light transmission 114 116 Limited contention protocol 274 277 Line code 126 Linear code 204 Linear cryptanalysis 793 Link asynchronous connectionless 325 Bluetooth 324 full duplex 97 half duplex 97 synchronous connection oriented 325 Link control protocol 245 Link encryption 765 Link layer Bluetooth 324 325 TCP IP 46 Link state routing 373 378 Little endian computer 429 LLC see Logical Link Control Load balancing Web server 740 Load shedding 395 401 403 INDEX Load shedding policy milk 401 wine 401 Local access transport area 142 Local area network 19 virtual 342 349 Local central office 21 Local exchange carrier 142 Local loop 140 144 152 Local number portability 144 Logical link control 283 310 Logical link control adaptation protocol 323 Long fat network 595 599 Long term evolution 69 179 314 Longest matching prefix algorithm 448 Lossless audio compression 701 Lossy audio compression 701 Lottery algorithm 112 Low density parity check 209 Low earth orbit satellite 121 121 123 Low water mark 718 LSR see Label Switched Router LTE see Long Term Evolution Luminance video 706 M M commerce 12 MAC see Medium Access Control MAC sublayer protocol 303 309 317 319 IEEE 802 11 303 309 IEEE 802 16 317 319 MACA see Multiple Access Collision Avoidance Macroblock MPEG 711 Magnetic media 95 96 MAHO see Mobile Assisted HandOff Mail server 624 Mail submission 624 637 641 Mailbox 625 Mailing list 625 Maintenance route 391 392 MAN see Metropolitan Area Network Man middle attack 835 Manchester encoding 127 MANET see Mobile Ad hoc NETwork Markup language 663 680 Marshaling parameters 544 Max min fairness 532 534 Maximum segment size TCP 559 Maximum transfer unit 433 556 Maximum transmission unit path 433 Maxwell James Clerk 105 MCI 110 MD5 804 807 Measurements network performance 584 586 Media gateway 68 Medium access control sublayer 43 257 350 320 327 Bluetooth 320 327 broadband wireless 312 320 channel allocation 258 261 Ethernet 280 299 IEEE 802 11 299 312 multiple access protocols 261 280 wireless LANs 299 312 Medium earth orbit satellite 121 MEO see Medium Earth Orbit Satellite Merkle Ralph 796 Message digest 800 801 Message disposition 628 Message format 630 Message header 688 690 Message integrity check 825 Message switching 600 Message transfer 637 643 642 Message transfer agent 624 Metafile 714 Metcalfe Robert 6 Method HTTP 686 688 Metric units 82 83 Metropolitan area network 23 MFJ see Modified Final Judgment MGW see Media GateWay MIC see Message Integrity Check Michelson Morley experiment 281 Microcell 168 Microwave transmission 110 114 Middlebox 740 Middleware 2 Milk load shedding policy 401 MIME see Multipurpose Internet Mail Extension MIME type 652 655 MIMO see Multiple Input Multiple Output Minislot 184 Mirroring Web site 744 Mobile ad hoc network 389 392 Mobile assisted handoff 174 920 Mobile code security 857 860 Mobile commerce 12 Mobile host 386 routing 386 389 Mobile Internet protocol 485 488 Mobile IP protocol 485 488 Mobile phone 164 179 Mobile phone system first generation 166 170 second generation 170 174 third generation 65 69 174 179 Mobile switching center 68 168 Mobile telephone 164 179 Mobile telephone switching office 168 Mobile telephone system 164 179 Mobile user 10 13 Mobile Web 693 695 Mobile wireless 11 Mockapetris Paul 52 Modem 145 cable 63 183 195 dial 62 V 32 146 V 34 146 V 90 147 Modified final judgment 142 Modulation 130 132 amplitude shift keying 130 131 BPSK 302 digital 125 discrete multitone 149 frequency shift keying 130 131 phase shift keying 130 131 pulse code 153 quadrature phase shift keying 131 trellis coded 146 Monoalphabetic substitution cipher 770 MOSPF see Multicast OSPF Motion picture experts group 709 Mouse 737 Mouse flow 737 MP3 702 MP4 702 MPEG see Motion Picture Experts Group MPEG compression 709 712 frame types 712 MPEG 1 710 MPEG 2 710 MPEG 4 710 MPEG standards 709 710 INDEX MPLS see MultiProtocol Label Switching MSC see Mobile Switching Center MSS see Maximum Segment Size MTSO see Mobile Telephone Switching Office MTU see Maximum Transfer Unit Mu law 700 Mu law 153 Multiaccess channel 257 Multiaccess network 475 Multicast OSPF 383 Multicast routing 382 382 385 Multicasting 17 283 382 Internet 484 488 Multidestination routing 380 Multihoming 481 Multihop network 75 Multimedia 697 734 699 Internet telephony 728 734 jitter control 550 552 live streaming 721 724 MP3 702 704 RTSP 715 streaming audio 699 704 video demand 713 720 videoconferencing 725 728 voice IP 728 734 Multimode fiber 101 Multipath fading 70 111 Multiple access protocol 261 280 Multiple access collision avoidance 279 Multiple input multiple output 303 Multiplexing 125 152 160 endpoint 527 inverse 527 statistical 34 Multiprotocol label switching 357 360 471 474 Multiprotocol router 429 Multipurpose internet mail extension 632 637 Multithreaded Web server 656 Multitone discrete 148 Mutlimedia streaming video 704 712 N Nagle algorithm 566 Name resolution 620 Name server 619 623 Naming see Addressing 921 INDEX Naming secure 848 853 NAP see Network Access Point NAT see Network Address Translation NAT box 453 National Institute Standards Technology 79 783 National Security Agency 782 NAV see Network Allocation Vector NCP see Network Control Protocol Near field communication 12 Needham Schroeder authentication 836 838 Negotiation protocol 35 Network ad hoc 70 299 389 392 ALOHA 72 broadcast 17 cellular 65 delay tolerant 599 605 enterprise 19 first generation mobile phone 166 170 home 6 10 local area 19 metropolitan area 23 multiaccess 475 multihop 75 passive optical 151 peer peer 7 performance 582 599 personal area 18 point point 17 power line 10 22 public switched telephone 68 139 scalable 34 second generation mobile phone 170 174 sensor 13 73 75 social 8 stub 481 third generation mobile phone 65 69 174 179 uses 3 16 virtual circuit 358 virtual private 4 26 wide area 23 Network accelerator 215 Network access point 60 61 Network address translation 452 455 Network allocation vector 305 Network architecture 31 Network control protocol 245 Network design issues 33 35 Network hardware 17 29 Network interface card 202 215 Network interface device 149 Network layer 43 44 355 489 congestion control 392 404 design issues 355 362 Internet 436 488 internetworking 424 436 quality service 404 424 routing algorithms 362 392 Network neutrality 14 Network overlay 430 Network performance measurement 584 586 Network protocol see Protocol Network service access point 509 Network service provider 26 Network software 29 41 Network standardization 75 82 NFC see Near Field Communication NIC see Network Interface Card NID see Network Interface Device NIST see National Institute Standards Technology Node B 66 Node identifier 754 Non return zero inverted encoding 127 Non return zero modulation 125 Nonadaptive algorithm 363 364 Nonce 824 Nonpersistent CSMA 267 Nonpersistent Web cookie 659 Nonrepudiation 798 Notification explicit congestion 400 NRZ see Non Return Zero modulation NRZI see Non Return Zero Inverted encoding NSA see National Security Agency NSAP see Network Service Access Point NSFNET 59 61 Nyquist frequency 94 146 153 O OFDM see Orthogonal Frequency Division Multiplexing OFDMA see Orthogonal Frequency Division Multiple Access One time pad 772 773 Onion routing 863 Open mail relay 642 922 INDEX Open shortest path first 378 Open shortest path first routing 474 479 Open Systems Interconnection 41 45 comparison TCP IP 49 51 Open Systems Interconnection application layer 45 critique 51 53 data link layer 43 network layer 43 44 physical layer 43 presentation layer 45 reference model 41 45 session layer 44 45 transport layer 44 Optimality principle 364 365 Organizationally unique identifier 283 Orthogonal frequency division multiple access 316 Orthogonal frequency division multiplexing 71 133 134 302 Orthogonal sequence 136 OSI see Open Systems Interconnection OSPF see Open Shortest Path First routing OSPF see Open Shortest Path First routing OUI see Organizationally Unique Identifier Out band signaling 155 Overlay 430 network 430 Overprovisioning 404 P P box cryptographic 779 P frame 611 712 P persistent CSMA 267 P2P see Peer peer network Packet 17 36 Packet encapsulation 387 Packet filter 819 Packet fragmentation 432 436 433 Packet header 31 Packet SONET 245 248 Packet scheduling 411 414 Packet switching 162 164 store forward 356 Packet train 736 Page Web 647 Paging channel 174 Pairing Bluetooth 320 PAN see Personal Area Network PAR see Positive Acknowledgement Retransmission protocol Parallel connection HTTP 686 Parameters marshaling 544 Parity bit 210 Parity packet 716 Passband 91 Passband signal 130 Passband transmission 125 130 132 Passive optical network 151 Passive RFID 73 Passkey 826 Path autonomous system 481 certification 812 maximum transmission unit 433 Path diversity 70 Path loss 109 Path maximum transmission unit discovery 433 Path MTU discovery 556 Path vector protocol 481 PAWS see Protection Against Wrapped Sequence numbers PCF see Point Coordination Function PCM see Pulse Code Modulation PCS see Personal Communications Service Peer 29 63 Peer peer network 7 14 735 748 753 BitTorrent 750 753 content distribution 750 753 Peering 481 Per hop behavior 421 Perceptual coding 702 Performance TCP 582 599 Performance issues networks 582 599 Performance measurements network 584 586 Perlman Radia 339 Persistence timer TCP 571 Persistent nonpersistent CSMA 266 268 Persistent connection HTTP 684 Persistent cookie Web 659 Personal area network 18 Personal communications service 170 PGP see Pretty Good Privacy Phase shift keying 130 Phishing 16 Phone see Telephone Photon 774 776 872 PHP 674 INDEX Physical layer 89 187 cable television 179 186 code division multiplexing 135 138 communication satellites 116 125 fiber optics 99 104 frequency division multiplexing 132 135 IEEE 802 11 301 303 IEEE 802 16 316 317 mobile telephones 164 179 modulation 125 135 Open Systems Interconnection 43 telephone system 138 164 time division multiplexing 135 twisted pairs 96 98 wireless transmission 105 116 Physical medium 30 Piconet Bluetooth 320 Piggybacking 226 PIM see Protocol Independent Multicast Ping 467 Pipelining 233 Pixel 704 PKI see Public Key Infrastructure Plain old telephone service 148 Plaintext 767 Playback point 551 Plug browser 653 859 Podcast 721 Poem spanning tree 339 Point coordination function 304 Point presence 63 143 Point point network 17 Point point protocol 198 245 Poisoned cache 849 Poisson model 260 Polynomial generator 213 Polynomial code 212 PON see Passive Optical Network POP see Point Presence POP3 see Post Office Protocol Port destination 453 454 Ethernet 20 source 453 TCP 553 transport layer 509 UDP 542 Portmapper 510 Positive acknowledgement retransmision protocol 225 Post Telegraph Telephone administration 77 Post office protocol version 3 644 POTS see Plain Old Telephone Service Power 532 Power law 737 Power line network 10 22 98 99 Power save mode 307 Power line network 10 22 PPP see Point Point Protocol PPP ATM 250 PPPoA see PPP ATM Preamble 200 Prediction header 592 Predictive encoding 548 Prefix IP address 443 444 Premaster key 854 Presentation layer 45 Pretty good privacy 842 846 Primitive service 38 40 Principal security 773 Privacy 860 861 Privacy amplification 776 Privacy service IEEE 802 11 312 Private key ring 845 Private network virtual 26 821 Process server 511 Procotol stack IEEE 802 11 299 301 Product cipher 780 Product code electronic 327 Profile Bluetooth 321 Progressive video 705 Promiscuous mode Ethernet 290 Proposed standard 81 Protection wrapped sequence numbers 516 560 Protocol 29 1 bit sliding window 229 232 adaptive tree walk 275 277 address resolution 467 469 address resolution gratuitous 469 address resolution protocol proxy 469 authentication protocols 827 841 BB84 773 binary countdown 272 273 bit map 270 271 Bluetooth 322 323 Bluetooth protocol stack 322 323 border gateway 432 479 484 bundle 603 605 carrier sense multiple access 266 269 challenge response 828 924 INDEX Protocol continued collision free 269 273 CSMA 266 269 data link 215 250 datagram congestion control 503 delay tolerant network 603 605 Diffie Hellman 833 835 distance vector multicast routing 383 dotted decimal notation Internet 443 DVMR 383 dynamic host configuration 470 extensible authentication 824 exterior gateway 431 474 file transfer 455 623 go back n 232 239 hypertext transfer 45 649 651 683 693 IEEE 802 11 299 312 IEEE 802 16 312 320 initial connection 511 interdomain 431 interior gateway 431 474 IP 438 488 intradomain 431 limited contention 274 277 link control 245 logical link control adaptation 323 long fat network 595 599 MAC 261 280 mobile IP 485 488 multiple access 261 280 multiprotocol label switching 360 471 474 multiprotocol router 429 negotiation 35 network 29 network control 245 packet SONET 245 248 path vector 481 point point 198 245 POP3 644 positive acknowledgement retransmission real time streaming 715 real time 606 real time transport 546 550 relation services 40 request reply 37 reservation 271 resource reservation 418 selective repeat 239 244 session initiation 731 735 Protocol continued simple Internet plus 457 simple mail transfer 625 638 641 sliding window 226 244 229 232 522 SLIP 245 SOAP 682 stop wait 221 226 522 stream 503 527 stream control transmission 503 527 subnet Internet 444 446 TCP see Transmission Control Protocol temporary key integrity 825 TKIP 825 token passing 271 272 transport 507 530 541 582 tree walk 275 277 UDP 541 552 utopia 220 222 wireless application 693 wireless LAN 277 280 Protocol 1 utopia 220 222 Protocol 2 stop wait 221 222 Protocol 3 PAR 222 226 Protocol 4 sliding window 229 232 Protocol 5 go back n 232 239 Protocol 6 selective repeat 239 244 Protocol hierarchy 29 33 Protocol independent multicast 385 485 Protocol layering 34 Protocol stack 31 32 Bluetooth 322 323 H 323 728 731 IEEE 802 11 299 301 IEEE 802 16 314 315 OSI 41 45 TCP IP 45 48 Proxy ARP 469 Proxy caching Web 692 PSK see Phase Shift Keying PSTN see Public Switched Telephone Network Psychoacoustic audio encoding 702 703 PTT see Post Telegraph Telephone administration Public switched telephone network 68 138 164 139 Public key authentication using 840 841 Public key cryptography 793 797 algoirhtms 796 797 RSA 794 796 Public key infrastructure 810 813 directory 812 Public key ring 845 INDEX Public key signature 799 800 Pulse code modulation 153 Pure ALOHA 262 265 Push talk system 166 Q Q 931 standard 729 QAM see Quadrature Amplitude Modulation QoS see Quality Service QoS traffic scheduling see Transmit power control QPSK see Quadrature Phase Shift Keying Quadrature amplitude modulation 132 Quadrature phase shift keying 131 Quality service 35 404 424 411 414 admission control 415 418 application requirements 405 406 differentiated services 421 424 integrated services 418 421 network layer 404 424 requirements 405 406 traffic shaping 407 411 Quality service routing 415 Quantization MPEG 707 Quantization noise 700 Quantum cryptography 773 776 Qubit 774 Queueing delay 164 Queueing theory 259 Quoted printable encoding 634 R RA see Regional Authority Radio access network 66 Radio frequency identification 10 327 332 active 74 backscatter 329 generation 2 327 331 HF 74 LF 74 passive 74 UHF 73 74 Radio network controller 66 Radio transmission 109 110 Random access channel 174 257 Random early detection 403 404 Ranging 184 IEEE 802 16 317 RAS see Registration Admission Status Rate adaptation 301 Rate anomaly 309 Rate regulation sending 535 539 Real time audio 697 Real time conferencing 724 734 Real time protocol 606 Real time streaming protocol 715 Real time transport protocols 546 550 Real time video 697 Realm Kerberos 840 Reassociation IEEE 802 11 311 Receiving window 228 Recovery clock 127 129 crash 527 530 fast 578 Rectilinear basis quantum cryptography 774 Recursive query 621 RED see Random Early Detection Redundancy quantum cryptography 777 778 Reed Solomon code 208 Reference model 41 54 Open Systems Interconnection 41 45 TCP IP 45 51 Reflection attack 829 Region network 379 Regional Authority 811 Registrar 613 Registration admission status 729 Relation protocols services 40 Relation services protocols 40 Reliable byte stream 502 Remailer anonymous 861 863 cypherpunk 862 Remote login 61 405 406 Remote procedure call 543 546 marshaling parameters 544 stubs 544 Rendezvous point 384 Repeater 281 340 342 Replay attack 836 Request comments 81 Request header 688 Request send 279 Request reply protocol 37 926 INDEX Request reply service 37 Reservation protocol 271 Resilient packet ring 271 272 Resolver 612 Resource record 616 Resource record set 851 Resource reservation protocol 418 Resource sharing 3 Response header 688 Retransmission fast 577 Retransmission timeout TCP 568 Retransmission timer 570 571 Retrospective Ethernet 298 299 Reverse lookup 617 Reverse path forwarding algorithm 381 419 Revocation certificate 812 813 RFC see Request For Comments RFC 768 541 RFC 793 552 RFC 821 625 RFC 822 625 630 632 633 635 636 843 862 RFC 1058 373 RFC 1122 553 RFC 1191 556 RFC 1323 516 596 RFC 1521 634 RFC 1663 246 RFC 1700 441 RFC 1939 644 RFC 1958 436 RFC 2018 553 RFC 2109 659 RFC 2326 719 RFC 2364 250 RFC 2410 814 RFC 2440 843 RFC 2459 809 RFC 2535 851 853 RFC 2581 553 RFC 2597 423 RFC 2615 247 RFC 2616 683 689 RFC 2854 635 RFC 2883 560 580 RFC 2965 689 RFC 2988 553 570 RFC 2993 455 RFC 3003 635 RFC 3022 452 RFC 3023 635 RFC 3119 717 RFC 3168 553 558 581 RFC 3174 804 RFC 3194 460 RFC 3246 422 RFC 3261 731 RFC 3344 487 RFC 3376 485 RFC 3390 574 RFC 3501 644 RFC 3517 580 RFC 3550 549 RFC 3748 824 RFC 3775 488 RFC 3782 580 RFC 3875 674 RFC 3963 488 RFC 3986 652 RFC 4120 838 RFC 4306 815 RFC 4409 642 RFC 4614 553 RFC 4632 447 RFC 4838 601 RFC 4960 582 RFC 4987 562 RFC 5050 603 RFC 5246 856 RFC 5280 809 RFC 5321 625 633 639 RFC 5322 625 630 631 632 633 760 RFC 5681 581 RFC 5795 595 RFID see Radio Frequency IDentification RFID backscatter 74 RFID network 73 75 Rijmen Vincent 784 Rijndael 784 787 Rijndael cipher 312 Ring resilient packet 271 token 271 Rivest Ron 773 792 795 797 804 Rivest Shamir Adleman algorithm 794 796 RNC see Radio Network Controller Robbed bit signaling 155 Roberts Larry 56 Robust header compression 594 ROHC see RObust Header Compression Root name server 620 INDEX Routing algorithm 27 34 362 362 392 ad hoc network 389 392 adaptive 364 anycast 385 386 AODV 389 Bellman Ford 370 broadcast 380 382 class based 421 classless interdomain 447 449 distance vector multicast protocol 383 dynamic 364 hierarchical 378 380 hot potato 484 interdomain 474 internetwork 431 432 intradomain 474 link state 373 378 mobile host 386 389 multicast 382 385 multidestination 380 network layer 362 392 onion 863 OSPF 464 479 distance vector multicast 383 quality service 415 session 362 shortest path 366 368 static 364 traffic aware 395 396 triangle 388 wormhole 336 Routing policy 432 RPC see Remote Procedure Call RPR see Resilient Packet Ring RRSet see Resource Record Set RSA see Rivest Shamir Adleman algorithm RSVP see Resource reSerVation Protocol RTCP see Real time Transport Control Protocol RTO see Retransmission TimeOut TCP RTP see Real time Transport Protocol RTS see Request To Send RTSP see Real Time Streaming Protocol Run length encoding 709 S S box cryptographic 779 S MIME 846 SA see Security Association SACK see Selective ACKnowledgement Sandbox 858 Satellite communication 116 125 geostationary 117 low earth orbit 121 123 medium earth orbit 121 Satellite footprint 119 Satellite hub 119 Sawtooth TCP 579 Scalable network 34 Scatternet Bluetooth 320 Scheduling packet 411 414 Scheme HTTP 650 SCO see Synchronous Connection Oriented link Scrambler 128 SCTP see Stream Control Transmission Protocol SDH see Synchronous Digital Hierarchy Second generation mobile phone network 170 174 Sectored antenna 178 Secure DNS 850 853 Secure HTTP 853 Secure naming 848 853 Secure pairing bluetooth 325 Secure simple pairing Bluetooth 325 Secure sockets layer 853 857 Secure MIME 846 Security Bluetooth 826 827 communication 813 827 email 841 846 IEEE 802 11 823 826 IP 814 818 Java applet 857 858 mobile code 857 860 social issues 860 869 transport layer 856 Web 856 860 wireless 822 827 Security association 815 Security obscurity 768 Security principal 773 Security threats 847 848 Seeder BitTorrent 751 Segment 499 542 Segment header TCP 557 560 Selective acknowledgement TCP 560 580 Selective repeat protocol 239 244 Self similarity 737 928 Sending rate regulation 535 539 Sending window 228 Sensor network 13 73 75 Serial line Internet protocol 245 Server 4 Server farm 64 738 741 Server side Web 655 658 Server side Web page generation 673 676 Server stub 544 Service connection oriented 35 38 359 361 connectionless 35 38 358 359 Service level agreement 407 Service primitive 38 40 Service IEEE 802 11 311 312 integrated 418 421 provided transport layer 495 507 provided transport layer 356 357 relation protocols 40 Service user transport 497 Serving GPRS support node 68 Session 44 Session initiation protocol 731 731 735 compared H 323 733 734 Session key 828 Session layer 44 45 Session routing 362 Set top box 4 723 SGSN see Serving GPRS Support Node SHA see Secure Hash Algorithm Shannon Claude 94 95 Shannon limit 100 106 146 Shared secret authentication using 828 833 Short interframe spacing 308 Short message service 12 Shortest path routing 366 368 SIFS see Short InterFrame Spacing Signal balanced 129 130 Signal noise ratio 94 Signaling common channel 155 band 155 robbed bit 155 Signature block 629 Signatures digital 797 806 Signing code 858 Silly window syndrome 567 SIM card 69 171 Simple Internet protocol plus 457 INDEX Simple mail transfer protocol 625 638 641 Simple object access protocol 682 Simplex link 97 Single mode fiber 101 Sink tree 365 SIP see Session Initiation Protocol SIPP see Simple Internet protocol Plus Skin player 715 SLA see Service Level Agreement Sliding window TCP 565 568 Sliding window protocol 1 bit 229 232 226 244 229 232 522 SLIP see Serial Line Internet protocol Slot 264 Slotted ALOHA 264 266 265 Slow start TCP 574 threshold 576 Smart phone 12 Smiley 623 SMS see Short Message Service SMTP see Simple Mail Transfer Protocol Snail mail 623 SNR see Signal Noise Ratio SOAP see Simple Object Access Protocol Social issues 14 16 security 860 869 Social network 8 Socket 59 Berkeley 500 507 TCP 553 Socket programming 503 507 Soft handoff 178 Soft decision decoding 208 Soliton 103 SONET see Synchronous Optical NETwork Source port 453 Spam 623 Spanning tree 382 Spanning tree bridge 337 340 Spanning tree poem 339 SPE see Synchronous Payload Envelope Spectrum allocation 182 183 Spectrum auction 112 Speed light 106 Splitter 149 Spoofing DNS 848 850 Spot beam 119 Spread spectrum 135 direct sequence 108 frequency hopping 107 929 INDEX Sprint 111 Spyware 662 SSL see Secure Sockets Layer SST see Structured Stream Transport Stack protocol 31 32 Standard de facto 76 de jure 76 Stateful firewall 819 Static channel allocation 258 261 Static page Web 649 Static routing 364 Static Web page 649 662 663 Station keeping 118 Statistical multiplexing 34 Statistical time division multiplexing 135 STDM see Statistical Time Division Multiplexing Steganography 865 867 Stop wait protocol 221 226 522 Store forward packet switching 36 356 Stream cipher mode 790 791 Stream control transmission protocol 503 527 Streaming audio video 697 734 Streaming live media 721 724 Streaming media 699 Streaming stored media 713 720 Strowger gear 161 Structured P2P network 754 Structured stream transport 503 STS 1 see Synchronous Transport Signal 1 Stub client 544 server 544 Stub area 477 Stub network 481 Style sheet 670 671 Sublayer medium access control 257 350 Subnet 24 444 446 Subnet Internet protocol 444 446 Subnet mask 443 Subnetting 444 Subscriber identity module 69 171 Substitution cipher 769 770 Superframe extended 154 Supergroup 153 Supernet 447 Swarm BitTorrent 751 Switch 24 compared bridge hub 340 342 Ethernet 20 289 Switched Ethernet 20 280 288 290 Switching 161 164 circuit 161 162 cut 36 336 data link layer 332 349 label 360 470 474 message 600 packet 162 164 store forward 36 Switching element 24 Symbol 126 Symbol rate 127 Symmetric key cryptography 778 793 AES 783 787 cipher feedback mode 789 790 counter mode 791 792 DES 780 782 electronic code book mode 787 788 Rijndael 784 787 stream cipher mode 790 791 triple DES 782 783 Symmetric key signature 798 799 SYN cookie TCP 561 SYN flood attack 561 Synchronization 44 Synchronous connection oriented link 325 Synchronous digital hierarchy 156 159 Synchronous optical network 156 159 Synchronous payload envelope 157 Synchronous transport signal 1 157 System distributed 2 Systematic code 204 T T1 carrier 154 155 T1 line 128 154 Tag HTML 663 666 Tag switching 471 Tail drop 412 Talkspurt 551 Tandem office 141 TCG see Trusted Computing Group TCM see Trellis Coded Modulation TCP see Transmission Control Protocol TDD see Time Division Duplex TDM see Time Division Multiplexing Telco 61 930 INDEX Telephone cordless 165 mobile 164 179 smart 12 Telephone system 138 164 end office 140 guard band 133 guard time 135 local loop 144 152 mobile 164 179 modem 145 modulation 130 132 point presence 143 politics 142 144 structure 139 142 switching 161 164 tandem office 141 toll office 141 trunk 152 160 Telephone trunk 152 160 Television cable 179 186 community antenna 179 180 Temporal masking 703 Temporary key integrity protocol 825 Terminal VoIP 728 Text messaging 12 Texting 12 Third Generation Partnership Project 76 Third generation mobile phone network 65 69 174 179 Third party Web cookie 662 Threats security 847 848 Three bears problem 450 Three way handshake 516 Tier 1 ISP 64 Tier 1 network 437 Time division duplex 316 317 Time division multiplexing 135 154 156 Time slot 135 Timer management TCP 568 571 Timestamp TCP 560 Timing wheel 593 Tit tat strategy BitTorrent 752 TKIP see Temporary Key Integrity Protocol TLS see Transport Layer Security Token 271 Token bucket algorithm 397 408 411 Token bus 272 Token management 44 Token passing protocol 271 272 Token ring 271 Toll connecting trunk 141 Toll office 141 Top level domain 613 Torrent BitTorrent 750 TPDU see Transport Protocol Data Unit TPM see Trusted Platform Module Traceroute 466 Tracker BitTorrent 751 Traffic analysis 815 Traffic engineering 396 Traffic policing 407 Traffic shaping 407 407 411 Traffic throttling 398 401 Traffic aware routing 395 396 Trailer 32 194 216 250 326 Transcoding 694 Transfer agent 624 625 630 631 Transit service 480 Transmission baseband 125 light 14 116 passband 125 wireless 105 116 Transmission control protocol TCP 47 552 582 acknowledgement clock 574 application layer 47 48 comparison OSI 49 51 congestion collapse 572 congestion control 571 581 congestion window 571 connection establishment 560 562 connection management 562 565 connection release 562 critique 53 54 cumulative acknowledgement 558 568 delayed acknowledgement 566 duplicate acknowledgement 577 fast recovery 578 fast retransmission 577 future 581 582 introduction 552 553 Karn algorithm 571 keepalive timer 571 link layer 46 maximum segment size 559 maximum transfer unit 556 Nagle algorithm 566 performance 582 599 931 INDEX Transmission control protocol continued persistence timer 571 port 553 reference model 45 51 retransmission timeout 568 sawtooth 579 segment header 557 560 selective acknowledgement 580 silly window syndrome 567 sliding window 565 568 slow start 574 slow start threshold 576 socket 553 speeding 582 599 SYN cookie 561 SYN flood attack 561 timer management 568 571 timestamp option 560 transport layer 47 urgent data 555 well known port 553 window probe 566 window scale 560 Transmission line 24 Transmission media guided 85 105 Transmission opportunity 309 Transmit power control IEEE 802 11 312 Transponder 116 Transport structured stream 503 Transport entity 496 Transport layer 44 addressing 509 512 congestion control 530 541 delay tolerant networking 599 605 error control 522 527 flow control 522 527 performance 582 599 port 509 security 856 TCP 552 582 TCP IP 47 Transport protocols 507 530 transport service 495 507 UDP 541 552 Transport mode IP security 815 Transport protocol 507 530 541 582 design issues 507 530 Transport protocol data unit 499 Transport service access point 509 Transport service primitive 498 500 Transport service provider 497 Transport service user 497 Transposition cipher 771 772 Tree walk protocol adaptive 275 277 Trellis coded modulation 146 Triangle routing 388 Trigram 770 Triple DES 782 783 Trunk telephone 152 160 Trust anchor 812 Trusted computing 869 Trusted platform module 869 TSAP see Transport Service Access Point Tunnel mode IPSec 815 Tunneling 387 429 431 Twisted pair 96 97 unshielded 97 Twitter 8 Two army problem 518 519 TXOP see Transmission opportunity U U NII see Unlicensed National Information Infrastructure Ubiquitous computing 10 UDP see User Datagram Protocol UHF RFID 73 74 Ultra wideband 108 UMTS see Universal Mobile Telecommunications System Unchoked peer BitTorrent 752 Unicast 385 Unicasting 17 385 Uniform resource identifier 652 Uniform resource locator 650 Uniform resource name 652 Universal mobile telecommunications system 65 175 Universal serial bus 128 Unlicensed national information infrastructure 113 Unshielded twisted pair 97 Unstructured P2P network 754 Upstream proxy 742 Urgent data 555 URI see Uniform Resource Identifier URL see Scheme URN see Uniform Resource Name USB see Universal Serial Bus 932 INDEX User mobile 10 13 User agent 624 626 User datagram protocol 47 541 552 542 549 550 port 542 real time transmission 546 552 remote procedure call 541 543 RTP 547 549 Utopia protocol 220 222 UTP see Unshielded Twisted Pair UWB see Ultra WideBand V V 32 modem 146 V 34 modem 146 V 90 modem 147 V 92 modem 147 Vacation agent 629 Vampire tap 291 Van Allen belt 117 VC see Virtual Circuit Very small aperture terminal 119 Video interlaced 705 progressive 705 streaming 704 712 Video compression 706 Video field 705 Video demand 713 Video server 414 416 Virtual circuit 249 358 361 Virtual circuit network 358 comparison datagram network 361 362 Virtual LAN 21 332 342 349 Virtual private network 4 26 431 821 822 Virtual circuit network 358 Virus 860 Visitor location register 171 VLAN see Virtual LAN VLR see Visitor Location Register Vocal tract 702 Vocoder 701 VOD see Video Demand Voice IP 5 36 698 725 728 734 Voice signals digitizing 153 154 Voice grade line 93 VoIP see Voice IP VPN see Virtual Private Network VSAT see Very Small Aperture Terminal W W3C see World Wide Web Consortium Walled garden 723 Walsh code 136 WAN see Wide Area Network WAP see Wireless Application Protocol Watermarking 867 Waveform coding 702 Wavelength 106 Wavelength division multiplexing 159 160 WCDMA see Wideband Code Division Multiple Access WDM see Wavelength Division Multiplexing Wearable computer 13 Web see World Wide Web Web application 4 Web browser 648 extension 859 860 helper application 654 plug 653 654 859 proxy 741 742 Webmail 645 645 646 Weighted fair queueing 414 Well known port TCP 553 WEP see Wired Equivalent Privacy WFQ see Weighted Fair Queueing White space 113 Whitening 781 Wide area network 23 23 27 Wideband code division multiple access 65 175 WiFi see IEEE 802 11 WiFi Alliance 76 WiFi protected access 73 311 WiFi protected access 2 312 823 Wiki 8 Wikipedia 8 WiMAX see IEEE 802 16 WiMAX Forum 313 Window probe TCP 566 Window scale TCP 560 Wine load shedding policy 401 Wired equivalent privacy 73 311 823 933 INDEX Wireless broadband 312 320 fixed 11 Wireless application protocol 693 Wireless issues 539 541 Wireless LAN 39 277 280 299 312 Wireless LAN see IEEE 802 11 Wireless LAN protocol 277 280 Wireless LAN protocols 277 280 Wireless router 19 Wireless security 822 827 Wireless transmission 105 116 Work factor cryptographic 768 World Wide Web 2 646 697 AJAX 679 683 architectural overview 647 649 caching 690 692 cascading style sheets 670 672 client side 649 652 client side page generation 676 678 connections 684 686 cookies 658 662 crawling 696 dynamic pages 672 forms 667 680 HTML 663 667 HTTP 683 684 message headers 688 690 methods 686 688 MIME types 652 655 mobile web 693 695 page 647 proxy 692 741 743 search 695 697 security 856 860 tracking 661 server side 655 658 server side page generation 673 676 static web pages 662 672 World Wide Web Consortium 82 647 Wormhole routing 336 WPA see WiFi Protected Access WPA2 see WiFi Protected Access 2 X X 400 standard 629 X 509 809 810 XHTML see eXtended HyperText Markup Language XML see eXtensible Markup Language XSLT see eXtensible Stylesheet Language Transformation Z Zipf law 737 Zone DNS 619 620 multimedia 728 Also Andrew S Tanenbaum Modern Operating Systems 3rd ed This worldwide best seller incorporates latest developments operating systems The book starts chapters principles including processes memory management file systems I O Then goes three chapter long case studies Linux Windows Symbian Tanenbaum experience designer three operating systems Amoeba Globe MINIX gives background authors match final chapter distills long experience advice operating system designers Also Andrew S Tanenbaum Albert S Woodhull Operating Systems Design Implementation 3rd ed All textbooks operating systems long theory short practice This one different In addition usual material processes memory management file systems I O contains CD ROM source code C small complete POSIXconformant operating system called MINIX 3 see www minix3 org All principles illustrated showing apply MINIX 3 The reader also compile test experiment MINIX 3 leading depth knowledge operating system really works Also Andrew S Tanenbaum Structured Computer Organization 5th ed A computer structured hierarchy levels hardware operating system This book treats starting transistor works ending operating system design No previous experience either hardware software needed follow book however topics self contained explained simple terms starting right beginning The running examples used throughout book range high end UltraSPARC III ever popular x86 Pentium tiny Intel 8051 used small embedded systems Also Andrew S Tanenbaum Maarten van Steen Distributed Systems Principles Paradigms 2nd ed Distributed systems becoming ever important world book explains principles illustrates numerous examples Among topics covered architectures processes communication naming synchronization consistency fault tolerance security Examples taken distributed object based file Web based coordination based systems ABOUT THE AUTHORS Andrew S Tanenbaum S B degree M I T Ph D University California Berkeley He currently Professor Computer Science Vrije Universiteit taught operating systems networks related topics 30 years His current research highly reliable operating systems although worked compilers distributed systems security topics years These research projects led 150 refereed papers journals conferences Prof Tanenbaum also co authored five books appeared 19 editions The books translated 21 languages ranging Basque Thai used universities world In 159 versions language edition combinations listed www cs vu nl ast publications Prof Tanenbaum also produced considerable volume software including Amsterdam Compiler Kit retargetable portable compiler Amoeba early distributed system used LANs Globe wide area distributed system He also author MINIX small UNIX clone initially intended use student programming labs It direct inspiration Linux platform Linux initially developed The current version MINIX called MINIX 3 focused extremely reliable secure operating system Prof Tanenbaum consider work done computer equipped reset button living person ever experienced system crash MINIX 3 going open source project invited contribute Go www minix3 org download free copy find happening Tanenbaum Fellow ACM Fellow IEEE member Royal Netherlands Academy Arts Sciences He also numerous scientific prizes including 2010 TAA McGuffey Award Computer Science Engineering books 2007 IEEE James H Mulligan Jr Education Medal 2002 TAA Texty Award Computer Science Engineering books 1997 ACM SIGCSE Award Outstanding Contributions Computer Science Education 1994 ACM Karl V Karlstrom Outstanding Educator Award His home page World Wide Web found http www cs vu nl ast David J Wetherall Associate Professor Computer Science Engineering University Washington Seattle advisor Intel Labs Seattle He hails Australia received B E electrical enginering University Western Australia Ph D computer science M I T Prof Wetherall worked area networking past two decades His research focused network systems especially wireless networks mobile computing design Internet protocols network measurement He received ACM SIGCOMM Test Time award research pioneered active networks architecture rapidly introducing new network services He received IEEE William Bennett Prize breakthroughs Internet mapping His research recognized NSF CAREER award 2002 became Sloan Fellow 2004 As well teaching networking Prof Wetherall participates networking research community He co chaired program committees SIGCOMM NSDI MobiSys cofounded ACM HotNets workshops He served numerous program committees networking conferences editor ACM Computer Communication Review His home page World Wide Web found http djw cs washington edu